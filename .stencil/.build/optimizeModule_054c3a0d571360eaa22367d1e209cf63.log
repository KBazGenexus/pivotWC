import{r as registerInstance,h}from"./p-df930776.js";var commonjsGlobal=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function createCommonjsModule(e,r,t){return t={path:r,exports:{},require:function(e,r){return commonjsRequire()}},e(t,t.exports),t.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var oat_pivotTable=createCommonjsModule((function(module,exports){var OAT={};OAT.Preferences={showAjax:1,useCursors:1,windowTypeOverride:0,version:"10.08.2023",httpError:1,allowDefaultResize:1,allowDefaultDrag:1};OAT.$=function(e){if(typeof e=="string"){var r=document.getElementById(e)}else{var r=e}if(e instanceof Array){var r=[];for(var t=0;t<e.length;t++){r.push(OAT.$(e[t]))}}if(!r)return false;return r};OAT.$$=function(e,r){var t=r||document;var a=t.getElementsByTagName("*");var s=[];if(OAT.Dom.isClass(t,e)){s.push(t)}for(var i=0;i<a.length;i++){if(OAT.Dom.isClass(a[i],e)){s.push(a[i])}}return s};OAT.$v=function(e){var r=OAT.$(e);if(!r)return false;if(!("value"in r))return false;return r.value};Array.prototype.findIndex=function(e){for(var r=0;r<this.length;r++)if(this[r]==e){return r}return-1};String.prototype.trimpivot=function(){var e=this.match(/^ *(.*?) *$/);return e?e[1]:this};OAT.addTextNode=function(e,r){var t=document.createTextNode(r);var a=jQuery('<span id="span_txt_pivot"></span>')[0];a.appendChild(t);e.appendChild(a)};OAT.addImageNode=function(e,r,t,a){var s=document.createElement("i");if(a!=undefined){s.setAttribute("id",a)}s.setAttribute("class","material-icons");s.setAttribute("style",t);s.textContent=r;e.appendChild(s)};OAT.replaceTextNode=function(e,r){while(e.firstChild){e.removeChild(e.firstChild)}var t=document.createTextNode(r);e.appendChild(t)};OAT.AddItemToList=function(e,r){if(e.indexOf(r)==-1){e.push(r)}return e.sort((function(e,r){return e-r}))};OAT.removeIconFont=function(e){return e.replace(/arrow_drop_up/g,"").replace(/arrow_drop_down/g,"").replace(/remove/g,"").replace(/add/g,"").replace(/settings/g,"")};OAT.ApplyPictureValue=function(e,r,t,a){if(e=="#NuN#"){var s=t.getAttribute("textForNullValues");if(s==""){return" "}if(s!=undefined){return s}return" "}var i=t.getAttribute("decimalSeparator")!=undefined&&t.getAttribute("decimalSeparator")!=null?t.getAttribute("decimalSeparator"):".";var f=t.getAttribute("decimalPlaces")!=undefined&&t.getAttribute("decimalPlaces")!=null?t.getAttribute("decimalPlaces"):2;t.getAttribute("thousandsSeparator");var l=t.getAttribute("dateFormat");var n=e;var o=false;var u="";if(r=="integer"||r=="real"){if(a!=undefined||a!=null){if(a[0]!="Z"||a[0]!="9"||a[0]!=","||a[0]!="."){o=true;var v=0;while(a.length>v&&a[v]!="Z"&&a[v]!="9"&&a[v]!=","&&a[v]!="."){v++}u=a.substring(0,v);a=a.substring(v)}}}var c=false;var d="";if(r=="integer"||r=="real"){if(a!=undefined||a!=null){if(a[a.length-1]!="Z"||a[a.length-1]!="9"||a[a.length-1]!=","||a[a.length-1]!="."){c=true;var v=a.length-1;while(v>-1&&a[v]!="Z"&&a[v]!="9"&&a[v]!=","&&a[v]!="."){v--}d=a.substring(v+1);a=a.substring(0,v+1)}}}switch(r){case"integer":f=0;case"real":if(a!=undefined&&a!=""){var n=qv.util.formatNumber(parseFloat(e),f,a,false)}else{var m=e.split(".");var h=true;if(a==""&&r=="integer"){h=false}if(r=="real"){n=parseFloat(e).toFixed(2);m=n.split(".")}n=m[0];var p=-1;if(a!=undefined&&a!=""){var T=a.split(".");if(T.length>1)p=T[1].indexOf("Z")}if(m[1]==null){if(h){var A=f;if(p!=-1){A=p}if(A>0){n=n+i;for(var w=0;w<A;w++){n=n+"0"}}}}else{if(h){if(p===-1){if(m[1].length<f){n=n+i+m[1];for(var w=0;w<f-m[1].length;w++){n=n+"0"}}else{if(m[1].length>f){var O="";for(var w=0;w<f;w++){O=O+m[1].charAt(w)}n=n+i+O}else{n=n+i+m[1]}}}else{var y=p;if(m[1].length<f){if(m[1].length>0||y>0){n=n+i+m[1];for(var w=0;w<y-m[1].length;w++){n=n+"0"}}}else{if(m[1].length>f){var O="";for(var w=0;w<f;w++){O=O+m[1].charAt(w)}n=n+i+O}else{n=n+i+m[1]}}}}}}break;case"date":if(e=="")return"";if(a===""){var _=e.split("-");var n=e;if(l!=undefined&&l!=null){pict=l.split("");n="";for(var w=0;w<=2;w++){if(pict[w]==="M")n=n+_[1];if(pict[w]==="D")n=n+_[2];if(pict[w]==="Y")n=n+_[0];if(w!=2)n=n+"/"}}else{n=_[1]+"/"+_[2]+"/"+_[0]}}else{var m=e.split("-");n="";if(a=="99/99/9999"){if(m[0].length==4){if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}}else{n=e;while(n.indexOf("-")!=-1){n.replace("-","/")}}}else if(a=="99/99/99"){if(m[0].length==4){m[0]=m[0].substr(m[0].length-2,2)}if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}}else if(a=="9999/99/99"){if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}}else{if(m[0].length==4){m[0]=m[0].substr(m[0].length-2,2)}if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}}}break;case"datetime":if(e=="")return"";var g=e.split("T");if(e.indexOf("T")===-1){g=e.split(" ")}if(a===""){var _=g[0].split("-");var n=e;if(l!=undefined&&l!=null){pict=l.split("");n="";for(var w=0;w<=2;w++){if(pict[w]==="M")n=n+_[1];if(pict[w]==="D")n=n+_[2];if(pict[w]==="Y")n=n+_[0];if(w!=2)n=n+"/"}}else{n=_[1]+"/"+_[2]+"/"+_[0]}}else{var b=a.split(" ");var m=g[0].split("-");n="";if(b[0]=="99/99/9999"){if(m[0].length==4){if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}}else{n=e;while(n.indexOf("-")!=-1){n.replace("-","/")}}}else if(b[0]=="99/99/99"){if(m[0].length==4){m[0]=m[0].substr(m[0].length-2,2)}if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}}else if(b[0]=="9999/99/99")if(l==undefined||l==null||l=="MDY"){n=m[1]+"/"+m[2]+"/"+m[0]}else if(l!=undefined&&l=="YMD"){n=m[0]+"/"+m[1]+"/"+m[2]}else{n=m[2]+"/"+m[1]+"/"+m[0]}else{n=""}}if(a===""){if(g.length>1){var x=g[1].split(".");n=n+" "+x[0]}}else{var b=a.split(" ");if(a.split(" ").length<2&&b[0]!="99/99/9999"&&b[0]!="9999/99/99"&&b[0]!="99/99/99"){b.push(a)}if(b.length>1){var F;if(g.length>1){var x=g[1].split(".");F=x[0].split(":");if(F.length<2){F[1]="00";F[2]="00"}if(F.length<3){F[2]="00"}if(x.length<2){F[3]="000"}else{F[3]=x[1]}}else{F=new Array(3);F[0]="00";F[1]="00";F[2]="00";F[3]="000"}switch(b[1]){case"99":n=n+" "+F[0];break;case"99:99":n=n+" "+F[0]+":"+F[1];break;case"99:99:99":n=n+" "+F[0]+":"+F[1]+":"+F[2];break;case"99:99:99.999":n=n+" "+F[0]+":"+F[1]+":"+F[2]+"."+F[3];break;default:n=n+" "+F[0]+":"+F[1]+":"+F[2]}}}break;case"character":n=OAT.Dom.fromSafeXML(e);if(a=="@!"){n=e.toUpperCase()}break}if(o){n=u+n}if(c){n=n+d}return n};OAT.SetSelectedNodeBackgroundColor=function(e,r,t){OAT.ClearSelectedNodes(t);OAT.SetNodeBackgroundColor(e,r)};OAT.ClearSelectedNodes=function(e){e.find(".gx-qv-selected-element").removeClass("gx-qv-selected-element")};OAT.SetNodeBackgroundColor=function(e,r){if(!jQuery(e).hasClass("gx-qv-selected-element")){jQuery(e).addClass("gx-qv-selected-element")}};OAT.IsNodeSelected=function(e){return jQuery(e).hasClass("gx-qv-selected-element")};OAT.SelectAllRow=function(e,r,t){for(var a=0;a<e.children.length;a++){if(t==undefined||t!=a)OAT.SetNodeBackgroundColor(e.children[a],r)}};OAT.isSD=function(){var e=navigator.userAgent.toLowerCase();var r=e.indexOf("android")>-1;var t=e.indexOf("iPhone")!=-1||e.indexOf("iPad")!=-1||e.indexOf("iPod")!=-1;if(r||t){return true}else{return false}};OAT.isAndroid=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("android")>-1};OAT.isSafari=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("Safari")!=-1&&e.indexOf("Chrome")===-1};OAT.isIE=function(){if(window.document.documentMode)return true;else return false};OAT.isWebkit=function(){var e=navigator.userAgent.toLowerCase();return e.search(/webkit/gi)!=-1};OAT.resourceURL=function(e){return e};OAT.charReplace=function(e,r,t){var a="";var s=e.length;for(var i=0;i<s;i++){var f=false;var l=r.length;for(var n=0;n<l;n++){if(e.charAt(i)==r[n]){if(n<t.length){a+=t[n];f=true;break}}}if(f===false)a+=e.charAt(i)}return a};OAT.Dom={create:function(e,r,t){var a=document.createElement(e);if(r){for(prop in r){a.style[prop]=r[prop]}}if(t){a.className=t}return a},createNS:function(e,r){if(document.createElementNS){var t=document.createElementNS(e,r)}else{var t=document.createElement(r);t.setAttribute("xmlns",e)}return t},text:function(e){var r=document.createTextNode(e);return r},button:function(e){var r=OAT.Dom.create("input");r.type="button";r.value=e;return r},radio:function(e){if(OAT.isIE()){var r=document.createElement('<input type="radio" name="'+e+'" />');return r}else{var r=OAT.Dom.create("input");r.name=e;r.type="radio";return r}},image:function(e,r,t,a){t=t?t+"px":"auto";a=a?a+"px":"auto";var s=OAT.Dom.create("img",{width:t,height:a});OAT.Dom.imageSrc(s,e,r);return s},imageSrc:function(e,r,t){var a=OAT.$(e);!!r.toLowerCase().match(/png$/);a.src=r},option:function(e,r,t){var a=OAT.Dom.create("option");OAT.addTextNode(a,e);a.value=r;if(t){OAT.$(t).appendChild(a)}return a},append:function(){for(var e=0;e<arguments.length;e++){var r=arguments[e];if(!(r instanceof Array)){continue}if(r.length<2){continue}var t=OAT.$(r[0]);for(var a=1;a<r.length;a++){var s=r[a];if(!(s instanceof Array)){s=[s]}for(var i=0;i<s.length;i++){var f=s[i];t.appendChild(OAT.$(f))}}}},hide:function(e){if(arguments.length>1){for(var r=0;r<arguments.length;r++){OAT.Dom.hide(arguments[r])}return}if(e instanceof Array){for(var r=0;r<e.length;r++){OAT.Dom.hide(e[r])}return}var t=OAT.$(e);if(!t){return}var a=t.getElementsByTagName("input");var s=[];for(var r=0;r<a.length;r++){s.push(a[r])}if(t.tagName.toLowerCase()=="input"){s.push(t)}for(var r=0;r<s.length;r++){var i=s[r];if(i.type=="radio"||i.type=="checkbox"){if(!i.__checked){i.__checked=i.checked?"1":"0"}}}t.style.display="none"},show:function(e){if(arguments.length>1){for(var r=0;r<arguments.length;r++){OAT.Dom.show(arguments[r])}return}if(e instanceof Array){for(var r=0;r<e.length;r++){OAT.Dom.show(e[r])}return}var t=OAT.$(e);if(!t){return}t.style.display="";var a=t.getElementsByTagName("input");var s=[];for(var r=0;r<a.length;r++){s.push(a[r])}if(t.tagName.toLowerCase()=="input"){s.push(t)}for(var r=0;r<s.length;r++){var i=s[r];if(i.type=="radio"||i.type=="checkbox"){if(i["__checked"]&&i.__checked==="1"){i.checked=true}if(i["__checked"]&&i.__checked==="0"){i.checked=false}i.__checked=false}}},clear:function(e){var r=OAT.$(e);while(r.firstChild){r.removeChild(r.firstChild)}},unlink:function(e){var r=OAT.$(e);if(!r){return}if(!r.parentNode){return}r.parentNode.removeChild(r)},center:function(e,r,t,a){var s=OAT.$(e);var i=s.offsetParent;if(a){i=a}if(!i){return}var f=i==document.body||i.tagName.toLowerCase()=="html"?OAT.Dom.getViewport():OAT.Dom.getWH(i);var l=OAT.Dom.getWH(s);var n=Math.round(f[0]/2-l[0]/2);var o=Math.round(f[1]/2-l[1]/2);if(o<0){o=30}var u=OAT.Dom.getScroll();if(i==document.body||i.tagName.toLowerCase()=="html"){n+=u[0];o+=u[1]}if(r){s.style.left=n+"px"}if(t){s.style.top=o+"px"}},isChild:function(e,r){var t=OAT.$(e);var a=OAT.$(r);var s=t.parentNode;do{if(!s){return false}if(s==a){return true}s=s.parentNode}while(s!=document.body&&s!=document);return false},isKonqueror:function(){return navigator.userAgent.match(/konqueror/i)?true:false},isKHTML:function(){return navigator.userAgent.match(/khtml/i)?true:false},isIE:function(){return document.attachEvent&&!document.addEventListener?true:false},isIE7:function(){return navigator.userAgent.match(/msie 7/i)?true:false},isIE6:function(){return OAT.Dom.isIE()&&!OAT.Dom.isIE7()},isGecko:function(){return!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i)?true:false},isOpera:function(){return navigator.userAgent.match(/Opera/)?true:false},isWebKit:function(){return navigator.userAgent.match(/AppleWebKit/)?true:false},isMac:function(){return navigator.platform.toString().match(/mac/i)?true:false},isLinux:function(){return navigator.platform.toString().match(/linux/i)?true:false},isWindows:function(){return navigator.userAgent.toString().match(/windows/i)?true:false},color:function(e){var r=function(e){return parseInt(e,16)};if(e.match(/#/)){if(e.length==4){var t="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3)}else{var t=e}var a=t.match(/#(..)(..)(..)/);return[r(a[1]),r(a[2]),r(a[3])]}else{var a=e.match(/\(([^,]*),([^,]*),([^\)]*)/);return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},isClass:function(e,r){var t=OAT.$(e);if(!t){return false}if(r=="*"){return true}if(r==""){return false}if(!t.className){return false}var a=t.className.split(" ");var s=a.indexOf(r);return s!=-1},addClass:function(e,r){var t=OAT.$(e);if(!t){return}if(OAT.Dom.isClass(t,r)){return}var a=t.className.split(" ");a.push(r);if(a[0]==""){a.splice(0,1)}t.className=a.join(" ")},setIdPropertyValue:function(e,r){var t=OAT.$(e);if(!t){return}t.id=r},removeClass:function(e,r){var t=OAT.$(e);if(!t){return}if(!OAT.Dom.isClass(t,r)){return}if(r=="*"){t.className=""}var a=t.className.split(" ");var s=a.indexOf(r);if(s==-1){return}a.splice(s,1);t.className=a.join(" ")},getViewport:function(){if(OAT.isWebkit()){return[window.innerWidth,window.innerHeight]}if(navigator.userAgent.match(/Opera/)||document.compatMode=="BackCompat"){return[document.body.clientWidth,document.body.clientHeight]}else{return[document.documentElement.clientWidth,document.documentElement.clientHeight]}},position:function(e){var r=OAT.$(e);var t=r.offsetParent;if(r==document.body||r==document||!t){return OAT.Dom.getLT(r)}var a=OAT.Dom.position(t);var s=OAT.Dom.getLT(r);var i=s[0];var f=s[1];if(!navigator.userAgent.match(/Opera/)||r.scrollTop!=r.offsetTop||r.scrollLeft!=r.offsetLeft){i-=r.scrollLeft;f-=r.scrollTop}if(OAT.isWebkit()&&t==document.body&&OAT.Dom.style(r,"position")=="absolute"){return[i,f]}i+=a[0];f+=a[1];return[i,f]},getLT:function(e){var r=OAT.$(e);var t,a;if(r.style.left&&r.style.position!="relative"){t=parseInt(r.style.left)}else{t=r.offsetLeft}if(r.style.top&&r.style.position!="relative"){a=parseInt(r.style.top)}else{a=r.offsetTop}return[t,a]},getWH:function(e){var r,t;var a=OAT.$(e);if(a.style.width&&!a.style.width.match(/%/)&&a.style.width!="auto"){r=parseInt(a.style.width)}else if(OAT.Style.get(a,"width")&&!OAT.isIE()){r=Math.round(parseFloat(OAT.Style.get(a,"width")))}else{r=a.offsetWidth;if(a.tagName.toLowerCase()=="input"){r+=5}}if(a.style.height&&!a.style.height.match(/%/)&&a.style.height!="auto"){t=parseInt(a.style.height)}else if(OAT.Style.get(a,"height")&&!OAT.isIE()){t=Math.round(parseFloat(OAT.Style.get(a,"height")))}else{t=a.offsetHeight;if(a.tagName.toLowerCase()=="input"){t+=5}}if(a==document.body){t=OAT.isIE()?document.body.clientHeight:window.innerHeight}return[r,t]},moveBy:function(e,r,t){var a,s;var i=OAT.$(e);if(OAT.Dom.style(i,"position")=="absolute"){if(!i.style.left){i.style.left=i.offsetLeft+"px";i.style.right=""}if(!i.style.top){i.style.top=i.offsetTop+"px";i.style.bottom=""}}var f=OAT.Dom.getLT(i);a=f[0];s=f[1];var l=a+r;var n=s+t;i.style.left=l+"px";i.style.top=n+"px"},resizeBy:function(e,r,t){var a,s;var i=OAT.$(e);if(OAT.Dom.style(i,"position")=="absolute"&&r){if(!i.style.left){i.style.left=i.offsetLeft+"px";i.style.right=""}if(!i.style.top&&t){i.style.top=i.offsetTop+"px";i.style.bottom=""}}var f=OAT.Dom.getWH(i);a=f[0];s=f[1];var l=a+r;var n=s+t;if(r){i.style.width=l+"px"}if(t){i.style.height=n+"px"}},decodeImage:function(e){var r=OAT.Crypto.base64d(e);var t="image/";switch(r.charAt(1)){case"I":t+="gif";break;case"P":t+="png";break;case"M":t+="bmp";break;default:t+="jpeg";break}var a="data:"+t+";base64,"+e;return a},removeSelection:function(){var e=false;if(document.getSelection&&!(!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i))){e=document.getSelection()}if(window.getSelection){e=window.getSelection()}if(document.selection){e=document.selection}if(e){if(e.empty){e.empty()}if(e.removeAllRanges){e.removeAllRanges()}}},getScroll:function(){var e=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var r=Math.max(document.documentElement.scrollTop,document.body.scrollTop);return[e,r]},getFreeSpace:function(e,r){var t=OAT.Dom.getScroll();var a=OAT.Dom.getViewport();var s=e-t[0];var i=a[0]-e+t[0];var f=r-t[1];var l=a[1]-r+t[1];var n=s>i;var o=f>l;return[n,o]},toSafeXML:function(e){if(typeof e!="string"){return e}return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},fromSafeXML:function(e){return e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<")},uriParams:function(){var e={};var r=location.search;if(r.length>1){r=r.substring(1)}if(!r){return e}var t=r.split("&");for(var a=0;a<t.length;a++){var s=t[a];if(!s){continue}var i=s.indexOf("=");if(i==-1){e[decodeURIComponent(s)]="";continue}var f=s.substring(0,i);var l=s.substring(i+1);f=decodeURIComponent(f);l=decodeURIComponent(l);var n=false;if(n=f.match(/(.*)\[\]$/)){f=n[1];if(f in e){e[f].push(l)}else{e[f]=[l]}}else{e[f]=l}}return e},changeHref:function(e,r){var t=false;var a=OAT.$(e);var s=a;while(s.parentNode){s=s.parentNode;if(s==document.body){t=true}}if(t){a.href=r}else if(a.parentNode){var i=a.parentNode;var f=a.nextSibling;document.body.appendChild(a);a.href=r;OAT.Dom.unlink(a);i.insertBefore(a,f)}else{document.body.appendChild(a);a.href=r;OAT.Dom.unlink(a)}},makePosition:function(e){var r=OAT.$(e);if(OAT.Dom.style(r,"position")!="absolute"){r.style.position="relative"}}};OAT.Style={include:function(e,r,t){if(!e)return;e=r+"QueryViewer/oatPivot/css/"+e;if(!t){var a=document.getElementsByTagName("link");var s=location.protocol+"//"+location.host;for(var i=0;i<a.length;i++)if(e==a[i].getAttribute("href")||s+e==a[i].getAttribute("href"))return}var f=OAT.Dom.create("link");f.rel="stylesheet";f.type="text/css";f.href=e;jQuery("head").prepend(f)},get:function(e,r){var t=OAT.$(e);if(document.defaultView&&document.defaultView.getComputedStyle){var a=document.defaultView.getComputedStyle(t,"");if(!a){return true}return a[r]}else{try{var s=t.currentStyle[r]}catch(e){var s=t.getExpression(r)}return s}},background:function(e,r){var t=OAT.$(e);var a=!!r.toLowerCase().match(/png$/);if(a&&OAT.isIE()){t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"', sizingMethod='crop')"}else{t.style.backgroundImage="url("+r+")"}},apply:function(e,r){var t=OAT.$(e);if(!t){return}for(var a in r){t.style[a]=r[a]}},opacity:function(e,r){var t=Math.max(r,0);var a=OAT.$(e);if(OAT.isIE()){a.style.filter="alpha(opacity="+Math.round(t*100)+")"}else{a.style.opacity=t}}};OAT.Dom.style=OAT.Style.get;OAT.Dom.applyStyle=OAT.Style.apply;OAT.Event={attach:function(e,r,t){var a=OAT.$(e);if(a.addEventListener){a.addEventListener(r,t,false)}else if(a.attachEvent){a.attachEvent("on"+r,t)}else{a["on"+r]=t}},detach:function(e,r,t){var a=OAT.$(e);if(a.removeEventListener){a.removeEventListener(r,t,false)}else if(a.detachEvent){a.detachEvent("on"+r,t)}else{a["on"+r]=false}},source:function(e){return e.target?e.target:e.srcElement},cancel:function(e){e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation()}},position:function(e){var r=OAT.Dom.getScroll();return[e.clientX+r[0],e.clientY+r[1]]},prevent:function(e){if(e.preventDefault){e.preventDefault()}if(window.document.documentMode){e.returnValue=false}}};OAT.Dom.attach=OAT.Event.attach;OAT.Dom.detach=OAT.Event.detach;OAT.Dom.source=OAT.Event.source;OAT.Dom.eventPos=OAT.Event.position;OAT.Dom.prevent=OAT.Event.prevent;OAT.Loader={toolkitPath:false,loadOccurred:0,openAjax:false};OAT.MSG={DEBUG:0,OAT_DEBUG:0,OAT_LOAD:1,ANIMATION_STOP:2,TREE_EXPAND:3,TREE_COLLAPSE:4,DS_RECORD_PREADVANCE:5,DS_RECORD_ADVANCE:6,DS_PAGE_PREADVANCE:7,DS_PAGE_ADVANCE:8,AJAX_START:9,AJAX_ERROR:10,GD_START:11,GD_ABORT:12,GD_END:13,DOCK_DRAG:14,DOCK_REMOVE:15,SLB_OPENED:16,SLB_CLOSED:17,registry:[],attach:function(e,r,t){if(!e){return}OAT.MSG.registry.push([e,r,t])},detach:function(e,r,t){if(!e){return}var a=-1;for(var s=0;s<OAT.MSG.registry.length;s++){var i=OAT.MSG.registry[s];if(i[0]==e&&i[1]==r&&i[2]==t){a=s}}if(a!=-1){OAT.MSG.registry.splice(a,1)}},send:function(e,r,t){for(var a=0;a<OAT.MSG.registry.length;a++){var s=OAT.MSG.registry[a];var i=e==s[0]||s[0]=="*";if(!i){continue}var f=r==s[1]||s[1]=="*";if(!f&&s[1].toString().match(/\*/)){var l=new RegExp(s[1]);var n="";for(var o in OAT.MSG){var u=OAT.MSG[o];if(u==r){n=o}}if(n.match(l)){f=true}}if(f){s[2](e,r,t)}}}};if(typeof window!="undefined"){OAT.Event.attach(window,"load",(function(){OAT.Loader.loadOccurred=1;OAT.Loader.callListeners()}))}OAT.Loader.listeners=new Array;OAT.Loader.addListener=function(e){if(OAT.Loader.loadOccurred==1)e();else{OAT.Loader.listeners.push(e)}};OAT.Loader.callListeners=function(){for(var e=0,r=this.listeners.length;e<r;e++)OAT.Loader.listeners[e]()};OAT.LoadJapanesseCharacters=function(){var e="";for(var r=0;r<jQuery("script").length;r++){var t=jQuery("script")[r].src;if(t.indexOf("gxpivotjs")>0){e=t;break}}OAT.rP=e.substring(0,e.indexOf("QueryViewer/oatPivot"));if(gx.languageCode=="jap"||gx.languageCode=="jpn"||gx.languageCode=="jp"||gx.languageCode=="ja"||gx.languageCode=="jpx"||gx.languageCode=="ain"||gx.languageCode=="jpns"||gx.languageCode=="ams"||gx.languageCode=="japanese"||gx.languageCode=="JAP"||gx.languageCode=="JP"||gx.languageCode=="JA"||gx.languageCode=="JPN"||gx.languageCode=="ja-JP"||gx.languageCode=="ja_JP"||gx.languageCode=="jp"){var a=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/downloadify/"+"jsPDF_japanese.js",true);var s=document.getElementsByTagName("head")[0]||document.documentElement;var i=s.getElementsByTagName("script");var f=false;for(var r=0;i.length>r;r++){if(i[r].src==a){f=true}}if(!f){var l=document.createElement("script");l.type="text/javascript";l.src=a;l.onerror=function(){var e=document.createElement("script");e.type="text/javascript";e.src=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/downloadify/"+"jsPDF_japanese.src.js",true);var r=document.getElementsByTagName("head")[0]||document.documentElement;r.insertBefore(e,r.lastChild)};l.onreadystatechange=function(){var e=this.readyState;if(e==="loaded"||e==="complete"){l.onreadystatechange=null}};s.insertBefore(l,s.lastChild)}}};var jsPDF=function(){if(typeof btoa==="undefined"){window.btoa=function(e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=r.split(""),a,s,i,f,l,n,o,u,v=0,c=0,d="",m=[],h;do{a=e.charCodeAt(v++);s=e.charCodeAt(v++);i=e.charCodeAt(v++);u=a<<16|s<<8|i;f=u>>18&63;l=u>>12&63;n=u>>6&63;o=u&63;m[c++]=t[f]+t[l]+t[n]+t[o]}while(v<e.length);d=m.join("");h=e.length%3;return(h?d.slice(0,h-3):d)+"===".slice(h||3)}}if(typeof atob==="undefined"){window.atob=function(e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t,a,s,i,f,l,n,o,u=0,v=0,c="",d=[];if(!e){return e}e+="";do{i=r.indexOf(e.charAt(u++));f=r.indexOf(e.charAt(u++));l=r.indexOf(e.charAt(u++));n=r.indexOf(e.charAt(u++));o=i<<18|f<<12|l<<6|n;t=o>>16&255;a=o>>8&255;s=o&255;if(l===64){d[v++]=String.fromCharCode(t)}else if(n===64){d[v++]=String.fromCharCode(t,a)}else{d[v++]=String.fromCharCode(t,a,s)}}while(u<e.length);c=d.join("");return c}}var e=typeof Object.keys==="function"?function(e){return Object.keys(e).length}:function(e){var r=0,t;for(t in e){if(e.hasOwnProperty(t)){r++}}return r},r=function(e){this.topics={};this.context=e;this.publish=function(e,r){if(this.topics[e]){var t=this.topics[e],a=[],s,i,f,l,n=function(){};r=Array.prototype.slice.call(arguments,1);for(i=0,f=t.length;i<f;i++){l=t[i];s=l[0];if(l[1]){l[0]=n;a.push(i)}s.apply(this.context,r)}for(i=0,f=a.length;i<f;i++){t.splice(a[i],1)}}};this.subscribe=function(e,r,t){if(!this.topics[e]){this.topics[e]=[[r,t]]}else{this.topics[e].push([r,t])}return{topic:e,callback:r}};this.unsubscribe=function(e){if(this.topics[e.topic]){var r=this.topics[e.topic],t,a;for(t=0,a=r.length;t<a;t++){if(r[t][0]===e.callback){r.splice(t,1)}}}}};function t(a,s,i,f,l,n){if(typeof a==="undefined"){a="p"}else{a=a.toString().toLowerCase()}if(typeof s==="undefined"){s="mm"}if(typeof i==="undefined"){i="a4"}if(typeof f==="undefined"&&typeof zpipe==="undefined"){f=false}var o=i.toString().toLowerCase(),u="0.9.0rc2",v=[],c=0,d=f,m="1.3",h={a3:[841.89,1190.55],a4:[l,n],a5:[420.94,595.28],letter:[612,792],legal:[612,1008]},p="0 g",T="0 G",A=0,w=[],O=2,y=false,_=[],g={},b={},x=16,F,S=.200025,k,N,I,D={title:"",subject:"",author:"",keywords:"",creator:""},E=0,C=0,P={},j=new r(P),Q,R,q=function(e){return e.toFixed(2)},M=function(e){return e.toFixed(3)},L=function(e){var r=e.toFixed(0);if(e<10){return"0"+r}else{return r}},V=function(e){var r=e.toFixed(0);if(r.length<10){return new Array(11-r.length).join("0")+r}else{return r}},B=function(e){if(y){w[A].push(e)}else{v.push(e);c+=e.length+1}},J=function(){O++;_[O]=c;B(O+" 0 obj");return O},U=function(e){B("stream");B(e);B("endstream")},z,H,Z,G=function(){z=N*I;H=k*I;var e,r,t,a,s,i;for(e=1;e<=A;e++){J();B("<</Type /Page");B("/Parent 1 0 R");B("/Resources 2 0 R");B("/Contents "+(O+1)+" 0 R>>");B("endobj");r=w[e].join("\n");J();if(d){t=[];for(a=0;a<r.length;++a){t[a]=r.charCodeAt(a)}i=adler32cs.from(r);s=new Deflater(6);s.append(new Uint8Array(t));r=s.flush();t=[new Uint8Array([120,156]),new Uint8Array(r),new Uint8Array([i&255,i>>8&255,i>>16&255,i>>24&255])];r="";for(a in t){if(t.hasOwnProperty(a)){r+=String.fromCharCode.apply(null,t[a])}}B("<</Length "+r.length+" /Filter [/FlateDecode]>>")}else{B("<</Length "+r.length+">>")}U(r);B("endobj")}_[1]=c;B("1 0 obj");B("<</Type /Pages");Z="/Kids [";for(a=0;a<A;a++){Z+=3+2*a+" 0 R "}B(Z+"]");B("/Count "+A);B("/MediaBox [0 0 "+q(z)+" "+q(H)+"]");B(">>");B("endobj")},X=function(e){e.objectNumber=J();B("<</BaseFont/"+e.PostScriptName+"/Type/Font");if(typeof e.encoding==="string"){B("/Encoding/"+e.encoding)}B("/Subtype/Type1>>");B("endobj")},Y=function(){var e;for(e in g){if(g.hasOwnProperty(e)){X(g[e])}}},$=function(){j.publish("putXobjectDict")},W=function(){B("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]");B("/Font <<");var e;for(e in g){if(g.hasOwnProperty(e)){B("/"+e+" "+g[e].objectNumber+" 0 R")}}B(">>");B("/XObject <<");$();B(">>")},K=function(){Y();j.publish("putResources");_[2]=c;B("2 0 obj");B("<<");W();B(">>");B("endobj");j.publish("postPutResources")},ee=function(e,r,t){var a;if(b[r]===a){b[r]={}}b[r][t]=e},re=function(r,t,a,s){var i="F"+(e(g)+1).toString(10),f=g[i]={id:i,PostScriptName:r,fontName:t,fontStyle:a,encoding:s,metadata:{}};ee(i,t,a);j.publish("addFont",f);return i},te=function(){var e="helvetica",r="times",t="courier",a="normal",s="bold",i="italic",f="bolditalic",l="StandardEncoding",n=[["Helvetica",e,a],["Helvetica-Bold",e,s],["Helvetica-Oblique",e,i],["Helvetica-BoldOblique",e,f],["Courier",t,a],["Courier-Bold",t,s],["Courier-Oblique",t,i],["Courier-BoldOblique",t,f],["Times-Roman",r,a],["Times-Bold",r,s],["Times-Italic",r,i],["Times-BoldItalic",r,f]],o,u,v,c;for(o=0,u=n.length;o<u;o++){v=re(n[o][0],n[o][1],n[o][2],l);c=n[o][0].split("-");ee(v,c[0],c[1]||"")}j.publish("addFonts",{fonts:g,dictionary:b})},ae=function(e,r){var t,a,s,i,f,l,n,o,u,v;if(r===s){r={}}i=r.sourceEncoding?i:"Unicode";l=r.outputEncoding;if((r.autoencode||l)&&g[F].metadata&&g[F].metadata[i]&&g[F].metadata[i].encoding){f=g[F].metadata[i].encoding;if(!l&&g[F].encoding){l=g[F].encoding}if(!l&&f.codePages){l=f.codePages[0]}if(typeof l==="string"){l=f[l]}if(l){o=false;n=[];for(t=0,a=e.length;t<a;t++){u=l[e.charCodeAt(t)];if(u){n.push(String.fromCharCode(u))}else{n.push(e[t])}if(n[t].charCodeAt(0)>>8){o=true}}e=n.join("")}}t=e.length;while(o===s&&t!==0){if(e.charCodeAt(t-1)>>8){o=true}t--}if(!o){return e}else{n=r.noBOM?[]:[254,255];for(t=0,a=e.length;t<a;t++){u=e.charCodeAt(t);v=u>>8;if(v>>8){throw new Error("Character at position "+t.toString(10)+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE")}n.push(v);n.push(u-(v<<8))}return String.fromCharCode.apply(s,n)}},se=function(e,r){return ae(e,r).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ie=function(){B("/Producer (jsPDF "+u+")");if(D.title){B("/Title ("+se(D.title)+")")}if(D.subject){B("/Subject ("+se(D.subject)+")")}if(D.author){B("/Author ("+se(D.author)+")")}if(D.keywords){B("/Keywords ("+se(D.keywords)+")")}if(D.creator){B("/Creator ("+se(D.creator)+")")}var e=new Date;B("/CreationDate (D:"+[e.getFullYear(),L(e.getMonth()+1),L(e.getDate()),L(e.getHours()),L(e.getMinutes()),L(e.getSeconds())].join("")+")")},fe=function(){B("/Type /Catalog");B("/Pages 1 0 R");B("/OpenAction [3 0 R /FitH null]");B("/PageLayout /OneColumn");j.publish("putCatalog")},le=function(){B("/Size "+(O+1));B("/Root "+O+" 0 R");B("/Info "+(O-1)+" 0 R")},ne=function(){A++;y=true;w[A]=[]},oe=function(){ne();B(q(S*I)+" w");B(T);if(E!==0){B(E.toString(10)+" J")}if(C!==0){B(C.toString(10)+" j")}j.publish("addPage",{pageNumber:A})},ue=function(e,r){var t,a;if(e===a){e=g[F].fontName}if(r===a){r=g[F].fontStyle}try{t=b[e][r]}catch(e){t=a}if(!t){throw new Error("Unable to look up font label for font '"+e+"', '"+r+"'. Refer to getFontList() for available fonts.")}return t},ve=function(){y=false;v=[];_=[];B("%PDF-"+m);G();K();J();B("<<");ie();B(">>");B("endobj");J();B("<<");fe();B(">>");B("endobj");var e=c,r;B("xref");B("0 "+(O+1));B("0000000000 65535 f ");for(r=1;r<=O;r++){B(V(_[r])+" 00000 n ")}B("trailer");B("<<");le();B(">>");B("startxref");B(e);B("%%EOF");y=true;return v.join("\n")},ce=function(e){var r="S";if(e==="F"){r="f"}else if(e==="FD"||e==="DF"){r="B"}return r},de=function(e,r){var t,a,s,i,f,l;switch(e){case t:return ve();case"save":if(navigator.getUserMedia){if(window.URL===undefined){return P.output("dataurlnewwindow")}else if(window.URL.createObjectURL===undefined){return P.output("dataurlnewwindow")}}a=ve();s=a.length;i=new Uint8Array(new ArrayBuffer(s));for(f=0;f<s;f++){i[f]=a.charCodeAt(f)}l=new Blob([i],{type:"application/pdf"});saveAs(l,r);break;case"datauristring":case"dataurlstring":return"data:application/pdf;base64,"+btoa(ve());case"datauri":case"dataurl":document.location.href="data:application/pdf;base64,"+btoa(ve());break;case"dataurlnewwindow":window.open("data:application/pdf;base64,"+btoa(ve()));break;default:throw new Error('Output type "'+e+'" is not supported.')}};if(s==="pt"){I=1}else if(s==="mm"){I=72/25.4}else if(s==="cm"){I=72/2.54}else if(s==="in"){I=72}else{throw"Invalid unit: "+s}if(h.hasOwnProperty(o)){k=h[o][1]/I;N=h[o][0]/I}else{try{k=i[1];N=i[0]}catch(e){throw"Invalid format: "+i}}if(a==="p"||a==="portrait"){a="p";if(N>k){Q=N;N=k;k=Q}}else if(a==="l"||a==="landscape"){a="l";if(k>N){Q=N;N=k;k=Q}}else{throw"Invalid orientation: "+a}P.internal={pdfEscape:se,getStyle:ce,getFont:function(){return g[ue.apply(P,arguments)]},getFontSize:function(){return x},btoa,write:function(e,r,t,a){B(arguments.length===1?e:Array.prototype.join.call(arguments," "))},getCoordinateString:function(e){return q(e*I)},getVerticalCoordinateString:function(e){return q((k-e)*I)},collections:{},newObject:J,putStream:U,events:j,scaleFactor:I,pageSize:{width:N,height:k},output:function(e,r){return de(e,r)}};P.addPage=function(){oe();return this};P.text=function(e,r,t,a){var s,i,f,l,n,o,u;if(typeof e==="number"){i=t;f=e;l=r;e=i;r=f;t=l}if(typeof e==="string"&&e.match(/[\n\r]/)){e=e.split(/\r\n|\r|\n/g)}if(typeof a==="undefined"){a={noBOM:true,autoencode:true}}else{if(a.noBOM===s){a.noBOM=true}if(a.autoencode===s){a.autoencode=true}}if(typeof e==="string"){o=se(e,a)}else if(e instanceof Array){n=e.concat();for(u=n.length-1;u!==-1;u--){n[u]=se(n[u],a)}o=n.join(") Tj\nT* (")}else{throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.')}B("BT\n/"+F+" "+x+" Tf\n"+x+" TL\n"+p+"\n"+q(r*I)+" "+q((k-t)*I)+" Td\n("+o+") Tj\nET");return this};P.line=function(e,r,t,a){B(q(e*I)+" "+q((k-r)*I)+" m "+q(t*I)+" "+q((k-a)*I)+" l S");return this};P.lines=function(e,r,t,a,s){var i,f,l,n,o,u,v,c,d,m,h,p,T,A,w;if(typeof e==="number"){f=t;l=e;n=r;e=f;r=l;t=n}s=ce(s);a=a===i?[1,1]:a;B(M(r*I)+" "+M((k-t)*I)+" m ");o=a[0];u=a[1];c=e.length;A=r;w=t;for(v=0;v<c;v++){d=e[v];if(d.length===2){A=d[0]*o+A;w=d[1]*u+w;B(M(A*I)+" "+M((k-w)*I)+" l")}else{m=d[0]*o+A;h=d[1]*u+w;p=d[2]*o+A;T=d[3]*u+w;A=d[4]*o+A;w=d[5]*u+w;B(M(m*I)+" "+M((k-h)*I)+" "+M(p*I)+" "+M((k-T)*I)+" "+M(A*I)+" "+M((k-w)*I)+" c")}}B(s);return this};P.rect=function(e,r,t,a,s){var i=ce(s);B([q(e*I),q((k-r)*I),q(t*I),q(-a*I),"re",i].join(" "));return this};P.setProperties=function(e){var r;for(r in D){if(D.hasOwnProperty(r)&&e[r]){D[r]=e[r]}}return this};P.setFontSize=function(e){x=e;return this};P.setFont=function(e,r){F=ue(e,r);return this};P.setFontStyle=P.setFontType=function(e){var r;F=ue(r,e);return this};P.getFontList=function(){var e={},r,t,a;for(r in b){if(b.hasOwnProperty(r)){e[r]=a=[];for(t in b[r]){if(b[r].hasOwnProperty(t)){a.push(t)}}}}return e};P.setLineWidth=function(e){B((e*I).toFixed(2)+" w");return this};P.setDrawColor=function(e,r,t,a){var s;if(r===undefined||a===undefined&&e===r===t){if(typeof e==="string"){s=e+" G"}else{s=q(e/255)+" G"}}else if(a===undefined){if(typeof e==="string"){s=[e,r,t,"RG"].join(" ")}else{s=[q(e/255),q(r/255),q(t/255),"RG"].join(" ")}}else{if(typeof e==="string"){s=[e,r,t,a,"K"].join(" ")}else{s=[q(e),q(r),q(t),q(a),"K"].join(" ")}}B(s);return this};P.setFillColor=function(e,r,t,a){var s;if(r===undefined||a===undefined&&e===r===t){if(typeof e==="string"){s=e+" g"}else{s=q(e/255)+" g"}}else if(a===undefined){if(typeof e==="string"){s=[e,r,t,"rg"].join(" ")}else{s=[q(e/255),q(r/255),q(t/255),"rg"].join(" ")}}else{if(typeof e==="string"){s=[e,r,t,a,"k"].join(" ")}else{s=[q(e),q(r),q(t),q(a),"k"].join(" ")}}B(s);return this};P.setTextColor=function(e,r,t){if(e===0&&r===0&&t===0||typeof r==="undefined"){p=M(e/255)+" g"}else{p=[M(e/255),M(r/255),M(t/255),"rg"].join(" ")}return this};P.CapJoinStyles={0:0,butt:0,but:0,bevel:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,milter:2};P.setLineCap=function(e){var r=this.CapJoinStyles[e];if(r===undefined){throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles")}E=r;B(r.toString(10)+" J");return this};P.setLineJoin=function(e){var r=this.CapJoinStyles[e];if(r===undefined){throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles")}C=r;B(r.toString(10)+" j");return this};P.output=de;P.save=function(e){P.output("save",e)};for(R in t.API){if(t.API.hasOwnProperty(R)){if(R==="events"&&t.API.events.length){(function(e,r){var t,a,s;for(s=r.length-1;s!==-1;s--){t=r[s][0];a=r[s][1];e.subscribe.apply(e,[t].concat(typeof a==="function"?[a]:a))}})(j,t.API.events)}else{P[R]=t.API[R]}}}te();F="F1";oe();j.publish("initialized");return P}t.API={events:[]};return t}();(function(e){var r="addImage_";var t=function(e){var r,t;if(!e.charCodeAt(0)===255||!e.charCodeAt(1)===216||!e.charCodeAt(2)===255||!e.charCodeAt(3)===224||!e.charCodeAt(6)==="J".charCodeAt(0)||!e.charCodeAt(7)==="F".charCodeAt(0)||!e.charCodeAt(8)==="I".charCodeAt(0)||!e.charCodeAt(9)==="F".charCodeAt(0)||!e.charCodeAt(10)===0){throw new Error("getJpegSize requires a binary jpeg file")}var a=e.charCodeAt(4)*256+e.charCodeAt(5);var s=4,i=e.length;while(s<i){s+=a;if(e.charCodeAt(s)!==255){throw new Error("getJpegSize could not find the size of the image")}if(e.charCodeAt(s+1)===192){t=e.charCodeAt(s+5)*256+e.charCodeAt(s+6);r=e.charCodeAt(s+7)*256+e.charCodeAt(s+8);return[r,t]}else{s+=2;a=e.charCodeAt(s)*256+e.charCodeAt(s+1)}}},a=function(e){var r=this.internal.newObject(),t=this.internal.write,a=this.internal.putStream;e["n"]=r;t("<</Type /XObject");t("/Subtype /Image");t("/Width "+e["w"]);t("/Height "+e["h"]);if(e["cs"]==="Indexed"){t("/ColorSpace [/Indexed /DeviceRGB "+(e["pal"].length/3-1)+" "+(r+1)+" 0 R]")}else{t("/ColorSpace /"+e["cs"]);if(e["cs"]==="DeviceCMYK"){t("/Decode [1 0 1 0 1 0 1 0]")}}t("/BitsPerComponent "+e["bpc"]);if("f"in e){t("/Filter /"+e["f"])}if("dp"in e){t("/DecodeParms <<"+e["dp"]+">>")}if("trns"in e&&e["trns"].constructor==Array){var s="";for(var i=0;i<e["trns"].length;i++){s+=e[s][i]+" "+e["trns"][i]+" ";t("/Mask ["+s+"]")}}if("smask"in e){t("/SMask "+(r+1)+" 0 R")}t("/Length "+e["data"].length+">>");a(e["data"]);t("endobj")},s=function(){var e=this.internal.collections[r+"images"];for(var t in e){a.call(this,e[t])}},i=function(){var e=this.internal.collections[r+"images"],t=this.internal.write,a;for(var s in e){a=e[s];t("/I"+a["i"],a["n"],"0","R")}};e.addImage=function(e,a,f,l,n,o){if(typeof e==="object"&&e.nodeType===1){var u=document.createElement("canvas");u.width=e.clientWidth;u.height=e.clientHeight;var v=u.getContext("2d");if(!v){throw"addImage requires canvas to be supported by browser."}v.drawImage(e,0,0,u.width,u.height);e=u.toDataURL("image/jpeg");a="JPEG"}if(a.toUpperCase()!=="JPEG"){throw new Error("addImage currently only supports format 'JPEG', not '"+a+"'")}var c,d=this.internal.collections[r+"images"],m=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;if(e.substring(0,23)==="data:image/jpeg;base64,"){e=atob(e.replace("data:image/jpeg;base64,",""))}if(d){c=Object.keys?Object.keys(d).length:function(e){var r=0;for(var t in e){if(e.hasOwnProperty(t)){r++}}return r}(d)}else{c=0;this.internal.collections[r+"images"]=d={};this.internal.events.subscribe("putResources",s);this.internal.events.subscribe("putXobjectDict",i)}var p=t(e);var T={w:p[0],h:p[1],cs:"DeviceRGB",bpc:8,f:"DCTDecode",i:c,data:e};d[c]=T;if(!n&&!o){n=-96;o=-96}if(n<0){n=-1*T["w"]*72/n/this.internal.scaleFactor}if(o<0){o=-1*T["h"]*72/o/this.internal.scaleFactor}if(n===0){n=o*T["w"]/T["h"]}if(o===0){o=n*T["h"]/T["w"]}this.internal.write("q",m(n),"0 0",m(o),m(f),h(l+o),"cm /I"+T["i"],"Do Q");return this}})(jsPDF.API);(function(e){var r=function(e){var r="0123456789abcdef",t="klmnopqrstuvwxyz",a={};for(var s=0;s<t.length;s++){a[t[s]]=r[s]}var i,f={},l=1,n,o=f,u=[],v,c="",d="",m,h=e.length-1,p;s=1;while(s!=h){p=e[s];s+=1;if(p=="'"){if(n){m=n.join("");n=i}else{n=[]}}else if(n){n.push(p)}else if(p=="{"){u.push([o,m]);o={};m=i}else if(p=="}"){v=u.pop();v[0][v[1]]=o;m=i;o=v[0]}else if(p=="-"){l=-1}else{if(m===i){if(a.hasOwnProperty(p)){c+=a[p];m=parseInt(c,16)*l;l=+1;c=""}else{c+=p}}else{if(a.hasOwnProperty(p)){d+=a[p];o[m]=parseInt(d,16)*l;l=+1;m=i;d=""}else{d+=p}}}}return f};var t={codePages:["WinAnsiEncoding"],WinAnsiEncoding:r("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},a={Unicode:{Courier:t,"Courier-Bold":t,"Courier-BoldOblique":t,"Courier-Oblique":t,Helvetica:t,"Helvetica-Bold":t,"Helvetica-BoldOblique":t,"Helvetica-Oblique":t,"Times-Roman":t,"Times-Bold":t,"Times-BoldItalic":t,"Times-Italic":t}},s={Unicode:{"Courier-Oblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":r("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":r("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Helvetica:r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),"Courier-Bold":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":r("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":r("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFonts",function(e){var r,t,i,f,l="Unicode",n;for(t in e.fonts){if(e.fonts.hasOwnProperty(t)){r=e.fonts[t];i=s[l][r.PostScriptName];if(i){if(r.metadata[l]){f=r.metadata[l]}else{f=r.metadata[l]={}}f.widths=i.widths;f.kerning=i.kerning}n=a[l][r.PostScriptName];if(n){if(r.metadata[l]){f=r.metadata[l]}else{f=r.metadata[l]={}}f.encoding=n;if(n.codePages&&n.codePages.length){r.encoding=n.codePages[0]}}}}}])})(jsPDF.API);(function(e){var r=e.getCharWidthsArray=function(e,r){if(!r){r={}}var t=r.widths?r.widths:this.internal.getFont().metadata.Unicode.widths,a=t.fof?t.fof:1,s=r.kerning?r.kerning:this.internal.getFont().metadata.Unicode.kerning,i=s.fof?s.fof:1;var f,l,n,o=0,u=t[0]||a,v=[];for(f=0,l=e.length;f<l;f++){n=e.charCodeAt(f);v.push((t[n]||u)/a+(s[n]&&s[n][o]||0)/i);o=n}return v};var t=function(e){var r=e.length,t=0;while(r){r--;t+=e[r]}return t};e.getStringUnitWidth=function(e,a){return t(r.call(this,e,a))};var a=function(e,r,t,a){var s=[];var i=0,f=e.length,l=0;while(i!==f&&l+r[i]<t){l+=r[i];i++}s.push(e.slice(0,i));var n=i;l=0;while(i!==f){if(l+r[i]>a){s.push(e.slice(n,i));l=0;n=i}l+=r[i];i++}if(n!==i){s.push(e.slice(n,i))}return s};var s=function(e,s,i){if(!i){i={}}var f=r(" ",i)[0];var l=e.split(" ");var n=[],o=[n],u=i.textIndent||0,v=0,c=0,d,m;var h,p,T;for(h=0,p=l.length;h<p;h++){d=l[h];m=r(d,i);c=t(m);if(u+v+c>s){if(c>s){T=a(d,m,s-(u+v),s);n.push(T.shift());n=[T.pop()];while(T.length){o.push([T.shift()])}c=t(m.slice(d.length-n[0].length))}else{n=[d]}o.push(n);u=c;v=f}else{n.push(d);u+=v+c;v=f}}var A=[];for(h=0,p=o.length;h<p;h++){A.push(o[h].join(" "))}return A};e.splitTextToSize=function(e,r,t){if(!t){t={}}var a=t.fontSize||this.internal.getFontSize(),i=function(e){var r={0:1},t={};if(!e.widths||!e.kerning){var a=this.internal.getFont(e.fontName,e.fontStyle),s="Unicode";if(a.metadata[s]){return{widths:a.metadata[s].widths||r,kerning:a.metadata[s].kerning||t}}}else{return{widths:e.widths,kerning:e.kerning}}return{widths:r,kerning:t}}.call(this,t);var f;if(e.match(/[\n\r]/)){f=e.split(/\r\n|\r|\n/g)}else{f=[e]}var l=1*this.internal.scaleFactor*r/a;i.textIndent=t.textIndent?t.textIndent*1*this.internal.scaleFactor/a:0;var n,o,u=[];for(n=0,o=f.length;n<o;n++){u=u.concat(s(f[n],l,i))}return u}})(jsPDF.API);(function(e){e.addSVG=function(e,r,t,a,s){var i;if(r===i||r===i){throw new Error("addSVG needs values for 'x' and 'y'")}function f(e,r){var t=r.createElement("style");t.type="text/css";if(t.styleSheet){t.styleSheet.cssText=e}else{t.appendChild(r.createTextNode(e))}r.getElementsByTagName("head")[0].appendChild(t)}function l(e){var r="childframe",t=e.createElement("iframe");f(".jsPDF_sillysvg_iframe {display:none;position:absolute;}",e);t.name=r;t.setAttribute("width",0);t.setAttribute("height",0);t.setAttribute("frameborder","0");t.setAttribute("scrolling","no");t.setAttribute("seamless","seamless");t.setAttribute("class","jsPDF_sillysvg_iframe");e.body.appendChild(t);return t}function n(e,r){var t=(r.contentWindow||r.contentDocument).document;t.write(e);t.close();return t.getElementsByTagName("svg")[0]}function o(e){var r=parseFloat(e[1]),t=parseFloat(e[2]),a=[],s=3,i=e.length;while(s<i){if(e[s]==="c"){a.push([parseFloat(e[s+1]),parseFloat(e[s+2]),parseFloat(e[s+3]),parseFloat(e[s+4]),parseFloat(e[s+5]),parseFloat(e[s+6])]);s+=7}else if(e[s]==="l"){a.push([parseFloat(e[s+1]),parseFloat(e[s+2])]);s+=3}else{s+=1}}return[r,t,a]}var u=l(document),v=n(e,u),c=[1,1],d=parseFloat(v.getAttribute("width")),m=parseFloat(v.getAttribute("height"));if(d&&m){if(a&&s){c=[a/d,s/m]}else if(a){c=[a/d,a/d]}else if(s){c=[s/m,s/m]}}var h,p,T,A,w=v.childNodes;for(h=0,p=w.length;h<p;h++){T=w[h];if(T.tagName&&T.tagName.toUpperCase()==="PATH"){A=o(T.getAttribute("d").split(" "));A[0]=A[0]*c[0]+r;A[1]=A[1]*c[1]+t;this.lines.call(this,A[2],A[0],A[1],c)}}return this}})(jsPDF.API);(function(e){e.output=function(e,r){return this.internal.output(e,r)}})(jsPDF.API);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */if(typeof window!="undefined"){var saveAs=saveAs||function(e){var r=e.document,t=function(){return e.URL||e.webkitURL||e},a=e.URL||e.webkitURL||e,s=r.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in s,f=function(t){var a=r.createEvent("MouseEvents");a.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);return t.dispatchEvent(a)},l=e.webkitRequestFileSystem,n=e.requestFileSystem||l||e.mozRequestFileSystem,o=function(r){(e.setImmediate||e.setTimeout)((function(){throw r}),0)},u="application/octet-stream",v=0,c=[],d=function(){var e=c.length;while(e--){var r=c[e];if(typeof r==="string"){a.revokeObjectURL(r)}else{r.remove()}}c.length=0},m=function(e,r,t){r=[].concat(r);var a=r.length;while(a--){var s=e["on"+r[a]];if(typeof s==="function"){try{s.call(e,t||e)}catch(e){o(e)}}}},h=function(r,a){var o=this,d=r.type,h=false,p,T,A=function(){var e=t().createObjectURL(r);c.push(e);return e},w=function(){m(o,"writestart progress write writeend".split(" "))},O=function(){if(h||!p){p=A()}if(T){T.location.href=p}o.readyState=o.DONE;w()},y=function(e){return function(){if(o.readyState!==o.DONE){return e.apply(this,arguments)}}},_={create:true,exclusive:false},g;o.readyState=o.INIT;if(!a){a="download"}if(i){p=A();s.href=p;s.download=a;if(f(s)){o.readyState=o.DONE;w();return}}if(e.chrome&&d&&d!==u){g=r.slice||r.webkitSlice;r=g.call(r,0,r.size,u);h=true}if(l&&a!=="download"){a+=".download"}if(d===u||l){T=e}if(!n){O();return}v+=r.size;n(e.TEMPORARY,v,y((function(e){e.root.getDirectory("saved",_,y((function(e){var t=function(){e.getFile(a,_,y((function(e){e.createWriter(y((function(t){t.onwriteend=function(r){T.location.href=e.toURL();c.push(e);o.readyState=o.DONE;m(o,"writeend",r)};t.onerror=function(){var e=t.error;if(e.code!==e.ABORT_ERR){O()}};"writestart progress write abort".split(" ").forEach((function(e){t["on"+e]=o["on"+e]}));t.write(r);o.abort=function(){t.abort();o.readyState=o.DONE};o.readyState=o.WRITING})),O)})),O)};e.getFile(a,{create:false},y((function(e){e.remove();t()})),y((function(e){if(e.code===e.NOT_FOUND_ERR){t()}else{O()}})))})),O)})),O)},p=h.prototype,T=function(e,r){return new h(e,r)};p.abort=function(){var e=this;e.readyState=e.DONE;m(e,"abort")};p.readyState=p.INIT=0;p.WRITING=1;p.DONE=2;p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null;e.addEventListener("unload",d,false);return T}(commonjsGlobal)}var MAX_BITS=15;var D_CODES=30;var BL_CODES=19;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var HEAP_SIZE=2*L_CODES+1;var END_BLOCK=256;var MAX_BL_BITS=7;var REP_3_6=16;var REPZ_3_10=17;var REPZ_11_138=18;var Buf_size=8*2;var Z_DEFAULT_COMPRESSION=-1;var Z_FILTERED=1;var Z_HUFFMAN_ONLY=2;var Z_DEFAULT_STRATEGY=0;var Z_NO_FLUSH=0;var Z_PARTIAL_FLUSH=1;var Z_FULL_FLUSH=3;var Z_FINISH=4;var Z_OK=0;var Z_STREAM_END=1;var Z_NEED_DICT=2;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_BUF_ERROR=-5;var _dist_code=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29];function Tree(){var e=this;function r(r){var t=e.dyn_tree;var a=e.stat_desc.static_tree;var s=e.stat_desc.extra_bits;var i=e.stat_desc.extra_base;var f=e.stat_desc.max_length;var l;var n,o;var u;var v;var c;var d=0;for(u=0;u<=MAX_BITS;u++)r.bl_count[u]=0;t[r.heap[r.heap_max]*2+1]=0;for(l=r.heap_max+1;l<HEAP_SIZE;l++){n=r.heap[l];u=t[t[n*2+1]*2+1]+1;if(u>f){u=f;d++}t[n*2+1]=u;if(n>e.max_code)continue;r.bl_count[u]++;v=0;if(n>=i)v=s[n-i];c=t[n*2];r.opt_len+=c*(u+v);if(a)r.static_len+=c*(a[n*2+1]+v)}if(d===0)return;do{u=f-1;while(r.bl_count[u]===0)u--;r.bl_count[u]--;r.bl_count[u+1]+=2;r.bl_count[f]--;d-=2}while(d>0);for(u=f;u!==0;u--){n=r.bl_count[u];while(n!==0){o=r.heap[--l];if(o>e.max_code)continue;if(t[o*2+1]!=u){r.opt_len+=(u-t[o*2+1])*t[o*2];t[o*2+1]=u}n--}}}function t(e,r){var t=0;do{t|=e&1;e>>>=1;t<<=1}while(--r>0);return t>>>1}function a(e,r,a){var s=[];var i=0;var f;var l;var n;for(f=1;f<=MAX_BITS;f++){s[f]=i=i+a[f-1]<<1}for(l=0;l<=r;l++){n=e[l*2+1];if(n===0)continue;e[l*2]=t(s[n]++,n)}}e.build_tree=function(t){var s=e.dyn_tree;var i=e.stat_desc.static_tree;var f=e.stat_desc.elems;var l,n;var o=-1;var u;t.heap_len=0;t.heap_max=HEAP_SIZE;for(l=0;l<f;l++){if(s[l*2]!==0){t.heap[++t.heap_len]=o=l;t.depth[l]=0}else{s[l*2+1]=0}}while(t.heap_len<2){u=t.heap[++t.heap_len]=o<2?++o:0;s[u*2]=1;t.depth[u]=0;t.opt_len--;if(i)t.static_len-=i[u*2+1]}e.max_code=o;for(l=Math.floor(t.heap_len/2);l>=1;l--)t.pqdownheap(s,l);u=f;do{l=t.heap[1];t.heap[1]=t.heap[t.heap_len--];t.pqdownheap(s,1);n=t.heap[1];t.heap[--t.heap_max]=l;t.heap[--t.heap_max]=n;s[u*2]=s[l*2]+s[n*2];t.depth[u]=Math.max(t.depth[l],t.depth[n])+1;s[l*2+1]=s[n*2+1]=u;t.heap[1]=u++;t.pqdownheap(s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1];r(t);a(s,e.max_code,t.bl_count)}}Tree._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28];Tree.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];Tree.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];Tree.d_code=function(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]};Tree.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];Tree.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];Tree.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];Tree.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function StaticTree(e,r,t,a,s){var i=this;i.static_tree=e;i.extra_bits=r;i.extra_base=t;i.elems=a;i.max_length=s}StaticTree.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8];StaticTree.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5];StaticTree.static_l_desc=new StaticTree(StaticTree.static_ltree,Tree.extra_lbits,LITERALS+1,L_CODES,MAX_BITS);StaticTree.static_d_desc=new StaticTree(StaticTree.static_dtree,Tree.extra_dbits,0,D_CODES,MAX_BITS);StaticTree.static_bl_desc=new StaticTree(null,Tree.extra_blbits,0,BL_CODES,MAX_BL_BITS);var MAX_MEM_LEVEL=9;var DEF_MEM_LEVEL=8;function Config(e,r,t,a,s){var i=this;i.good_length=e;i.max_lazy=r;i.nice_length=t;i.max_chain=a;i.func=s}var STORED=0;var FAST=1;var SLOW=2;var config_table=[new Config(0,0,0,0,STORED),new Config(4,4,8,4,FAST),new Config(4,5,16,8,FAST),new Config(4,6,32,32,FAST),new Config(4,4,16,16,SLOW),new Config(8,16,32,32,SLOW),new Config(8,16,128,128,SLOW),new Config(8,32,128,256,SLOW),new Config(32,128,258,1024,SLOW),new Config(32,258,258,4096,SLOW)];var z_errmsg=["need dictionary","stream end","","","stream error","data error","","buffer error","",""];var NeedMore=0;var BlockDone=1;var FinishStarted=2;var FinishDone=3;var PRESET_DICT=32;var INIT_STATE=42;var BUSY_STATE=113;var FINISH_STATE=666;var Z_DEFLATED=8;var STORED_BLOCK=0;var STATIC_TREES=1;var DYN_TREES=2;var MIN_MATCH=3;var MAX_MATCH=258;var MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1;function smaller(e,r,t,a){var s=e[r*2];var i=e[t*2];return s<i||s==i&&a[r]<=a[t]}function Deflate(){var e=this;var r;var t;var a;var s;var i;var f;var l;var n;var o;var u;var v;var c;var d;var m;var h;var p;var T;var A;var w;var O;var y;var _;var g;var b;var x;var F;var S;var k;var N;var I;var D;var E;var C;var P=new Tree;var j=new Tree;var Q=new Tree;e.depth=[];var R;var q;var M;var L;var V;var B;var J;var U;e.bl_count=[];e.heap=[];D=[];E=[];C=[];function z(){var e;o=2*i;v[d-1]=0;for(e=0;e<d-1;e++){v[e]=0}F=config_table[S].max_lazy;N=config_table[S].good_length;I=config_table[S].nice_length;x=config_table[S].max_chain;y=0;T=0;g=0;A=b=MIN_MATCH-1;O=0;c=0}function H(){var r;for(r=0;r<L_CODES;r++)D[r*2]=0;for(r=0;r<D_CODES;r++)E[r*2]=0;for(r=0;r<BL_CODES;r++)C[r*2]=0;D[END_BLOCK*2]=1;e.opt_len=e.static_len=0;M=V=0}function Z(){P.dyn_tree=D;P.stat_desc=StaticTree.static_l_desc;j.dyn_tree=E;j.stat_desc=StaticTree.static_d_desc;Q.dyn_tree=C;Q.stat_desc=StaticTree.static_bl_desc;J=0;U=0;B=8;H()}e.pqdownheap=function(r,t){var a=e.heap;var s=a[t];var i=t<<1;while(i<=e.heap_len){if(i<e.heap_len&&smaller(r,a[i+1],a[i],e.depth)){i++}if(smaller(r,s,a[i],e.depth))break;a[t]=a[i];t=i;i<<=1}a[t]=s};function G(e,r){var t;var a=-1;var s;var i=e[0*2+1];var f=0;var l=7;var n=4;if(i===0){l=138;n=3}e[(r+1)*2+1]=65535;for(t=0;t<=r;t++){s=i;i=e[(t+1)*2+1];if(++f<l&&s==i){continue}else if(f<n){C[s*2]+=f}else if(s!==0){if(s!=a)C[s*2]++;C[REP_3_6*2]++}else if(f<=10){C[REPZ_3_10*2]++}else{C[REPZ_11_138*2]++}f=0;a=s;if(i===0){l=138;n=3}else if(s==i){l=6;n=3}else{l=7;n=4}}}function X(){var r;G(D,P.max_code);G(E,j.max_code);Q.build_tree(e);for(r=BL_CODES-1;r>=3;r--){if(C[Tree.bl_order[r]*2+1]!==0)break}e.opt_len+=3*(r+1)+5+5+4;return r}function Y(r){e.pending_buf[e.pending++]=r}function $(e){Y(e&255);Y(e>>>8&255)}function W(e){Y(e>>8&255);Y(e&255&255)}function K(e,r){var t,a=r;if(U>Buf_size-a){t=e;J|=t<<U&65535;$(J);J=t>>>Buf_size-U;U+=a-Buf_size}else{J|=e<<U&65535;U+=a}}function ee(e,r){var t=e*2;K(r[t]&65535,r[t+1]&65535)}function re(e,r){var t;var a=-1;var s;var i=e[0*2+1];var f=0;var l=7;var n=4;if(i===0){l=138;n=3}for(t=0;t<=r;t++){s=i;i=e[(t+1)*2+1];if(++f<l&&s==i){continue}else if(f<n){do{ee(s,C)}while(--f!==0)}else if(s!==0){if(s!=a){ee(s,C);f--}ee(REP_3_6,C);K(f-3,2)}else if(f<=10){ee(REPZ_3_10,C);K(f-3,3)}else{ee(REPZ_11_138,C);K(f-11,7)}f=0;a=s;if(i===0){l=138;n=3}else if(s==i){l=6;n=3}else{l=7;n=4}}}function te(e,r,t){var a;K(e-257,5);K(r-1,5);K(t-4,4);for(a=0;a<t;a++){K(C[Tree.bl_order[a]*2+1],3)}re(D,e-1);re(E,r-1)}function ae(){if(U==16){$(J);J=0;U=0}else if(U>=8){Y(J&255);J>>>=8;U-=8}}function se(){K(STATIC_TREES<<1,3);ee(END_BLOCK,StaticTree.static_ltree);ae();if(1+B+10-U<9){K(STATIC_TREES<<1,3);ee(END_BLOCK,StaticTree.static_ltree);ae()}B=7}function ie(r,t){var a,s,i;e.pending_buf[L+M*2]=r>>>8&255;e.pending_buf[L+M*2+1]=r&255;e.pending_buf[R+M]=t&255;M++;if(r===0){D[t*2]++}else{V++;r--;D[(Tree._length_code[t]+LITERALS+1)*2]++;E[Tree.d_code(r)*2]++}if((M&8191)===0&&S>2){a=M*8;s=y-T;for(i=0;i<D_CODES;i++){a+=E[i*2]*(5+Tree.extra_dbits[i])}a>>>=3;if(V<Math.floor(M/2)&&a<Math.floor(s/2))return true}return M==q-1}function fe(r,t){var a;var s;var i=0;var f;var l;if(M!==0){do{a=e.pending_buf[L+i*2]<<8&65280|e.pending_buf[L+i*2+1]&255;s=e.pending_buf[R+i]&255;i++;if(a===0){ee(s,r)}else{f=Tree._length_code[s];ee(f+LITERALS+1,r);l=Tree.extra_lbits[f];if(l!==0){s-=Tree.base_length[f];K(s,l)}a--;f=Tree.d_code(a);ee(f,t);l=Tree.extra_dbits[f];if(l!==0){a-=Tree.base_dist[f];K(a,l)}}}while(i<M)}ee(END_BLOCK,r);B=r[END_BLOCK*2+1]}function le(){if(U>8){$(J)}else if(U>0){Y(J&255)}J=0;U=0}function ne(r,t,a){le();B=8;if(a){$(t);$(~t)}e.pending_buf.set(n.subarray(r,r+t),e.pending);e.pending+=t}function oe(e,r,t){K((STORED_BLOCK<<1)+(t?1:0),3);ne(e,r,true)}function ue(r,t,a){var s,i;var f=0;if(S>0){P.build_tree(e);j.build_tree(e);f=X();s=e.opt_len+3+7>>>3;i=e.static_len+3+7>>>3;if(i<=s)s=i}else{s=i=t+5}if(t+4<=s&&r!=-1){oe(r,t,a)}else if(i==s){K((STATIC_TREES<<1)+(a?1:0),3);fe(StaticTree.static_ltree,StaticTree.static_dtree)}else{K((DYN_TREES<<1)+(a?1:0),3);te(P.max_code+1,j.max_code+1,f+1);fe(D,E)}H();if(a){le()}}function ve(e){ue(T>=0?T:-1,y-T,e);T=y;r.flush_pending()}function ce(){var e,t;var a;var s;do{s=o-g-y;if(s===0&&y===0&&g===0){s=i}else if(s==-1){s--}else if(y>=i+i-MIN_LOOKAHEAD){n.set(n.subarray(i,i+i),0);_-=i;y-=i;T-=i;e=d;a=e;do{t=v[--a]&65535;v[a]=t>=i?t-i:0}while(--e!==0);e=i;a=e;do{t=u[--a]&65535;u[a]=t>=i?t-i:0}while(--e!==0);s+=i}if(r.avail_in===0)return;e=r.read_buf(n,y+g,s);g+=e;if(g>=MIN_MATCH){c=n[y]&255;c=(c<<p^n[y+1]&255)&h}}while(g<MIN_LOOKAHEAD&&r.avail_in!==0)}function de(e){var t=65535;var s;if(t>a-5){t=a-5}while(true){if(g<=1){ce();if(g===0&&e==Z_NO_FLUSH)return NeedMore;if(g===0)break}y+=g;g=0;s=T+t;if(y===0||y>=s){g=y-s;y=s;ve(false);if(r.avail_out===0)return NeedMore}if(y-T>=i-MIN_LOOKAHEAD){ve(false);if(r.avail_out===0)return NeedMore}}ve(e==Z_FINISH);if(r.avail_out===0)return e==Z_FINISH?FinishStarted:NeedMore;return e==Z_FINISH?FinishDone:BlockDone}function me(e){var r=x;var t=y;var a;var s;var f=b;var o=y>i-MIN_LOOKAHEAD?y-(i-MIN_LOOKAHEAD):0;var v=I;var c=l;var d=y+MAX_MATCH;var m=n[t+f-1];var h=n[t+f];if(b>=N){r>>=2}if(v>g)v=g;do{a=e;if(n[a+f]!=h||n[a+f-1]!=m||n[a]!=n[t]||n[++a]!=n[t+1])continue;t+=2;a++;do{}while(n[++t]==n[++a]&&n[++t]==n[++a]&&n[++t]==n[++a]&&n[++t]==n[++a]&&n[++t]==n[++a]&&n[++t]==n[++a]&&n[++t]==n[++a]&&n[++t]==n[++a]&&t<d);s=MAX_MATCH-(d-t);t=d-MAX_MATCH;if(s>f){_=e;f=s;if(s>=v)break;m=n[t+f-1];h=n[t+f]}}while((e=u[e&c]&65535)>o&&--r!==0);if(f<=g)return f;return g}function he(e){var t=0;var a;while(true){if(g<MIN_LOOKAHEAD){ce();if(g<MIN_LOOKAHEAD&&e==Z_NO_FLUSH){return NeedMore}if(g===0)break}if(g>=MIN_MATCH){c=(c<<p^n[y+(MIN_MATCH-1)]&255)&h;t=v[c]&65535;u[y&l]=v[c];v[c]=y}if(t!==0&&(y-t&65535)<=i-MIN_LOOKAHEAD){if(k!=Z_HUFFMAN_ONLY){A=me(t)}}if(A>=MIN_MATCH){a=ie(y-_,A-MIN_MATCH);g-=A;if(A<=F&&g>=MIN_MATCH){A--;do{y++;c=(c<<p^n[y+(MIN_MATCH-1)]&255)&h;t=v[c]&65535;u[y&l]=v[c];v[c]=y}while(--A!==0);y++}else{y+=A;A=0;c=n[y]&255;c=(c<<p^n[y+1]&255)&h}}else{a=ie(0,n[y]&255);g--;y++}if(a){ve(false);if(r.avail_out===0)return NeedMore}}ve(e==Z_FINISH);if(r.avail_out===0){if(e==Z_FINISH)return FinishStarted;else return NeedMore}return e==Z_FINISH?FinishDone:BlockDone}function pe(e){var t=0;var a;var s;while(true){if(g<MIN_LOOKAHEAD){ce();if(g<MIN_LOOKAHEAD&&e==Z_NO_FLUSH){return NeedMore}if(g===0)break}if(g>=MIN_MATCH){c=(c<<p^n[y+(MIN_MATCH-1)]&255)&h;t=v[c]&65535;u[y&l]=v[c];v[c]=y}b=A;w=_;A=MIN_MATCH-1;if(t!==0&&b<F&&(y-t&65535)<=i-MIN_LOOKAHEAD){if(k!=Z_HUFFMAN_ONLY){A=me(t)}if(A<=5&&(k==Z_FILTERED||A==MIN_MATCH&&y-_>4096)){A=MIN_MATCH-1}}if(b>=MIN_MATCH&&A<=b){s=y+g-MIN_MATCH;a=ie(y-1-w,b-MIN_MATCH);g-=b-1;b-=2;do{if(++y<=s){c=(c<<p^n[y+(MIN_MATCH-1)]&255)&h;t=v[c]&65535;u[y&l]=v[c];v[c]=y}}while(--b!==0);O=0;A=MIN_MATCH-1;y++;if(a){ve(false);if(r.avail_out===0)return NeedMore}}else if(O!==0){a=ie(0,n[y-1]&255);if(a){ve(false)}y++;g--;if(r.avail_out===0)return NeedMore}else{O=1;y++;g--}}if(O!==0){a=ie(0,n[y-1]&255);O=0}ve(e==Z_FINISH);if(r.avail_out===0){if(e==Z_FINISH)return FinishStarted;else return NeedMore}return e==Z_FINISH?FinishDone:BlockDone}function Te(r){r.total_in=r.total_out=0;r.msg=null;e.pending=0;e.pending_out=0;t=BUSY_STATE;s=Z_NO_FLUSH;Z();z();return Z_OK}e.deflateInit=function(r,t,s,o,c,T){if(!o)o=Z_DEFLATED;if(!c)c=DEF_MEM_LEVEL;if(!T)T=Z_DEFAULT_STRATEGY;r.msg=null;if(t==Z_DEFAULT_COMPRESSION)t=6;if(c<1||c>MAX_MEM_LEVEL||o!=Z_DEFLATED||s<9||s>15||t<0||t>9||T<0||T>Z_HUFFMAN_ONLY){return Z_STREAM_ERROR}r.dstate=e;f=s;i=1<<f;l=i-1;m=c+7;d=1<<m;h=d-1;p=Math.floor((m+MIN_MATCH-1)/MIN_MATCH);n=new Uint8Array(i*2);u=[];v=[];q=1<<c+6;e.pending_buf=new Uint8Array(q*4);a=q*4;L=Math.floor(q/2);R=(1+2)*q;S=t;k=T;return Te(r)};e.deflateEnd=function(){if(t!=INIT_STATE&&t!=BUSY_STATE&&t!=FINISH_STATE){return Z_STREAM_ERROR}e.pending_buf=null;v=null;u=null;n=null;e.dstate=null;return t==BUSY_STATE?Z_DATA_ERROR:Z_OK};e.deflateParams=function(e,r,t){var a=Z_OK;if(r==Z_DEFAULT_COMPRESSION){r=6}if(r<0||r>9||t<0||t>Z_HUFFMAN_ONLY){return Z_STREAM_ERROR}if(config_table[S].func!=config_table[r].func&&e.total_in!==0){a=e.deflate(Z_PARTIAL_FLUSH)}if(S!=r){S=r;F=config_table[S].max_lazy;N=config_table[S].good_length;I=config_table[S].nice_length;x=config_table[S].max_chain}k=t;return a};e.deflateSetDictionary=function(e,r,a){var s=a;var f,o=0;if(!r||t!=INIT_STATE)return Z_STREAM_ERROR;if(s<MIN_MATCH)return Z_OK;if(s>i-MIN_LOOKAHEAD){s=i-MIN_LOOKAHEAD;o=a-s}n.set(r.subarray(o,o+s),0);y=s;T=s;c=n[0]&255;c=(c<<p^n[1]&255)&h;for(f=0;f<=s-MIN_MATCH;f++){c=(c<<p^n[f+(MIN_MATCH-1)]&255)&h;u[f&l]=v[c];v[c]=f}return Z_OK};e.deflate=function(a,i){var l,n,o,u,c;if(i>Z_FINISH||i<0){return Z_STREAM_ERROR}if(!a.next_out||!a.next_in&&a.avail_in!==0||t==FINISH_STATE&&i!=Z_FINISH){a.msg=z_errmsg[Z_NEED_DICT-Z_STREAM_ERROR];return Z_STREAM_ERROR}if(a.avail_out===0){a.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR];return Z_BUF_ERROR}r=a;u=s;s=i;if(t==INIT_STATE){n=Z_DEFLATED+(f-8<<4)<<8;o=(S-1&255)>>1;if(o>3)o=3;n|=o<<6;if(y!==0)n|=PRESET_DICT;n+=31-n%31;t=BUSY_STATE;W(n)}if(e.pending!==0){r.flush_pending();if(r.avail_out===0){s=-1;return Z_OK}}else if(r.avail_in===0&&i<=u&&i!=Z_FINISH){r.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR];return Z_BUF_ERROR}if(t==FINISH_STATE&&r.avail_in!==0){a.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR];return Z_BUF_ERROR}if(r.avail_in!==0||g!==0||i!=Z_NO_FLUSH&&t!=FINISH_STATE){c=-1;switch(config_table[S].func){case STORED:c=de(i);break;case FAST:c=he(i);break;case SLOW:c=pe(i);break}if(c==FinishStarted||c==FinishDone){t=FINISH_STATE}if(c==NeedMore||c==FinishStarted){if(r.avail_out===0){s=-1}return Z_OK}if(c==BlockDone){if(i==Z_PARTIAL_FLUSH){se()}else{oe(0,0,false);if(i==Z_FULL_FLUSH){for(l=0;l<d;l++)v[l]=0}}r.flush_pending();if(r.avail_out===0){s=-1;return Z_OK}}}if(i!=Z_FINISH)return Z_OK;return Z_STREAM_END}}function ZStream(){var e=this;e.next_in_index=0;e.next_out_index=0;e.avail_in=0;e.total_in=0;e.avail_out=0;e.total_out=0}ZStream.prototype={deflateInit:function(e,r){var t=this;t.dstate=new Deflate;if(!r)r=MAX_BITS;return t.dstate.deflateInit(t,e,r)},deflate:function(e){var r=this;if(!r.dstate){return Z_STREAM_ERROR}return r.dstate.deflate(r,e)},deflateEnd:function(){var e=this;if(!e.dstate)return Z_STREAM_ERROR;var r=e.dstate.deflateEnd();e.dstate=null;return r},deflateParams:function(e,r){var t=this;if(!t.dstate)return Z_STREAM_ERROR;return t.dstate.deflateParams(t,e,r)},deflateSetDictionary:function(e,r){var t=this;if(!t.dstate)return Z_STREAM_ERROR;return t.dstate.deflateSetDictionary(t,e,r)},read_buf:function(e,r,t){var a=this;var s=a.avail_in;if(s>t)s=t;if(s===0)return 0;a.avail_in-=s;e.set(a.next_in.subarray(a.next_in_index,a.next_in_index+s),r);a.next_in_index+=s;a.total_in+=s;return s},flush_pending:function(){var e=this;var r=e.dstate.pending;if(r>e.avail_out)r=e.avail_out;if(r===0)return;e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+r),e.next_out_index);e.next_out_index+=r;e.dstate.pending_out+=r;e.total_out+=r;e.avail_out-=r;e.dstate.pending-=r;if(e.dstate.pending===0){e.dstate.pending_out=0}}};function Deflater(e){var r=this;var t=new ZStream;var a=512;var s=Z_NO_FLUSH;var i=new Uint8Array(a);if(typeof e=="undefined")e=Z_DEFAULT_COMPRESSION;t.deflateInit(e);t.next_out=i;r.append=function(e,r){var f,l=[],n=0,o=0,u=0,v;if(!e.length)return;t.next_in_index=0;t.next_in=e;t.avail_in=e.length;do{t.next_out_index=0;t.avail_out=a;f=t.deflate(s);if(f!=Z_OK)throw"deflating: "+t.msg;if(t.next_out_index)if(t.next_out_index==a)l.push(new Uint8Array(i));else l.push(new Uint8Array(i.subarray(0,t.next_out_index)));u+=t.next_out_index;if(r&&t.next_in_index>0&&t.next_in_index!=n){r(t.next_in_index);n=t.next_in_index}}while(t.avail_in>0||t.avail_out===0);v=new Uint8Array(u);l.forEach((function(e){v.set(e,o);o+=e.length}));return v};r.flush=function(){var e,r=[],s=0,f=0,l;do{t.next_out_index=0;t.avail_out=a;e=t.deflate(Z_FINISH);if(e!=Z_STREAM_END&&e!=Z_OK)throw"deflating: "+t.msg;if(a-t.avail_out>0)r.push(new Uint8Array(i.subarray(0,t.next_out_index)));f+=t.next_out_index}while(t.avail_in>0||t.avail_out===0);t.deflateEnd();l=new Uint8Array(f);r.forEach((function(e){l.set(e,s);s+=e.length}));return l}}var JSZip=function(e,r){this.files={};this.root="";if(e)this.load(e,r)};JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"};JSZip.defaults={base64:false,binary:false,dir:false,date:null};JSZip.prototype=function(){var e=function(e,r,t){this.name=e;this.data=r;this.options=t};e.prototype={asText:function(){return this.options.binary?JSZip.prototype.utf8decode(this.data):this.data},asBinary:function(){return this.options.binary?this.data:JSZip.prototype.utf8encode(this.data)}};var r=function(e,r){var t="",a;for(a=0;a<r;a++){t+=String.fromCharCode(e&255);e=e>>>8}return t};var t=function(){var e={},r,t;for(r=0;r<arguments.length;r++){for(t in arguments[r]){if(typeof e[t]==="undefined"){e[t]=arguments[r][t]}}}return e};var a=function(e){e=e||{};if(e.base64===true&&e.binary==null)e.binary=true;e=t(e,JSZip.defaults);e.date=e.date||new Date;return e};var s=function(e,r,t){var s=i(e);if(s)f.call(this,s);t=a(t);return this.files[e]={name:e,data:r,options:t}};var i=function(e){if(e.slice(-1)=="/"){e=e.substring(0,e.length-1)}var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""};var f=function(e){if(e.slice(-1)!="/")e+="/";if(!this.files[e]){var r=i(e);if(r)f.call(this,r);s.call(this,e,"",{dir:true})}return this.files[e]};var l=function(e,t,a){var s=t!==e.name,i=e.data,f=e.options,l,n;l=f.date.getHours();l=l<<6;l=l|f.date.getMinutes();l=l<<5;l=l|f.date.getSeconds()/2;n=f.date.getFullYear()-1980;n=n<<4;n=n|f.date.getMonth()+1;n=n<<5;n=n|f.date.getDate();if(f.base64===true)i=JSZipBase64.decode(i);if(f.binary===false)i=this.utf8encode(i);var o=JSZip.compressions[a];var u=o.compress(i);var v="";v+="\n\0";v+=s?"\0\b":"\0\0";v+=o.magic;v+=r(l,2);v+=r(n,2);v+=r(this.crc32(i),4);v+=r(u.length,4);v+=r(i.length,4);v+=r(t.length,2);v+="\0\0";return{header:v,compressedData:u}};return{load:function(e,r){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(r){var a=[],s,i,f,l;for(s in this.files){f=this.files[s];l=new e(f.name,f.data,t(f.options));i=s.slice(this.root.length,s.length);if(s.slice(0,this.root.length)===this.root&&r(i,l)){a.push(l)}}return a},file:function(e,r,t){if(arguments.length===1){if(e instanceof RegExp){var a=e;return this.filter((function(e,r){return!r.options.dir&&a.test(e)}))}else{return this.filter((function(r,t){return!t.options.dir&&r===e}))[0]||null}}else{e=this.root+e;s.call(this,e,r,t)}return this},folder:function(e){if(!e){throw new Error("folder : wrong argument")}if(e instanceof RegExp){return this.filter((function(r,t){return t.options.dir&&e.test(r)}))}var r=this.root+e;var t=f.call(this,r);var a=this.clone();a.root=t.name;return a},remove:function(e){e=this.root+e;var r=this.files[e];if(!r){if(e.slice(-1)!="/")e+="/";r=this.files[e]}if(r){if(!r.options.dir){delete this.files[e]}else{var t=this.filter((function(r,t){return t.name.slice(0,e.length)===e}));for(var a=0;a<t.length;a++){delete this.files[t[a].name]}}}return this},generate:function(e){e=t(e||{},{base64:true,compression:"STORE"});var a=e.compression.toUpperCase();var s=[],i=[],f=0;if(!JSZip.compressions[a]){throw a+" is not a valid compression method !"}for(var n in this.files){if(!this.files.hasOwnProperty(n)){continue}var o=this.files[n];var u=this.utf8encode(o.name);var v="",c="",d=l.call(this,o,u,a);v=JSZip.signature.LOCAL_FILE_HEADER+d.header+u+d.compressedData;c=JSZip.signature.CENTRAL_FILE_HEADER+"\0"+d.header+"\0\0"+"\0\0"+"\0\0"+(this.files[n].dir===true?"\0\0\0":"\0\0\0\0")+r(f,4)+u;f+=v.length;i.push(v);s.push(c)}var m=i.join("");var h=s.join("");var p="";p=JSZip.signature.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+r(i.length,2)+r(i.length,2)+r(h.length,4)+r(m.length,4)+"\0\0";var T=m+h+p;return e.base64?JSZipBase64.encode(T):T},crc32:function(e,r){if(e===""||typeof e==="undefined")return 0;var t="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";if(typeof r=="undefined"){r=0}var a=0;var s=0;r=r^-1;for(var i=0,f=e.length;i<f;i++){s=(r^e.charCodeAt(i))&255;a="0x"+t.substr(s*9,8);r=r>>>8^a}return r^-1},clone:function(){var e=new JSZip;for(var r in this){if(typeof this[r]!=="function"){e[r]=this[r]}}return e},utf8encode:function(e){e=e.replace(/\r\n/g,"\n");var r="";for(var t=0;t<e.length;t++){var a=e.charCodeAt(t);if(a<128){r+=String.fromCharCode(a)}else if(a>127&&a<2048){r+=String.fromCharCode(a>>6|192);r+=String.fromCharCode(a&63|128)}else{r+=String.fromCharCode(a>>12|224);r+=String.fromCharCode(a>>6&63|128);r+=String.fromCharCode(a&63|128)}}return r},utf8decode:function(e){var r="";var t=0;var a=0,s=0,i=0;while(t<e.length){a=e.charCodeAt(t);if(a<128){r+=String.fromCharCode(a);t++}else if(a>191&&a<224){s=e.charCodeAt(t+1);r+=String.fromCharCode((a&31)<<6|s&63);t+=2}else{s=e.charCodeAt(t+1);i=e.charCodeAt(t+2);r+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);t+=3}}return r}}}();JSZip.compressions={STORE:{magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e}}};var JSZipBase64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(r,t){var a="";var s,i,f,l,n,o,u;var v=0;while(v<r.length){s=r.charCodeAt(v++);i=r.charCodeAt(v++);f=r.charCodeAt(v++);l=s>>2;n=(s&3)<<4|i>>4;o=(i&15)<<2|f>>6;u=f&63;if(isNaN(i)){o=u=64}else if(isNaN(f)){u=64}a=a+e.charAt(l)+e.charAt(n)+e.charAt(o)+e.charAt(u)}return a},decode:function(r,t){var a="";var s,i,f;var l,n,o,u;var v=0;r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(v<r.length){l=e.indexOf(r.charAt(v++));n=e.indexOf(r.charAt(v++));o=e.indexOf(r.charAt(v++));u=e.indexOf(r.charAt(v++));s=l<<2|n>>4;i=(n&15)<<4|o>>2;f=(o&3)<<6|u;a=a+String.fromCharCode(s);if(o!=64){a=a+String.fromCharCode(i)}if(u!=64){a=a+String.fromCharCode(f)}}return a}}}();if(!JSZip){throw"JSZip not defined"}(function(){var e=32768;var r=0;var t=1;var a=2;var s=6;var i=32768;var f=64;var l=1024*8;var n=2*e;var o=3;var u=258;var v=16;var c=8192;var d=13;var m=c;var h=1<<d;var p=h-1;var T=e-1;var A=0;var w=4096;var O=u+o+1;var y=e-O;var _=1;var g=15;var b=7;var x=29;var F=256;var S=256;var k=F+1+x;var N=30;var I=19;var D=16;var E=17;var C=18;var P=2*k+1;var j=parseInt((d+o-1)/o);var Q;var R,q;var M;var L=null;var V,B;var J;var U;var z;var H;var Z;var G;var X;var Y;var $;var W;var K;var ee;var re;var te;var ae;var se;var ie;var fe;var le;var ne;var oe;var ue;var ve;var ce;var de;var me;var he;var pe;var Te;var Ae;var we;var Oe;var ye;var _e;var ge;var be;var xe;var Fe;var Se;var ke;var Ne;var Ie;var De;var Ee;var Ce;var Pe;var je;var Qe;var Re;var qe=function(){this.fc=0;this.dl=0};var Me=function(){this.dyn_tree=null;this.static_tree=null;this.extra_bits=null;this.extra_base=0;this.elems=0;this.max_length=0;this.max_code=0};var Le=function(e,r,t,a){this.good_length=e;this.max_lazy=r;this.nice_length=t;this.max_chain=a};var Ve=function(){this.next=null;this.len=0;this.ptr=new Array(l);this.off=0};var Be=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0);var Je=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);var Ue=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7);var ze=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);var He=new Array(new Le(0,0,0,0),new Le(4,4,8,4),new Le(4,5,16,8),new Le(4,6,32,32),new Le(4,4,16,16),new Le(8,16,32,32),new Le(8,16,128,128),new Le(8,32,128,256),new Le(32,128,258,1024),new Le(32,258,258,4096));var Ze=function(e){var r;if(!e)e=s;else if(e<1)e=1;else if(e>9)e=9;oe=e;M=false;ie=false;if(L!=null)return;Q=R=q=null;L=new Array(l);U=new Array(n);z=new Array(m);H=new Array(i+f);Z=new Array(1<<v);ve=new Array(P);for(r=0;r<P;r++)ve[r]=new qe;ce=new Array(2*N+1);for(r=0;r<2*N+1;r++)ce[r]=new qe;de=new Array(k+2);for(r=0;r<k+2;r++)de[r]=new qe;me=new Array(N);for(r=0;r<N;r++)me[r]=new qe;he=new Array(2*I+1);for(r=0;r<2*I+1;r++)he[r]=new qe;pe=new Me;Te=new Me;Ae=new Me;we=new Array(g+1);Oe=new Array(2*k+1);ge=new Array(2*k+1);be=new Array(u-o+1);xe=new Array(512);Fe=new Array(x);Se=new Array(N);ke=new Array(parseInt(c/8))};var Ge=function(e){e.next=Q;Q=e};var Xe=function(){var e;if(Q!=null){e=Q;Q=Q.next}else e=new Ve;e.next=null;e.len=e.off=0;return e};var Ye=function(r){return Z[e+r]};var $e=function(r,t){return Z[e+r]=t};var We=function(e){L[B+V++]=e;if(B+V==l)Ir()};var Ke=function(e){e&=65535;if(B+V<l-2){L[B+V++]=e&255;L[B+V++]=e>>>8}else{We(e&255);We(e>>>8)}};var er=function(){$=($<<j^U[ae+o-1]&255)&p;W=Ye($);Z[ae&T]=W;$e($,ae)};var rr=function(e,r){Sr(r[e].fc,r[e].dl)};var tr=function(e){return(e<256?xe[e]:xe[256+(e>>7)])&255};var ar=function(e,r,t){return e[r].fc<e[t].fc||e[r].fc==e[t].fc&&ge[r]<=ge[t]};var sr=function(e,r,t){var a;for(a=0;a<t&&Re<Qe.length;a++)e[r+a]=Qe.charCodeAt(Re++)&255;return a};var ir=function(){var r;for(r=0;r<h;r++)Z[e+r]=0;ne=He[oe].max_lazy;ue=He[oe].good_length;le=He[oe].max_chain;ae=0;Y=0;fe=sr(U,0,2*e);if(fe<=0){ie=true;fe=0;return}ie=false;while(fe<O&&!ie)lr();$=0;for(r=0;r<o-1;r++){$=($<<j^U[r]&255)&p}};var fr=function(e){var r=le;var t=ae;var a;var s;var i=te;var f=ae>y?ae-y:A;var l=ae+u;var n=U[t+i-1];var o=U[t+i];if(te>=ue)r>>=2;do{a=e;if(U[a+i]!=o||U[a+i-1]!=n||U[a]!=U[t]||U[++a]!=U[t+1]){continue}t+=2;a++;do{}while(U[++t]==U[++a]&&U[++t]==U[++a]&&U[++t]==U[++a]&&U[++t]==U[++a]&&U[++t]==U[++a]&&U[++t]==U[++a]&&U[++t]==U[++a]&&U[++t]==U[++a]&&t<l);s=u-(l-t);t=l-u;if(s>i){se=e;i=s;{if(s>=u)break}n=U[t+i-1];o=U[t+i]}}while((e=Z[e&T])>f&&--r!=0);return i};var lr=function(){var r,t;var a=n-fe-ae;if(a==-1){a--}else if(ae>=e+y){for(r=0;r<e;r++)U[r]=U[r+e];se-=e;ae-=e;Y-=e;for(r=0;r<h;r++){t=Ye(r);$e(r,t>=e?t-e:A)}for(r=0;r<e;r++){t=Z[r];Z[r]=t>=e?t-e:A}a+=e}if(!ie){r=sr(U,ae+fe,a);if(r<=0)ie=true;else fe+=r}};var nr=function(){while(fe!=0&&R==null){var e;er();if(W!=A&&ae-W<=y){re=fr(W);if(re>fe)re=fe}if(re>=o){e=br(ae-se,re-o);fe-=re;if(re<=ne){re--;do{ae++;er()}while(--re!=0);ae++}else{ae+=re;re=0;$=U[ae]&255;$=($<<j^U[ae+1]&255)&p}}else{e=br(0,U[ae]&255);fe--;ae++}if(e){gr(0);Y=ae}while(fe<O&&!ie)lr()}};var or=function(){while(fe!=0&&R==null){er();te=re;K=se;re=o-1;if(W!=A&&te<ne&&ae-W<=y){re=fr(W);if(re>fe)re=fe;if(re==o&&ae-se>w){re--}}if(te>=o&&re<=te){var e;e=br(ae-1-K,te-o);fe-=te-1;te-=2;do{ae++;er()}while(--te!=0);ee=0;re=o-1;ae++;if(e){gr(0);Y=ae}}else if(ee!=0){if(br(0,U[ae-1]&255)){gr(0);Y=ae}ae++;fe--}else{ee=1;ae++;fe--}while(fe<O&&!ie)lr()}};var ur=function(){if(ie)return;G=0;X=0;dr();ir();R=null;V=0;B=0;if(oe<=3){te=o-1;re=0}else{re=o-1;ee=0}J=false};var vr=function(e,r,t){var a;if(!M){ur();M=true;if(fe==0){J=true;return 0}}if((a=cr(e,r,t))==t)return t;if(J)return a;if(oe<=3)nr();else or();if(fe==0){if(ee!=0)br(0,U[ae-1]&255);gr(1);J=true}return a+cr(e,a+r,t-a)};var cr=function(e,r,t){var a,s,i;a=0;while(R!=null&&a<t){s=t-a;if(s>R.len)s=R.len;for(i=0;i<s;i++)e[r+a+i]=R.ptr[R.off+i];R.off+=s;R.len-=s;a+=s;if(R.len==0){var f;f=R;R=R.next;Ge(f)}}if(a==t)return a;if(B<V){s=t-a;if(s>V-B)s=V-B;for(i=0;i<s;i++)e[r+a+i]=L[B+i];B+=s;a+=s;if(V==B)V=B=0}return a};var dr=function(){var e;var r;var t;var a;var s;if(me[0].dl!=0)return;pe.dyn_tree=ve;pe.static_tree=de;pe.extra_bits=Be;pe.extra_base=F+1;pe.elems=k;pe.max_length=g;pe.max_code=0;Te.dyn_tree=ce;Te.static_tree=me;Te.extra_bits=Je;Te.extra_base=0;Te.elems=N;Te.max_length=g;Te.max_code=0;Ae.dyn_tree=he;Ae.static_tree=null;Ae.extra_bits=Ue;Ae.extra_base=0;Ae.elems=I;Ae.max_length=b;Ae.max_code=0;t=0;for(a=0;a<x-1;a++){Fe[a]=t;for(e=0;e<1<<Be[a];e++)be[t++]=a}be[t-1]=a;s=0;for(a=0;a<16;a++){Se[a]=s;for(e=0;e<1<<Je[a];e++){xe[s++]=a}}s>>=7;for(;a<N;a++){Se[a]=s<<7;for(e=0;e<1<<Je[a]-7;e++)xe[256+s++]=a}for(r=0;r<=g;r++)we[r]=0;e=0;while(e<=143){de[e++].dl=8;we[8]++}while(e<=255){de[e++].dl=9;we[9]++}while(e<=279){de[e++].dl=7;we[7]++}while(e<=287){de[e++].dl=8;we[8]++}Tr(de,k+1);for(e=0;e<N;e++){me[e].dl=5;me[e].fc=kr(e,5)}mr()};var mr=function(){var e;for(e=0;e<k;e++)ve[e].fc=0;for(e=0;e<N;e++)ce[e].fc=0;for(e=0;e<I;e++)he[e].fc=0;ve[S].fc=1;Pe=je=0;Ne=Ie=De=0;Ee=0;Ce=1};var hr=function(e,r){var t=Oe[r];var a=r<<1;while(a<=ye){if(a<ye&&ar(e,Oe[a+1],Oe[a]))a++;if(ar(e,t,Oe[a]))break;Oe[r]=Oe[a];r=a;a<<=1}Oe[r]=t};var pr=function(e){var r=e.dyn_tree;var t=e.extra_bits;var a=e.extra_base;var s=e.max_code;var i=e.max_length;var f=e.static_tree;var l;var n,o;var u;var v;var c;var d=0;for(u=0;u<=g;u++)we[u]=0;r[Oe[_e]].dl=0;for(l=_e+1;l<P;l++){n=Oe[l];u=r[r[n].dl].dl+1;if(u>i){u=i;d++}r[n].dl=u;if(n>s)continue;we[u]++;v=0;if(n>=a)v=t[n-a];c=r[n].fc;Pe+=c*(u+v);if(f!=null)je+=c*(f[n].dl+v)}if(d==0)return;do{u=i-1;while(we[u]==0)u--;we[u]--;we[u+1]+=2;we[i]--;d-=2}while(d>0);for(u=i;u!=0;u--){n=we[u];while(n!=0){o=Oe[--l];if(o>s)continue;if(r[o].dl!=u){Pe+=(u-r[o].dl)*r[o].fc;r[o].fc=u}n--}}};var Tr=function(e,r){var t=new Array(g+1);var a=0;var s;var i;for(s=1;s<=g;s++){a=a+we[s-1]<<1;t[s]=a}for(i=0;i<=r;i++){var f=e[i].dl;if(f==0)continue;e[i].fc=kr(t[f]++,f)}};var Ar=function(e){var r=e.dyn_tree;var t=e.static_tree;var a=e.elems;var s,i;var f=-1;var l=a;ye=0;_e=P;for(s=0;s<a;s++){if(r[s].fc!=0){Oe[++ye]=f=s;ge[s]=0}else r[s].dl=0}while(ye<2){var n=Oe[++ye]=f<2?++f:0;r[n].fc=1;ge[n]=0;Pe--;if(t!=null)je-=t[n].dl}e.max_code=f;for(s=ye>>1;s>=1;s--)hr(r,s);do{s=Oe[_];Oe[_]=Oe[ye--];hr(r,_);i=Oe[_];Oe[--_e]=s;Oe[--_e]=i;r[l].fc=r[s].fc+r[i].fc;if(ge[s]>ge[i]+1)ge[l]=ge[s];else ge[l]=ge[i]+1;r[s].dl=r[i].dl=l;Oe[_]=l++;hr(r,_)}while(ye>=2);Oe[--_e]=Oe[_];pr(e);Tr(r,f)};var wr=function(e,r){var t;var a=-1;var s;var i=e[0].dl;var f=0;var l=7;var n=4;if(i==0){l=138;n=3}e[r+1].dl=65535;for(t=0;t<=r;t++){s=i;i=e[t+1].dl;if(++f<l&&s==i)continue;else if(f<n)he[s].fc+=f;else if(s!=0){if(s!=a)he[s].fc++;he[D].fc++}else if(f<=10)he[E].fc++;else he[C].fc++;f=0;a=s;if(i==0){l=138;n=3}else if(s==i){l=6;n=3}else{l=7;n=4}}};var Or=function(e,r){var t;var a=-1;var s;var i=e[0].dl;var f=0;var l=7;var n=4;if(i==0){l=138;n=3}for(t=0;t<=r;t++){s=i;i=e[t+1].dl;if(++f<l&&s==i){continue}else if(f<n){do{rr(s,he)}while(--f!=0)}else if(s!=0){if(s!=a){rr(s,he);f--}rr(D,he);Sr(f-3,2)}else if(f<=10){rr(E,he);Sr(f-3,3)}else{rr(C,he);Sr(f-11,7)}f=0;a=s;if(i==0){l=138;n=3}else if(s==i){l=6;n=3}else{l=7;n=4}}};var yr=function(){var e;wr(ve,pe.max_code);wr(ce,Te.max_code);Ar(Ae);for(e=I-1;e>=3;e--){if(he[ze[e]].dl!=0)break}Pe+=3*(e+1)+5+5+4;return e};var _r=function(e,r,t){var a;Sr(e-257,5);Sr(r-1,5);Sr(t-4,4);for(a=0;a<t;a++){Sr(he[ze[a]].dl,3)}Or(ve,e-1);Or(ce,r-1)};var gr=function(e){var s,i;var f;var l;l=ae-Y;ke[De]=Ee;Ar(pe);Ar(Te);f=yr();s=Pe+3+7>>3;i=je+3+7>>3;if(i<=s)s=i;if(l+4<=s&&Y>=0){var n;Sr((r<<1)+e,3);Nr();Ke(l);Ke(~l);for(n=0;n<l;n++)We(U[Y+n])}else if(i==s){Sr((t<<1)+e,3);xr(de,me)}else{Sr((a<<1)+e,3);_r(pe.max_code+1,Te.max_code+1,f+1);xr(ve,ce)}mr();if(e!=0)Nr()};var br=function(e,r){H[Ne++]=r;if(e==0){ve[r].fc++}else{e--;ve[be[r]+F+1].fc++;ce[tr(e)].fc++;z[Ie++]=e;Ee|=Ce}Ce<<=1;if((Ne&7)==0){ke[De++]=Ee;Ee=0;Ce=1}if(oe>2&&(Ne&4095)==0){var t=Ne*8;var a=ae-Y;var s;for(s=0;s<N;s++){t+=ce[s].fc*(5+Je[s])}t>>=3;if(Ie<parseInt(Ne/2)&&t<parseInt(a/2))return true}return Ne==c-1||Ie==m};var xr=function(e,r){var t;var a;var s=0;var i=0;var f=0;var l=0;var n;var o;if(Ne!=0)do{if((s&7)==0)l=ke[f++];a=H[s++]&255;if((l&1)==0){rr(a,e)}else{n=be[a];rr(n+F+1,e);o=Be[n];if(o!=0){a-=Fe[n];Sr(a,o)}t=z[i++];n=tr(t);rr(n,r);o=Je[n];if(o!=0){t-=Se[n];Sr(t,o)}}l>>=1}while(s<Ne);rr(S,e)};var Fr=16;var Sr=function(e,r){if(X>Fr-r){G|=e<<X;Ke(G);G=e>>Fr-X;X+=r-Fr}else{G|=e<<X;X+=r}};var kr=function(e,r){var t=0;do{t|=e&1;e>>=1;t<<=1}while(--r>0);return t>>1};var Nr=function(){if(X>8){Ke(G)}else if(X>0){We(G)}G=0;X=0};var Ir=function(){if(V!=0){var e,r;e=Xe();if(R==null)R=q=e;else q=q.next=e;e.len=V-B;for(r=0;r<e.len;r++)e.ptr[r]=L[B+r];V=B=0}};var Dr=function(e,r){var t,a;Qe=e;Re=0;if(typeof r=="undefined")r=s;Ze(r);var i=new Array(1024);var f=[];while((t=vr(i,0,i.length))>0){var l=new Array(t);for(a=0;a<t;a++){l[a]=String.fromCharCode(i[a])}f[f.length]=l.join("")}Qe=null;return f.join("")};if(!JSZip.compressions["DEFLATE"]){JSZip.compressions["DEFLATE"]={magic:"\b\0",compress:Dr}}else{JSZip.compressions["DEFLATE"].compress=Dr}})();if(!JSZip){throw"JSZip not defined"}(function(){var e;var r=32768;var t=0;var a=9;var s=6;var i;var f;var l=null;var n;var o;var u;var v;var c;var d;var m;var h;var p,T;var A,w;var O;var y;var _=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);var g=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0);var b=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99);var x=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577);var F=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);var S=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);function k(){this.next=null;this.list=null}function N(){this.e=0;this.b=0;this.n=0;this.t=null}function I(e,r,t,a,s,i){this.BMAX=16;this.N_MAX=288;this.status=0;this.root=null;this.m=0;{var f;var l=new Array(this.BMAX+1);var n;var o;var u;var v;var c;var d;var m;var h=new Array(this.BMAX+1);var p;var T;var A;var w=new N;var O=new Array(this.BMAX);var y=new Array(this.N_MAX);var _;var g=new Array(this.BMAX+1);var b;var x;var F;var S;var I;I=this.root=null;for(c=0;c<l.length;c++)l[c]=0;for(c=0;c<h.length;c++)h[c]=0;for(c=0;c<O.length;c++)O[c]=null;for(c=0;c<y.length;c++)y[c]=0;for(c=0;c<g.length;c++)g[c]=0;n=r>256?e[256]:this.BMAX;p=e;T=0;c=r;do{l[p[T]]++;T++}while(--c>0);if(l[0]==r){this.root=null;this.m=0;this.status=0;return}for(d=1;d<=this.BMAX;d++)if(l[d]!=0)break;m=d;if(i<d)i=d;for(c=this.BMAX;c!=0;c--)if(l[c]!=0)break;u=c;if(i>c)i=c;for(x=1<<d;d<c;d++,x<<=1)if((x-=l[d])<0){this.status=2;this.m=i;return}if((x-=l[c])<0){this.status=2;this.m=i;return}l[c]+=x;g[1]=d=0;p=l;T=1;b=2;while(--c>0)g[b++]=d+=p[T++];p=e;T=0;c=0;do{if((d=p[T++])!=0)y[g[d]++]=c}while(++c<r);r=g[u];g[0]=c=0;p=y;T=0;v=-1;_=h[0]=0;A=null;F=0;for(;m<=u;m++){f=l[m];while(f-- >0){while(m>_+h[1+v]){_+=h[1+v];v++;F=(F=u-_)>i?i:F;if((o=1<<(d=m-_))>f+1){o-=f+1;b=m;while(++d<F){if((o<<=1)<=l[++b])break;o-=l[b]}}if(_+d>n&&_<n)d=n-_;F=1<<d;h[1+v]=d;A=new Array(F);for(S=0;S<F;S++){A[S]=new N}if(I==null)I=this.root=new k;else I=I.next=new k;I.next=null;I.list=A;O[v]=A;if(v>0){g[v]=c;w.b=h[v];w.e=16+d;w.t=A;d=(c&(1<<_)-1)>>_-h[v];O[v-1][d].e=w.e;O[v-1][d].b=w.b;O[v-1][d].n=w.n;O[v-1][d].t=w.t}}w.b=m-_;if(T>=r)w.e=99;else if(p[T]<t){w.e=p[T]<256?16:15;w.n=p[T++]}else{w.e=s[p[T]-t];w.n=a[p[T++]-t]}o=1<<m-_;for(d=c>>_;d<F;d+=o){A[d].e=w.e;A[d].b=w.b;A[d].n=w.n;A[d].t=w.t}for(d=1<<m-1;(c&d)!=0;d>>=1)c^=d;c^=d;while((c&(1<<_)-1)!=g[v]){_-=h[v];v--}}}this.m=h[1];this.status=x!=0&&u!=1?1:0}}function D(){if(O.length==y)return-1;return O.charCodeAt(y++)&255}function E(e){while(v<e){u|=D()<<v;v+=8}}function C(e){return u&_[e]}function P(e){u>>=e;v-=e}function j(e,t,a){var s;var l;var n;if(a==0)return 0;n=0;for(;;){E(A);l=p.list[C(A)];s=l.e;while(s>16){if(s==99)return-1;P(l.b);s-=16;E(s);l=l.t[C(s)];s=l.e}P(l.b);if(s==16){f&=r-1;e[t+n++]=i[f++]=l.n;if(n==a)return a;continue}if(s==15)break;E(s);m=l.n+C(s);P(s);E(w);l=T.list[C(w)];s=l.e;while(s>16){if(s==99)return-1;P(l.b);s-=16;E(s);l=l.t[C(s)];s=l.e}P(l.b);E(s);h=f-l.n-C(s);P(s);while(m>0&&n<a){m--;h&=r-1;f&=r-1;e[t+n++]=i[f++]=i[h++]}if(n==a)return a}c=-1;return n}function Q(e,t,a){var s;s=v&7;P(s);E(16);s=C(16);P(16);E(16);if(s!=(~u&65535))return-1;P(16);m=s;s=0;while(m>0&&s<a){m--;f&=r-1;E(8);e[t+s++]=i[f++]=C(8);P(8)}if(m==0)c=-1;return s}function R(r,t,a){if(l==null){var s;var i=new Array(288);var f;for(s=0;s<144;s++)i[s]=8;for(;s<256;s++)i[s]=9;for(;s<280;s++)i[s]=7;for(;s<288;s++)i[s]=8;o=7;f=new I(i,288,257,g,b,o);if(f.status!=0){alert("HufBuild error: "+f.status);return-1}l=f.root;o=f.m;for(s=0;s<30;s++)i[s]=5;e=5;f=new I(i,30,0,x,F,e);if(f.status>1){l=null;alert("HufBuild error: "+f.status);return-1}n=f.root;e=f.m}p=l;T=n;A=o;w=e;return j(r,t,a)}function q(e,r,t){var i;var f;var l;var n;var o;var u;var v;var c;var d=new Array(286+30);var m;for(i=0;i<d.length;i++)d[i]=0;E(5);v=257+C(5);P(5);E(5);c=1+C(5);P(5);E(4);u=4+C(4);P(4);if(v>286||c>30)return-1;for(f=0;f<u;f++){E(3);d[S[f]]=C(3);P(3)}for(;f<19;f++)d[S[f]]=0;A=7;m=new I(d,19,19,null,null,A);if(m.status!=0)return-1;p=m.root;A=m.m;n=v+c;i=l=0;while(i<n){E(A);o=p.list[C(A)];f=o.b;P(f);f=o.n;if(f<16)d[i++]=l=f;else if(f==16){E(2);f=3+C(2);P(2);if(i+f>n)return-1;while(f-- >0)d[i++]=l}else if(f==17){E(3);f=3+C(3);P(3);if(i+f>n)return-1;while(f-- >0)d[i++]=0;l=0}else{E(7);f=11+C(7);P(7);if(i+f>n)return-1;while(f-- >0)d[i++]=0;l=0}}A=a;m=new I(d,v,257,g,b,A);if(A==0)m.status=1;if(m.status!=0){return-1}p=m.root;A=m.m;for(i=0;i<c;i++)d[i]=d[i+v];w=s;m=new I(d,c,0,x,F,w);T=m.root;w=m.m;if(w==0&&v>257){return-1}if(m.status!=0)return-1;return j(e,r,t)}function M(){if(i==null)i=new Array(2*r);f=0;u=0;v=0;c=-1;d=false;m=h=0;p=null}function L(e,a,s){var l,n;l=0;while(l<s){if(d&&c==-1)return l;if(m>0){if(c!=t){while(m>0&&l<s){m--;h&=r-1;f&=r-1;e[a+l++]=i[f++]=i[h++]}}else{while(m>0&&l<s){m--;f&=r-1;E(8);e[a+l++]=i[f++]=C(8);P(8)}if(m==0)c=-1}if(l==s)return l}if(c==-1){if(d)break;E(1);if(C(1)!=0)d=true;P(1);E(2);c=C(2);P(2);p=null;m=0}switch(c){case 0:n=Q(e,a+l,s-l);break;case 1:if(p!=null)n=j(e,a+l,s-l);else n=R(e,a+l,s-l);break;case 2:if(p!=null)n=j(e,a+l,s-l);else n=q(e,a+l,s-l);break;default:n=-1;break}if(n==-1){if(d)return 0;return-1}l+=n}return l}function V(e){var r,t;var a,s;M();O=e;y=0;t=new Array(1024);r="";while((a=L(t,0,t.length))>0){for(s=0;s<a;s++)r+=String.fromCharCode(t[s])}O=null;return r}if(!JSZip.compressions["DEFLATE"]){JSZip.compressions["DEFLATE"]={magic:"\b\0",uncompress:V}}else{JSZip.compressions["DEFLATE"].uncompress=V}})();(function(){var e=function(e){var r="",t,a;for(a=0;a<e.length;a++){t=e.charCodeAt(a);r+="\\x"+(t<10?"0":"")+t.toString(16)}return r};var r=function(e){for(var r in JSZip.compressions){if(JSZip.compressions[r].magic===e){return JSZip.compressions[r]}}return null};function t(e){this.stream=e;this.index=0}t.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.stream.length<e||e<0){throw new Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+e+"). Corrupted zip ?")}},setIndex:function(e){this.checkIndex(e);this.index=e},eof:function(){return this.index>=this.stream.length},byteAt:function(e){return this.stream.charCodeAt(e)&255},readByte:function(){this.checkOffset(1);return this.byteAt(1+this.index++)},readInt:function(e){var r=0,t;this.checkOffset(e);for(t=e-1;t>=0;t--){r=(r<<8)+this.byteAt(this.index+t)}this.index+=e;return r},readString:function(e){var r="",t,a;this.checkOffset(e);for(t=0;t<e;t++){a=this.byteAt(this.index+t);r+=String.fromCharCode(a)}this.index+=e;return r},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};function a(e,r){this.options=e;this.loadOptions=r}a.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},hasDataDescriptor:function(){return(this.bitFlag&8)===8},useUTF8:function(){return(this.bitFlag&2048)===2048},isZIP64:function(){return this.options.zip64},readLocalPartHeader:function(e){this.versionNeeded=e.readInt(2);this.bitFlag=e.readInt(2);this.compressionMethod=e.readString(2);this.date=e.readDate();this.crc32=e.readInt(4);this.compressedSize=e.readInt(4);this.uncompressedSize=e.readInt(4);this.fileNameLength=e.readInt(2);this.extraFieldsLength=e.readInt(2);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}},readLocalPart:function(t){var a;this.readLocalPartHeader(t);this.fileName=t.readString(this.fileNameLength);this.readExtraFields(t);if(!this.hasDataDescriptor()){this.compressedFileData=t.readString(this.compressedSize)}else{this.compressedFileData=this.findDataUntilDataDescriptor(t);this.crc32=t.readInt(4);this.compressedSize=t.readInt(this.isZIP64()?8:4);this.uncompressedSize=t.readInt(this.isZIP64()?8:4);if(this.compressedFileData.length!==this.compressedSize){throw new Error("Bug : data descriptor incorrectly read (size mismatch)")}}this.uncompressedFileData=null;a=r(this.compressionMethod);if(a===null){throw new Error("Corrupted zip : compression "+e(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")}this.uncompressedFileData=a.uncompress(this.compressedFileData);if(this.loadOptions.checkCRC32&&JSZip.prototype.crc32(this.uncompressedFileData)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName)}},findDataUntilDataDescriptor:function(e){var r="",t=e.readString(4),a;while(t!==JSZip.signature.DATA_DESCRIPTOR){a=e.readString(1);r+=t.slice(0,1);t=(t+a).slice(-4)}return r},readCentralPart:function(e){this.versionMadeBy=e.readString(2);this.readLocalPartHeader(e);this.fileCommentLength=e.readInt(2);this.diskNumberStart=e.readInt(2);this.internalFileAttributes=e.readInt(2);this.externalFileAttributes=e.readInt(4);this.localHeaderOffset=e.readInt(4);this.fileName=e.readString(this.fileNameLength);this.readExtraFields(e);this.fileComment=e.readString(this.fileCommentLength);if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName);this.fileComment=JSZip.prototype.utf8decode(this.fileComment)}this.dir=this.externalFileAttributes&16?true:false},parseZIP64ExtraField:function(e){var r=new t(this.extraFields[1].value);if(this.uncompressedSize===-1){this.uncompressedSize=r.readInt(8)}if(this.compressedSize===-1){this.compressedSize=r.readInt(8)}if(this.localHeaderOffset===-1){this.localHeaderOffset=r.readInt(8)}if(this.diskNumberStart===-1){this.diskNumberStart=r.readInt(4)}},readExtraFields:function(e){var r=e.index,t,a,s;this.extraFields=this.extraFields||{};while(e.index<r+this.extraFieldsLength){t=e.readInt(2);a=e.readInt(2);s=e.readString(a);this.extraFields[t]={id:t,length:a,value:s}}if(this.isZIP64()&&this.extraFields[1]){this.parseZIP64ExtraField(e)}}};function s(e,r){this.files=[];this.loadOptions=r;if(e)this.load(e)}s.prototype={checkSignature:function(r){var t=this.reader.readString(4);if(t!==r){throw new Error("Corrupted zip or bug : unexpected signature "+"("+e(t)+", expected "+e(r)+")")}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var e=this.zip64EndOfCentralSize-44,r=0,t,a,s;while(r<e){t=this.reader.readInt(2);a=this.reader.readInt(4);s=this.reader.readString(a);this.zip64ExtensibleData[t]={id:t,length:a,value:s}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++){r=this.files[e];this.reader.setIndex(r.localHeaderOffset);this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER);r.readLocalPart(this.reader)}},readCentralDir:function(){var e;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER){e=new a({zip64:this.zip64},this.loadOptions);e.readCentralPart(this.reader);this.files.push(e)}},readEndOfCentral:function(){var e=this.reader.stream.lastIndexOf(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(e===-1){this.zip64=false;e=this.reader.stream.lastIndexOf(JSZip.signature.CENTRAL_DIRECTORY_END);if(e===-1){throw new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(e);this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral()}else{this.zip64=true;this.reader.setIndex(e);this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},load:function(e){this.reader=new t(e);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};JSZip.prototype.load=function(e,r){var t,a,i,f;r=r||{};if(r.base64){e=JSZipBase64.decode(e)}a=new s(e,r);t=a.files;for(i in t){f=t[i];this.file(f.fileName,f.uncompressedFileData,{binary:true,date:f.date,dir:f.dir})}return this}})();function xlsx(e){var r="Calibri";var t=11;var a="000000";var s,i=new JSZip,f,l,n,o,u,v,c,d,m,h,p,T,A,w,O,y,_,g,b,x,F,S,k,N,I,D=[[],[]],E=[],C=[],P=[],j,Q,R,q,M,L,V,B=["General","0","0.00","#,##0","#,##0.00",,,,,"0%","0.00%","0.00E+00","# ?/?","# ??/??","mm-dd-yy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm",,,,,,,,,,,,,,,"#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)",,,,,"mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@"],J="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function U(e){var r=Math.floor(e/26)-1;return(r>-1?U(r):"")+J.charAt(e%26)}function z(e){return typeof e==="object"?(e-new Date(1900,0,0))/864e5+1:new Date(+new Date(1900,0,0)+(e-1)*864e5)}function H(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function Z(e){return(e||"").replace(/&amp;/g,"&").replace(/&(?!(lt|gt))/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace("settings","")}function G(e,r,t){if(e==undefined||e.trim()==""){e=""}else{if(r.genexusType=="date"){var a=t?["DMY","YMD","YDM"]:r.genexusPicture=="99/99/99"?["dd/mm/yy","yy/mm/dd","yyyy/dd/mm"]:["dd/mm/yyyy","yyyy/mm/dd","yyyy/dd/mm"];var s=e.split("-");if(!r.genexusPicture||r.genexusPicture=="99/99/99"){e=s[1]+"/"+s[2]+"/"+s[0].substring(2);if(r.formatCode==a[0])e=s[2]+"/"+s[1]+"/"+s[0].substring(2);if(r.formatCode==a[1])e=s[0].substring(2)+"/"+s[1]+"/"+s[2]}if(r.genexusPicture=="99/99/9999"){e=s[1]+"/"+s[2]+"/"+s[0];if(r.formatCode==a[0])e=s[2]+"/"+s[1]+"/"+s[0];if(r.formatCode==a[1])e=s[0]+"/"+s[1]+"/"+s[2]}if(r.genexusPicture=="9999/99/99"){e=s[0]+"/"+s[1]+"/"+s[2];if(r.formatCode==a[2])e=s[0]+"/"+s[2]+"/"+s[1];if(r.formatCode==a[1])e=s[0]+"/"+s[1]+"/"+s[2]}}else{var i=e.split(" ");var s=i[0].split("-");ie=i[1].split(":");if(!r.genexusPicture){e=s[1]+"/"+s[2]+"/"+s[0].substring(2)+" "+ie[0]+":"+ie[1]}else{var f=r.genexusPicture.split(" ");var a=t?["DMY","YMD","YDM"]:f[0]=="99/99/99"?["dd/mm/yy","yy/mm/dd","yyyy/dd/mm"]:["dd/mm/yyyy","yyyy/mm/dd","yyyy/dd/mm"];if(f[0]=="99/99/99"){e=s[1]+"/"+s[2]+"/"+s[0].substring(2);if(r.formatCode==a[0])e=s[2]+"/"+s[1]+"/"+s[0].substring(2);if(r.formatCode==a[1])e=s[0].substring(2)+"/"+s[1]+"/"+s[2]}if(f[0]=="99/99/9999"){e=s[1]+"/"+s[2]+"/"+s[0];if(r.formatCode==a[0])e=s[2]+"/"+s[1]+"/"+s[0];if(r.formatCode==a[1])e=s[0]+"/"+s[1]+"/"+s[2]}if(f[0]=="9999/99/99"){e=s[0]+"/"+s[1]+"/"+s[2];if(r.formatCode==a[2])e=s[0]+"/"+s[2]+"/"+s[1];if(r.formatCode==a[1])e=s[0]+"/"+s[1]+"/"+s[2]}if(f[1]=="99"){e=e+" "+ie[0]}if(f[1]=="99:99"){e=e+" "+ie[0]+":"+ie[1]}if(f[1]=="99:99:99"){e=e+" "+ie[0]+":"+ie[1]+":"+ie[2].split(".")[0]}if(f[1]=="99:99:99.999"){e=e+" "+ie[0]+":"+ie[1]+":"+ie[2]}}}}return e}if(e.pivot){l=Date.now();i.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>'+'<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/>'+'<Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/>'+"</Relationships>");S=i.folder("docProps");S.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">'+"<dc:creator>gonzalo</dc:creator>"+'<dcterms:created xsi:type="dcterms:W3CDTF">2010-12-23T01:32:21Z</dcterms:created>'+"<cp:lastModifiedBy>xperTools</cp:lastModifiedBy>"+'<dcterms:modified xsi:type="dcterms:W3CDTF">2010-02-23T01:32:21Z</dcterms:modified>'+"</cp:coreProperties>");S.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">'+"<DocSecurity>0</DocSecurity>"+"<ScaleCrop>false</ScaleCrop>"+"<HeadingPairs>"+'<vt:vector size="2" baseType="variant">'+"<vt:variant>"+"<vt:lpstr>Hojas de cálculo</vt:lpstr>"+"</vt:variant>"+"<vt:variant>"+"<vt:i4>2</vt:i4>"+"</vt:variant>"+"</vt:vector>"+"</HeadingPairs>"+"<TitlesOfParts>"+'<vt:vector size="2" baseType="lpstr">'+"<vt:lpstr>PivotTable</vt:lpstr>"+"<vt:lpstr>SourceData</vt:lpstr>"+"</vt:vector>"+"</TitlesOfParts>"+"<LinksUpToDate>false</LinksUpToDate>"+"<SharedDoc>false</SharedDoc>"+"<HyperlinksChanged>false</HyperlinksChanged>"+"<AppVersion>12.0000</AppVersion>"+"</Properties>");i.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">'+'<Default Extension="xml" ContentType="application/xml"/>'+'<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>'+'<Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>'+'<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>'+'<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+'<Override PartName="/xl/worksheets/sheet2.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>'+'<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>'+'<Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>'+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>'+'<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>'+'<Override PartName="/xl/pivotTables/pivotTable1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml"/>'+'<Override PartName="/xl/pivotCache/pivotCacheDefinition1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml"/>'+'<Override PartName="/xl/pivotCache/pivotCacheRecords1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml"/>'+"</Types>");k=i.folder("xl");k.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>'+'<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet2.xml"/>'+'<Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="pivotCache/pivotCacheDefinition1.xml"/>'+'<Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>'+'<Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>'+'<Relationship Id="rId6" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/>'+"</Relationships>");var X=k.folder("pivotCache").file("pivotCacheRecords1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<pivotCacheRecords xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+"</pivotCacheRecords>");X.file("pivotCacheDefinition1.xml",e.pivotCacheDefinition);X.folder("_rels").file("pivotCacheDefinition1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords" Target="pivotCacheRecords1.xml"/>'+"</Relationships>");var Y=k.folder("pivotTables").file("pivotTable1.xml",e.pivotTable1);Y.folder("_rels").file("pivotTable1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="../pivotCache/pivotCacheDefinition1.xml"/>'+"</Relationships>");k.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<a:theme name="Tema de Office" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"/>');N=k.folder("worksheets");N.file("sheet1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+"<sheetData/>"+"</worksheet>");p=new Array(1);y=new Array(1);b=new Array(1);var $="";var W=1;m=e.worksheets.length;while(m--){j=m+1;I=e.worksheets[m];A=I.data;n="";Q=[];L=[];o=-1;c=A.length;while(++o<c){u=-1;v=A[o].length;n+='<row r="'+(o+1)+'" x14ac:dyDescent="0.25">';while(++u<v){var K=false;M=A[o][u];w=M.hasOwnProperty("value")?M.value:M;d="";O={borders:M.borders,hAlign:M.hAlign,vAlign:M.vAlign,bold:M.bold,italic:M.italic,fontColor:M.fontColor,fontName:M.fontName,fontSize:M.fontSize,fill:M.fill,formatCode:M.formatCode||"General"};q=0;if((M.isString||w&&typeof w==="string"&&!isFinite(w))&&!(M.genexusType=="date")&&!(M.genexusType=="datetime")||M.genexusType=="character"){w=Z(w);d="inlineStr";K=true}else if(typeof w==="boolean"){w=w?1:0;d="b";q=1}else if(H(w)==="date"||M.genexusType=="date"||M.genexusType=="datetime"){w=G(w,M,true);d="inlineStr";K=true;O.hAlign="right"}else if(typeof w==="object"){w=null}else{q=(""+w).length}O=JSON.stringify(O);T=p.indexOf(O);if(T<0){O=p.push(O)-1}else{O=T}if(Q[u]==null){Q[u]={autoWidth:false,max:0}}if(M.autoWidth){Q[u].autoWidth=true}if(q>Q[u].max){Q[u].max=q}if(M.colSpan>1){L.push([U(u)+(o+1),U(u+M.colSpan-1)+(o+1)]);V=[u,0];for(var ee=0;ee<M.colSpan-1;ee++){V.push(M)}A[o].splice.apply(A[o],V);v+=M.colSpan-1}else if(M.rowSpan>1){for(var ee=1;ee<M.rowSpan;ee++){if(A[o+ee]){A[o+ee].splice(u,0,M)}else{M.rowSpan=ee;break}}L.push([U(u)+(o+1),U(u)+(o+M.rowSpan)])}if(M.rowSpan>1||M.colSpan>1){delete M.value;delete M.rowSpan;delete M.colSpan}n+='<c r="'+U(u)+(o+1)+'"'+(O?' s="'+O+'"':"")+(d?' t="'+d+'"':"");if(w!=null){if(K){n+=">"+(M.formula?"<f>"+M.formula+"</f>":"")+"<is><t>"+w+"</t></is></c>"}else{n+=">"+(M.formula?"<f>"+M.formula+"</f>":"")+"<v>"+w+"</v></c>"}}else{n+="/>"}}n+="</row>"}R=[];for(o=0;o<Q.length;o++){if(Q[o].autoWidth){R.push('<col min="',o+1,'" max="',o+1,'" width="',Q[o].max,'" bestFit="1"/>')}}if(R.length>0){R=["<cols>"].concat(R,["</cols>"]).join("")}n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+'<dimension ref="A1:'+U(A[0].length-1)+A.length+'"/><sheetViews><sheetView '+(m===e.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+R+"<sheetData>"+n+"</sheetData>";if(L.length>0){n+='<mergeCells count="'+L.length+'">';for(o=0;o<L.length;o++){n+='<mergeCell ref="'+L[o].join(":")+'"/>'}n+="</mergeCells>"}n+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';if(I.table){n+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>'}N.file("sheet2.xml",n+"</worksheet>")}o=p.length;d=[];var re=0;while(--o){O=JSON.parse(p[o]);if(O.formatCode!=="General"){T=B.indexOf(O.formatCode);if(T<0){T=164+d.length;d.push('<numFmt formatCode="'+O.formatCode+'" numFmtId="'+T+'"/>')}O.formatCode=T}else{O.formatCode=0}g=0;if(O.borders){_=["<border>"];for(var te in{left:0,right:0,top:0,bottom:0,diagonal:0}){if(O.borders[te]){_.push("<",te,' style="thin">','<color rgb="',O.borders[te],'"/></',te,">")}else{_.push("<",te,"/>")}}_.push("</border>");_=_.join("");g=y.indexOf(_);if(g<0){g=y.push(_)-1}}F=0;if(O.bold||O.italic||O.fontSize||O.fontName||O.fontColor){x=["<font>"];if(O.bold){x.push("<b/>")}if(O.italic){x.push("<i/>")}x.push('<sz val="',O.fontSize||t,'"/>');x.push('<color rgb="FF',O.fontColor||a,'"/>');x.push('<name val="',O.fontName||r,'"/>');x.push('<family val="2"/>',"</font>");x=x.join("");F=b.indexOf(x);if(F<0){F=b.push(x)-1}}re=0;if(O.fill){$=$+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+O.fill+'"/>'+'<bgColor indexed="64"/></patternFill></fill>';W++;re=W}p[o]=['<xf xfId="0" borderId="',g,'" fontId="',F,'" numFmtId="',O.formatCode,'" fillId="',re,'" ',O.hAlign||O.vAlign?'applyAlignment="1" ':" ",O.formatCode>0?'applyNumberFormat="1" ':" ",g>0?'applyBorder="1" ':" ",F>0?'applyFont="1" ':" ",re>0?'applyFill="1" ':" ",">"];if(O.hAlign||O.vAlign){p[o].push("<alignment");if(O.hAlign){p[o].push(' horizontal="',O.hAlign,'"')}if(O.vAlign){p[o].push(' vertical="',O.vAlign,'"')}p[o].push("/>")}p[o].push("</xf>");p[o]=p[o].join("")}d=d.length?'<numFmts count="'+d.length+'">'+d.join("")+"</numFmts>":"";if(e.style!=""){d=e.style}var ae='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+d+'<fonts count="'+b.length+'" x14ac:knownFonts="1"><font><sz val="'+t+'"/><color theme="1"/><name val="'+r+'"/><family val="2"/>'+'<scheme val="minor"/></font>'+b.join("")+"</fonts>"+'<fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+$+"</fills>"+'<borders count="'+y.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+y.join("")+'</borders><cellStyleXfs count="1">'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+p.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+p.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>';if(e.dfx!=undefined){ae=ae+"<dxfs>"+e.dfx+"</dxfs>"}else{ae=ae+'<dxfs count="0"/>'}ae=ae+'<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/>'+'<extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main">'+'<x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>';k.file("styles.xml",ae);N.folder("_rels").file("sheet1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable" Target="../pivotTables/pivotTable1.xml"/></Relationships>');k.file("sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">'+"</sst>");k.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<fileVersion appName="xl" lastEdited="4" lowestEdited="4" rupBuild="4506"/>'+'<workbookPr defaultThemeVersion="124226"/>'+"<bookViews>"+'<workbookView xWindow="360" yWindow="555" windowWidth="21015" windowHeight="9405"/>'+"</bookViews>"+"<sheets>"+'<sheet name="PivotTable" sheetId="1" r:id="rId1"/>'+'<sheet name="SourceData" sheetId="2" r:id="rId2"/>'+"</sheets>"+'<calcPr calcId="125725"/>'+"<pivotCaches>"+'<pivotCache cacheId="5" r:id="rId3"/>'+"</pivotCaches>"+'<fileRecoveryPr repairLoad="1"/>'+"</workbook>");l=Date.now()-l;f=Date.now();s={base64:i.generate({compression:"STORE"}),zipTime:Date.now()-f,processTime:l,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}}else{l=Date.now();h=[[],0];i.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>');S=i.folder("docProps");k=i.folder("xl");k.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>');N=k.folder("worksheets");S.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>'+(e.creator||"XLSX.js")+"</dc:creator><cp:lastModifiedBy>"+(e.lastModifiedBy||"XLSX.js")+'</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">'+(e.created||new Date).toISOString()+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+(e.modified||new Date).toISOString()+"</dcterms:modified></cp:coreProperties>");p=new Array(1);y=new Array(1);b=new Array(1);var $="";var W=1;m=e.worksheets.length;while(m--){j=m+1;I=e.worksheets[m];A=I.data;n="";Q=[];L=[];o=-1;c=A.length;while(++o<c){u=-1;v=A[o].length;n+='<row r="'+(o+1)+'" x14ac:dyDescent="0.25">';while(++u<v){M=A[o][u];w=M.hasOwnProperty("value")?M.value:M;d="";O={borders:M.borders,hAlign:M.hAlign,vAlign:M.vAlign,bold:M.bold,italic:M.italic,fontColor:M.fontColor,fontName:M.fontName,fontSize:M.fontSize,fill:M.fill,formatCode:M.formatCode||"General"};q=0;if(w&&typeof w==="string"&&!isFinite(w)&&!(M.genexusType=="date")&&!(M.genexusType=="datetime")||M.genexusType=="character"){w=Z(w);h[1]++;T=h[0].indexOf(w);q=w.length;if(T<0){T=h[0].push(w)-1}w=T;d="s"}else if(typeof w==="boolean"){w=w?1:0;d="b";q=1}else if(H(w)==="date"){var se=w.split("-");var ie;if(M.genexusType=="datetime"){var fe=w.split(" ");se=fe[0].split("-");ie=fe[1].split(":")}var le=null;if(M.genexusType=="datetime"){le=new Date(se[0],parseInt(se[1])-1,parseInt(se[2]),parseInt(ie[0])+1,parseInt(ie[1])-15,parseInt(ie[2])-9)}else{le=new Date(se[0],parseInt(se[1])-1,parseInt(se[2])+1)}w=z(le);if(M.genexusType=="date"){w=parseInt(w);O.formatCode=M.formatCode||"mm/dd/yy"}else{O.formatCode=M.formatCode||"mm/dd/yy hh:mm"}q=M.formatCode.length+1}else if(M.genexusType=="date"||M.genexusType=="datetime"){w=G(w,M,false);w=Z(w);h[1]++;T=h[0].indexOf(w);q=w.length;if(T<0){T=h[0].push(w)-1}w=T;d="s";O.formatCode="General";O.hAlign="right"}else if(typeof w==="object"){w=null}else{q=(""+w).length;if(w==undefined||w.trim()==""){w=Z(w);h[1]++;T=h[0].indexOf(w);q=w.length;if(T<0){T=h[0].push(w)-1}w=T;d="s"}}O=JSON.stringify(O);T=p.indexOf(O);if(T<0){O=p.push(O)-1}else{O=T}if(Q[u]==null){Q[u]={autoWidth:false,max:0}}if(M.autoWidth||M.genexusType=="date"||M.genexusType=="datetime"){Q[u].autoWidth=true}if(q>Q[u].max){Q[u].max=q}if(M.colSpan>1){L.push([U(u)+(o+1),U(u+M.colSpan-1)+(o+1)]);V=[u,0];for(var ee=0;ee<M.colSpan-1;ee++){V.push(M)}A[o].splice.apply(A[o],V);v+=M.colSpan-1}else if(M.rowSpan>1){for(var ee=1;ee<M.rowSpan;ee++){if(A[o+ee]){A[o+ee].splice(u,0,M)}else{M.rowSpan=ee;break}}L.push([U(u)+(o+1),U(u)+(o+M.rowSpan)])}if(M.rowSpan>1||M.colSpan>1){delete M.value;delete M.rowSpan;delete M.colSpan}n+='<c r="'+U(u)+(o+1)+'"'+(O?' s="'+O+'"':"")+(d?' t="'+d+'"':"");if(w!=null){n+=">"+(M.formula?"<f>"+M.formula+"</f>":"")+"<v>"+w+"</v></c>"}else{n+="/>"}}n+="</row>"}R=[];for(o=0;o<Q.length;o++){if(Q[o].autoWidth){R.push('<col min="',o+1,'" max="',o+1,'" width="',Q[o].max,'" bestFit="1"/>')}}if(R.length>0){R=["<cols>"].concat(R,["</cols>"]).join("")}n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+'<dimension ref="A1:'+U(A[0].length-1)+A.length+'"/><sheetViews><sheetView '+(m===e.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+R+"<sheetData>"+n+"</sheetData>";if(L.length>0){n+='<mergeCells count="'+L.length+'">';for(o=0;o<L.length;o++){n+='<mergeCell ref="'+L[o].join(":")+'"/>'}n+="</mergeCells>"}n+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';if(I.table){n+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>'}N.file("sheet"+j+".xml",n+"</worksheet>");if(I.table){o=-1;c=A[0].length;d=U(A[0].length-1)+A.length;n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" id="'+j+'" name="Table'+j+'" displayName="Table'+j+'" ref="A1:'+d+'" totalsRowShown="0"><autoFilter ref="A1:'+d+'"/><tableColumns count="'+A[0].length+'">';while(++o<c){n+='<tableColumn id="'+(o+1)+'" name="'+(A[0][o].hasOwnProperty("value")?A[0][o].value:A[0][o])+'"/>'}n+='</tableColumns><tableStyleInfo name="TableStyleMedium2" showFirstColumn="0" showLastColumn="0" showRowStripes="1" showColumnStripes="0"/></table>';k.folder("tables").file("table"+j+".xml",n);N.folder("_rels").file("sheet"+j+".xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table'+j+'.xml"/></Relationships>');D[1].unshift('<Override PartName="/xl/tables/table'+j+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"/>')}D[0].unshift('<Override PartName="/xl/worksheets/sheet'+j+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>');E.unshift(Z(I.name)||"Sheet"+j);C.unshift('<Relationship Id="rId'+j+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+j+'.xml"/>');P.unshift('<sheet name="'+(Z(I.name)||"Sheet"+j)+'" sheetId="'+j+'" r:id="rId'+j+'"/>')}o=p.length;d=[];var re=0;while(--o){O=JSON.parse(p[o]);if(O.formatCode!=="General"){T=B.indexOf(O.formatCode);if(T<0){T=164+d.length;d.push('<numFmt formatCode="'+O.formatCode+'" numFmtId="'+T+'"/>')}O.formatCode=T}else{O.formatCode=0}g=0;if(O.borders){_=["<border>"];for(var te in{left:0,right:0,top:0,bottom:0,diagonal:0}){if(O.borders[te]){_.push("<",te,' style="thin">','<color rgb="',O.borders[te],'"/></',te,">")}else{_.push("<",te,"/>")}}_.push("</border>");_=_.join("");g=y.indexOf(_);if(g<0){g=y.push(_)-1}}F=0;if(O.bold||O.italic||O.fontSize||O.fontName||O.fontColor){x=["<font>"];if(O.bold){x.push("<b/>")}if(O.italic){x.push("<i/>")}x.push('<sz val="',O.fontSize||t,'"/>');x.push('<color rgb="FF',O.fontColor||a,'"/>');x.push('<name val="',O.fontName||r,'"/>');x.push('<family val="2"/>',"</font>");x=x.join("");F=b.indexOf(x);if(F<0){F=b.push(x)-1}}re=0;if(O.fill){$=$+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+O.fill+'"/>'+'<bgColor indexed="64"/></patternFill></fill>';W++;re=W}p[o]=['<xf xfId="0" borderId="',g,'" fontId="',F,'" numFmtId="',O.formatCode,'" fillId="',re,'" ',O.hAlign||O.vAlign?'applyAlignment="1" ':" ",O.formatCode>0?'applyNumberFormat="1" ':" ",g>0?'applyBorder="1" ':" ",F>0?'applyFont="1" ':" ",re>0?'applyFill="1" ':" ",">"];if(O.hAlign||O.vAlign){p[o].push("<alignment");if(O.hAlign){p[o].push(' horizontal="',O.hAlign,'"')}if(O.vAlign){p[o].push(' vertical="',O.vAlign,'"')}p[o].push("/>")}p[o].push("</xf>");p[o]=p[o].join("")}d=d.length?'<numFmts count="'+d.length+'">'+d.join("")+"</numFmts>":"";k.file("styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+d+'<fonts count="'+b.length+'" x14ac:knownFonts="1"><font><sz val="'+t+'"/><color theme="1"/><name val="'+r+'"/><family val="2"/>'+'<scheme val="minor"/></font>'+b.join("")+"</fonts>"+'<fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+$+"</fills>"+'<borders count="'+y.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+y.join("")+'</borders><cellStyleXfs count="1">'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+p.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+p.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0"/>'+'<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/>'+'<extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main">'+'<x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>');i.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+D[0].join("")+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>'+D[1].join("")+'<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>');S.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>XLSX.js</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+e.worksheets.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="'+E.length+'" baseType="lpstr"><vt:lpstr>'+E.join("</vt:lpstr><vt:lpstr>")+"</vt:lpstr></vt:vector></TitlesOfParts><Manager></Manager><Company>Microsoft Corporation</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>");k.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+C.join("")+'<Relationship Id="rId'+(C.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/>'+'<Relationship Id="rId'+(C.length+2)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>'+'<Relationship Id="rId'+(C.length+3)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/></Relationships>');k.file("sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+h[1]+'" uniqueCount="'+h[0].length+'"><si><t>'+h[0].join("</t></si><si><t>")+"</t></si></sst>");k.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView '+(e.activeWorksheet?'activeTab="'+e.activeWorksheet+'" ':"")+'xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"/></bookViews><sheets>'+P.join("")+'</sheets><calcPr calcId="145621"/></workbook>');l=Date.now()-l;f=Date.now();s={base64:i.generate({compression:"DEFLATE"}),zipTime:Date.now()-f,processTime:l,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}}return s}OAT.GeneratePDFOutput=function(e,r){var t=-1;var a=10;var s=13;var i=25;var f=-1;s+jQuery("#"+e.controlName+"_"+e.query+" tr").length*30+5;var l=0;var n=true;var o=0;while(n&&o<jQuery("#"+e.controlName+"_"+e.query+" tr").length){if(jQuery("#"+e.controlName+"_"+e.query+" tr")[o].getAttribute("title_row")!="true")n=false;else o++}var u=jQuery("#"+e.controlName+"_"+e.query+" tr")[o];if(u==undefined){u=jQuery("#"+e.controlName+"_"+e.query+" tr")[0]}for(var v=0;v<u.children.length;v++){if(u.children[v].getAttribute("colspan")!=null){l=l+parseInt(u.children[v].getAttribute("colspan"))}else{l=l+1}}l=a+l*(i+48)+5;if(l<595){l=595}var c=[];var d=[];for(var m=0;m<u.childNodes.length;m++){d[m]=0}for(var h=0;h<jQuery("#"+e.controlName+"_"+e.query+" tr").length;h++){var p=-1;t=-1;var T=0;if(e.colConditions.length==0){for(var A=0;A<d.length;A++){if(d[A]>0){T=1+T;d[A]=d[A]-1}}}else{for(var w=0;w<h;w++){var O=jQuery("#"+e.controlName+"_"+e.query+" tr")[w];for(var y=0;y<O.children.length;y++){var _=O.children[y].getAttribute("rowspan");if(_!=null&&parseInt(_)>h-w){var g=O.children[y].getAttribute("colspan");if(g===null){T=1+T}else{T=parseInt(g)+T}}}}}p=T-1;var u=jQuery("#"+e.controlName+"_"+e.query+" tr")[h];if(e.colConditions.length==0){for(var v=0;v<u.children.length;v++){var b=u.children[v].getAttribute("rowspan");if(b==null)b=0;d[T+v]=parseInt(b)-1}}for(var v=0;v<u.children.length;v++){p++;var x=OAT.removeIconFont(u.children[v].textContent.replace(/^\s+|\s+$/g,""));var F=u.children[v].getAttribute("hidden");if(F===null){var S=u.children[v].getAttribute("rowspan");var k=u.children[v].getAttribute("colspan");var N=p;if(c[N]==undefined){c[N]=i}if(S===null&&k===null||v===u.children.length-1&&k==="3"){if(k!=null&&x===""){p=parseInt(k)+p-1}}else if(k===null);else if(S===null){p=parseInt(k)+p-1}else{p=parseInt(k)+p-1}var I=0;var D=0;var E=0;while(E<x.length&&x.charCodeAt(E)<1e3){D++;E++}I=x.length-D;if(I==0){if(x.length>14&&(k==null||h==0||parseInt(k)<2)){if(x.length*1.98>c[N]){c[N]=x.length*1.98}}}else{var C=I*3.1+(x.length-I)*2;if(C>c[N]&&(k==null||h==0||parseInt(k)<2)){c[N]=C}}}t=p}}var P=0;for(var j=0;j<c.length;j++){P=P+c[j]*2.5+48}P=a+P+5;if(P>l){l=P}var Q=function(e,r){if(e>r.length){e=r.length}var t=0;for(var a=0;a<e;a++){t=t+r[a]}return t};var R;if(l<=595){R=new jsPDF("portrait","mm","a4",false,l,792)}else if(l>595&&l<792){R=new jsPDF("landscape","mm","a4",false,793,792)}else{R=new jsPDF("landscape","mm","a4",false,l,792)}R.setFontSize(8);var q=[];if(jQuery("#"+e.controlName+"_"+e.query+" tr")[1+e.colConditions.length]!=undefined){for(var M=0;M<jQuery("#"+e.controlName+"_"+e.query+" tr")[1+e.colConditions.length].children.length;M++){q[M]=0}}else{for(var M=0;M<jQuery("#"+e.controlName+"_"+e.query+" tr")[e.colConditions.length].children.length;M++){q[M]=0}}d=[];for(var m=0;m<c.length;m++){d[m]=0}for(var h=0;h<jQuery("#"+e.controlName+"_"+e.query+" tr").length;h++){var p=-1;t=-1;f++;var T=0;if(e.colConditions.length==0){for(var A=0;A<d.length;A++){if(d[A]>0){T=1+T;d[A]=d[A]-1}}}else{for(var w=0;w<h;w++){var O=jQuery("#"+e.controlName+"_"+e.query+" tr")[w];for(var y=0;y<O.children.length;y++){var _=O.children[y].getAttribute("rowspan");if(_!=null&&parseInt(_)>h-w){var g=O.children[y].getAttribute("colspan");if(g===null){T=1+T}else{T=parseInt(g)+T}}}}}p=T-1;var u=jQuery("#"+e.controlName+"_"+e.query+" tr")[h];if(e.colConditions.length==0){for(var v=0;v<u.children.length;v++){var b=u.children[v].getAttribute("rowspan");if(b==null)b=0;d[T+v]=parseInt(b)-1}}var L=-1;for(var v=0;v<u.children.length;v++){var x=OAT.removeIconFont(u.children[v].textContent.replace(/^\s+|\s+$/g,""));var F=u.children[v].getAttribute("hidden");var V=u.children[v].getAttribute("pivotcorrect");var B=false;R.setDrawColor(0,0,0);R.setTextColor(0,0,0);R.setFontStyle("normal");var J=!isNaN(parseFloat(x))||x=="-"&&(u.children[v].getAttribute("style")==undefined||u.children[v].getAttribute("style").indexOf("text-align: left")==-1);var U=0;U=R.getStringUnitWidth(x);if(u.children[v].getAttribute("style")!=undefined&&u.children[v].getAttribute("style")!=null){var z=u.children[v].getAttribute("style").split(";");for(var H=0;H<z.length;H++){var Z=z[H].split(":");if(Z[0].replace(/^\s+|\s+$/g,"")==="color"){var G=Z[1].replace(/^\s+|\s+$/g,"");G=G.substring(4,G.length);G=G.substring(0,G.length-1);R.setTextColor(parseInt(G.split(",")[0]),parseInt(G.split(",")[1]),parseInt(G.split(",")[2]))}else if(Z[0].replace(/^\s+|\s+$/g,"")==="text-align"){J=Z[1].replace(/^\s+|\s+$/g,"")=="right"}else if(Z[0].replace(/^\s+|\s+$/g,"")==="font-style"){R.setFontStyle("italic")}else if(Z[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(Z[1].replace(/^\s+|\s+$/g,"")==="bold"){R.setFontStyle("bold")}}else if(Z[0].replace(/^\s+|\s+$/g,"")==="background-color"){var G=Z[1].replace(/^\s+|\s+$/g,"");G=G.substring(4,G.length);G=G.substring(0,G.length-1);R.setFillColor(parseInt(G.split(",")[0]),parseInt(G.split(",")[1]),parseInt(G.split(",")[2]));B=true}else if(Z[0].replace(/^\s+|\s+$/g,"")==="border-color"){var G=Z[1].replace(/^\s+|\s+$/g,"");G=G.substring(4,G.length);G=G.substring(0,G.length-1);R.setDrawColor(parseInt(G.split(",")[0]),parseInt(G.split(",")[1]),parseInt(G.split(",")[2]))}}}var X=[];var Y="",$=-1;var W=0;if(x.charCodeAt(0)>1e3){for(var K=0;K<x.length;K++){if((W==58||W==65306)&&x.charCodeAt(K)==32){X[K]="ToDelete"}else{X[K]=OAT.getCharacterImg(x.charCodeAt(K));W=x.charCodeAt(K)}if(x.charCodeAt(K)<1e3){Y=Y+x[K];if($==-1)$=K}else{Y="";$=-1}}}else{var ee=-1;for(var m=1;m<x.length;m++){if(x.charCodeAt(m)>1e3){ee=m;break}}if(ee>0){var re=x.substring(0,ee);var te=0;for(var K=ee;K<x.length;K++){if(x.charCodeAt(K)<1e3){Y=Y+x[K];if($==-1)$=K-ee}else{Y="";$=-1}if((W==58||W==65306)&&x.charCodeAt(K)==32){X[te]="ToDelete"}else{X[te]=OAT.getCharacterImg(x.charCodeAt(K));W=x.charCodeAt(K)}te++}x=re}}try{if($!=-1&&!J){X=X.slice(0,$)}}catch(e){}while(X.length>0&&X.indexOf("ToDelete")!=-1){var ae=X.indexOf("ToDelete");X.splice(ae,1)}if(F===null&&!V){p++;var S=u.children[v].getAttribute("rowspan");var k=u.children[v].getAttribute("colspan");L=L+1;if(S&&f+parseInt(S)>26){var se=f+parseInt(S)-26;S=parseInt(S)-se;q[L+T]=se}var N=p;if(S===null&&k===null||v===u.children.length-1&&k==="3"&&e.colConditions.length==0){if(B){var ie=p;if(k!=null&&x===""){ie=parseInt(k)+p-1}R.rect(a-2+Q(N,c),s+f*10-7,Q(ie+1,c)-Q(N,c),10,"F")}var fe=0;if(x.charCodeAt(0)<1e3){fe=x.length*1.4+2;if(J){R.text(a+Q(p+1,c)-U*3-4,s+f*10,x)}else{R.text(a+Q(p,c),s+f*10,x)}}if(X.length>0){for(var K=0;K<X.length;K++){R.addImage(X[K],"JPEG",a+Q(p,c)+fe+K*2.5,s+f*10-2.3,2.5,2.5)}}if($!=-1&&!J){R.text(a+Q(p,c)+fe+X.length*2.5,s+f*10,Y)}if(k!=null&&x===""){p=parseInt(k)+p-1}R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(p+1,c),s+f*10-7);R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(N,c),s+f*10+3)}else if(k===null){if(B){if(S===null){R.rect(a-2+Q(p,c),s+f*10-7,i,10,"F")}else{R.rect(a-2+Q(p,c),s+f*10-7,i,10+(parseInt(S)-1)*10,"F")}}var fe=0;if(x.charCodeAt(0)<1e3){fe=x.length*1.4+2;R.text(a+Q(p,c),s+f*10,x)}if(X.length>0){for(var K=0;K<X.length;K++){R.addImage(X[K],"JPEG",a+Q(p,c)+fe+K*2.5,s+f*10-2.3,2.5,2.5)}}if($!=-1&&!J){R.text(a+Q(p,c)+fe+X.length*2.5,s+f*10,Y)}R.line(a-2+Q(p,c),s+f*10-7,a-2+Q(p+1,c),s+f*10-7);if(S===null){R.line(a-2+Q(p,c),s+f*10-7,a-2+Q(p,c),s+f*10+3)}else{R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(N,c),s+(f+parseInt(S)-1)*10+3)}}else if(S===null){if(B){var le=parseInt(k)+p-1;R.rect(a-2+Q(N,c),s+f*10-7,Q(le+1,c)-Q(N,c),10,"F")}var fe=0;if(x.charCodeAt(0)<1e3){fe=x.length*1.4+2;R.text(a+Q(p,c),s+f*10,x)}if(X.length>0){for(var K=0;K<X.length;K++){R.addImage(X[K],"JPEG",a+Q(p,c)+fe+K*2.5,s+f*10-2.3,2.5,2.5)}}if($!=-1&&!J){R.text(a+Q(p,c)+fe+X.length*2.5,s+f*10,Y)}p=parseInt(k)+p-1;R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(p+1,c),s+f*10-7);R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(N,c),s+f*10+3)}else{if(B){var le=parseInt(k)+p-1;if(S===null){R.rect(a-2+Q(N,c),s+f*10-7,Q(le+1,c)-Q(N,c),10,"F")}else{R.rect(a-2+Q(N,c),s+f*10-7,Q(le+1,c)-Q(N,c),(parseInt(S)-1)*10,"F")}}var fe=0;if(x.charCodeAt(0)<1e3){fe=x.length*1.4+2;R.text(a+Q(p,c),s+f*10,x)}if(X.length>0){for(var K=0;K<X.length;K++){R.addImage(X[K],"JPEG",a+Q(p,c)+fe+K*2.5,s+f*10-2.3,2.5,2.5)}}if($!=-1&&!J){R.text(a+Q(p,c)+fe+X.length*2.5,s+f*10,Y)}p=parseInt(k)+p-1;R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(p+1,c),s+f*10-7);if(S===null){R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(N,c),s+f*10+3)}else{R.line(a-2+Q(N,c),s+f*10-7,a-2+Q(N,c),s+(f+parseInt(S)-1)*10+3)}}}R.setFontSize(8);t=p;if(v===u.children.length-1){R.line(a-2+Q(p+1,c),s+f*10-7,a-2+Q(p+1,c),s+f*10+3)}}if(f>=25){R.setDrawColor(0,0,0);R.line(a-2,s+(f+1)*10-7,a-2+Q(t+1,c),s+(f+1)*10-7);f=0;R.addPage();for(var ne=0;ne<q.length;ne++){if(!isNaN(q[ne])){if(q[ne]>=25){q[ne]=q[ne]-25;R.line(a-2+Q(ne,c),s+1*10-7,a-2+Q(ne+1,c),s+1*10-7);R.line(a-2+Q(ne,c),s+1*10-7,a-2+Q(ne,c),s+(1+25-1)*10+3)}else{R.line(a-2+Q(ne,c),s+1*10-7,a-2+Q(ne+1,c),s+1*10-7);R.line(a-2+Q(ne,c),s+1*10-7,a-2+Q(ne,c),s+(1+q[ne]-1)*10+3);q[ne]=0}}}}}R.setDrawColor(0,0,0);R.line(a-2,s+(f+1)*10-7,a-2+Q(t+1,c),s+(f+1)*10-7);if(OAT.isSafari()||e.isSD){R.output("dataurlnewwindow")}else{R.save(r+".pdf")}};var removeComas=function(e,r){var t="";actPos=0;var a=r.defaultPicture.getAttribute("decimalSeparator");for(var s=0;s<e.length;s++){if(e[s]=="0"||e[s]=="1"||e[s]=="2"||e[s]=="3"||e[s]=="4"||e[s]=="5"||e[s]=="6"||e[s]=="7"||e[s]=="8"||e[s]=="9"||e[s]==a||e[s]=="-"){t=t+e[s]}}if(a!="."){var i="";for(var s=0;s<t.length;s++){if(t[s]==a){i=i+"."}else{i=i+t[s]}}t=i}return t};var cleanDistinctValue=function(e,r,t){if(e=="#NuN#"){return" "}else{var a=true;if(e.indexOf(">")>-1){e=e.replace(/\>/g,"&lt;");a=false}if(e.indexOf("<")>-1){e=e.replace(/\</g,"&gt;");a=false}if(e.indexOf("settings")>-1){e=e.replace("settings","");a=false}if(e.indexOf("%")>-1&&t!=undefined){return e.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\%/g,"%"+t).trimpivot()}else{e=e.replace(/"/g,"&quot;");if(a){e=e.replace(/\&/g,"&amp;")}if(e.indexOf("&amp;lt;")>-1){e=e.replace(/\&amp\;lt\;/g,"&lt;")}return e.trimpivot()}}};var headers=[];var getMeasureTitle=function(e,r){if(headers[r]!=undefined){return headers[r]}else{return e}};var createExcelROWITEMS=function(e,r,t,a,s){if(r===0){var i=t[a].indexOf(e.value);var f="";if(s===0){f="<i>"}else{f='<i r="'+s+'">'}if(i>0){return f+'<x v="'+i+'"/></i>'}else{return f+"<x/></i>"}}else{r--;var l="";for(var n=0;n<e.items.length;n++){l=l+createExcelROWITEMS(e.items[n],r,t,a,s)}return l}};var createExcelCOLITEMS=function(e,r,t,a,s){if(r===0){var i=t[a].indexOf(e.value.trimpivot());var f="";for(var l=0;l<measures.length;l++){if(s===0){f="<i>"}else{f='<i r="'+s+'">'}f=f+'<x v="'+i+'"/>';if(measures.length>1){f=f+"<x/>"}f=f+"</i>"}return f}else{r--;var n="";for(var o=0;o<e.items.length;o++){n=n+createExcelROWITEMS(e.items[o],r,t,a,s)}return n}};OAT.GenerateExcelOutput=function(e,r,t){function a(e){var r=e.toString(16);return r.length==1?"0"+r:r}function s(e,r,t){return a(e)+a(r)+a(t)}function i(e){var r={};for(var t=0;t<e.length;t++){var a=e[t].split(":");if(a[0].replace(/^\s+|\s+$/g,"")==="color"){var i=a[1].replace(/^\s+|\s+$/g,"");i=i.substring(4,i.length);i=i.substring(0,i.length-1);var f=s(parseInt(i.split(",")[0]),parseInt(i.split(",")[1]),parseInt(i.split(",")[2]));r.fontColor=f}else if(a[0].replace(/^\s+|\s+$/g,"")==="text-align"){var l=a[1].replace(/^\s+|\s+$/g,"");r.vAlign=l}else if(a[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(a[1].replace(/^\s+|\s+$/g,"")==="italic"){r.italic=1}}else if(a[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(a[1].replace(/^\s+|\s+$/g,"")==="bold"){r.bold=1}}else if(a[0].replace(/^\s+|\s+$/g,"")==="background-color"){var i=a[1].replace(/^\s+|\s+$/g,"");i=i.substring(4,i.length);i=i.substring(0,i.length-1);var f=s(parseInt(i.split(",")[0]),parseInt(i.split(",")[1]),parseInt(i.split(",")[2]));r.fill=f}}return r}var f=function(e,r){for(var t in e.formulaInfo.itemPosition){if(e.formulaInfo.itemPosition[t]==r){return t}}};headers=[];var l=[];for(var n=0;n<t.length;n++){for(var o=0;o<l.length;o++){if(l[o]==cleanDistinctValue(t[n].getAttribute("displayName"),r,t[n].getAttribute("name"))){headers[n]=cleanDistinctValue(t[n].getAttribute("displayName"),r,t[n].getAttribute("name"))+" ("+t[n].getAttribute("dataField")+")"}}l.push(cleanDistinctValue(t[n].getAttribute("displayName"),r,t[n].getAttribute("name")))}dataTable=[];dataRow=[];for(var u=0;u<r.columns.length;u++){var v={value:cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))};v.isString=1;dataRow.push(v)}for(var n=0;n<t.length;n++){if(!r.formulaInfo.measureFormula[n].hasFormula){var v={value:cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))};dataRow.push(v)}}var c=[];if(r.formulaInfo.cantFormulaMeasures>0){for(var d=0;d<r.formulaInfo.measureFormula.length;d++){if(r.formulaInfo.measureFormula[d].hasFormula){for(var m=0;m<r.formulaInfo.measureFormula[d].relatedMeasures.length;m++){var h=r.formulaInfo.measureFormula[d].relatedMeasures[m];if(c.indexOf(h)==-1){c.push(h)}}}}c.sort();for(var n=0;n<c.length;n++){var v={value:f(r,c[n])};dataRow.push(v)}}dataTable.push(dataRow);var p=r.GeneralDataRows;if(r.autoPaging){p=r.RowsWhenMoveToFilter}if(r.formulaInfo.cantFormulaMeasures>0){p=r.recordForFormula}var T=function(e,r){if(e.getAttribute("style")!=undefined){var t=e.getAttribute("style").split(";");for(var a=0;a<t.length;a++){var i=t[a].split(":");if(i[0].replace(/^\s+|\s+$/g,"")==="color"){var f=i[1].replace(/^\s+|\s+$/g,"");f=f.substring(4,f.length);f=f.substring(0,f.length-1);var l=s(parseInt(f.split(",")[0]),parseInt(f.split(",")[1]),parseInt(f.split(",")[2]));r.fontColor=l}else if(i[0].replace(/^\s+|\s+$/g,"")==="text-align"){var n=i[1].replace(/^\s+|\s+$/g,"");r.vAlign=n}else if(i[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(i[1].replace(/^\s+|\s+$/g,"")==="italic"){r.italic=1}}else if(i[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(i[1].replace(/^\s+|\s+$/g,"")==="bold"){r.bold=1}}else if(i[0].replace(/^\s+|\s+$/g,"")==="background-color"){var f=i[1].replace(/^\s+|\s+$/g,"");f=f.substring(4,f.length);f=f.substring(0,f.length-1);var l=s(parseInt(f.split(",")[0]),parseInt(f.split(",")[1]),parseInt(f.split(",")[2]));r.fill=l}}}return r};for(var A=0;A<p.length;A++){dataRow=[];for(var u=0;u<r.columns.length;u++){var o=r.conditions[u].dataRowPosition;var w=p[A][o];if(w=="#NuN#"){w=" "}var v={value:w};v.isString=1;var O=OAT.Dom.create("th",{},"");O=r.applyFormatValues(O,p[A][o],o);v=T(O,v);v.formatCode=r.defaultPicture.getAttribute("dateFormat");v.genexusType=r.columns[u].getAttribute("dataType");v.genexusPicture=r.columns[u].getAttribute("picture");dataRow.push(v)}for(var n=0;n<t.length;n++){if(!r.formulaInfo.measureFormula[n].hasFormula){var o=r.columns.length+n;var w=p[A][o];w=r.defaultPictureValue(w,n==t.length-1,n);w=removeComas(w,r);var v={value:w};var y=OAT.Dom.create("td",{},"");y=r.applyConditionalFormats(y,p[A][o],n===t.length-1?true:false,n);v=T(y,v);v.formatCode=r.defaultPicture.getAttribute("dateFormat");v.genexusType=t[n].getAttribute("dataType");v.genexusPicture=t[n].getAttribute("picture");dataRow.push(v)}}for(var _=0;_<c.length;_++){dataRow.push({value:p[A][c[_]]})}dataTable.push(dataRow)}var g=[];var b=[];var x=1;for(var u=0;u<r.columns.length;u++){b[u]=0;var O=OAT.Dom.create("th",{},"");var o=r.conditions[u].dataRowPosition;O=r.applyFormatValues(O,p[0][o],o);if(O.getAttribute("style")!=undefined){var F=O.getAttribute("style").split(";");var S=i(F);if(S.fontColor!=undefined||S.italic!=undefined||S.bold!=undefined){b[u]=x;x++;g.push(S)}}}var k=[];for(var N=0;N<t.length;N++){k[N]=0;var y=OAT.Dom.create("td",{},"");var o=r.columns.length+N;y=r.applyConditionalFormats(y,p[0][o],N===t.length-1?true:false,N);if(y.getAttribute("style")!=undefined){var F=y.getAttribute("style").split(";");var S=i(F);if(S.fontColor!=undefined||S.italic!=undefined||S.bold!=undefined){k[N]=x;x++;g.push(S)}}}var I='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+'<pivotCacheDefinition r:id="rId1" refreshOnLoad="1" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n'+'<cacheSource type="worksheet">\n';var D=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD"];var E=g.length>0;var C=D[t.length+r.columns.length-1]+(p.length+1+2);var P=r.colConditions.length+2;var j=r.colConditions.length>0?r.colConditions.length:1;var Q=" ";var p=r.GeneralDataRows;if(r.autoPaging){p=r.RowsWhenMoveToFilter}var R;if(r.columns.length<0){var q='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+"Value"+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" rowHeaderCaption="Make" '+Q+'xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">'+'<location ref="A1:'+C+'" firstHeaderRow="1" firstDataRow="'+P+'" firstDataCol="'+j+'"/>'+"<pivotFields>";var M=[];var L=[];var V=[];var B=-1;var J=0;var U=-1;var z=0;for(var n=0;n<r.columns.length;n++){var H="axisRow";if(r.rowConditions.findIndex(n)!=-1){H="axisRow";B++;J=n}else if(r.colConditions.findIndex(n)!=-1){H="axisCol";U++;z=n}else{H="axisRow";B++;J=n}var Z="";var G='<item t="default"/>';q=q+'<pivotField axis="'+H+'" showAll="0" '+Z+">"+"<items>";var X;var Y;if(r.conditions[n].distinctValues!=undefined){X=[];Y=[];for(var $=0;$<r.conditions[n].distinctValues.length;$++){X.push(cleanDistinctValue(r.conditions[n].distinctValues[$]));var W="";if(r.conditions[n].blackList.findIndex(r.conditions[n].distinctValues[$])!=-1){W=' h="1"';Y.push(cleanDistinctValue(r.conditions[n].distinctValues[$]))}q=q+'<item x="'+$+'" '+W+" />"}q=q+G+"</items>"+"</pivotField>"}L[n]=X;V[n]=Y[n];M.push(n)}for(var n=0;n<t.length;n++){q=q+'<pivotField dataField="1" showAll="0"/>';M.push(cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")))}q=q+"</pivotFields>";q=q+"<rowFields>";for(var n=0;n<r.columns.length;n++){if(r.rowConditions.findIndex(n)!=-1||r.filterIndexes.findIndex(n)!=-1){q=q+'<field x="'+0+'"/>'}}q=q+"</rowFields>";q=q+"<rowItems>";for(var K=0;K<r.rowStructure.items.length;K++){q=q+createExcelROWITEMS(r.rowStructure.items[K],B,L,J,B)}q=q+'<i t="grand"><x/></i>'+"</rowItems>";if(U>-1||t.length>1){q=q+"<colFields>";for(var n=0;n<r.columns.length;n++){if(r.colConditions.findIndex(n)!=-1){var o=M.indexOf(n);q=q+'<field x="'+o+'"/>'}}if(t.length>1){q=q+'<field x="-2"/>'}q=q+"</colFields>"}q=q+"<colItems>";if(r.colStructure.items){for(var K=0;K<r.colStructure.items.length;K++){q=q+createExcelCOLITEMS(r.colStructure.items[K],U,L,z,U)}}else{for(var n=0;n<t.length;n++){q=q+"<i/>"}}q=q+"</colItems>";q=q+"<dataFields>";for(var n=0;n<t.length;n++){q=q+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))+'" fld="'+(n+r.columns.length)+'"/>'}q=q+"</dataFields>";if(E){q=q+"<formats>";for(var n=0;n<r.columns.length;n++){if(b[n]>0){q=q+'<format dxfId="'+b[n]+'">'+'<pivotArea dataOnly="0" labelOnly="1" fieldPosition="0">'+'<references ><reference field="0">';if(r.conditions[n].distinctValues!=undefined){for(var $=0;$<r.conditions[n].distinctValues.length;$++){q=q+'<x v="'+$+'"/>'}}q=q+"</reference></references>"+"</pivotArea>"+"</format>"}}for(var K=0;K<t.length;K++){if(k[K]>0){q=q+'<format dxfId="'+k[K]+'">';q=q+'<pivotArea  fieldPosition="0">';q=q+"<references>";q=q+'<reference field="4294967294" selected="0">';q=q+'<x v="'+K+'"/></reference>';q=q+'<reference field="0">';for(var ee=0;ee<r.rowStructure.items.length;ee++){q=q+'<x v="'+ee+'"/>'}q=q+"</reference>";q=q+"</references></pivotArea>";q=q+"</format>"}}q=q+"</formats>"}q=q+'<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/>'+"</pivotTableDefinition>";var re='<dxf><font><color rgb="FFCCCCCC" /></font></dxf>';if(E){for(var te=0;te<g.length;te++){re=re+"<dxf><font>";if(g[te].bold!=undefined){re=re+"<b/>"}if(g[te].italic!=undefined){re=re+"<i/>"}if(g[te].fontColor!=undefined){re=re+'<color rgb="FF'+g[te].fontColor+'"/>'}re=re+"</font></dxf>"}}var ae=re;for(var A=0;A<p.length;A++){for(var u=0;u<r.columns.length;u++){L[u].indexOf(p[A][u])}for(var n=0;n<t.length;n++){var o=r.columns.length+n;var w=r.defaultPictureValue(p[A][o],n==t.length-1,n);w=removeComas(w,r);w=cleanDistinctValue(w)}}I=I+'<worksheetSource ref="A1:'+D[r.columns.length+t.length-1]+(p.length+1)+'" sheet="SourceData"/>';I=I+"</cacheSource>";I=I+'<cacheFields count="'+(r.columns.length+t.length)+'">';for(var u=0;u<r.columns.length;u++){I=I+'<cacheField name="'+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+'" numFmtId="0">';I=I+'<sharedItems count="'+r.conditions[u].distinctValues.length+'">';for(var $=0;$<r.conditions[u].distinctValues.length;$++){I=I+'<s v="'+cleanDistinctValue(r.conditions[u].distinctValues[$])+'"/>'}I=I+"</sharedItems>";I=I+"</cacheField>"}for(var n=0;n<t.length;n++){I=I+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))+'" numFmtId="0">';I=I+"<sharedItems/>";I=I+"</cacheField>"}I=I+"</cacheFields>";I=I+"</pivotCacheDefinition>";var se='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<dimension ref="A1:'+D[r.columns.length+t.length-1]+(p.length+1)+'"/>'+"<sheetViews>"+'<sheetView workbookViewId="0"/>'+"</sheetViews>"+"<sheetData>";var ie=1;var fe=0;se=se+'<row r="'+ie+'" span="1:3">';for(var u=0;u<r.columns.length;u++){se=se+'<c t="inlineStr" r="'+D[fe]+ie+'">';se=se+"<is><t>"+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))+"</t></is>";se=se+"</c>";fe++}for(var n=0;n<t.length;n++){se=se+'<c t="inlineStr" r="'+D[fe]+ie+'">';se=se+"<is><t>"+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))+"</t></is>";se=se+"</c>";fe++}se=se+"</row>";for(var A=0;A<p.length;A++){fe=0;ie++;se=se+'<row r="'+ie+'" span="1:3">';for(var u=0;u<r.columns.length;u++){var o=r.conditions[u].dataRowPosition;var w=cleanDistinctValue(p[A][o]);se=se+'<c t="inlineStr" r="'+D[fe]+ie+'">';se=se+"<is><t>"+w+"</t></is>";se=se+"</c>";fe++}for(var n=0;n<t.length;n++){o=r.columns.length+n;var w=r.defaultPictureValue(p[A][o],n==t.length-1,n);w=removeComas(w,r);w=cleanDistinctValue(w);if(t[n].getAttribute("dataType")==="real"||t[n].getAttribute("dataType")==="integer"){se=se+'<c r="'+D[fe]+ie+'">';se=se+"<v>"+w+"</v>";se=se+"</c>"}else{se=se+'<c t="inlineStr" r="'+D[fe]+ie+'">';se=se+"<is><t>"+w+"</t></is>";se=se+"</c>"}fe++}se=se+"</row>"}se=se+"</sheetData>";se=se+"</worksheet>";R=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:I,pivotTable1:q,Sheet2:se,style:re,dfx:ae,worksheets:[{data:dataTable,name:"Sheet 1"}]})}else{var P=r.colConditions.length+1;var j=r.colConditions.length>0?r.colConditions.length:1;if(r.filterIndexes.length>0&&r.rowConditions.length+1==t.length){j=0}if(r.rowConditions.length+r.filterIndexes.length==0){P=1;j=1}var le="1";var ne="";if(r.filterIndexes.length>0){P=P+r.filterIndexes.length;ne=' rowPageCount="'+r.filterIndexes.length+'\'" colPageCount="1" ';le=P+1}var oe="";if(r.rowConditions.length>0){var ue=r.rowConditions[0];if(r.columns.length>ue){oe=' rowHeaderCaption="'+cleanDistinctValue(r.columns[ue].getAttribute("displayName"),r,r.columns[ue].getAttribute("name"))+'" '}}if(r.colConditions.length>0){var ve=r.colConditions[0];if(r.columns.length>ve){oe=oe+' colHeaderCaption="'+cleanDistinctValue(r.columns[ve].getAttribute("displayName"),r,r.columns[ve].getAttribute("name"))+'" '}}var q='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+'<pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+"Value"+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" '+oe+" "+Q+' xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">\n'+"<location "+'ref="A'+le+'"'+' firstHeaderRow="1" firstDataRow="'+P+'" firstDataCol="'+j+'" '+ne+"/>\n"+"<pivotFields>\n";var M=[];var L=[];var V=[];var ce="";if(r.formulaInfo.cantFormulaMeasures==0){for(var n=0;n<t.length;n++){var de=163;if(t[n].getAttribute("picture")!=""){de=164+n}if(r.rowConditions.length>0||r.colConditions.length==0){q=q+'<pivotField dataField="1" showAll="0"  numFmtId="'+de+'"/>\n'}else{ce=ce+'<pivotField dataField="1" showAll="0"  numFmtId="'+de+'"/>\n'}M.push(cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")))}}var B=-1;var J=0;var U=-1;var z=0;for(var me=0;me<r.filterIndexes.length;me++){var n=r.filterIndexes[me];H="axisPage";var Z='numFmtId="163"';var G='<item t="default"/>\n';q=q+'<pivotField axis="'+H+'" showAll="0" '+Z+" >\n"+"<items>\n";var X;var Y;if(r.conditions[n].distinctValues!=undefined){X=[];Y=[];var he=r.conditions[n].distinctValues;var o=0;for(var $=0;$<he.length;$++){if(!(he[$]==""&&he.findIndex("#NuN#")!=-1)){X.push(cleanDistinctValue(he[$]));var W="";if(r.conditions[n].blackList.findIndex(he[$])!=-1){W=' h="1"';Y.push(cleanDistinctValue(he[$]))}q=q+'<item x="'+o+'" '+W+" />\n";o=o+1}}q=q+G+"</items>\n"+"</pivotField>\n"}L[n]=X;V[n]=Y[n];M.push(n)}for(var n=0;n<r.columns.length;n++){if(r.filterIndexes.indexOf(n)==-1){var H="axisRow";if(r.rowConditions.length>0&&r.rowConditions.indexOf(n)!=-1||r.rowConditions.length+r.filterIndexes.length+r.colConditions.length==0){H="axisRow";B++;J=n}else if(r.colConditions.indexOf(n)!=-1){H="axisCol";U++;z=n}else{H="axisPage"}var Z='numFmtId="163"';var G='<item t="default"/>\n';q=q+'<pivotField axis="'+H+'" showAll="0" '+Z+" >\n"+"<items>\n";var X;var Y;if(r.conditions[n].distinctValues!=undefined){X=[];Y=[];var he=r.conditions[n].distinctValues;var o=0;for(var $=0;$<he.length;$++){if(!(he[$]==""&&he.findIndex("#NuN#")!=-1)){X.push(cleanDistinctValue(he[$]));var W="";if(r.conditions[n].blackList.findIndex(he[$])!=-1){W=' h="1"';Y.push(cleanDistinctValue(he[$]))}q=q+'<item x="'+o+'" '+W+" />";o=o+1}}q=q+G+"</items>\n"+"</pivotField>\n"}L[n]=X;V[n]=Y[n];M.push(n)}}if(r.formulaInfo.cantFormulaMeasures>0){for(var n=0;n<t.length;n++){var de=163;if(t[n].getAttribute("picture")!=""){de=164+n}if(!r.formulaInfo.measureFormula[n].hasFormula){q=q+'<pivotField dataField="1" showAll="0"  numFmtId="'+de+'"/>\n';M.push(cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")))}}for(var n=0;n<c.length;n++){q=q+'<pivotField showAll="0" defaultSubtotal="0"/>\n'}for(var n=0;n<t.length;n++){if(r.formulaInfo.measureFormula[n].hasFormula){q=q+'<pivotField dataField="1" dragToRow="0" dragToCol="0" dragToPage="0" showAll="0" defaultSubtotal="0" numFmtId="'+de+'"/>\n'}}}if(r.rowConditions.length==0&&r.colConditions.length>0){q=q+ce}q=q+"</pivotFields>\n";if(r.rowConditions.length+1!=t.length){q=q+"<rowFields>\n";for(var n=0;n<r.columns.length;n++){if(r.rowConditions.findIndex(n)!=-1||r.rowConditions.length+r.filterIndexes.length==0){var o=M.indexOf(n);q=q+'<field x="'+o+'"/>\n'}}q=q+"</rowFields>\n"}q=q+"<rowItems>\n";for(var K=0;K<r.rowStructure.items.length;K++){q=q+createExcelROWITEMS(r.rowStructure.items[K],B,L,J,B)}if(r.rowConditions.length==0&&r.colConditions.length>0){q=q+"<i/>\n"+"</rowItems>\n"}else{q=q+'<i t="grand"><x/></i>\n'+"</rowItems>\n"}if(U>-1||t.length>1){q=q+"<colFields>\n";for(var n=0;n<r.columns.length;n++){if(r.colConditions.findIndex(n)!=-1&&r.rowConditions.length+r.filterIndexes.length!=0){var o=M.indexOf(n);q=q+'<field x="'+o+'"/>\n'}else{if(r.colConditions.findIndex(n)!=-1&&r.rowConditions.length+r.filterIndexes.length==0){var o=M.indexOf(n);if(r.rowConditions.length==0)o=M.indexOf(n)-t.length;q=q+'<field x="'+o+'"/>\n'}}}if(t.length>1){q=q+'<field x="-2"/>\n'}q=q+"</colFields>\n"}q=q+"<colItems>\n";if(r.colStructure.items){for(var K=0;K<r.colStructure.items.length;K++){q=q+createExcelCOLITEMS(r.colStructure.items[K],U,L,z,U)}if(r.rowConditions.length==0){q=q+'<i t="grand"><x/></i>'}}else{for(var n=0;n<t.length;n++){q=q+"<i/>\n"}}q=q+"</colItems>\n";if(r.filterIndexes.length>0){q=q+"<pageFields>\n";for(var pe=0;pe<r.filterIndexes.length;pe++){q=q+'<pageField fld="'+(t.length+pe)+'" hier="-1"/>\n'}q=q+"</pageFields>\n"}q=q+"<dataFields>\n";var Te=0;var Ae=0;for(var n=0;n<t.length;n++){var de=163;if(t[n].getAttribute("picture")!=""){de=164+n}if(!r.formulaInfo.measureFormula[n].hasFormula){var we=0;if(r.formulaInfo.cantFormulaMeasures>0)we=r.columns.length-Te;var Oe="";var ye=t[n].getAttribute("aggregation")=="count"?"sum":t[n].getAttribute("aggregation");if(t[n].getAttribute("displayName").indexOf("%")>-1){for(var _e=0;_e<n;_e++){Oe=Oe+" "}q=q+'<dataField name="'+t[n].getAttribute("displayName")+Oe+'" fld="'+(n+we)+'" subtotal="'+ye+'" numFmtId="'+de+'"/>\n'}else{if(r.rowConditions.length>0){q=q+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+'" fld="'+(n+we)+'" subtotal="'+ye+'" numFmtId="'+de+'"/>\n'}else{q=q+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+'" fld="'+(n+we+r.colConditions.length)+'" numFmtId="'+de+'"/>\n'}}}else{Te++;var de=163;if(t[n].getAttribute("picture")!=""){de=164+n}if(r.formulaInfo.measureFormula[n].hasFormula){if(t[n].getAttribute("displayName").indexOf("%")>-1){for(var _e=0;_e<n;_e++){Oe=Oe+" "}q=q+'<dataField name="'+t[n].getAttribute("displayName").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+Oe+' " fld="'+(n+r.columns.length+c.length)+'" numFmtId="'+de+'" baseField="0" baseItem="0"/>\n'}else{var ge=0;var be=0;for(var _e=0;_e<r.formulaInfo.measureFormula.length;_e++){if(r.formulaInfo.measureFormula[_e].hasFormula){ge=ge+r.formulaInfo.measureFormula[_e].relatedMeasures.length}else{be++}}var xe=ge+be+r.columns.length+Ae;var Fe=xe;q=q+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))+' " fld="'+Fe+'" numFmtId="'+de+'" baseField="0" baseItem="0"/>\n';Ae++}}}}q=q+"</dataFields>\n"+'<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/>\n'+"</pivotTableDefinition>\n";for(var A=0;A<p.length;A++){for(var u=0;u<r.columns.length;u++){L[u].indexOf(cleanDistinctValue(p[A][u]))}for(var n=0;n<t.length;n++){var o=r.columns.length+n;var w=r.defaultPictureValue(p[A][o],n==t.length-1,n);w=removeComas(w,r);w=cleanDistinctValue(w)}}I=I+'<worksheetSource ref="A1:'+D[r.columns.length+t.length-1-r.formulaInfo.cantFormulaMeasures+c.length]+(p.length+1)+'" sheet="SourceData"/>\n';I=I+"</cacheSource>\n";I=I+'<cacheFields count="'+(r.columns.length+t.length+c.length)+'">\n';if(r.formulaInfo.cantFormulaMeasures==0&&(r.rowConditions.length>0||r.colConditions.length==0)){for(var n=0;n<t.length;n++){I=I+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")).replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("settings","")+'" numFmtId="0">\n';I=I+"<sharedItems/>\n";I=I+"</cacheField>\n"}}for(var me=0;me<r.filterIndexes.length;me++){var u=r.filterIndexes[me];var Se="";for(var $=0;$<r.GeneralDistinctValues[u].length;$++){if(!isNaN(r.GeneralDistinctValues[u][$])){Se=' containsMixedTypes="1" containsString="1" containsNumber="1" containsInteger="1" ';break}}if(Se!=""){var ke=true;for(var $=0;$<r.GeneralDistinctValues[u].length;$++){if(isNaN(r.GeneralDistinctValues[u][$])){ke=false;break}}if(ke){Se=' containsSemiMixedTypes="0" containsString="0" containsNumber="1" containsInteger="1" '}}I=I+'<cacheField name="'+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))+'" numFmtId="0">\n';I=I+"<sharedItems "+Se+' count="'+r.GeneralDistinctValues[u].length+'">\n';for(var $=0;$<r.GeneralDistinctValues[u].length;$++){if(!isNaN(r.GeneralDistinctValues[u][$])){I=I+'<n v="'+cleanDistinctValue(r.GeneralDistinctValues[u][$])+'"/>\n'}else{I=I+'<s v="'+cleanDistinctValue(r.GeneralDistinctValues[u][$])+'"/>\n'}}I=I+"</sharedItems>\n";I=I+"</cacheField>\n"}for(var u=0;u<r.columns.length;u++){if(r.filterIndexes.indexOf(u)==-1){I=I+'<cacheField name="'+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))+'" numFmtId="0">\n';I=I+'<sharedItems count="'+r.conditions[u].distinctValues.length+'">\n';for(var $=0;$<r.conditions[u].distinctValues.length;$++){I=I+'<s v="'+cleanDistinctValue(r.conditions[u].distinctValues[$])+'"/>\n'}I=I+"</sharedItems>\n";I=I+"</cacheField>\n"}}if(r.formulaInfo.cantFormulaMeasures>0){for(var n=0;n<t.length;n++){if(!r.formulaInfo.measureFormula[n].hasFormula){I=I+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))+'" numFmtId="165">\n';I=I+"<sharedItems/>\n";I=I+"</cacheField>\n"}}for(var n=0;n<c.length;n++){I=I+'<cacheField name="'+f(r,c[n])+'" numFmtId="0">\n'+"</cacheField>\n"}for(var n=0;n<t.length;n++){if(r.formulaInfo.measureFormula[n].hasFormula){I=I+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name"))+'" numFmtId="165" formula="'+r.formulaInfo.measureFormula[n].textFormula+'" databaseField="0"/>\n'}}}if(r.formulaInfo.cantFormulaMeasures==0&&(r.rowConditions.length==0&&r.colConditions.length>0)){for(var n=0;n<t.length;n++){I=I+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[n].getAttribute("displayName"),n),r,t[n].getAttribute("name")).replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("settings","")+'" numFmtId="164">\n';I=I+"<sharedItems/>\n";I=I+"</cacheField>\n"}}I=I+"</cacheFields>\n";I=I+"</pivotCacheDefinition>\n";var re="<numFmts>";var Ne=false;for(var Ie=0;Ie<t.length;Ie++){if(t[Ie].getAttribute("picture")!=""){var De=t[Ie].getAttribute("picture");var de=164+Ie;var Ee="";for(var Ce=0;Ce<De.length;Ce++){if(De[Ce]=="Z"){Ee=Ee+"#"}else if(De[Ce]=="9"){Ee=Ee+"0"}else if(De[Ce]=="."||De[Ce]==","){Ee=Ee+De[Ce]}else{Ee=Ee+"\\"+De[Ce]}}re=re+'<numFmt formatCode="'+Ee+'" numFmtId="'+de+'"/>';Ne=true}}if(Ne){re=re+"</numFmts>"}else{re=""}R=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:I,pivotTable1:q,Sheet2:"",style:re,worksheets:[{data:dataTable,name:"Sheet 1"}]})}if(OAT.isSafari()||r.isSD){window.location=R.href()}else{var Pe=atob(R.base64);function qe(e){return e.charCodeAt(0)}var je=Array.prototype.map.call(Pe,qe);var Qe=new Uint8Array(je);var Re=new Blob([Qe],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(Re,e+".xlsx")}};OAT.Dialog=function(e,r,t){var a=this,s={width:0,height:0,modal:0,onshow:function(){},onhide:function(){},zIndex:1e3,buttons:1,resize:1,close:1,autoEnter:1,imagePath:OAT.Preferences.imagePath};if(t)for(var i in t)s[i]=t[i];var f=new OAT.Window({close:s.close,max:0,min:0,width:s.width,height:s.height,x:0,y:0,title:e,resize:s.resize,imagePath:s.imagePath});OAT.Dom.hide(f.div);try{OAT.$(r).style.margin="10px"}catch(e){}e=OAT.Dom.create("table",{marginTop:"1em",width:"90%",textAlign:"center"});t=OAT.Dom.create("tbody");i=OAT.Dom.create("tr");var l=OAT.Dom.create("td",{border:"none"}),n=OAT.Dom.create("input");n.setAttribute("type","button");n.value=" OK ";l.appendChild(n);var o=OAT.Dom.create("input",{marginLeft:"2em"});o.setAttribute("type","button");o.value="Cancel";l.appendChild(o);i.appendChild(l);t.appendChild(i);e.appendChild(t);s.buttons&&OAT.$(r).appendChild(e);document.body.appendChild(f.div);f.content.appendChild(OAT.$(r));f.div.style.zIndex=s.zIndex;s.modal?(this.show=function(){OAT.Dimmer.show(f.div,{});f.accomodate();OAT.Dom.center(f.div,1,1);s.onshow()},this.hide=function(){OAT.Dimmer.hide();s.onhide()}):(this.show=function(){OAT.Dom.show(f.div);f.accomodate();OAT.Dom.center(f.div,1,1);s.onshow()},this.hide=function(){OAT.Dom.hide(f.div);s.onhide()});f.onclose=this.hide;this.accomodate=f.accomodate;this.ok=function(){};this.cancel=function(){};this.okBtn=n;this.cancelBtn=o;OAT.Dom.attach(n,"click",(function(){a.ok()}));OAT.Dom.attach(o,"click",(function(){a.cancel()}));r=function(e){if(a.okBtn.getAttribute("disabled")!="disabled"){e.keyCode==13&&a.ok();e.keyCode==27&&a.cancel()}};s.autoEnter&&OAT.Dom.attach(f.div,"keypress",r)};try{OAT.Loader.featureLoaded("dialog")}catch(e){}OAT.Drag={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,elm:!1,mouse_x:0,mouse_y:0,move:function(e){function r(e,r){return Math.abs(e-r)<=u}if(OAT.Drag.elm){OAT.Dom.removeSelection();var t=OAT.Dom.getViewport(),a=OAT.Dom.position(OAT.Drag.elm);OAT.Dom.eventPos(e);OAT.Dom.getWH(OAT.Drag.elm);if(!(e.clientX>t[0]||0>e.clientX||e.clientY>t[1]||0>e.clientY)){for(var t=e.clientX-OAT.Drag.mouse_x,s=e.clientY-OAT.Drag.mouse_y,i=!0,f=OAT.Drag.elm._Drag_movers,l=0;l<f.length;l++){var a=f[l][0],n=f[l][1],a=OAT.Dom.getLT(a);n.restrictionFunction(a[0]+t,a[1]+s)&&(i=!1)}for(var o=!0,u=10,l=0;l<f.length;l++){for(var a=f[l][0],n=f[l][1],v=OAT.Dom.getWH(a),c=OAT.Dom.position(a),d=c[0]+t,c=c[1]+s,m=0;m<n.magnetsH.length;m++){var h=OAT.$(n.magnetsH[m]),p=OAT.Dom.position(h),h=OAT.Dom.getWH(h);if(r(d,p[0])){a.style.left=p[0]+"px";o=!1;break}if(r(d+v[0],p[0])){a.style.left=p[0]-v[0]+"px";o=!1;break}if(r(d,p[0]+h[0])){a.style.left=p[0]+h[0]+"px";o=!1;break}if(r(d+v[0],p[0]+h[0])){a.style.left=p[0]+h[0]-v[0]+"px";o=!1;break}}for(m=0;m<n.magnetsV.length;m++){h=OAT.$(n.magnetsV[m]);p=OAT.Dom.position(h);h=OAT.Dom.getWH(h);if(r(c,p[1])){a.style.top=p[1]+"px";o=!1;break}if(r(c+v[1],p[1])){a.style.top=p[1]-v[1]+"px";o=!1;break}if(r(c,p[1]+h[1])){a.style.top=p[1]+h[1]+"px";o=!1;break}if(r(c+v[1],p[1]+h[1])){a.style.top=p[1]+h[1]-v[1]+"px";o=!1;break}}}if(i&&o){for(l=0;l<f.length;l++)if(a=f[l][0],n=f[l][1],n.moveFunction)n.moveFunction(t,s);else switch(n.type){case OAT.Drag.TYPE_X:OAT.Dom.moveBy(a,t,0);break;case OAT.Drag.TYPE_Y:OAT.Dom.moveBy(a,0,s);break;case OAT.Drag.TYPE_XY:OAT.Dom.moveBy(a,t,s)}OAT.Drag.mouse_x=e.clientX;OAT.Drag.mouse_y=e.clientY}}}},up:function(){if(OAT.Drag.elm){for(var e=OAT.Drag.elm._Drag_movers,r=0;r<e.length;r++)e[r][1].endFunction(e[r][0]);OAT.Drag.elm=!1}},create:function(e,r,t){var a={type:OAT.Drag.TYPE_XY,restrictionFunction:function(){return!1},endFunction:function(){},moveFunction:!1,magnetsH:[],magnetsV:[],cursor:!0};if(t)for(p in t)a[p]=t[p];var s=OAT.$(e),e=OAT.$(r),r=function(e){OAT.Drag.initiate(e,s)};s._Drag_movers||(OAT.Dom.attach(s,"mousedown",r),s._Drag_movers=[],s._Drag_cursor=s.style.cursor);a.cursor&&(s.style.cursor="move");s._Drag_movers.push([e,a])},initiate:function(e,r){OAT.Drag.elm=r;OAT.Drag.mouse_x=e.clientX;OAT.Drag.mouse_y=e.clientY},remove:function(e,r){var t=OAT.$(e);OAT.$(r);if(t._Drag_movers){for(var a=-1,s=0;s<t._Drag_movers.length;s++)t._Drag_movers[s][0]==r&&(a=s);-1!=a&&t._Drag_movers.splice(a,1)}},removeAll:function(e){e=OAT.$(e);e._Drag_movers&&(e._Drag_movers=[],e.style.cursor=e._Drag_cursor)},createDefault:function(e,r){if(OAT.Preferences.allowDefaultDrag){var t=OAT.$(e),a=OAT.Dom.create("div",{position:"absolute",width:"21px",height:"21px"}),s=OAT.Dom.getLT(t);a.style.left=s[0]-21+"px";a.style.top=s[1]-21+"px";if(r){t.parentNode.appendChild(a);s=function(e,r){var a=OAT.Dom.getWH(t),s=OAT.Dom.getWH(t.parentNode),i=e+a[0],a=r+a[1];return 20>e||20>r||i>s[0]||a>s[1]};OAT.Drag.create(a,a);OAT.Drag.create(a,t,{restrictionFunction:s});OAT.Dom.hide(a);var i=function(){a._Drag_pending&&OAT.Dom.hide(a)};OAT.Dom.attach(t,"mouseover",(function(){OAT.Dom.show(a);a._Drag_pending=0}));OAT.Dom.attach(t,"mouseout",(function(){a._Drag_pending=1;setTimeout(i,3e3)}))}else s=function(e,r){var a=OAT.Dom.getWH(t),s=OAT.Dom.getWH(t.parentNode),i=e+a[0],a=r+a[1];return 0>e||0>r||i>s[0]||a>s[1]},OAT.Drag.create(t,t,{restrictionFunction:s})}}};if(typeof document!="undefined"){OAT.Dom.attach(document,"mousemove",OAT.Drag.move);OAT.Dom.attach(document,"mouseup",OAT.Drag.up)}try{OAT.Loader.featureLoaded("drag")}catch(e){}OAT.GhostDragData={lock:!1,up:function(e){if(OAT.GhostDragData.lock){var r=OAT.GhostDragData.lock,t=r.object;if(t.pending)t.pending=0,OAT.GhostDragData.lock=!1;else{OAT.GhostDragData.lock=!1;for(var a=OAT.Dom.eventPos(e),e=a[0],a=a[1],s=0,i=0;i<t.targets.length;i++){var f=t.targets[i],l=f[1]?f[1](e,a):OAT.GhostDragData.pos(f[0],e,a);!s&&l&&(s=1,t.callback(f[0],e,a))}s?(OAT.Dom.unlink(r),OAT.MSG.send(t,OAT.MSG.GD_END,r)):(OAT.MSG.send(t,OAT.MSG.GD_ABORT,r),t.onFail(),t=OAT.Dom.position(t.originalElement),e=t[0],a=t[1],t=new OAT.AnimationPosition(r,{speed:10,delay:10,left:e,top:a}),OAT.MSG.attach(t.animation,OAT.MSG.ANIMATION_STOP,(function(){OAT.Dom.unlink(r)})),t.start())}}},move:function(e){if(OAT.GhostDragData.lock){var r=OAT.GhostDragData.lock,t=r.object;t.pending&&(document.body.appendChild(r),r.style.zIndex=2e3,t.process&&t.process(r),t.pending=0,OAT.MSG.send(t,OAT.MSG.GD_START,r));OAT.Dom.removeSelection();var a=e.clientX-r.mouse_x,t=e.clientY-r.mouse_y,a=parseInt(OAT.Dom.style(r,"left"))+a,t=parseInt(OAT.Dom.style(r,"top"))+t;r.style.left=a+"px";r.style.top=t+"px";r.mouse_x=e.clientX;r.mouse_y=e.clientY}},pos:function(e,r,t){if(!e||"none"==e.style.display.toLowerCase())return 0;var a=OAT.Dom.position(e),s=a[0]-2,a=a[1]-2,i=parseInt(e.offsetWidth)+2,e=parseInt(e.offsetHeight)+2;return r>=s&&r<=s+i&&t>=a&&t<=a+e}};OAT.GhostDrag=function(){var e=this;this.onFail=function(){};this.sources=[];this.processes=[];this.callbacks=[];this.targets=[];this.pending=0;this.addSource=function(r,t,a){var s=OAT.$(r);e.sources.push(s);e.processes.push(t);e.callbacks.push(a);OAT.Dom.attach(s,"mousedown",(function(r){OAT.Dom.prevent(r);var t=e.sources.indexOf(s);-1!=t&&e.startDrag(e.sources[t],e.processes[t],e.callbacks[t],r.clientX,r.clientY)}))};this.delSource=function(r){r=$(r);r=e.sources.indexOf(r);-1!=r&&(e.sources.splice(r,1),e.processes.splice(r,1),e.callbacks.splice(r,1))};this.clearSources=function(){e.sources=[];e.processes=[];e.callbacks=[]};this.addTarget=function(r,t,a){r=[OAT.$(r),t,a];e.targets.length&&e.targets[e.targets.length-1][2]?e.targets.splice(e.targets.length-1,0,r):e.targets.push(r)};this.delTarget=function(r){for(var r=OAT.$(r),t=-1,a=0;a<e.targets.length;a++)e.targets[a][0]==r&&(t=a);-1!=t&&e.targets.splice(t,1)};this.clearTargets=function(){e.targets=[]};this.startDrag=function(r,t,a,s,i){OAT.GhostDragData.lock||(e.pending=1,e.originalElement=r,e.callback=a,a=OAT.Dom.create("div",{position:"absolute"}),e.process=t,t=OAT.Dom.position(r),a.style.left=t[0]+"px",a.style.top=t[1]+"px",OAT.Style.opacity(a,.5),a.appendChild(r.cloneNode(!0)),a.mouse_x=s,a.mouse_y=i,a.object=e,OAT.GhostDragData.lock=a)}};if(typeof document!="undefined"){OAT.Dom.attach(document,"mousemove",OAT.GhostDragData.move);OAT.Dom.attach(document,"mouseup",OAT.GhostDragData.up)}try{OAT.Loader.featureLoaded("ghostdrag")}catch(e){}OAT.Instant=function(e,r){var t=this;this.options={showCallback:!1,hideCallback:!1};for(var a in r)t.options[a]=r[a];this.state=1;this.elm=OAT.$(e);this.handles=[];this.hide=function(){t.state=0;OAT.Dom.hide(t.elm)};this.show=function(){t.options.showCallback&&t.options.showCallback();OAT.Dom.show(t.elm);t.state=1};this.check=function(e){t.state&&(e=OAT.Event.source(e),e==t.elm||OAT.Dom.isChild(e,t.elm)||(t.options.hideCallback&&t.options.hideCallback(),t.hide()))};this.createHandle=function(e){var r=OAT.$(e);t.handles.push(r);OAT.Event.attach(r,"mousedown",(function(e){-1!=t.handles.indexOf(r)&&!t.state&&(OAT.Event.cancel(e),t.show())}))};this.removeHandle=function(e){e=OAT.$(e);e=t.handles.indexOf(e);-1!=e&&t.handles.splice(e,1)};t.elm._Instant_show=t.show;t.elm._Instant_hide=t.hide;t.hide();OAT.Dom.attach(document,"mousedown",t.check)};OAT.Instant.assign=function(e,r){new OAT.Instant(e,{hideCallback:r})};try{OAT.Loader.featureLoaded("instant")}catch(e){}OAT.GridData={index:0,LIMIT:15,ALIGN_CENTER:1,ALIGN_START:2,ALIGN_END:3,ALIGN_RIGHT:4,SORT_NONE:1,SORT_ASC:2,SORT_DESC:3,TYPE_STRING:1,TYPE_NUMERIC:2,TYPE_AUTO:3};OAT.Grid=function(e,r,t,a,s,i,f,l,n,o,u,v,c,d,m,h,p,T,A){var w=this;w.controlName=r;w.columnsDataType=a;w.query=t;w.rowsPerPage="";w.columns=s;w.QueryViewerCollection=i;w.InitPageSize=f;w.disableColumnSort=l;w.UcId=n;w.IdForQueryViewerCollection=o;w.rememberLayout=u;w.serverPaging=v;w.HideDataFilds=c;w.OrderFildsHidden=d;w.TableDataFilds=m;w.relativePath=h;w.selection=p;w.translations=A;w.isSD=OAT.isSD();w.conditions=new Array(a.length);for(iC=0;iC<a.length;iC++){w.conditions[iC]={blackList:[],sort:1}}this.init=function(){var r;if(jQuery("#"+w.controlName+"_grid_top_div").length==0||w.QueryViewerCollection[w.IdForQueryViewerCollection]._ControlRenderedTo==undefined){var t=OAT.$(e);w.ContainerName=t.getAttribute("id");OAT.Dom.clear(t);var a=document.createElement("div");a.setAttribute("class","divIeContainer");a.setAttribute("style","position: relative;opacity: 0");t.appendChild(a);w.div=a;r=OAT.Dom.create("div");if(w.isSD){r.setAttribute("class","oatgrid_top_div oatgrid_top_div_small")}else{r.setAttribute("class","oatgrid_top_div")}if(T){OAT.addTextNode(r," "+T)}else{OAT.addTextNode(r,"")}r.setAttribute("id",w.controlName+"_grid_top_div");var s=OAT.Dom.create("a");s.href="#";OAT.addTextNode(s,document.createTextNode("GXPL_QViewerJSVisibleColumns"));w.div.appendChild(r);OAT.Dom.makePosition(w.div);w.html=OAT.Dom.create("table");OAT.Dom.addClass(w.html,"oatgrid");OAT.Dom.setIdPropertyValue(w.html,w.controlName);w.header=new OAT.GridHeader(w);w.rows=[];w.rowBlock=OAT.Dom.create("tbody");OAT.Dom.append([w.div,w.html],[w.html,w.header.html,w.rowBlock])}else{var t=OAT.$(e);w.ContainerName=t.getAttribute("id");w.div=jQuery("#"+w.ContainerName).find(".divIeContainer")[0];r=jQuery("#"+w.ContainerName).find(".oatgrid_top_div")[0];OAT.Dom.clear(r);if(T){OAT.addTextNode(r," "+T)}else{OAT.addTextNode(r,"")}w.html=jQuery("#"+w.ContainerName).find("table")[0];var i=jQuery("#"+w.ContainerName).find("thead")[0];OAT.Dom.clear(i);w.header=new OAT.GridHeader(w,i);w.rows=[];w.rowBlock=jQuery("#"+w.ContainerName).find("tbody")[0];OAT.Dom.clear(w.rowBlock)}var f=OAT.Dom.create("div");f.href="#";if(w.isSD){f.setAttribute("class","exportOptionsAnchor exportOptionsAnchor_small")}else{f.setAttribute("class","exportOptionsAnchor")}w.exportPage=OAT.Dom.create("div",{padding:"0px"});OAT.addImageNode(f,"menu","");var l=function(e){source=OAT.Event.source(e);var r=false;var t=false;for(var a=0;a<jQuery(".oat_winrect_container").length;a++){var s=jQuery(".oat_winrect_container")[a];if(!(source==s)&&!OAT.Dom.isChild(source,s)){r=true}else{r=false;break}}for(var a=0;a<jQuery(".oat_winrect_container").length;a++){if(jQuery(".oat_winrect_container")[a].style.display!="none"){t=true}}if((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,s))&&t){w.oat_component.resetAllScrollValue(w.UcId)}if(r){jQuery(".oat_winrect_container").css({display:"none"})}};OAT.Dom.attach(document,"mousedown",l);OAT.Anchor.assign(f,{title:" ",content:w.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(w.QueryViewerCollection[o])+" ExportPopup "});var n=function(e){if(OAT_JS.grid.gridData[w.UcId].rowsMetadata.columns[e].getAttribute("visible")!="Never"){var r=w.header.cells[e].html.style.display!="none";var t=OAT.Dom.create("div");var a=r?"check_item_img":"uncheck_item_img";if(w.isSD){a=r?"check_item_img_small":"uncheck_item_img_small"}OAT.addImageNode(t,r?"check_box":"check_box_outline_blank","");t.setAttribute("class",a);var s=OAT.Dom.create("span");OAT.addTextNode(s," "+w.header.cells[e].value.textContent.replace("settings",""));t.appendChild(s);OAT.Event.attach(t,"click",(function(){var r="check_item_img";var t="uncheck_item_img";if(w.isSD){r="check_item_img_small";t="uncheck_item_img_small"}var a=this.getAttribute("class")===r?t:r;this.setAttribute("class",a);jQuery(this).find("i")[0].textContent=this.getAttribute("class")===r?"check_box":"check_box_outline_blank";var s=w.header.cells[e].html.style.display=="none"?"":"none";w.header.cells[e].html.style.display=s;var i=e;for(var f=0;f<w.rows.length;f++){w.rows[f].cells[i].html.style.display=s}OAT_JS.grid.setColumnVisibleValue(w.UcId,i,s=="")}));return t}else{return false}};var u=function(e){var r=OAT.Event.position(e);w.exportPage.style.left=r[0]+"px";w.exportPage.style.top=r[1]+"px";w.exportPage.id="exportOptionsContainer";if(OAT.isIE()){w.exportPage.id="exportOptionsContainerGrid";w.exportPage.className="export_option_container"}Math.max(jQuery(".ExportPopup")[0].clientWidth,300);jQuery(e.currentTarget).offset().left;var t=e.currentTarget;jQuery(".ExportPopup").css({left:-2500+"px",top:0+"px"});jQuery(".oat_winrect_title").find(".winrect_title_label").remove();var a=OAT.Dom.create("label");if(w.isSD){jQuery(".oat_winrect_container").addClass("oat_winrect_container_small");a.setAttribute("class","winrect_title_label winrect_title_label_small")}else{a.setAttribute("class","winrect_title_label")}OAT.addTextNode(a,w.translations.GXPL_QViewerPopupTitle);jQuery(".oat_winrect_title").append(a);OAT.Dom.clear(w.exportPage);var s=false;var i=document.createElement("div");i.setAttribute("class","upper_container");jQuery("#divtoxml").remove();jQuery("#divtoxls").remove();jQuery("#divtoxlsx").remove();jQuery("#divtoexport").remove();jQuery("#divtohtml").remove();s=w.appendExportToXmlOption(i,s);s=w.appendExportToHtmlOption(i,s);s=w.appendExportToPdfOption(i,s);s=w.appendExportToExcelOption(i,s);s=w.appendExportToExcel2010Option(i,s);w.exportPage.appendChild(i);if(s){var f=OAT.Dom.create("hr",{});w.exportPage.appendChild(f)}var l=document.createElement("div");l.setAttribute("class","down_container");w.exportPage.appendChild(l);var o=document.createElement("span");o.textContent=w.translations.GXPL_QViewerJSVisibleColumns;var u=document.createElement("div");u.setAttribute("class","div_label_win");u.appendChild(o);l.appendChild(u);for(var v=0;v<w.columns.length;v++){for(var c=0;c<w.header.cells.length;c++){if(w.header.cells[c].dataField==w.columns[v].getAttribute("dataField")){var d=n(c);if(d)l.appendChild(d)}}}setTimeout((function(){var e=window.innerWidth;var r=jQuery(".ExportPopup")[0].clientWidth;if(r==0){var a=jQuery(".ExportPopup").length;r=jQuery(".ExportPopup")[a-1].clientWidth}if(w.isSD){if(r<235){r=235}var s=(e-r)/2+jQuery(window).scrollLeft();jQuery(".ExportPopup").css({left:s+"px",top:jQuery(t).offset().top+"px",width:r+"px"})}else{var i=jQuery(t).offset().left;if(i+r+15<e){jQuery(".ExportPopup").css({left:jQuery(t).offset().left+"px",top:jQuery(t).offset().top+"px"})}else{jQuery(".ExportPopup").css({left:i-r+16+"px",top:jQuery(t).offset().top+"px"})}}}),50)};OAT.Event.attach(f,"click",u);r.appendChild(f)};this.setPageDataForTable=function(e){switch(w.oat_component.lastCallToQueryViewer){case"getDataForTable":if(w.oat_component.lastCallData.PageNumber==0){w.oat_component.lastCallData.PageNumber=1,w.oat_component.lastCallData.RecalculateCantPages=false}OAT_JS.grid.redraw(w.oat_component.lastCallData.self,w.oat_component.lastCallData.UcId,e,w.oat_component.lastCallData.RecalculateCantPages,w.oat_component.lastCallData.DataFieldOrder!="",w.oat_component.lastCallData.PageNumber,w.oat_component.lastCallData.fromExternalRefresh);break;case"getAllDataRowsForExport":var r=e;var t=r.split("<Record>");var a=[];var s=w.oat_component.lastCallData.UcId;var i=w.oat_component.lastCallData.fileName;var f=w.oat_component.lastCallData._selfgrid;var l=w.oat_component.lastCallData.format;for(var n=1;n<t.length;n++){var o=[];for(var u=0;u<OAT_JS.grid.gridData[s].grid.columns.length;u++){o[u]="#NuN#";var v=t[n].split("<"+OAT_JS.grid.gridData[s].grid.columns[u].getAttribute("dataField")+">");if(v.length>1){var c=v[1].split("</"+OAT_JS.grid.gridData[s].grid.columns[u].getAttribute("dataField")+">");o[u]=c[0]}}a.push(o);if(l!="xlsx"){if(n>OAT_JS.grid.gridData[s].rowsPerPage&&!(OAT_JS.grid.gridData[s].rowsPerPage=="")){OAT.CreateGridRow(o,OAT_JS.grid.gridData[s],true)}}}switch(l){case"pdf":OAT.ExportToPdf(f,i);break;case"xml":OAT.ExportToXML(f,i);break;case"html":OAT_JS.grid.gridData[s].grid.ExportToHtml(f,i);break;case"xls":OAT.ExportToExcel(f,i);break;case"xlsx":OAT.ExportToExcel2010(f,i,true,a,s);break}OAT_JS.grid.gridData[s].grid.removeAllCollapseRows();break}};this.setAttributeForTable=function(e){var r=JSON.parse(e);switch(w.oat_component.lastCallToQueryViewer){case"getValuesForColumn":OAT_JS.grid.changeValues(w.oat_component.lastCallData.UcId,w.oat_component.lastCallData.dataField,w.oat_component.lastCallData.columnNumber,r,w.oat_component.lastCallData.filterValue);break;case"readScrollValue":OAT_JS.grid.appendNewValueData(w.oat_component.lastCallData.UcId,r);break;case"readScrollValueFilter":OAT_JS.grid.appendNewFilteredValueData(w.oat_component.lastCallData.UcId,r,w.oat_component.lastCallData.posColumnNumber,w.oat_component.lastCallData.filterText);case"initValueRead":OAT_JS.grid.initValueLoad(r,w.oat_component.lastCallData.UcId,w.oat_component.lastCallData.dataField);break;case"filterChange":OAT_JS.grid.appendNewValueData(w.oat_component.lastCallData.UcId,r,true);OAT_JS.grid.setFilterChangedWhenServerPagination(w.oat_component.lastCallData.UcId,w.oat_component.lastCallData.oatDimension);break}};this.setDataSynForTable=function(e){_self=w.oat_component.lastCallData.self;OAT.ClickHandle(_self,w.oat_component.lastCallData.elemvalue,e)};this.appendExportToXmlOption=function(e,r){var t;var a=this.query;if(a==""){try{a=w.controlName.substr(4).split("_")[0]}catch(e){}}if(w.QueryViewerCollection[w.IdForQueryViewerCollection].ExportToXML){t=OAT.Dom.create("div");var s=w.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,w.translations.GXPL_QViewerContextMenuExportXml);i.htmlFor="pivot_checkbox_restoreview";t.appendChild(i);OAT.Dom.attach(s,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(w.UcId,{grid:w},a,"xml")}));e.appendChild(t);if(!r)r=true}return r};this.appendExportToHtmlOption=function(e,r){var t;var a=this.query;if(a==""){try{a=w.controlName.substr(4).split("_")[0]}catch(e){}}if(w.QueryViewerCollection[w.IdForQueryViewerCollection].ExportToHTML){t=OAT.Dom.create("div");var s=w.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,w.translations.GXPL_QViewerContextMenuExportHtml);i.htmlFor="pivot_checkbox_restoreview";t.appendChild(i);OAT.Dom.attach(s,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(w.UcId,w,a,"html")}));e.appendChild(t);if(!r)r=true}return r};this.ExportToHtml=function(e,r){var t=OAT.resourceURL(e.relativePath+"QueryViewer/oatPivot/css/grid.css");var a="<!DOCTYPE><HTML><BODY>";a=a+"<HEAD>";a=a+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';a=a+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+t+'" />';for(var s=0;s<jQuery("link").length;s++){if(jQuery("link")[s].href.indexOf("QueryViewer.css")<0){a=a+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+jQuery("link")[s].href+'" />'}}a=a+"</STYLE>";a=a+"</HEAD>";a=a+'<div class="gx_usercontrol qv-table QueryViewer-table">';a=a+'<table class="oatgrid"  style="width: 100%;">';a=a+OAT.removeIconFont(jQuery("#"+e.controlName)[0].innerHTML.replace(/visibility: collapse;/g,"").replace(/visibility:collapse;/g,""));a=a+"</table>";a=a+"</div>";a=a+"</BODY></HTML>";isSD=OAT.isSD();if(OAT.isSafari()||isSD){window.open("data:text/html,"+a)}else{var i=new Blob([a],{type:"text/html"});saveAs(i,r+".html")}};this.appendExportToPdfOption=function(e,r){var t=this.query;if(t==""){try{t=w.controlName.substr(4).split("_")[0]}catch(e){}}var a;if(w.QueryViewerCollection[w.IdForQueryViewerCollection].ExportToPDF){a=OAT.Dom.create("div");var s=w.createExportButton(a);var i=OAT.Dom.create("label");OAT.addTextNode(i,w.translations.GXPL_QViewerContextMenuExportPdf);i.htmlFor="pivot_checkbox_restoreview";a.appendChild(i);OAT.Dom.attach(s,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(w.UcId,{grid:w},t,"pdf")}));e.appendChild(a);if(!r)r=true}return r};this.appendExportToExcelOption=function(e,r){var t=this.query;if(t==""){try{t=w.controlName.substr(4).split("_")[0]}catch(e){}}var a;if(w.QueryViewerCollection[w.IdForQueryViewerCollection].ExportToXLS){a=OAT.Dom.create("div");var s=w.createExportButton(a);var i=OAT.Dom.create("label");OAT.addTextNode(i,w.translations.GXPL_QViewerContextMenuExportXls2003);i.htmlFor="pivot_checkbox_restoreview";a.appendChild(i);OAT.Dom.attach(s,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(w.UcId,{grid:w},t,"xls")}));e.appendChild(a);if(!r)r=true}return r};this.appendExportToExcel2010Option=function(e,r){var t=this.query;if(t==""){try{t=w.controlName.substr(4).split("_")[0]}catch(e){}}var a;if(w.QueryViewerCollection[w.IdForQueryViewerCollection].ExportToXLSX){a=OAT.Dom.create("div");var s=w.createExportButton(a);var i=OAT.Dom.create("label");OAT.addTextNode(i,w.translations.GXPL_QViewerContextMenuExportXlsx);i.htmlFor="pivot_checkbox_restoreview";a.appendChild(i);OAT.Dom.attach(s,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(w.UcId,{grid:w},t,"xlsx")}));e.appendChild(a);if(!r)r=true}return r};this.createExportButton=function(e){var r=OAT.Dom.create("div",{});r.setAttribute("id","divtoxml");e.appendChild(r);if(w.isSD){r.setAttribute("class","download_file_img_small")}else{r.setAttribute("class","download_file_img")}OAT.addImageNode(r,"download","");e.setAttribute("class","export_item_div");if(w.isSD){e.setAttribute("class","export_item_div export_item_div_small")}return e};this.clearData=function(){w.rows=[];OAT.Dom.clear(w.rowBlock)};this.appendHeader=function(e,r,t){var a=!t?w.header.cells.length:t;var s=w.header.addCell(e,"character",a,r);for(var a=0;a<w.header.cells.length;a++){w.header.cells[a].number=a}return s};this.ieFix=function(){for(var e=0;e<w.header.cells.length;e++){var r=w.header.cells[e].html;OAT.Dom.addClass(r,"hover");OAT.Dom.removeClass(r,"hover");var t=w.header.cells[e].value;OAT.Dom.getWH(t)}};this.createHeader=function(e,r){w.header.clear();for(var t=0;t<e.length;t++){w.appendHeader(e[t],r[t])}if(OAT.isIE()){w.ieFix()}};this.getHeaders=function(){var e=[];for(var r=0;r<w.header.cells.length;r++){e.push(w.header.cells[r].value.textContent)}return e};this.createRow=function(e,r,t,a,s,i,f,l,n,o){var u=!n?w.rows.length:n;var v=new OAT.GridRow(w,u);if(n==u||u==w.rows.length){w.rowBlock.appendChild(v.html)}else{w.rowBlock.insertBefore(v.html,w.rowBlock.childNodes[u])}OAT.underRecursionStyle=[];for(var c=0;c<e.length;c++){v.addCell(e[c],r[c],t,a[c],s,i,f,c,n,o[c])}w.rows.splice(u,0,v);return v.html};this.loadDifferentValues=function(e,r){w.conditions[e].differentValue=[];for(var t=0;t<r.length;t++){w.conditions[e].differentValue.push(r[t])}};this.removeAllRows=function(){var e=w.rows.length;for(var r=0;r<e;r++){w.removeRow(0)}};this.removeAllHiddenRows=function(){var e=w.rows.length-1;while(e>0&&w.rows[e].html.style.display=="none"){w.removeRow(e);e--}};this.removeAllCollapseRows=function(){var e=w.rows.length-1;while(e>0&&w.rows[e].html.style.visibility=="collapse"){w.removeRow(e);e--}};this.removeRow=function(e){jQuery(w.rows[e].html).remove();w.rows.splice(e,1)};this.removeColumn=function(e){w.header.removeColumn(e);for(var r=0;r<w.rows.length;r++){w.rows[r].removeColumn(e)}};this.hideColumnHeader=function(e){var r=e;w.header.cells[r].html.style.display="none"};this.showColumnHeader=function(e){w.header.cells[e].html.style.display=""};this.sort=function(e,r,t){for(var a=0;a<w.header.cells.length;a++){w.conditions[a].sort=1;w.header.cells[a].changeSort(OAT.GridData.SORT_NONE)}w.conditions[e].sort=r;w.header.cells[t].changeSort(r)};this.applySaveState=function(e){if(w.rememberLayout&&w.rememberLayout!="false"){w=this;var r=OAT.getState(w,e);if(r){OAT.filterRows(w);for(var t=0;t<w.columnsDataType.length;t++){if(w.conditions[t].sort!=1){w.sort(t,w.conditions[t].sort,t)}}}}};this.applySortOrderType=function(e,r){w.sort(e,r,e)};this.applyCustomSort=function(e,r,t){var a=[];for(var s=0;s<r.childNodes.length;s++){if(r.childNodes[s]!=undefined&&r.childNodes[s].localName!=undefined&&r.childNodes[s].localName==="customOrder"){for(var i=0;i<r.childNodes[s].childNodes.length;i++){if(r.childNodes[s].childNodes[i].localName=="Value"){a.push(r.childNodes[s].childNodes[i].textContent.trimpivot())}}}}for(var f=0;f<t.length;f++){if(a.indexOf(t[f][e].trimpivot())==-1){a.push(t[f][e])}}var l=t;t=[];for(var n=0;n<a.length;n++){for(var o=0;o<l.length;o++){if(l[o][e].trimpivot()===a[n].trimpivot()){t.push(l[o])}}}return[t,a]};this.applyCustomFilter=function(e,r){try{var t=[];var a=false;for(var s=0;s<r.childNodes.length;s++){if(r.childNodes[s]!=undefined&&r.childNodes[s].localName!=undefined&&r.childNodes[s].localName==="include"){a=true;for(var i=0;i<r.childNodes[s].childNodes.length;i++){if(r.childNodes[s].childNodes[i].localName!=null&&r.childNodes[s].childNodes[i].localName.toLowerCase()==="value"){t.push(r.childNodes[s].childNodes[i].textContent)}}}}if(a){w.conditions[e].blackList=[];var f=OAT_JS.grid.gridData[w.UcId].columnDataField[e];OAT_JS.grid.gridData[w.UcId].blackLists[f].state="";OAT_JS.grid.gridData[w.UcId].blackLists[f].defaultAction="Exclude";OAT_JS.grid.gridData[w.UcId].blackLists[f].hiddens=[];for(var l=0;l<t.length;l++){if(t[l]!="TOTAL")OAT_JS.grid.gridData[w.UcId].blackLists[f].visibles.push(t[l])}for(var l=0;l<w.rows.length;l++){var n=e;if(t.findIndex(w.rows[l].cells[n].options.value)===-1&&t.findIndex(w.rows[l].cells[n].options.value.trimpivot())===-1&&w.conditions[n].blackList.findIndex(w.rows[l].cells[n].options.value)===-1){w.conditions[n].blackList.push(w.rows[l].cells[n].options.value);OAT.HideGridRow({grid:w},e,w.rows[l].cells[e].options.value);OAT.actualizeBlackList("push",w,e,w.rows[l].cells[e].options.value,false)}}}}catch(e){}};this.moveToNextPage=function(){w.oat_component.moveToNextPage(w.UcId)};this.moveToFirstPage=function(){w.oat_component.moveToFirstPage(w.UcId)};this.moveToLastPage=function(){w.oat_component.moveToLastPage(w.UcId)};this.moveToPreviousPage=function(){w.oat_component.moveToPreviousPage(w.UcId)};this.selectValue=function(e){OAT_JS.grid.gridData[w.UcId].selection.SelectedNode=[];OAT.ClearSelectedNodes(jQuery(w.html));var r=0;var t=OAT_JS.grid.gridData[w.UcId].columnDataField.indexOf(e[r].DataField);OAT.SelectNodes({grid:w},e[r].Value,false,t,-1,r,e)};this.deselectValue=function(){OAT_JS.grid.gridData[w.UcId].selection.SelectedNode=[];OAT.ClearSelectedNodes(jQuery(w.html))};this.refreshPivot=function(e,r,t){if(e!=""&&r!=""){var a=new DOMParser;var s=a.parseFromString(e,"text/xml");var i=s.getElementsByTagName("OLAPDimension");var f="";var l="";var n=[];for(var o=0;o<i.length;o++){var u=i[o].getElementsByTagName("name")[0].childNodes[0].nodeValue;var v=-1;var c=-1;for(var d=0;d<w.columns.length;d++){if(w.columns[d].attributes.getNamedItem("name").nodeValue===u){var m=w.columns[d].attributes.getNamedItem("displayName").nodeValue;for(var h=0;h<w.header.cells.length;h++){if(w.header.cells[h].options.value===m){v=w.header.cells.length-1-h;c=h}}}}if(v!=-1){var p=i[o].getElementsByTagName("condition")[0].childNodes[0].nodeValue;if(p==="none"){var T="none";w.header.cells[c].html.style.display=T;for(var A=0;A<w.rows.length;A++){w.rows[A].cells[v].html.style.display=T}OAT_JS.grid.setColumnVisibleValue(w.UcId,c,T=="")}else{var T="";w.header.cells[c].html.style.display=T;for(var A=0;A<w.rows.length;A++){w.rows[A].cells[v].html.style.display=T}OAT_JS.grid.setColumnVisibleValue(w.UcId,c,T=="")}try{var O=OAT_JS.grid.gridData[w.UcId].columnDataField[c];n[parseInt(i[o].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=O}catch(e){}var O=OAT_JS.grid.gridData[w.UcId].columnDataField[c];OAT_JS.grid.updateFilterInfo(w.UcId,O,{op:"all",values:[]});var y=i[o].getElementsByTagName("order")[0].childNodes[0].nodeValue;if(y=="ascending"&&w.conditions[v].sort==3){w.sort(v,OAT.GridData.SORT_ASC,c);l="Ascending";f=i[o].getElementsByTagName("dataField")[0].childNodes[0].nodeValue}else if(y=="descending"&&w.conditions[v].sort!=3){w.sort(v,OAT.GridData.SORT_DESC,c);l="Descending";f=i[o].getElementsByTagName("dataField")[0].childNodes[0].nodeValue}var _=i[o].getElementsByTagName("hide")[0].childNodes;for(var g=0;g<_.length;g++){if(_[g].tagName==="value"){var O=OAT_JS.grid.gridData[w.UcId].columnDataField[c];var b=OAT_JS.grid.gridData[w.UcId].differentValues[O];for(var A=0;A<b.length;A++){if(b[A].trimpivot()==_[g].textContent){OAT_JS.grid.updateFilterInfo(w.UcId,O,{op:"push",values:b[A]})}}}}}}if(n.length!=OAT_JS.grid.gridData[w.UcId].columnDataField.length){n=[]}var i=s.getElementsByTagName("OLAPDimension");OAT_JS.grid.refreshPivotWhenServerPagination(w.UcId,f,l,n)}};this.getDataXML=function(e){var r=e.split("<Recordset")[1];r="<Recordset"+r;return r};this.getFilteredDataXML=function(e){return OAT_JS.grid.getTableWhenServerPagination(w.UcId,e)};this.getMetadataXML=function(){var e='<OLAPCube format="'+"compact"+'" thousandsSeparator="'+","+'" decimalSeparator="'+"."+'" dateFormat="'+"MDY"+'">';for(var r=0;r<w.columns.length;r++){var t=w.columns[r].getAttribute("isMeasure")!=undefined;if(t)e=e+"<OLAPMeasure> ";else e=e+"<OLAPDimension> ";e=e+OAT.createXMLDimensionInfo(w,r);var a=0;for(var s=0;s<w.header.cells.length;s++){if(w.header.cells[s].dataField==w.columns[r].getAttribute("dataField")){a=s;if(w.header.cells[s].html.style.display=="none"){e=e+"<hidden>true</hidden>"}}}if(w.columns[r].getAttribute("picture")===""){e=e+"<picture/> "}else{e=e+"<picture>"+w.columns[r].getAttribute("picture")+"</picture> "}if(w.columns[r].getAttribute("format")===""){e=e+"<format/> "}else{e=e+"<format>"+w.columns[r].getAttribute("format")+"</format> "}var i=0;var f=false;var l=-1;for(var n=0;n<OAT_JS.grid.gridData[w.UcId].columnDataField.length&&!f;n++){var o=OAT_JS.grid.gridData[w.UcId].columnDataField[n];var u=false;for(var v=0;v<w.columns.length;v++){if(o==w.columns[v].getAttribute("dataField"))u=w.columns[v].getAttribute("visible").toLowerCase()=="never"}if(!u)i=i+1;if(o==w.columns[r].getAttribute("dataField")){f=true;if(!u)l=i}}if(l>0)e=e+"<position>"+l+"</position> ";else e=e+"<position/>";if(OAT_JS.grid.gridData[w.UcId].dataFieldOrder==w.columns[r].getAttribute("dataField")){if(OAT_JS.grid.gridData[w.UcId].orderType=="Descending")e=e+"<order>descending</order> ";else e=e+"<order>ascending</order> "}else{e=e+"<order>none</order> "}e=e+"<customOrder/> ";e=e+"<include> ";var c=[];for(var d=0;d<w.rows.length;d++){if(w.rows[d].cells[a]!=undefined){if(c.findIndex(w.rows[d].cells[a].options.value)===-1){if(w.conditions[r].blackList.findIndex(w.rows[d].cells[a].options.value)===-1){e=e+"<value>"+w.rows[d].cells[a].options.value+"</value> ";c.push(w.rows[d].cells[a].options.value)}}}}e=e+"<value>TOTAL</value> </include> <collapse/> ";if(t)e=e+"</OLAPMeasure>";else e=e+" </OLAPDimension>"}e=e+"</OLAPCube>";return e};w.init();setInterval((function(){if(jQuery("#"+w.controlName).length>0&&jQuery("#"+w.controlName)[0].getAttribute("class")==="oatgrid"){var e=0;if(jQuery("#"+w.controlName+"tablePagination_rowsPerPage").length>0){if(!OAT_JS.grid.gridData[w.UcId].autoResize){var r=jQuery("#"+w.ContainerName)[0].clientWidth;jQuery("#"+w.controlName).css({width:r+"px"})}else{r=jQuery("#"+w.controlName)[0].clientWidth}e=parseInt(jQuery("#"+w.controlName+"tablePagination_rowsPerPage")[0].value);if(!isNaN(e)){if(w.rowsPerPage!=e){w.rowsPerPage=e}else{w.rowsPerPage=e}}var t=r;jQuery("#"+w.controlName+"_tablePagination").css({width:t+"px"});jQuery("#"+w.controlName+"_grid_top_div").css({width:t+"px"});var a=jQuery("#"+w.controlName)[0].clientWidth;if(a>r+10||jQuery("#"+w.controlName).closest(".gxwebcomponent").length>0){jQuery("#"+w.controlName+"_tablePagination").css({width:a+1+"px"});jQuery("#"+w.controlName+"_grid_top_div").css({width:a+1+"px"})}}else{if(!OAT_JS.grid.gridData[w.UcId].autoResize){var r=jQuery("#"+w.ContainerName)[0].clientWidth;jQuery("#"+w.controlName).css({width:r+"px"})}else{r=jQuery("#"+w.controlName)[0].clientWidth}var s=r;jQuery("#"+w.controlName+"_grid_top_div").css({width:s+"px"});jQuery(".oatgrid").css({marginBottom:"0px"});var a=jQuery("#"+w.controlName)[0].clientWidth;if(a>r+10||jQuery("#"+w.controlName).closest(".gxwebcomponent").length>0){jQuery("#"+w.controlName+"_grid_top_div").css({width:a+1+"px"})}}jQuery(".divIeContainer").css({opacity:"1"});if(jQuery("#"+w.controlName+" tr").length<500){var i=1;for(var f=1;f<jQuery("#"+w.controlName+" tr").length;f++){if(jQuery("#"+w.controlName+" tr")[f].style.display!="none"){if(i%2===1){jQuery("#"+w.controlName+" tr")[f].className="odd"}else{jQuery("#"+w.controlName+" tr")[f].className="even"}i++}}}if(jQuery("#"+w.controlName+"tablePagination_rowsPerPage").length>0&&w.QueryViewerCollection.length===0){jQuery(".pivot_pag_div").css({marginBottom:"0px"})}}}),150)};OAT.GridHeader=function(e,r){var t=this;this.cells=[];this.grid=e;if(r){this.html=r}else{this.html=OAT.Dom.create("thead")}this.container=OAT.Dom.create("tr");this.html.appendChild(t.container);this.clear=function(){OAT.Dom.clear(t.container);t.cells=[]};this.addCell=function(e,r,a,s){var i=new OAT.GridHeaderCell(t.grid,e,a,s);var f=t.container.childNodes;if(f.length&&a<f.length){t.container.insertBefore(i.html,f[a])}else{t.container.appendChild(i.html)}t.cells.splice(a,0,i);return i};t.removeColumn=function(e){OAT.Dom.unlink(t.cells[e].html);t.cells.splice(e,1);for(var r=0;r<t.cells.length;r++){t.cells[r].number=r}}};OAT.GridHeaderCell=function(e,r,t,a){var s=this;this.options={value:"",sortable:1,align:OAT.GridData.ALIGN_START,sort:OAT.GridData.SORT_NONE,type:OAT.GridData.TYPE_AUTO};var i=typeof r=="object"?r:{value:r};for(var f in i){s.options[f]=i[f]}this.changeSort=function(e){s.options.sort=e;s.updateSortImage()};this.updateSortImage=function(){if(!s.sorter){return}var e="none";switch(s.options.sort){case OAT.GridData.SORT_NONE:e="none";break;case OAT.GridData.SORT_ASC:e="asc";break;case OAT.GridData.SORT_DESC:e="desc";break}s.sorter.className="table-sort-image table-sort-"+e;jQuery(s.sorter).find("i")[0].textContent=e=="none"?"":e=="asc"?"arrow_drop_up":"arrow_drop_down"};this.signal=0;this.number=t;this.grid=e;this.dataField=a;this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div",{position:"relative"});this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(s.value,"header_value");OAT.addTextNode(this.value,i.value.replace(/ /g," "));this.value.setAttribute("title_v",i.value);this.value.setAttribute("dataField",a);this.html.setAttribute("title_v",i.value);this.html.setAttribute("dataField",a);var l=OAT.Dom.create("div");l.className="div_settings";OAT.addImageNode(l,"settings","");OAT.Dom.append([s.html,s.container],[s.container,s.value],[s.value,l]);if(s.options.sortable){s.html.style.cursor="pointer";s.sorter=OAT.Dom.create("div",{position:"absolute",right:"6px",bottom:"4px"});OAT.addImageNode(s.sorter,"arrow_drop_up","");s.container.appendChild(s.sorter);s.updateSortImage();var n;if(OAT.isIE()){if(e.isSD){n=OAT.Dom.create("div","","oatfilterwindowGrid oatfilterwindow_small")}else{n=OAT.Dom.create("div","","oatfilterwindowGrid")}}else{if(e.isSD){n=OAT.Dom.create("div","","oatfilterwindow oatfilterwindow_small")}else{n=OAT.Dom.create("div","","oatfilterwindow")}}OAT.Anchor.assign(s.container,{title:" ",content:n,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(s.grid.QueryViewerCollection[IdForQueryViewerCollection])+" FilterPopup "});var o=function(e){var r=OAT.GridData.SORT_NONE;switch(s.options.sort){case OAT.GridData.SORT_NONE:r=OAT.GridData.SORT_ASC;break;case OAT.GridData.SORT_ASC:r=OAT.GridData.SORT_DESC;break;case OAT.GridData.SORT_DESC:r=OAT.GridData.SORT_ASC;break}if(OAT_JS.grid.gridData[s.grid.UcId].differentValuesPaginationInfo[a].previousPage==0){OAT_JS.grid.initValueRead(s.grid.UcId,0,a);jQuery(".oat_winrect_container").css({left:"-10000000px",top:"-10000000px"});var t=jQuery.extend(true,{},e);var i=function(){if(OAT_JS.grid.gridData[s.grid.UcId].differentValuesPaginationInfo[a].previousPage==0){setTimeout(i,100)}else{OAT.showPopup(t,s,r,n)}};i()}else{OAT.showPopup(e,s,r,n)}};OAT.Event.attach(s.container,"click",o)}switch(s.options.align){case OAT.GridData.ALIGN_START:s.html.style.textAlign="start";break;case OAT.GridData.ALIGN_CENTER:s.html.style.textAlign="center";break;case OAT.GridData.ALIGN_END:s.html.style.textAlign="end";break}var u=function(e){OAT.Dom.addClass(s.html,"hover")};var v=function(e){OAT.Dom.removeClass(s.html,"hover")};OAT.Event.attach(s.html,"mouseover",u);OAT.Event.attach(s.html,"mouseout",v)};OAT.GridRow=function(e,r){var t=this;this.clear=function(){OAT.Dom.clear(t.html);t.cells=[]};this.removeColumn=function(e){OAT.Dom.unlink(t.cells[e].html);t.cells.splice(e,1)};this.isDecimal=function(e,r){var t=/^[0-9]+(\.[0-9]+)+$/;if(e.match(t)){return true}else{return false}};this.addCell=function(e,r,a,s,i,f,l,n,o,u){var v=!o?t.cells.length:o;if(e==undefined){e=""}var c=new OAT.GridRowCell(e,v,r,a,s,i,f,l,n,u);var d=t.html.childNodes;if(d.length&&v!=d.length){t.html.insertBefore(c.html,d[v]);if(!u)d[v].style.display="none"}else{t.html.appendChild(c.html);if(!u)c.html.style.display="none"}OAT.setClickEventHandlers(t,d[d.length-1],e,"DIMENSION",n,t.grid.rows.length);t.cells.splice(v,0,c);return c.value};this.select=function(){t.selected=1};this.deselect=function(){t.selected=0;OAT.Dom.removeClass(t.html,"selected")};this.grid=e;this.cells=[];this.html=OAT.Dom.create("tr");this.selected=0;OAT.Dom.addClass(t.html,r%2?"even":"odd");var a=function(e){OAT.Dom.addClass(t.html,"hover")};var s=function(e){OAT.Dom.removeClass(t.html,"hover")};var i=function(e){if(!e.shiftKey&&!e.ctrlKey){for(var r=0;r<t.grid.rows.length;r++){var a=t.grid.rows[r];if(a!=t){a.deselect()}}}if(e.shiftKey){var s=-1;var i=-1;var f=0;for(var r=0;r<t.grid.rows.length;r++){var a=t.grid.rows[r];if(a!=t){if(!f&&a.selected){s=r}if(!f&&s!=-1){a.select()}if(f&&a.selected){i=r}}else{f=1}}if(s==-1&&i!=-1){var f=0;for(var r=0;r<t.grid.rows.length;r++){var a=t.grid.rows[r];if(a==t){f=1}if(f&&a!=t&&r<i){a.select()}}}}t.selected?t.deselect():t.select()};OAT.Event.attach(t.html,"mouseover",a);OAT.Event.attach(t.html,"mouseout",s);OAT.Event.attach(t.html,"click",i)};OAT.GridRowCell=function(e,r,t,a,s,i,f,l,n,o){var u=this;this.options={value:"",align:OAT.GridData.ALIGN_START};var v=typeof e=="object"?e:{value:e};for(p in v){u.options[p]=v[p]}this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div");this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(u.value,"row_value");OAT.addTextNode(this.value,OAT.ApplyPictureValue(u.options.value,t,a,s).trim().replace(/ /g," "));var c=u.options.value;if(t=="date"){c=OAT.ApplyPictureValue(u.options.value,t,a,s)}this.html=OAT.applyFormatValues(this.html,c,t,n,f,i,l,a);this.html.setAttribute("title",OAT.ApplyPictureValue(u.options.value,t,a,s));OAT.Dom.append([u.html,u.container],[u.container,u.value]);this.html.setAttribute("sin_pictureValue",e);if(t!="character"&&t!="guid"){if(!isNaN(u.options.value)){u.options.align=4}if(u.options.value){u.options.align=4}}if(t==="date"){u.options.align=4}switch(u.options.align){case OAT.GridData.ALIGN_START:u.html.style.textAlign="start";break;case OAT.GridData.ALIGN_CENTER:u.html.style.textAlign="center";break;case OAT.GridData.ALIGN_END:u.html.style.textAlign="end";break;case OAT.GridData.ALIGN_RIGHT:u.html.style.textAlign="right";break}};OAT.underRecursionStyle=[];OAT.applyFormatValues=function(e,r,t,a,s,i,f){var l=t;var n=f[a];if(n!=null&&n!=""){e=OAT.setStyleValues(e,n)}if(OAT.underRecursionStyle.length>0){for(var o=0;o<OAT.underRecursionStyle.length;o++){e=OAT.setStyleValues(e,OAT.underRecursionStyle[o].format)}}for(var o=0;o<s.length;o++){if(s[o].columnNumber==a){if(s[o].value===r.trimpivot()){e=OAT.setStyleValues(e,s[o].format);if(self.formatValues[o].recursive!=undefined&&self.formatValues[o].recursive=="yes"){OAT.underRecursionStyle.push(s[o])}}}}var u=[];var v=[];var c=[];var d=[];var m=[];var h=[];var d=[];var p=[];for(var o=0;o<i.length;o++){if(i[o].columnNumber==a){if(i[o].operation1=="equal"){if(l==="real"||l==="integer"){u[0]=parseFloat(i[o].value1)}else{u[0]=i[o].value1}u[1]=i[o].format}if(i[o].operation1=="notequal"){if(l==="real"||l==="integer"){v[0]=parseFloat(i[o].value1)}else{v[0]=i[o].value1}v[1]=i[o].format}if(i[o].operation1=="less"){if(l==="real"||l==="integer"){m[0]=parseFloat(i[o].value1)}else{m[0]=i[o].value1}m[1]=i[o].format}if(i[o].operation1=="lessequal"){if(l==="real"||l==="integer"){h[0]=parseFloat(i[o].value1)}else{h[0]=i[o].value1}m[1]=i[o].format}if(i[o].operation1=="greater"){if(l==="real"||l==="integer"){c[0]=parseFloat(i[o].value1)}else{c[0]=i[o].value1}c[1]=i[o].format}if(i[o].operation1=="greaterequal"&&i[o].operation2==undefined){if(l==="real"||l==="integer"){d[0]=parseFloat(i[o].value1)}else{d[0]=i[o].value1}c[1]=i[o].format}if(i[o].operation2&&i[o].operation1=="greaterequal"){if(l==="real"||l==="integer"){p[0]=parseFloat(i[o].value1)}else{p[0]=i[o].value1}if(i[o].operation2&&i[o].operation2=="lessequal"){if(l==="real"||l==="integer"){p[1]=parseFloat(i[o].value2)}else{p[1]=i[o].value2}p[2]=i[o].format}}}}var T=new Array(3);if(l==="real"){r=parseFloat(r);if(c[0]!=undefined&&c[0]!=""){T[0]=parseFloat(c[0])}if(m[0]!=undefined&&m[0]!=""){T[1]=parseFloat(m[0])}if(p[0]!=undefined&&p[0]!=""){T[2]=parseFloat(p[0])}}if(l==="integer"){r=parseInt(r);if(c[0]!=undefined&&c[0]!=""){T[0]=parseInt(c[0])}if(m[0]!=undefined&&m[0]!=""){T[1]=parseInt(m[0])}if(p[0]!=undefined&&p[0]!=""){T[2]=parseInt(p[0])}}if(l==="date"){var A=r.split("-");var w=new Array(3);w[0]=parseInt(A[0]);w[1]=parseInt(A[1]);w[2]=parseInt(A[2]);try{if(u[0]!=undefined||d[0]!=undefined||h[0]!=undefined){var O;if(u[0]!=undefined){O=u[0].split("-")}else if(d[0]!=undefined){O=d[0].split("-")}else if(d[0]!=undefined){O=h[0].split("-")}var y=new Array(3);y[1]=parseInt(O[1]);y[2]=parseInt(O[2]);y[0]=parseInt(O[0]);if(y[0]==w[0]||y[0]==w[0]&&y[1]==w[1]){if(u[1]!=undefined)e=OAT.setStyleValues(e,u[1]);else if(c[1]!=undefined)e=OAT.setStyleValues(e,c[1]);else if(m[1]!=undefined)e=OAT.setStyleValues(e,m[1])}}if(v[0]!=undefined){var O=v[0].split("-");var y=new Array(3);y[1]=parseInt(O[1]);y[2]=parseInt(O[2]);y[0]=parseInt(O[0]);if(y[0]!=w[0]||y[0]!=w[0]&&y[1]!=w[1]){e=OAT.setStyleValues(e,v[1])}}if(c[0]!=undefined||d[0]!=undefined){var O;if(c[0].split("-")!=undefined){O=c[0].split("-")}else{O=d[0].split("-")}y[1]=parseInt(O[1]);y[2]=parseInt(O[2]);y[0]=parseInt(O[0]);if(y[0]<w[0]||y[0]<=w[0]&&y[1]<w[1]||y[0]<=w[0]&&y[1]<=w[1]&&y[2]<w[2]){e=OAT.setStyleValues(e,c[1])}}if(m[0]!=undefined||h[0]!=undefined){var O;if(m[0].split("-")!=undefined){O=m[0].split("-")}else{O=h[0].split("-")}y=new Array(3);y[1]=parseInt(O[1]);y[2]=parseInt(O[2]);y[0]=parseInt(O[0]);if(y[0]>w[0]||y[0]>=w[0]&&y[1]>w[1]||y[0]>=w[0]&&y[1]>=w[1]&&y[2]>w[2]){e=OAT.setStyleValues(e,m[1])}}if(p[0]!=undefined&&p[1]!=undefined){var O=p[0].split("-");var _=p[1].split("-");y=new Array(3);cmparElements2=new Array(3);y[1]=parseInt(O[1]);y[2]=parseInt(O[2]);y[0]=parseInt(O[0]);cmparElements2[1]=parseInt(_[1]);cmparElements2[2]=parseInt(_[2]);cmparElements2[0]=parseInt(_[0]);if((y[0]<=w[0]||y[0]<=w[0]&&y[1]<w[1]||y[0]<=w[0]&&y[1]<=w[1]&&y[2]<w[2])&&(cmparElements2[0]>w[0]||cmparElements2[0]>=w[0]&&cmparElements2[1]>w[1]||cmparElements2[0]>=w[0]&&cmparElements2[1]>=w[1]&&cmparElements2[2]>w[2])){e=OAT.setStyleValues(e,p[2])}}}catch(e){}}if(l!="date"){if(u[0]!=undefined&&r==u[0]){e=OAT.setStyleValues(e,u[1])}if(v[0]!=undefined&&r!=v[0]){e=OAT.setStyleValues(e,v[1])}if(c[0]!=undefined&&r>c[0]||d[0]!=undefined&&r>=d[0]){e=OAT.setStyleValues(e,c[1])}if(m[0]!=undefined&&r<m[0]||h[0]!=undefined&&r<=h[0]){e=OAT.setStyleValues(e,m[1])}if(p[0]!=undefined&&p[1]!=undefined&&(r>=p[0]&&r<=p[1])){e=OAT.setStyleValues(e,p[2])}}return e};OAT.setStyleValues=function(e,r){if(r==undefined)return e;function t(e){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(r,(function(e,r,t,a){return r+r+t+t+a+a}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var a=r.split(";");for(var s=0;s<a.length;s++){var i=a[s].split(":");var f=qv.util.trim(i[0]);var l=qv.util.trim(i[1]);switch(f){case"color":if(l[0]!=undefined&&l[0]==="#"){e.style.color="rgb("+t(l).r+","+t(l).g+","+t(l).b+")"}else{e.style.color=l}break;case"fontStyle":e.style.fontStyle=l;break;case"backgroundColor":e.style.backgroundColor=l;break;case"textDecoration":e.style.textDecoration=l;break;case"fontWeight":e.style.fontWeight=l;break;case"fontFamily":e.style.fontFamily=l;break;case"fontVariant":e.style.fontVariant=l;break;case"fontSize":e.style.fontSize=l.replace("px","")+"px";break;case"textAlign":e.style.textAlign=l;break;case"lineHeight":e.style.lineHeight=l;break;case"textIndent":e.style.textIndent=l;break;case"verticalAlign":e.style.verticalAlign=l;break;case"wordSpacing":e.style.wordSpacing=l;break;case"display":e.style.display=l;break;case"borderThickness":e.style.borderThickness=l;e.style.borderWidth=l+"px";break;case"borderColor":e.style.borderColor=l;break;case"borderWith":e.style.borderWith=l;break;case"borderStyle":e.style.borderStyle=l;break;case"padding":e.style.padding=l;break;case"paddingBottom":e.style.paddingBottom=l;break;case"paddingLeft":e.style.paddingLeft=l;break;case"paddingRight":e.style.paddingRight=l;break;case"paddingTop":e.style.paddingTop=l;break}}return e};OAT.GenerateFormatDateForGrid=function(e,r){r.split(" ");var t=e[0].split("-");var a="";switch(r){case"99/99/9999":a=t[1]+"/"+t[2]+"/"+t[0];break;case"99/99/99":if(t[0].length==4){t[0]=t[0].substr(t[0].length-2,2)}a=t[1]+"/"+t[2]+"/"+t[0];break;default:a=t[2]+"/"+t[1]+"/"+t[0]}return a};OAT.HideGridRow=function(e,r,t){for(var a=0;a<e.grid.rows.length;a++){if(e.grid.rows[a].cells[r].options.value.toString().trimpivot()===t.toString().trimpivot()){e.grid.rows[a].html.style.display="none";e.grid.rows[a].html.setAttribute("visibQ","tf")}}};OAT.ShowGridRow=function(e,r,t){for(var a=0;a<e.grid.rows.length;a++){if(e.grid.rows[a].cells[r].options.value.toString().trimpivot()===t.toString().trimpivot()){e.grid.rows[a].html.style.display="";e.grid.rows[a].html.setAttribute("visibQ","tt")}}};OAT.RestoreGridRow=function(e){for(var r=0;r<e.grid.rows.length;r++){e.grid.rows[r].html.style.display="";e.grid.rows[r].html.setAttribute("visibQ","tt")}for(var t=0;t<e.grid.columnsDataType.length;t++){e.grid.conditions[t].blackList=[]}};OAT.RestoreGridOrder=function(e){e.grid.sort(0,2,e.grid.columnsDataType.length-1-0);e.grid.sort(0,1,e.grid.columnsDataType.length-1-0)};OAT.RestoreGridColumns=function(e){for(var r=0;r<e.grid.columnsDataType.length;r++){e.grid.header.cells[r].html.style.display="";var t=0;var a=e.grid.columnsDataType.length-1-r;for(t=0;t<e.grid.rows.length;t++){e.grid.rows[t].cells[a].html.style.display=""}}};OAT.CreateGridRow=function(e,r,t){var a=[];var s=[];var i=[];var f=[];var l=[];for(var n=0;n<r.columnDataField.length;n++){var o=r.originalColumnDataField.indexOf(r.columnDataField[n]);a[n]=e[o];s[n]=r.rowsMetadata.columnsDataType[o];i[n]=r.rowsMetadata.forPivotCustomPicture[o];f[n]=r.rowsMetadata.forPivotCustomFormat[o];l[n]=r.columnVisible[o]}var u=r.grid.createRow(a,s,r.rowsMetadata.defaultPicture,i,r.rowsMetadata.conditionalFormatsColumns,r.rowsMetadata.formatValues,f,r.rowsMetadata.columns,null,l);if(t)u.style.visibility="collapse"};OAT.filterRows=function(e){var r={grid:e};for(var t=0;t<e.columnsDataType.length;t++){for(var a=0;a<e.conditions[t].blackList.length;a++){OAT.HideGridRow(r,t,e.conditions[t].blackList[a]);OAT.actualizeBlackList("push",e,t,e.conditions[t].blackList[a],false)}}};OAT.actualizeBlackList=function(e,r,t,a,s){if(e==="push"){if(r.conditions[t].blackList.indexOf(a)===-1)r.conditions[t].blackList.push(a)}else{var i=r.conditions[t].blackList.indexOf(a);if(i!=-1)r.conditions[t].blackList.splice(i,1)}};OAT.showPopup=function(e,r,t,a){var s=[];var i=function(){jQuery(".oat_winrect_container").css({display:"none"})};var f=r.number;if(OAT_JS.grid.gridData[r.grid.UcId].redrawHeader){var l=0;for(var n=0;n<r.grid.columns.length;n++){if(OAT_JS.grid.gridData[r.grid.UcId].columnVisible[n])l=l+1;if(r.grid.columns[n].getAttribute("dataField")==r.dataField)f=l-1}}var o=e;if(r.grid.isSD){jQuery(".oat_winrect_container").css({left:"-1500px",top:jQuery(o.currentTarget).offset().top+"px"})}else{jQuery(".oat_winrect_container").css({left:jQuery(o.currentTarget).offset().left+"px",top:jQuery(o.currentTarget).offset().top+"px"})}OAT.Dom.clear(a);s.push(a);jQuery(".oat_winrect_title").find(".winrect_title_label").remove();var u=OAT.Dom.create("label");if(r.grid.isSD){jQuery(".oat_winrect_container").addClass("oat_winrect_container_small");u.setAttribute("class","winrect_title_label winrect_title_label_small")}else{u.setAttribute("class","winrect_title_label")}var v=r.grid.columns[f].getAttribute("displayName");for(var c=0;c<r.grid.columns.length;c++){if(r.dataField==r.grid.columns[c].getAttribute("dataField")){v=r.grid.columns[c].getAttribute("displayName")}}OAT.addTextNode(u,v);jQuery(".oat_winrect_title").append(u);var d=Math.floor(Math.random()*1e4);if(!r.grid.disableColumnSort){var m=document.createElement("div");m.setAttribute("class","first_popup_subdiv");var h=OAT.Dom.radio("order");var p="pivot_order_asc"+"_"+r.grid.ContainerName+"_"+r.grid.TableDataFilds[r.number]+d;h.id=p;h.className="input_radio_popup";h.checked=r.grid.conditions[f].sort===2;OAT.Dom.attach(h,"change",(function(){}));OAT.Dom.attach(h,"click",(function(){var e=r.grid.conditions[f].sort;r.grid.sort(f,OAT.GridData.SORT_ASC,r.number);var t=r.grid.conditions[f].sort;if(qv.util.isGeneXusPreview()){if(t!=e&&e!=OAT.GridData.SORT_NONE){try{var a='<DATA event="OrderChanged" name="'+r.grid.columns[r.number].getAttribute("name")+'" displayName="'+r.grid.columns[r.number].getAttribute("displayName")+'"  order="ascending">';a=a+"</DATA>";window.external.SendText(qv.collection[OAT_JS.grid.gridData[UcId].IdForQueryViewerCollection].ControlName,a)}catch(e){}}}var s=r.container.parentNode.cellIndex;var i;if(s<0)i=r.dataField;else i=OAT_JS.grid.gridData[r.grid.UcId].columnDataField[s];self.getDataForTable(r.grid.UcId,1,r.grid.rowsPerPage,false,i,"Ascending","","");var l="i_"+this.getAttribute("id");var n=document.getElementById(l);n.textContent="radio_button_checked";var o=document.getElementById(l.replace("asc","desc"));o.textContent="radio_button_unchecked"}));m.appendChild(h);var T=OAT.Dom.create("label");T.className="first_div_label";T.htmlFor=p;var A=OAT.isIE()?"top:-10px;":"";OAT.addImageNode(T,r.grid.conditions[f].sort===2?"radio_button_checked":"radio_button_unchecked",A,"i_"+p);OAT.addTextNode(T,self.translations.GXPL_QViewerJSAscending);m.appendChild(T);m.appendChild(OAT.Dom.create("br"));var w=OAT.Dom.radio("order");var O="pivot_order_desc"+"_"+r.grid.ContainerName+"_"+r.grid.TableDataFilds[r.number]+d;w.id=O;w.className="input_radio_popup";w.checked=r.grid.conditions[f].sort===3;OAT.Dom.attach(w,"change",(function(){}));OAT.Dom.attach(w,"click",(function(){var e=r.grid.conditions[f].sort;r.grid.sort(f,OAT.GridData.SORT_DESC,r.number);var t=r.grid.conditions[f].sort;if(qv.util.isGeneXusPreview()){if(t!=e){try{var a='<DATA event="OrderChanged" name="'+r.grid.columns[r.number].getAttribute("name")+'" displayName="'+r.grid.columns[r.number].getAttribute("displayName")+'"  order="descending">';a=a+"</DATA>";window.external.SendText(qv.collection[OAT_JS.grid.gridData[UcId].IdForQueryViewerCollection].ControlName,a)}catch(e){}}}var s=r.container.parentNode.cellIndex;var i;if(s<0)i=r.dataField;else i=OAT_JS.grid.gridData[r.grid.UcId].columnDataField[s];self.getDataForTable(r.grid.UcId,1,r.grid.rowsPerPage,false,i,"Descending","","");var l="i_"+this.getAttribute("id");var n=document.getElementById(l);n.textContent="radio_button_checked";var o=document.getElementById(l.replace("desc","asc"));o.textContent="radio_button_unchecked"}));var y=OAT.Dom.create("label");y.className="first_div_label";y.htmlFor=O;OAT.addImageNode(y,r.grid.conditions[f].sort===3?"radio_button_checked":"radio_button_unchecked",A,"i_"+O);OAT.addTextNode(y,self.translations.GXPL_QViewerJSDescending);m.appendChild(w);m.appendChild(y);s.push(m);if(self.header.length>1){var _=OAT.Dom.create("hr",{});s.push(_)}}var g=OAT.Dom.create("hr",{});var b=OAT.Dom.create("div");if(r.grid.disableColumnSort){b.setAttribute("class","first_popup_subdiv")}if(r.container.parentNode.cellIndex>0){var x=document.createElement("div");x.setAttribute("class","move_item_img");OAT.Dom.attach(x,"click",(function(){var e=r.container.parentNode.cellIndex;var t=e-1;while(t>=0&&r.container.parentNode.parentNode.children[t].clientWidth==0){t=t-1}if(t==-1)return;var a=0;var s=0;var f=r.container.parentNode.parentNode.children[t].getAttribute("title_v");for(var l=0;l<r.grid.header.cells.length;l++){if(r.container.children[0].getAttribute("title_v")===r.grid.header.cells[l].value.firstChild.textContent.replace(/\u00A0/g," ")){a=l}if(f===r.grid.header.cells[l].value.firstChild.textContent.replace(/\u00A0/g," ")){s=l}}r.grid.header.cells[a].html.parentNode.insertBefore(r.grid.header.cells[a].html,r.grid.header.cells[s].html);OAT_JS.grid.gridData[r.grid.UcId].redrawHeader=true;for(var l=0;l<r.grid.rows.length;l++){r.grid.rows[l].cells[a].html.parentNode.insertBefore(r.grid.rows[l].cells[a].html,r.grid.rows[l].cells[s].html)}var n=[];for(var o=0;o<jQuery("#"+r.grid.controlName).find("thead td").length;o++){n.push(jQuery("#"+r.grid.controlName).find("thead td")[o].getAttribute("dataField"))}OAT_JS.grid.setDataFieldPosition(r.grid.UcId,n);i()}));var F=OAT.Dom.create("label");OAT.addTextNode(F,self.translations.GXPL_QViewerJSMoveColumnToLeft);F.htmlFor="move_column_to_left"+d;x.appendChild(F);OAT.Dom.append([b,x]);if(r.container.parentNode.cellIndex>=r.grid.header.cells.length-2){s.push(b)}}if(r.container.parentNode.cellIndex<r.grid.header.cells.length-1){var S=document.createElement("div");S.setAttribute("class","move_item_img");OAT.Dom.attach(S,"click",(function(){var e=r.container.parentNode.cellIndex;if(e==-1){for(var t=0;t<r.grid.html.tHead.rows[0].cells.length;t++){if(r.container.children[0].getAttribute("title_v")==r.grid.html.tHead.rows[0].cells[t].getAttribute("title_v")){e=t}}}var a=e+1;var s=r.container.parentNode.parentNode;if(r.container.parentNode.parentNode==undefined)s=r.grid.div.children[1].children[0].children[0];while(a<s.children.length-1&&s.children[a].clientWidth==0){a=a+1}if(a>=s.children.length)return;var f=0;var l=0;var n;if(r.container.parentNode.parentNode!=undefined){n=r.container.parentNode.parentNode.children[a].getAttribute("title_v")}else{n=r.grid.html.tHead.rows[0].cells[a].getAttribute("title_v")}for(var o=0;o<r.grid.header.cells.length;o++){if(r.container.children[0].getAttribute("title_v")===r.grid.header.cells[o].value.firstChild.textContent.replace(/\u00A0/g," ")){f=o}if(n===r.grid.header.cells[o].value.firstChild.textContent.replace(/\u00A0/g," ")){l=o}}r.grid.header.cells[f].html.parentNode.insertBefore(r.grid.header.cells[l].html,r.grid.header.cells[f].html);OAT_JS.grid.gridData[r.grid.UcId].redrawHeader=true;for(var o=0;o<r.grid.rows.length;o++){r.grid.rows[o].cells[f].html.parentNode.insertBefore(r.grid.rows[o].cells[l].html,r.grid.rows[o].cells[f].html)}var u=[];for(var v=0;v<jQuery("#"+r.grid.controlName).find("thead td").length;v++){u.push(jQuery("#"+r.grid.controlName).find("thead td")[v].getAttribute("dataField"))}OAT_JS.grid.setDataFieldPosition(r.grid.UcId,u);i()}));var k=OAT.Dom.create("label");OAT.addTextNode(k,self.translations.GXPL_QViewerJSMoveColumnToRight);k.htmlFor="move_column_to_right"+d;S.appendChild(k);OAT.Dom.append([b,S]);s.push(b)}if(OAT.gridStateChanged(r)){var N=OAT.Dom.create("div");var I=document.createElement("div");OAT.Dom.attach(I,"click",(function(){self.getDataForTable(r.grid.UcId,1,r.grid.rowsPerPage,true,"","","","",true);i()}));var D=OAT.Dom.create("label");OAT.addTextNode(D,self.translations.GXPL_QViewerJSRestoreDefaultView);D.htmlFor="pivot_checkbox_restoreview";I.appendChild(D);OAT.Dom.append([N,I]);s.push(N)}var E=OAT.Dom.create("div");E.setAttribute("class","last_div_popup");OAT.distinctDivs(r,E);s.push(g);s.push(E);OAT.Dom.append(s);if(r.grid.isSD){setTimeout((function(){var e=window.innerWidth;var r=jQuery(".oat_winrect_container")[0].clientWidth;if(r==0){var t=jQuery(".oat_winrect_container").length;r=jQuery(".oat_winrect_container")[t-1].clientWidth}if(r<220){r=220}var a=(e-r)/2+jQuery(window).scrollLeft();jQuery(".oat_winrect_container").css({left:a+"px",width:r+"px"})}),50)}};OAT.distinctDivs=function(e,r){var t=e.grid.columns.length-1-e.number;var a=e.container.parentNode.cellIndex;if(a>-1){t=a}else{t=e.number}var s=function(e,r,t){var a=OAT.Dom.create("div");var s=OAT.Dom.create("input");var i=OAT.Dom.create("label");OAT.addTextNode(i,e);i.htmlFor=r;OAT.addImageNode(a,t?"check_box":"check_box_outline_blank","");a.appendChild(i);return[a,s]};var i=function(r,a){var s="pop";if(r){OAT.actualizeBlackList("pop",e.grid,t,a,e.grid.serverPaging)}else{s="push";OAT.actualizeBlackList("push",e.grid,t,a,e.grid.serverPaging)}var i=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",i,{op:s,values:a});OAT.onFilteredChangedEventHandle(e,t)};var f=function(){var a=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",a,{op:"all",values:[]});OAT.onFilteredChangedEventHandle(e,t);OAT.distinctDivs(e,r)};var l=function(){var a=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",a,{op:"none",values:[]});OAT.onFilteredChangedEventHandle(e,t);OAT.distinctDivs(e,r)};var n=function(){var a=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",a,{op:"reverse",values:[]});OAT.distinctDivs(e,r);OAT.onFilteredChangedEventHandle(e,t)};var o=function(){self.getValuesForColumn(e.grid.UcId,t,this.value)};OAT.Dom.clear(r);var u=OAT.Dom.create("div");u.setAttribute("class","div_buttons_popup");var v=document.createElement("button");v.textContent=self.translations.GXPL_QViewerJSAll;v.setAttribute("class","btn");jQuery(v).click(f);var c=document.createElement("button");c.textContent=self.translations.GXPL_QViewerJSNone;c.setAttribute("class","btn");jQuery(c).click(l);var d=document.createElement("button");d.textContent=self.translations.GXPL_QViewerJSReverse;d.setAttribute("class","btn");jQuery(d).click(n);OAT.Dom.append([u,v,c,d],[r,u]);var m=OAT.Dom.create("div");m.setAttribute("class","div_filter_input");OAT.addImageNode(m,"search","");var h=document.createElement("input");h.textContent="none";h.setAttribute("class","search_input");h.setAttribute("type","text");h.setAttribute("label",self.translations.GXPL_QViewerSearch);h.setAttribute("title",self.translations.GXPL_QViewerSearch);h.setAttribute("placeholder",self.translations.GXPL_QViewerSearch);h.setAttribute("id",e.grid.UcId+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t]);jQuery(h).keyup(o);OAT.Dom.append([m,h],[r,m]);var p=OAT.Dom.create("div");var T=OAT_JS.grid.getCantDifferentValues(e.grid.UcId,t);for(var A=0;A<T;A++){var w=OAT_JS.grid.getDifferentValues(e.grid.UcId,t,A);if(w){var O=w.value;var y=w.pict_value;if(w.value=="#NuN#"||y.trimpivot()==""){y=y+" "}y=y.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(y.length>33){var _=y.substring(32,y.length).trimpivot().length>0?"...":"";y=y.substring(0,32)+_}y=y.replace(/ /g," ")+"     ";var g=w.checked;var b=s(y,"pivot_distinct_"+A,g);b[0].setAttribute("value",O);p.appendChild(b[0]);var x=g?"check_item_img":"uncheck_item_img";if(e.grid.isSD){var x=g?"check_item_img_small":"uncheck_item_img_small"}b[0].setAttribute("class",x);OAT.Dom.attach(b[0],"click",(function(){var r="check_item_img";var t="uncheck_item_img";if(e.grid.isSD){r="check_item_img_small";t="uncheck_item_img_small"}var a=!(this.getAttribute("class")===r);var s=this.getAttribute("class")===r?t:r;this.setAttribute("class",s);jQuery(this).find("i")[0].textContent=a?"check_box":"check_box_outline_blank";i(a,this.getAttribute("value"))}))}}if(OAT_JS.grid.getCantDifferentValues(e.grid.UcId,t)<=9){p.setAttribute("class","pivot_popup_auto")}else{p.setAttribute("class","pivot_popup_fix")}p.setAttribute("ucid",e.grid.UcId);p.setAttribute("columnnumber",t);p.setAttribute("id","values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t]);r.appendChild(p)};OAT.appendNewPairToPopUp=function(e,r,t,a,s,f){var l=function(e,r,t){var a=OAT.Dom.create("div");var s=OAT.Dom.create("input");var i=OAT.Dom.create("label");OAT.addTextNode(i,e);i.htmlFor=r;OAT.addImageNode(a,t?"check_box":"check_box_outline_blank","");a.appendChild(i);return[a,s]};var n=function(r,a){var s="pop";if(!r){s="push"}self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",f,{op:s,values:a});OAT.onFilteredChangedEventHandle(e,t)};var s=s;if(r=="#NuN#"){s=" "}s=s.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(s.length>33){var o=s.substring(32,s.length).trimpivot().length>0?"...":"";s=s.substring(0,32)+o}s=s.replace(/ /g," ")+"     ";var u=l(s,"pivot_distinct_"+i,a);u[0].setAttribute("value",r);var v=jQuery("#values_"+e.grid.UcId+"_"+f)[0];v.appendChild(u[0]);var c=a;var d=c?"check_item_img":"uncheck_item_img";if(e.grid.isSD){var d=c?"check_item_img_small":"uncheck_item_img_small"}u[0].setAttribute("class",d);OAT.Dom.attach(u[0],"click",(function(){var r="check_item_img";var t="uncheck_item_img";if(e.grid.isSD){r="check_item_img_small";t="uncheck_item_img_small"}var a=!(this.getAttribute("class")===r);var s=this.getAttribute("class")===r?t:r;jQuery(this).find("i")[0].textContent=a?"check_box":"check_box_outline_blank";this.setAttribute("class",s);n(a,this.getAttribute("value"))}))};OAT.removeAllPairsFromPopUp=function(e,r,t){var a="check_item_img";var s="uncheck_item_img";if(e.grid.isSD){a="check_item_img_small";s="uncheck_item_img_small"}jQuery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).find("."+a).remove();jQuery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).find("."+s).remove();jQuery(".last_div_popup ."+a).remove();jQuery(".last_div_popup ."+s).remove();if(t){jQuery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).removeClass("pivot_popup_auto");jQuery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).addClass("pivot_popup_fix")}else{jQuery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).removeClass("pivot_popup_fix");jQuery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).addClass("pivot_popup_auto")}};OAT.onFilteredChangedEventHandle=function(e,r){var t=e.dataField;var a=r;for(var s=0;s<e.grid.columns.length;s++){if(t==e.grid.columns[s].getAttribute("dataField"))a=s}return OAT_JS.grid.setFilterChangedWhenServerPagination(e.grid.UcId,e.grid.columns[a])};OAT.setClickEventHandlers=function(e,r,t,a,s,i){var f=jQuery(r).find("#span_txt_pivot")[0];if(f){jQuery(r).data("itemValue",t);jQuery(r).data("numberMorD",s);jQuery(r).data("itemInfo",i);jQuery(f).data("itemValue",t);jQuery(f).data("typeMorD",a);jQuery(f).data("numberMorD",s);jQuery(f).data("itemInfo",i);var l=e.grid.QueryViewerCollection[e.grid.IdForQueryViewerCollection];var n=true;for(var o=0;o<l.Metadata.Axes.length;o++){if(e.grid.TableDataFilds[s]==l.Metadata.Axes[o].DataField){n=l.Metadata.Axes[o].RaiseItemClick}}for(var o=0;o<l.Metadata.Data.length;o++){if(e.grid.TableDataFilds[s]==l.Metadata.Data[o].DataField){n=l.Metadata.Data[o].RaiseItemClick}}if(l.ItemClick&&n){f.onclick=function(){OAT.onClickEventHandle(e,this);if(OAT_JS.grid.gridData[e.grid.UcId].selection.Allow){OAT.onClickSelectNode(r,e)}};f.classList.add("gx-qv-clickable-element")}else if(OAT_JS.grid.gridData[e.grid.UcId].selection.Allow){f.onclick=function(){OAT.onClickSelectNode(r,e)}}}};OAT.onClickEventHandle=function(e,r){OAT.PreClickHandle(e,r)};OAT.PreClickHandle=function(e,r){OAT_JS.grid.lastCallData={self:e,elemvalue:r};if(e.grid.HideDataFilds.length){OAT_JS.grid.requestDataSynForTable(e.grid.IdForQueryViewerCollection)}else{OAT.ClickHandle(e,r)}};OAT.ClickHandle=function(e,r,t){if(e.grid.HideDataFilds.length){var a=e.grid.IdForQueryViewerCollection;var s=t;e.grid.allRowsPivot=[];e.grid.allFullRowsPivot=[];var i=s.split("<Record>");for(var f=1;f<i.length;f++){var l=[];var n=[];for(var o=0;o<e.grid.TableDataFilds.length;o++){l[o]="#NuN#";var u=i[f].split("<"+e.grid.TableDataFilds[o]+">");if(u.length>1){var v=u[1].split("</"+e.grid.TableDataFilds[o]+">");l[o]=v[0];n[o]=l[o]}else{if(i[f].indexOf("<"+e.grid.TableDataFilds[o]+"/>")>=0){l[o]="";n[o]=""}else{l[o]="#NuN#";n[o]="#NuN#"}}}e.grid.allRowsPivot.push(l);for(var o=0;o<e.grid.HideDataFilds.length;o++){var u=i[f].split("<"+e.grid.HideDataFilds[o]+">");if(u.length>1){var v=u[1].split("</"+e.grid.HideDataFilds[o]+">");n[n.length+o]=v[0]}else{if(i[f].indexOf("<"+e.grid.HideDataFilds[o]+"/>")>=0){n[n.length+o]=""}else{n[n.length+o]="#NuN#"}}}e.grid.allFullRowsPivot.push(n)}}var c=[];var d=jQuery(r).data("itemValue");var m=jQuery(r).data("typeMorD");var h=jQuery(r).data("numberMorD");var p=jQuery(r).data("itemInfo");var T=OAT.IsNodeSelected(e.cells[h].html);var A='<DATA><ITEM type="'+m+'" ';A=A+'name="'+e.grid.columns[h].getAttribute("name")+'" ';A=A+'displayName="'+e.grid.columns[h].getAttribute("displayName")+'" ';A=A+'selected="'+T.toString()+'" ';A=A+'location="rows">';A=A+d;A=A+"</ITEM>";A=A+"<CONTEXT>";A=A+"<RELATED>";for(var f=0;f<e.grid.rows[p].cells.length;f++){A=A+'<ITEM name="'+e.grid.columns[f].getAttribute("name")+'">';A=A+"<VALUES";var w=false;var O="";if(e.grid.rows[p].cells[f].options.value!="#NuN#"){O=O+"<VALUE>"+e.grid.rows[p].cells[f].options.value+"</VALUE>"}else{w=true}c.push(e.grid.rows[p].cells[f].options.value);if(w){A=A+' Null="true"'}A=A+">"+O;A=A+"</VALUES>";A=A+"</ITEM>"}if(e.grid.HideDataFilds.length){var y=function(e,r){for(var t=0;t<e.length;t++){if(e[t]!=undefined&&e[t]!=r[t]){return false}}return true};for(var _=0;_<e.grid.allFullRowsPivot.length;_++){if(y(c,e.grid.allFullRowsPivot[_])){for(var g=0;g<e.grid.HideDataFilds.length;g++){A=A+'<ITEM name="'+e.grid.OrderFildsHidden[g]+'">';A=A+"<VALUES";var w=false;var O="";if(e.grid.rows[p].cells[f].options.value!="#NuN#"){O=O+"<VALUE>"+e.grid.allFullRowsPivot[_][g+e.grid.rows[p].cells.length]+"</VALUE>"}else{w=true}if(w){A=A+' Null="true"'}A=A+">"+O;A=A+"</VALUES>";A=A+"</ITEM>"}}}}A=A+"</RELATED>";A=A+"<FILTERS>";A=A+"</FILTERS>";A=A+"</CONTEXT>";A=A+"</DATA>";var a=e.grid.IdForQueryViewerCollection;OAT_JS.grid.fireOnItemClickEvent(e.grid.QueryViewerCollection[a],A,false)};OAT.onClickSelectNode=function(e,r){var t=jQuery(e).data("itemValue");var a=jQuery(e).data("numberMorD");var s=jQuery(e).data("itemInfo");var i=OAT_JS.grid.gridData[r.grid.UcId].columnDataField.indexOf(r.grid.TableDataFilds[a]);if(OAT_JS.grid.gridData[r.grid.UcId].selection.Allow){OAT.SelectNodes(r,t,false,i,s)}};OAT.SelectNodes=function(e,r,t,a,s,i,f){if(s>=0){var l=jQuery("#"+e.grid.controlName+" tbody").find("tr")[s];if(OAT.IsNodeSelected(jQuery(l).find("td")[a])){OAT.ClearSelectedNodes(jQuery(e.grid.html));OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode=[]}else{if(!t){OAT.SetSelectedNodeBackgroundColor(jQuery(l).find("td")[a],e.grid.selection.Color,jQuery(e.grid.html));OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode=[];OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode[0]={value:r,dataField:OAT_JS.grid.gridData[e.grid.UcId].columnDataField[a],rowData:[OAT_JS.grid.gridData[e.grid.UcId].rowsData[s]],clicked:true}}else{OAT.SetNodeBackgroundColor(jQuery(l).find("td")[a],e.grid.selection.Color)}if(OAT_JS.grid.gridData[e.grid.UcId].selection.EntireLine){for(var n=0;n<e.grid.rows[s].cells.length;n++){if(n!=a){OAT.SetNodeBackgroundColor(jQuery(l).find("td")[n],OAT_JS.grid.gridData[e.grid.UcId].selection.Color)}}}}}else{if(!t)OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode[i]={value:r,dataField:OAT_JS.grid.gridData[e.grid.UcId].columnDataField[a],rowData:[],clicked:false,conditions:f};for(var o=0;o<jQuery("#"+e.grid.controlName+" tbody").find("tr").length;o++){var u=e.grid.columnsDataType[e.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[e.grid.UcId].columnDataField[a])];var v=OAT_JS.grid.gridData[e.grid.UcId].rowsData[o][e.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[e.grid.UcId].columnDataField[a])];var c=false;if(u=="real"||u=="integer"){c=parseFloat(r)==v}else{c=v.trim()==r.trim()}if(c){if(OAT.checkConditions(e,OAT_JS.grid.gridData[e.grid.UcId].rowsData[o],f)){var l=jQuery("#"+e.grid.controlName+" tbody").find("tr")[o];OAT.SetNodeBackgroundColor(jQuery(l).find("td")[a],e.grid.selection.Color,jQuery(e.grid.html));OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode[i].rowData.push(OAT_JS.grid.gridData[e.grid.UcId].rowsData[o]);if(OAT_JS.grid.gridData[e.grid.UcId].selection.EntireLine){for(var n=0;n<e.grid.rows[o].cells.length;n++){if(n!=a){OAT.SetNodeBackgroundColor(jQuery(l).find("td")[n],OAT_JS.grid.gridData[e.grid.UcId].selection.Color)}}}}}}}};OAT.checkConditions=function(e,r,t){var a=true;for(var s=0;s<t.length;s++){var i=OAT_JS.grid.gridData[e.grid.UcId].columnDataField.indexOf(t[s].DataField);var f=e.grid.columnsDataType[e.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[e.grid.UcId].columnDataField[i])];var l=true;if(f=="real"||f=="integer"){l=parseFloat(t[s].Value)==parseFloat(r[i])}else{l=t[s].Value.trim()==r[i].trim()}if(!l){return false}}return a};OAT.RedrawSelectedNode=function(e){if(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode){OAT.ClearSelectedNodes(jQuery(e.html));for(var r=0;r<OAT_JS.grid.gridData[e.UcId].selection.SelectedNode.length;r++){if(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].clicked){for(var t=0;t<OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].rowData.length;t++){var a=OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].rowData[t];for(var s=0;s<OAT_JS.grid.gridData[e.UcId].rowsData.length;s++){var i=true;for(var f=0;f<OAT_JS.grid.gridData[e.UcId].rowsData[s].length;f++){if(OAT_JS.grid.gridData[e.UcId].rowsData[s][f]!=a[f])i=false}if(i)OAT.SelectNodes({grid:e},OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].value,true,OAT_JS.grid.gridData[self.UcId].columnDataField.indexOf(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].dataField),s)}}}else{OAT.SelectNodes({grid:e},OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].value,true,OAT_JS.grid.gridData[self.UcId].columnDataField.indexOf(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].dataField),-1,r,OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].conditions)}}}};OAT.gridStateChanged=function(e){return OAT_JS.grid.getStateChange(e.grid.UcId)};OAT.createXMLDimensionInfo=function(e,r){return"<name>"+e.columns[r].getAttribute("name")+"</name> "+"<displayName>"+e.columns[r].getAttribute("displayName")+"</displayName> "+"<description>"+e.columns[r].getAttribute("description")+"</description> "+"<dataField>"+e.columns[r].getAttribute("dataField")+"</dataField> "+"<dataType>"+e.columns[r].getAttribute("dataType")+"</dataType> "+"<summarize>"+e.columns[r].getAttribute("summarize")+"</summarize> "+"<align>"+e.columns[r].getAttribute("align")+"</align> "+"<axis>"+e.columns[r].getAttribute("axis")+"</axis> "};OAT.createXMLMetadata=function(e,r,t){var a='<OLAPCube format="'+"compact"+'" thousandsSeparator="'+","+'" decimalSeparator="'+"."+'" dateFormat="'+"MDY"+'">';for(var s=0;s<=e.grid.columns.length-1;s++){var i=s;a=a+"<OLAPDimension> ";a=a+OAT.createXMLDimensionInfo(e.grid,i);var f=0;for(var l=0;l<e.grid.header.cells.length;l++){if(e.grid.header.cells[l].dataField==e.grid.columns[i].getAttribute("dataField")){f=l}}if(e.grid.header.cells[f].html.style.display=="none"){a=a+"<hidden>true</hidden>"}if(e.grid.columns[i].getAttribute("picture")===""){a=a+"<picture/> "}else{a=a+"<picture>"+e.grid.columns[i].getAttribute("picture")+"</picture> "}if(e.grid.columns[i].getAttribute("picture")===""){a=a+"<format/> "}else{a=a+"<format>"+e.grid.columns[i].getAttribute("format")+"</format> "}if(OAT_JS.grid.gridData[e.grid.UcId].dataFieldOrder==e.grid.columns[i].getAttribute("dataField")){if(OAT_JS.grid.gridData[e.grid.UcId].orderType=="Descending")a=a+"<order>descending</order> ";else a=a+"<order>ascending</order> "}else{a=a+"<order>none</order> "}a=a+"<customOrder/> ";a=a+"<include> ";var n=e.grid.columns[i].getAttribute("dataField");if(e.blackLists[n].state!="none"&&e.blackLists[n].state!="all"){for(var o=0;o<e.blackLists[n].visibles.length;o++){a=a+"<value>"+e.blackLists[n].visibles[o].trimpivot()+"</value> "}}else if(e.blackLists[n].state!="none"){for(var o=0;o<e.differentValues[n].length;o++){a=a+"<value>"+e.differentValues[n][o].trimpivot()+"</value> "}}a=a+"<value>TOTAL</value> </include> <collapse/> ";a=a+"<hide> ";var n=e.grid.columns[i].getAttribute("dataField");if(e.blackLists[n].state!="none"&&e.blackLists[n].state!="all"){for(var o=0;o<e.blackLists[n].hiddens.length;o++){a=a+"<value>"+e.blackLists[n].hiddens[o].trimpivot()+"</value> "}}else if(e.blackLists[n].state!="all"){for(var o=0;o<e.differentValues[n].length;o++){a=a+"<value>"+e.differentValues[n][o].trimpivot()+"</value> "}}a=a+"</hide> ";var u=e.grid.columnsDataType.length-1-i;try{if(e.grid.header.cells[u]!=undefined){if(e.grid.header.cells[u].html.style.display===""){a=a+"<condition>table</condition> ";a=a+"<filterbar>no</filterbar> "}else{a=a+"<condition>none</condition> ";a=a+"<filterbar>yes</filterbar> "}}}catch(e){}var v=0;var c=false;var d=-1;for(var m=0;e.columnDataField&&m<e.columnDataField.length&&!c;m++){var h=e.columnDataField[m];var p=false;for(var T=0;T<e.grid.columns.length;T++){if(h==e.grid.columns[T].getAttribute("dataField"))p=e.grid.columns[T].getAttribute("visible").toLowerCase()=="never"}if(!p)v=v+1;if(h==e.grid.columns[i].getAttribute("dataField")){c=true;if(!p)d=v}}if(d>0)a=a+"<position>"+d+"</position> ";else a=a+"<position/>";a=a+"<restoreview>no</restoreview> ";a=a+" </OLAPDimension>"}a=a+"</OLAPCube>";return a};OAT.ExportToPdf=function(e,r){var t=[];for(var a=0;a<1;a++){var s=jQuery("#"+e.grid.controlName+" tr")[a];for(var i=0;i<s.children.length;i++){if(s.children[i].style.display=="none"){t.push(i)}}}var f=20+jQuery("#"+e.grid.controlName+" tr").length*30+5;if(f<841){f=841}var l=0;var s=jQuery("#"+e.grid.controlName+" tr")[0].children.length-t.length;l=20+s*(30+65)+5;if(l<595){l=595}var n=[];for(var a=0;a<jQuery("#"+e.grid.controlName+" tr").length;a++){var s=jQuery("#"+e.grid.controlName+" tr")[a];var o=0;for(var i=0;i<s.children.length;i++){var u=s.children[i].textContent;var v=s.children[i].getAttribute("hidden");if(s.children[i].style.display!="none"){if(v===null){if(n[o]==undefined){n[o]=30}var c=0;for(var d=0;d<u.length;d++){if(u.charCodeAt(d)>1e3){c++}}if(c===0){if(u.length>14){if(u.length*1.68>n[o]){n[o]=u.length*1.68}}}else{var m=c*2.8+(u.length-c)*1.68;if(m>n[o]){n[o]=m}}o=o+1}}}}var h=0;for(var a=0;a<n.length;a++){h=h+n[a]*2.5+65}h=20+h+5;if(h>l){l=h}var p=function(e,r){var t=0;for(var a=0;a<e;a++){t=t+r[a]}return t};var T;if(l<=f){T=new jsPDF("portrait","mm","a4",false,l,792)}else{T=new jsPDF("landscape","mm","a4",false,l,792)}T.setFontSize(8);T.line(18,13,20+p(jQuery("#"+e.grid.controlName+" tr")[0].children.length-t.length,n),13);var A=-1;var w=1;var O=Math.min(jQuery("#"+e.grid.controlName+" tr").length-(w-1)*26,26);for(var a=0;a<jQuery("#"+e.grid.controlName+" tr").length;a++){A++;var s=jQuery("#"+e.grid.controlName+" tr")[a];var o=0;for(var i=0;i<s.children.length;i++){if(s.children[i].style.display!="none"){T.line(18+p(o,n),13,18+p(o,n),23+(O-1)*10);var u=OAT.removeIconFont(s.children[i].textContent);var v=s.children[i].getAttribute("hidden");var y=[];if(u.charCodeAt(0)>1e3){for(var _=0;_<u.length;_++){y[_]=OAT.getCharacterImg(u.charCodeAt(_))}}else{var g=-1;for(var d=1;d<u.length;d++){if(u.charCodeAt(d)>1e3){g=d;break}}if(g>0){var b=u.substring(0,g);var x=0;for(var _=g;_<u.length;_++){y[x]=OAT.getCharacterImg(u.charCodeAt(_));x++}u=b}}var F=false;T.setTextColor(0,0,0);T.setFontStyle("normal");var S=!isNaN(parseFloat(u));var k=T.getStringUnitWidth(u);if(s.children[i].getAttribute("style")!=undefined&&s.children[i].getAttribute("style")!=null){var N=s.children[i].getAttribute("style").split(";");for(var I=0;I<N.length;I++){var D=N[I].split(":");if(D[0].replace(/^\s+|\s+$/g,"")==="color"){var E=D[1].replace(/^\s+|\s+$/g,"");E=E.substring(4,E.length);E=E.substring(0,E.length-1);T.setTextColor(parseInt(E.split(",")[0]),parseInt(E.split(",")[1]),parseInt(E.split(",")[2]))}else if(D[0].replace(/^\s+|\s+$/g,"")==="text-align"){S=D[1].replace(/^\s+|\s+$/g,"")=="right"}else if(D[0].replace(/^\s+|\s+$/g,"")==="font-style"){T.setFontStyle("italic")}else if(D[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(D[1].replace(/^\s+|\s+$/g,"")==="bold"){T.setFontStyle("bold")}}else if(D[0].replace(/^\s+|\s+$/g,"")==="background-color"){var E=D[1].replace(/^\s+|\s+$/g,"");E=E.substring(4,E.length);E=E.substring(0,E.length-1);T.setFillColor(parseInt(E.split(",")[0]),parseInt(E.split(",")[1]),parseInt(E.split(",")[2]));F=true}else if(D[0].replace(/^\s+|\s+$/g,"")==="border-color"){var E=D[1].replace(/^\s+|\s+$/g,"");E=E.substring(4,E.length);E=E.substring(0,E.length-1);T.setDrawColor(parseInt(E.split(",")[0]),parseInt(E.split(",")[1]),parseInt(E.split(",")[2]))}}}if(F&&i==s.children.length-1){T.rect(18+p(o,n),23+(A-1)*10,32,10,"FD")}else if(F){T.rect(18+p(o,n),23+(A-1)*10,30,10,"FD")}T.setDrawColor(0,0,0);T.setFontSize(8);if(v===null){var C=0;if(u.charCodeAt(0)<1e3){C=u.length+2;if(S){T.text(20+p(o+1,n)-k*3-4,20+A*10,u)}else{T.text(20+p(o,n),20+A*10,u)}}if(y.length>0){for(var _=0;_<y.length;_++){T.addImage(y[_],"JPEG",20+p(o,n)+C+_*2.5,20+A*10-2.5,2.5,2.5)}}}o=o+1}}T.line(20+p(s.children.length-t.length,n),13,20+p(s.children.length-t.length,n),23+(O-1)*10);T.line(18,23+A*10,20+p(s.children.length-t.length,n),23+A*10);if(A>=25){T.setDrawColor(0,0,0);w++;O=Math.min(jQuery("#"+e.grid.controlName+" tr").length-1-(w-1)*26+1,26);A=-1;T.addPage();T.line(18,13,20+p(jQuery("#"+e.grid.controlName+" tr")[0].children.length-t.length,n),13)}}isSD=OAT.isSD();if(OAT.isSafari()||isSD){T.output("dataurlnewwindow")}else{T.save(r+".pdf")}};OAT.ExportToExcel=function(e,r){var t="<table><tbody>";for(var a=0;a<jQuery("#"+e.grid.controlName+" tr").length;a++){t=t+"<tr>";var s=jQuery("#"+e.grid.controlName+" tr")[a];for(var i=0;i<s.children.length;i++){var f;if(a===0){f=s.children[i].getAttribute("title_v");if(f===undefined){f=OAT.removeIconFont(s.children[i].textContent).trim()}}else{f=s.children[i].getAttribute("title");if(f===undefined){f=s.children[i].textContent}}f=f.replace(/\u00A0/g," ");var l=s.children[i].getAttribute("hidden");if(s.children[i].style.display!="none"){if(l===null){var n=s.children[i].getAttribute("rowspan");var o=s.children[i].getAttribute("colspan");var u="";if(s.children[i].getAttribute("style")!=undefined&&s.children[i].getAttribute("style")!=null){u=' style="'+s.children[i].getAttribute("style")+'" '}if(n===null&&o===null){t=t+"<td "+u+">"+f+"</td>"}else if(o===null){t=t+"<td "+u+' rowspan="'+n+'">'+f+"</td>"}else if(n===null){t=t+"<td "+u+' colspan="'+o+'">'+f+"</td>"}else{t=t+"<td "+u+' colspan="'+o+'" rowspan="'+n+'">'+f+"</td>"}}}}t=t+"</tr>"}t=t+"</tbody></table>";var v='<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></head><body>';t=v+t+"</body>";var c=t;isSD=OAT.isSD();if(OAT.isSafari()||isSD){window.open("data:application/vnd.ms-excel,"+encodeURIComponent(c))}else{return c}};OAT.ExportToExcel2010=function(e,r,t,a,s){function i(e){var r=e.toString(16);return r.length==1?"0"+r:r}function f(e,r,t){return i(e)+i(r)+i(t)}dataTable=[];var l=jQuery("#"+e.grid.controlName+" tr").length;if(t!=undefined&&t){l=1}var n=[];for(var o=0;o<l;o++){dataRow=[];var u=jQuery("#"+e.grid.controlName+" tr")[o];for(var v=0;v<u.children.length;v++){var c=u.children[v].textContent;var d=u.children[v].getAttribute("hidden");if(u.children[v].style.display!="none"){if(d===null){var m=u.children[v].getAttribute("rowspan");var h=u.children[v].getAttribute("colspan");var p={value:c};if(u.children[v].getAttribute("style")!=undefined&&u.children[v].getAttribute("style")!=null){var T=u.children[v].getAttribute("style").split(";");for(var A=0;A<T.length;A++){var w=T[A].split(":");if(w[0].replace(/^\s+|\s+$/g,"")==="color"){var O=w[1].replace(/^\s+|\s+$/g,"");O=O.substring(4,O.length);O=O.substring(0,O.length-1);var y=f(parseInt(O.split(",")[0]),parseInt(O.split(",")[1]),parseInt(O.split(",")[2]));p.fontColor=y}else if(w[0].replace(/^\s+|\s+$/g,"")==="text-align"){var _=w[1].replace(/^\s+|\s+$/g,"");p.hAlign=_}else if(w[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(w[1].replace(/^\s+|\s+$/g,"")==="italic"){p.italic=1}}else if(w[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(w[1].replace(/^\s+|\s+$/g,"")==="bold"){p.bold=1}}else if(w[0].replace(/^\s+|\s+$/g,"")==="background-color"){var O=w[1].replace(/^\s+|\s+$/g,"");O=O.substring(4,O.length);O=O.substring(0,O.length-1);var y=f(parseInt(O.split(",")[0]),parseInt(O.split(",")[1]),parseInt(O.split(",")[2]));p.fill=y}}}if(m===null&&h===null){dataRow.push(p)}else if(h===null){p.rowSpan=parseInt(m);dataRow.push(p)}else if(m===null){p.colSpan=parseInt(h);dataRow.push(p)}else{p.colSpan=parseInt(h);p.rowSpan=parseInt(m);dataRow.push(p)}}}else{n.push(v)}}dataTable.push(dataRow)}if(t!=undefined&&t){for(var o=0;o<a.length;o++){dataRow=[];for(var v=0;v<a[o].length;v++){if(n.indexOf(v)==-1){var c=OAT.ApplyPictureValue(a[o][v],"",OAT_JS.grid.gridData[s].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v]);var g=OAT.Dom.create("td");g.setAttribute("title",c);var b=a[o][v];if(e.grid.columnsDataType[v]=="date"){b=OAT.ApplyPictureValue(a[o][v],e.grid.columnsDataType[v],OAT_JS.grid.gridData[s].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v])}g=OAT.applyFormatValues(g,b,e.grid.columnsDataType,v,OAT_JS.grid.gridData[s].rowsMetadata.formatValues,OAT_JS.grid.gridData[s].rowsMetadata.conditionalFormatsColumns,OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomFormat);if(e.grid.columnsDataType[v]!="character"&&e.grid.columnsDataType[v]!="guid"||e.grid.columnsDataType[v]==="date"){g.style.textAlign="right"}var p={value:c};if(!isNaN(parseFloat(c))&&e.grid.columnsDataType[v]!="character"&&e.grid.columnsDataType[v]!="date"&&e.grid.columnsDataType[v]!="datetime"&&e.grid.columnsDataType[v]!="guid"){p={value:parseFloat(c)+""}}if(g.getAttribute("style")!=undefined&&g.getAttribute("style")!=null){var T=g.getAttribute("style").split(";");for(var A=0;A<T.length;A++){var w=T[A].split(":");if(w[0].replace(/^\s+|\s+$/g,"")==="color"){var O=w[1].replace(/^\s+|\s+$/g,"");O=O.substring(4,O.length);O=O.substring(0,O.length-1);var y=f(parseInt(O.split(",")[0]),parseInt(O.split(",")[1]),parseInt(O.split(",")[2]));p.fontColor=y}else if(w[0].replace(/^\s+|\s+$/g,"")==="text-align"){var _=w[1].replace(/^\s+|\s+$/g,"");p.hAlign=_}else if(w[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(w[1].replace(/^\s+|\s+$/g,"")==="italic"){p.italic=1}}else if(w[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(w[1].replace(/^\s+|\s+$/g,"")==="bold"){p.bold=1}}else if(w[0].replace(/^\s+|\s+$/g,"")==="background-color"){var O=w[1].replace(/^\s+|\s+$/g,"");O=O.substring(4,O.length);O=O.substring(0,O.length-1);var y=f(parseInt(O.split(",")[0]),parseInt(O.split(",")[1]),parseInt(O.split(",")[2]));p.fill=y}}}if(e.grid.columnsDataType[v]=="real"||e.grid.columnsDataType[v]=="integer"){p.formatCode=OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v].replace(/Z/g,"#").replace(/9/g,"0")}if(e.grid.columnsDataType[v]=="date"){if(OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v]!=undefined){var x=OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v].trim();var F=OAT_JS.grid.gridData[s].rowsMetadata.defaultPicture.getAttribute("dateFormat");if(x=="99/99/99"){p.formatCode="mm/dd/yy";if(F=="DMY")p.formatCode="dd/mm/yy";if(F=="YMD")p.formatCode="yy/mm/dd"}if(x=="99/99/9999"){p.formatCode="mm/dd/yyyy";if(F=="DMY")p.formatCode="dd/mm/yyyy";if(F=="YMD")p.formatCode="yyyy/mm/dd"}if(x=="9999/99/99"){p.formatCode="yyyy/mm/dd";if(F=="YDM")p.formatCode="yyyy/dd/mm";if(F=="YMD")p.formatCode="yyyy/mm/dd"}}}if(e.grid.columnsDataType[v]=="datetime"){if(OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v]!=undefined){var x=OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v].trim().split(" ");var S=OAT_JS.grid.gridData[s].rowsMetadata.defaultPicture.getAttribute("dateFormat");if(x[0]=="99/99/99"){if(S=="DMY")p.formatCode="dd/mm/yy";if(S=="YMD")p.formatCode="yy/mm/dd"}if(x[0]=="99/99/9999"){if(S=="DMY")p.formatCode="dd/mm/yyyy";if(S=="YMD")p.formatCode="yyyy/mm/dd"}if(x[0]=="9999/99/99"){if(S=="YDM")p.formatCode="yyyy/dd/mm";if(S=="YMD")p.formatCode="yyyy/mm/dd"}}}p.genexusType=e.grid.columnsDataType[v];p.genexusPicture=OAT_JS.grid.gridData[s].rowsMetadata.forPivotCustomPicture[v];dataRow.push(p)}}dataTable.push(dataRow)}}var k=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:false,worksheets:[{data:dataTable,name:"Sheet 1"}]});isSD=OAT.isSD();if(OAT.isSafari()||isSD){window.location=k.href()}else{var N=atob(k.base64);function C(e){return e.charCodeAt(0)}var I=Array.prototype.map.call(N,C);var D=new Uint8Array(I);var E=new Blob([D],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(E,r+".xlsx")}};OAT.ExportToXML=function(e,r){var t=[];for(var a=0;a<1;a++){var s=jQuery("#"+e.grid.controlName+" tr")[a];for(var i=0;i<s.children.length;i++){if(s.children[i].style.display=="none"){t.push(i)}}}var f='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><EXPORT format="XML" type="flat">';f=f+"<METADATA>";for(var l=0;l<e.grid.columns.length;l++){if(t.indexOf(l)==-1){var n="row";f=f+"<OLAPDimension ";f=f+'name="'+e.grid.columns[l].getAttribute("dataField")+'" ';f=f+'label="'+e.grid.columns[l].getAttribute("displayName")+'" ';f=f+'picture="'+e.grid.columns[l].getAttribute("picture")+'" ';f=f+'datatype="'+e.grid.columns[l].getAttribute("dataType")+'" ';f=f+'showAll="false" ';f=f+'position="'+n+'">';var o=[];for(var a=0;a<e.grid.rows.length;a++){if(o.findIndex(e.grid.rows[a].cells[l].options.value)===-1){f=f+"<VALUE CHECKED=";if(e.grid.conditions[l].blackList.findIndex(e.grid.rows[a].cells[l].options.value)===-1){o.push(e.grid.rows[a].cells[l].options.value);f=f+'"true"'}else{f=f+'"false"'}f=f+' COLLAPSED="false">';var u=e.grid.rows[a].cells[l].options.value;if(!isNaN(parseFloat(e.grid.rows[a].cells[l].options.value))){if(data!=undefined){for(var v=0;v<data.length;v++){if(data[v]!=undefined){for(var c=0;c<data[v].length;c++){if(parseFloat(data[v][c])!=undefined&&!isNaN(data[v][c])){if(parseFloat(data[v][c])===parseFloat(e.grid.rows[a].cells[l].options.value)){u=data[v][c]}}}}}}}f=f+u+"</VALUE>"}}f=f+"</OLAPDimension>"}}for(var l=0;l<measures.length;l++){f=f+"<OLAPMeasure ";f=f+'name="'+measures[l].getAttribute("dataField")+'" ';f=f+'label="'+measures[l].getAttribute("displayName")+'" ';f=f+'picture="'+measures[l].getAttribute("picture")+'" ';f=f+'datatype="'+measures[l].getAttribute("dataType")+'" ';f=f+'showAll="true" ';f=f+'aggregator="sum"/>'}f=f+"</METADATA>";f=f+"<FLATDATA>";if(data!=undefined){for(var a=0;a<data.length;a++){f=f+"<ROW ";for(var l=0;l<data[0].length;l++){if(t.indexOf(l)==-1){var u=data[a][l];f=f+e.grid.columns[l].getAttribute("dataField")+'="'+u+'" '}}f=f+"/>"}}else{for(var a=0;a<e.grid.rows.length;a++){f=f+"<ROW ";for(var l=0;l<e.grid.rows[0].cells.length;l++){var u="";u=e.grid.rows[a].cells[l].options.value;if(!isNaN(parseFloat(e.grid.rows[a].cells[l].options.value))){if(data!=undefined){for(var v=0;v<data.length;v++){if(data[v]!=undefined){for(var c=0;c<data[v].length;c++){if(parseFloat(data[v][c])!=undefined&&!isNaN(data[v][c])){if(parseFloat(data[v][c])===parseFloat(e.grid.rows[a].cells[l].options.value)){u=data[v][c]}}}}}}}f=f+e.grid.columns[l].getAttribute("dataField")+'="'+u+'" '}f=f+"/>"}}f=f+"</FLATDATA>";f=f+"<HTML>";f=f+"<HEAD>";f=f+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';f=f+"<STYLE>";f=f+".odd {background-color: #FEFEFE; font-family: Verdana; font-size: 10pt;}\n";f=f+".event {background-color: #EBEBEB; font-family: Verdana; font-size: 10pt;}\n";f=f+".even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\n";f=f+"tr {border-left: 1px solid #BBBBBB; border-right: 1px solid #BBBBBB; line-height: 22px;}\n";f=f+"table {border-collapse: collapse;}\n";f=f+"</STYLE>";f=f+"</HEAD>";f=f+"<BODY>";for(var a=0;a<jQuery("#"+e.grid.controlName+" tr").length;a++){f=f+"<TR>";var s=jQuery("#"+e.grid.controlName+" tr")[a];for(var i=0;i<s.children.length;i++){var d=OAT.removeIconFont(s.children[i].textContent).trim();var m=s.children[i].getAttribute("hidden");if(s.children[i].style.display!="none"){if(m===null){var h=s.children[i].getAttribute("rowspan");var p=s.children[i].getAttribute("colspan");var T="";if(s.children[i].getAttribute("style")!=undefined&&s.children[i].getAttribute("style")!=null){T=' style="'+s.children[i].getAttribute("style")+'" '}var A="";if(s.getAttribute("class")!=undefined&&s.getAttribute("class")!=null){A=' class="'+s.getAttribute("class")+'" '}if(h===null&&p===null){f=f+"<TD "+A+" "+T+" >"+d+"</TD>"}else if(p===null){f=f+"<TD "+A+" "+T+' rowspan="'+h+'">'+d+"</TD>"}else if(h===null){f=f+"<TD "+A+" "+T+' colspan="'+p+'">'+d+"</TD>"}else{f=f+"<TD "+A+" "+T+' colspan="'+p+'" rowspan="'+h+'">'+d+"</TD>"}}}}f=f+"</TR>"}f=f+"</BODY>";f=f+"</HTML>";f=f+"</EXPORT>";var w=OAT.isSD();f=f.replace(/\&/g,"&amp;");if(OAT.isSafari()||w){window.open("data:text/xml,"+encodeURIComponent(f))}else{var O=new Blob([f],{type:"text/xml"});saveAs(O,r+".xml")}};OAT.SaveStateWhenServerPaging=function(e,r){localStorage.setItem(OAT.getURL()+e.grid.controlName+e.grid.query,JSON.stringify({pageSize:e.rowsPerPage,dataFieldOrder:e.dataFieldOrder,orderType:e.orderType,filters:e.filterInfo,blackLists:e.blackLists,columnVisible:e.columnVisible,columnDataField:e.columnDataField}))};OAT.getStateWhenServingPaging=function(e,r){return JSON.parse(localStorage.getItem(OAT.getURL()+e+r))};OAT.getState=function(grid,actualPageSize){if(typeof JSON.retrocycle!=="function"){JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function rez(value){var i,item,name,path;if(value&&typeof value==="object"){if(Object.prototype.toString.apply(value)==="[object Array]"){for(i=0;i<value.length;i+=1){item=value[i];if(item&&typeof item==="object"){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[i]=eval(path)}else{rez(item)}}}}else{for(name in value){if(typeof value[name]==="object"){item=value[name];if(item){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[name]=eval(path)}else{rez(item)}}}}}}})($);return $}}var retrievedObject=localStorage.getItem(OAT.getURL()+grid.controlName+grid.query);var oldState=JSON.retrocycle(JSON.parse(retrievedObject));if(oldState!=null&&oldState.rowsPerPage+" "==actualPageSize+" "){for(var tC=0;tC<grid.columnsDataType.length;tC++){grid.header.cells[tC].html.style.display=oldState.columnDisplay[tC];var numCol=grid.columnsDataType.length-1-tC;var j=0;for(j=0;j<grid.rows.length;j++){grid.rows[j].cells[numCol].html.style.display=oldState.columnDisplay[tC]}}grid.conditions=oldState.conditions;grid.rowsPerPage=oldState.rowsPerPage;return true}else return false};OAT.SaveMetadata=function(e,r){try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+r);localStorage.setItem(OAT.getURL()+r,e)}}catch(e){}};OAT.GetSavedMetadata=function(e){try{if(localStorage.getItem(OAT.getURL()+e)!=null){var r=localStorage.getItem(OAT.getURL()+e);if(r!=undefined&&r!=null){return r}}}catch(e){return""}return""};try{OAT.Loader.featureLoaded("grid")}catch(e){}commonjsGlobal.contains=function(e,r){for(var t=0;t<e.length;t++){if(e[t]===r){return t}}return-1};{Object.defineProperty(exports,"__esModule",{value:true});exports.renderJSPivot=void 0;exports.setPageDataForPivotTable=void 0;exports.setAttributeValuesForPivotTable=void 0;exports.setPivottableDataCalculation=void 0;exports.setDataSynForPivotTable=void 0;exports.setPageDataForTable=void 0;exports.setAttributeForTable=void 0;exports.setDataSynForTable=void 0;exports.getDataXML=void 0;exports.getFilteredDataXML=void 0}function renderJSPivot(e,r,t,a){if(e.RealType!="Table"){e.ServerPaging=false}if(e.RealType=="Table"){e.ServerPagingPivot=false;if(qv.collection[e.UcId].AutoRefreshGroup==""){jQuery(".oat_winrect_container").remove()}}if(e.RememberLayout&&e.ServerPaging&&e.RealType!="PivotTable"){var s=OAT.getStateWhenServingPaging(e.UcId+"_"+e.ObjectName.replace(/\./g,""),e.ObjectName.replace(/\./g,""));if(!s){renderJSPivotInter(e,r,t,null,a)}else{if(s.pageSize==""){s.pageSize=undefined}e.previousDataFieldOrder=s.dataFieldOrder;e.orderType=s.orderType;renderJSPivotInter(e,r,t,s,a)}}else{if(e.RealType!="Table"){renderJSPivotInter(e,r,t,null,a)}else{e.customFilterInfo="";var i=jQuery.parseXML(e.metadata);var f=i.getElementsByTagName("OLAPDimension");var l=false;for(var n=0;n<f.length;n++){f[n].getAttribute("dataField");var o=[];var u=false;for(var v=0;v<f[n].childNodes.length;v++){if(f[n].childNodes[v]!=undefined&&f[n].childNodes[v].localName!=undefined&&f[n].childNodes[v].localName==="include"){u=true;for(var c=0;c<f[n].childNodes[v].childNodes.length;c++){if(f[n].childNodes[v].childNodes[c].localName!=null&&f[n].childNodes[v].childNodes[c].localName.toLowerCase()==="value"){o.push(f[n].childNodes[v].childNodes[c].textContent)}}}}if(!l){if(f[n].getAttribute("order")!=undefined&&f[n].getAttribute("order")!=""){f[n].getAttribute("dataField");f[n].getAttribute("order")=="descending"?"Descending":"Ascending";l=true}}if(u){var d=r[e.UcId].getAttributeValuesSync([f[n].getAttribute("dataField"),1,0,""]);var d=JSON.parse(d);var m=d.NotNullValues;var h=[];for(var p=0;p<o.length;p++){for(var v=0;v<m.length;v++){if(m[v].trimpivot()==o[p].trimpivot()){h.push(m[v]);break}}}if(e.customFilterInfo==""){e.customFilterInfo=[]}var T={DataField:f[n].getAttribute("dataField"),NotNullValues:{DefaultAction:"Exclude",Excluded:"",Included:h},NullIncluded:true};e.customFilterInfo.push(T)}}renderJSPivotInter(e,r,t,null,a)}}}{exports.renderJSPivot=renderJSPivot}function setPageDataForPivotTable(e,r){e.setPageDataForPivotTable(r)}{exports.setPageDataForPivotTable=setPageDataForPivotTable}function setAttributeValuesForPivotTable(e,r){e.setAttributeValuesForPivotTable(r)}{exports.setAttributeValuesForPivotTable=setAttributeValuesForPivotTable}function setPivottableDataCalculation(e,r){e.setPivottableDataCalculation(r)}{exports.setPivottableDataCalculation=setPivottableDataCalculation}function setDataSynForPivotTable(e,r){e.setDataSynForPivotTable(r)}{exports.setDataSynForPivotTable=setDataSynForPivotTable}function setPageDataForTable(e,r){e.setPageDataForTable(r)}{exports.setPageDataForTable=setPageDataForTable}function setAttributeForTable(e,r){e.setAttributeForTable(r)}{exports.setAttributeForTable=setAttributeForTable}function setDataSynForTable(e,r){e.setDataSynForTable(r)}{exports.setDataSynForTable=setDataSynForTable}function getDataXML(e,r){result=e.getDataXML(r);return result}{exports.getDataXML=getDataXML}function getFilteredDataXML(e,r){result=e.getFilteredDataXML(r);return result}{exports.getFilteredDataXML=getFilteredDataXML}var renderJSPivotInter=function(e,r,t,a,s){var i=e.RealType;var f=e.container;var l=e.page;var n=e.content;var o=e.metadata;this.dataString=e.data;var u=e.ObjectName;var v=e.ControlName;var c=parseInt(e.PageSize);var d=e.AutoResize;var m=e.DisableColumnSort;var h=e.UcId;var p=e.RememberLayout;this.pivotParams=e;this.serverPaging=e.ServerPaging;this.previousDataFieldOrder=e.previousDataFieldOrder;this.previousOrderType=e.orderType;this.previousFilters=a?a.filters:undefined;this.previousColumnVisible=a?a.columnVisible:undefined;this.initialColumnVisible=[];this.previousState=a;this.customFilterInfo=e.customFilterInfo;this.gridCacheSize=e.ServerPagingCacheSize;this.hasShowValuesAs=e.metadata.indexOf("showValuesAs")>0;if(e.RealType=="Table"){o=o.replace(/\<OLAPMeasure/g,'<OLAPMeasure axis="" isMeasure="true" ');o=o.replace(/OLAPMeasure/g,"OLAPDimension")}if(e.RealType!="Table"){var T=o.split("<OLAPMeasure");var A=T[0];for(var w=1;w<T.length;w++){var O="";if(T[w].indexOf('isComponent="true"')>-1){O="<OLAPDimension"+T[w].replace(/OLAPMeasure/g,"OLAPDimension")}else{O="<OLAPMeasure"+T[w]}A=A+O}o=A}var y=e.ShowDataLabelsIn=="Rows";if(p==undefined||p=="false"){p=false}try{if(p){var _=OAT.GetSavedMetadata(f.id+u+h+v+i+"metadata");if(_===""){OAT.SaveMetadata(o,f.id+u+h+v+i+"metadata")}else{var g=_.split("OLAPDimension").length===o.split("OLAPDimension").length;var b=_.split("OLAPMeasure").length===o.split("OLAPMeasure").length;var x=_.split("name").length===o.split("name").length;var F=true;if(g&&b&&x){for(var S=1;S<_.split("name").length;S++){var k=_.split("name")[S].substring(2,_.split("name")[S].length).split('"')[0];var N=o.split("name")[S].substring(2,o.split("name")[S].length).split('"')[0];if(k!=N){F=false}}}if(!(g&&b&&x&&F)){if(OAT.isIE()){p=false}else{try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+f.id+u+h+v+i+"metadata");localStorage.removeItem(OAT.getURL()+u+h)}}catch(e){}}}}}}catch(e){}var I=jQuery.parseXML(o);this.InitMetadata={};this.InitMetadata.Metadata=o;this.InitMetadata.DataString=dataString;this.InitMetadata.Dimensions=[];this.InitMetadata.Conditions=[];this.InitMetadata.DataFields=[];this.InitMetadata.RowsPerPage=c;var D=I.getElementsByTagName("OLAPDimension");for(var S=0;S<D.length;S++){var E={};E.name=D[S].getAttribute("name");E.displayName=D[S].getAttribute("displayName");E.description=D[S].getAttribute("description");E.dataField=D[S].getAttribute("dataField");var C="";var P=D[S].getAttribute("visible");if(P=="Never"){E.defaultPosition="hidden";E.Visible=false}else{if(P=="No"){E.Visible=false}else{E.Visible=true}E.defaultPosition=D[S].getAttribute("axis");var j=0;C=D[S].getAttribute("canDragToPages")=="true"?"filters;":"";C=C+"rows;columns;hidden"}E.validPosition=C;this.InitMetadata.Dimensions.push(E);this.InitMetadata.Conditions.push("");this.InitMetadata.DataFields.push(E.dataField)}this.InitMetadata.Measures=[];var Q=I.getElementsByTagName("OLAPMeasure");for(var S=0;S<Q.length;S++){var R={};R.name=Q[S].attributes.getNamedItem("name").nodeValue;R.displayName=Q[S].attributes.getNamedItem("displayName").nodeValue;R.dataField=Q[S].attributes.getNamedItem("dataField").nodeValue;R.dataType=Q[S].attributes.getNamedItem("dataType").nodeValue;R.Visible=Q[S].attributes.getNamedItem("visible").nodeValue.toLowerCase()=="yes";if(Q[S].attributes.getNamedItem("visible").nodeValue.toLowerCase()!="never"){R.defaultPosition=Q[S].attributes.getNamedItem("axis")?Q[S].attributes.getNamedItem("axis"):"data";R.validPosition="data;hidden"}else{R.defaultPosition="hidden";R.validPosition="hidden"}this.InitMetadata.Measures.push(R)}this.InitMetadata.DimensionPosition=[];this.HideDataFilds=[];var q;var M=OATgetState(u,h.replace(/,/g,"").replace(/\./g,""));if(p&&M!=undefined){var L=[];for(var S=0;S<M.Dimensions.length;S++){if(!M.Dimensions[S].Visible){L.push(M.Dimensions[S].dataField)}}var V=[];for(var S=0;S<M.Measures.length;S++){if(!M.Measures[S].Visible){V.push(M.Measures[S].dataField)}}this.InitMetadata.Measures=M.Measures;this.InitMetadata.Dimensions=M.Dimensions;this.InitMetadata.DataFields=M.DataFields;this.InitMetadata.DimensionPosition=M.DimensionPosition;if(e.ServerPagingPivot){this.InitMetadata.Conditions=M.Conditions}q=OATParseMetadata(o,L,V,e.ServerPagingPivot,t)}else{var L=[];for(var S=0;S<this.InitMetadata.Dimensions.length;S++){if(!this.InitMetadata.Dimensions[S].Visible){L.push(this.InitMetadata.Dimensions[S].dataField)}}var V=[];for(var S=0;S<this.InitMetadata.Measures.length;S++){if(!this.InitMetadata.Measures[S].Visible){V.push(this.InitMetadata.Measures[S].dataField)}}if(e.RealType=="Table"){q=OATParseMetadata(o,[],V,e.ServerPagingPivot,t)}else{q=OATParseMetadata(o,L,V,e.ServerPagingPivot,t)}}this.InitMetadata.GrandTotalVisibility={TotalForRows:e.TotalForRows,TotalForColumns:e.TotalForColumns};o=q[0];var B=q[1];var J=q[3];this.HideDataFilds=q[2];var U=jQuery.parseXML(o);var z=U.childNodes[0];this.IdForQueryViewerCollection=h;h=h.replace(/,/g,"").replace(/\./g,"");this.UcId=h;this.pivotDiv=f.id;this.query=u;this.control=v;this.pageSize=c;this.autoResize=d;this.disableColumnSort=m;this.header=[];this.data=[];this.columnNumbers=[];this.rowNumbers=[];this.filterNumbers=[];this.cols=0;this.conditionalFormats=[];this.conditionalFormatsColumns=[];this.formatValues=[];this.formatValuesMeasures=[];this.forPivotFormatValues=[];this.forPivotFormats=[];this.forPivotCustomPicture=[];this.forPivotCustomFormat=[];var H=U.getElementsByTagName("OLAPDimension");var Z=[];var G=[];var X=[];this.measures=U.getElementsByTagName("OLAPMeasure");var Y=[];var $=[];var j=0;var W=0;var K=[];var ee={measureFormula:[],itemPosition:[]};var re=[];var te=[];var ae=[];var se=[];var ie=[];if(e.RealType=="Table"){for(var S=0;S<H.length;S++){this.initialColumnVisible[S]=true;if(H[S].attributes.getNamedItem("visible").nodeValue!="Yes"){this.initialColumnVisible[S]=false}}}for(var S=0;S<H.length;S++){if(H[S].attributes.getNamedItem("axis").nodeValue=="Rows"||e.RealType=="Table"||this.InitMetadata.Dimensions[S].validPosition==""){Z[j]=H[S].attributes.getNamedItem("displayName").nodeValue;K[S]=Z[j];j++}if(H[S].attributes.getNamedItem("axis").nodeValue=="Columns"){G[W]=H[S].attributes.getNamedItem("displayName").nodeValue;K[S]=G[W];W++}if(H[S].attributes.getNamedItem("axis").nodeValue=="Pages"){X[W]=H[S].attributes.getNamedItem("displayName").nodeValue;K[S]=X[W];W++}if(e.ServerPagingPivot&&H[S].attributes.getNamedItem("axis").nodeValue==""){for(var w=0;w<this.InitMetadata.Dimensions.length;w++){if(this.InitMetadata.Dimensions[w].dataField==H[S].attributes.getNamedItem("dataField").nodeValue){if(this.InitMetadata.Dimensions[w].Visible){Z[j]=H[S].attributes.getNamedItem("displayName").nodeValue;j++;K[S]=H[S].attributes.getNamedItem("displayName").nodeValue}}}}Y[S]=H[S].attributes.getNamedItem("dataType").nodeValue;if(H[S].childNodes.length>0){if(H[S].childNodes!=null){for(var fe=0;fe<H[S].childNodes.length;fe++){if(H[S].childNodes[fe].localName=="formatValues"){for(var le=0;le<H[S].childNodes[fe].childNodes.length;le++){if(H[S].childNodes[fe].childNodes[le].localName=="value"){var ne={};ne.format=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("format").nodeValue;ne.recursive=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("recursive").nodeValue;var oe=H[S].childNodes[fe].childNodes[le].textContent;ne.value=oe.replace(/^\s+|\s+$/g,"");ne.columnNumber=S;this.formatValues.push(ne)}}}}}}if(H[S].childNodes.length>0){if(H[S].childNodes!=null){for(var fe=0;fe<H[S].childNodes.length;fe++){if(H[S].childNodes[fe].localName=="conditionalFormats"){for(var le=0;le<H[S].childNodes[fe].childNodes.length;le++){if(H[S].childNodes[fe].childNodes[le].localName=="rule"){var ue={};ue.format=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("format").nodeValue;ue.operation1=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("op1").nodeValue;ue.value1=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("value1").nodeValue;if(H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("op2")!=null){ue.operation2=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("op2").nodeValue;ue.value2=H[S].childNodes[fe].childNodes[le].attributes.getNamedItem("value2").nodeValue}ue.columnNumber=S;this.conditionalFormatsColumns.push(ue)}}}}}}if(H[S].attributes.getNamedItem("picture").nodeValue!=""){if(H[S].attributes.getNamedItem("dataType").nodeValue=="date"){te.push(H[S].attributes.getNamedItem("picture").nodeValue);se.push(H[S].attributes.getNamedItem("dataField").nodeValue)}if(H[S].attributes.getNamedItem("dataType").nodeValue=="integer"){ae.push(H[S].attributes.getNamedItem("picture").nodeValue);ie.push(H[S].attributes.getNamedItem("dataField").nodeValue)}}this.forPivotCustomPicture.push(H[S].attributes.getNamedItem("picture").nodeValue);this.forPivotCustomFormat.push(H[S].attributes.getNamedItem("format").nodeValue);re.push(H[S].attributes.getNamedItem("dataField").nodeValue)}for(var S=0;S<this.measures.length;S++){$[S]=this.measures[S].attributes.getNamedItem("displayName").nodeValue;if(measures[S].childNodes.length>0){if(measures[S].childNodes!=null){for(var fe=0;fe<measures[S].childNodes.length;fe++){if(measures[S].childNodes[fe].localName=="formatValues"){for(var le=0;le<measures[S].childNodes[fe].childNodes.length;le++){if(measures[S].childNodes[fe].childNodes[le].localName=="value"){var ne={};ne.format=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("format").nodeValue;ne.recursive=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("recursive").nodeValue;var oe=measures[S].childNodes[fe].childNodes[le].textContent;ne.value=oe.replace(/^\s+|\s+$/g,"");ne.columnNumber=S;this.formatValuesMeasures.push(ne)}}}}}}if(measures[S].childNodes.length>0){if(measures[S].childNodes!=null){for(var fe=0;fe<measures[S].childNodes.length;fe++){if(measures[S].childNodes[fe].localName=="conditionalFormats"){for(var le=0;le<measures[S].childNodes[fe].childNodes.length;le++){if(measures[S].childNodes[fe].childNodes[le].localName=="rule"){var ue={};ue.format=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("format").nodeValue;ue.operation1=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("op1").nodeValue;ue.value1=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("value1").nodeValue;if(measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("op2")!=null){ue.operation2=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("op2").nodeValue;ue.value2=measures[S].childNodes[fe].childNodes[le].attributes.getNamedItem("value2").nodeValue}ue.columnNumber=S;this.conditionalFormats.push(ue)}}}}}}if(measures[S].attributes.getNamedItem("picture").nodeValue!=""){if(measures[S].attributes.getNamedItem("dataType").nodeValue=="date"){te.push(measures[S].attributes.getNamedItem("picture").nodeValue);se.push(measures[S].attributes.getNamedItem("dataField").nodeValue)}if(measures[S].attributes.getNamedItem("dataType").nodeValue=="integer"||measures[S].attributes.getNamedItem("dataType").nodeValue=="real"){ae.push(measures[S].attributes.getNamedItem("picture").nodeValue);ie.push(measures[S].attributes.getNamedItem("dataField").nodeValue)}}if(measures[S].attributes.getNamedItem("formula")!=undefined&&measures[S].attributes.getNamedItem("formula").nodeValue!=""){ee.measureFormula.push({hasFormula:true,textFormula:measures[S].attributes.getNamedItem("formula").nodeValue})}else{ee.measureFormula.push({hasFormula:false})}this.forPivotCustomPicture.push(measures[S].attributes.getNamedItem("picture").nodeValue);re.push(measures[S].attributes.getNamedItem("dataField").nodeValue)}this.header=K.concat($);this.getDataFromXML=function(e,r){var t=e.split("<Record>");if(this.serverPaging){this.ServerRecordCount=parseToIntRegisterValue(t[0],"RecordCount");this.ServerPageCount=parseToIntRegisterValue(t[0],"PageCount");this.ServerPageNumber=parseToIntRegisterValue(t[0],"PageNumber")}filds=r;for(var a=1;a<t.length;a++){var s=[];var i=[];for(var f=0;f<filds.length;f++){s[f]="#NuN#";var l=t[a].split("<"+filds[f]+">");if(l.length>1){var n=l[1].split("</"+filds[f]+">");s[f]=n[0];i[f]=s[f]}else{if(t[a].indexOf("<"+filds[f]+"/>")>=0){s[f]="";i[f]=""}}}this.data.push(s);var o=filds.length;for(var f=0;f<this.HideDataFilds.length;f++){i[o+f]=undefined;var l=t[a].split("<"+this.HideDataFilds[f]+">");if(l.length>1){var n=l[1].split("</"+this.HideDataFilds[f]+">");i[o+f]=n[0]}}this.fullRecord.push(i);if(i.length>this.maxLengthRecord)this.maxLengthRecord=i.length}};this.maxLengthRecord=0;this.data=[];this.fullRecord=[];this.orderFildsHidden=B;this.TableOrderFilds=re;if(!e.ServerPagingPivot){this.getDataFromXML(e.data,this.TableOrderFilds)}else{y=y&&measures.length>1;this.pagingData={};this.pagingData.dataFields=re}var ve={};for(var j=0;j<B.length;j++){ve[B[j]]=re.length+j}this.orderFildsHidden=J;ee.itemPosition=ve;ee.recordDataLength=this.maxLengthRecord;ee.cantFormulaMeasures=0;for(var le=0;le<ee.measureFormula.length;le++){if(ee.measureFormula[le].hasFormula){ee.cantFormulaMeasures++;var ce=ee.measureFormula[le].textFormula;var de=ce;var me=["*","-","+","/","(",")"];for(var j=0;j<me.length;j++){var he=de.split(me[j]);if(he.length>1){de="";for(var S=0;S<he.length-1;S++){de=de+he[S]+" "+me[j]+" "}de=de+he[he.length-1]}}var pe=InfixToPostfix(de);ee.measureFormula[le].polishNotationText=pe;var Te=pe.split(" ");while(Te.indexOf("")!=-1){Te.splice(Te.indexOf(""),1)}var Ae=[];for(var W=0;W<Te.length;W++){if(me.indexOf(Te[W])==-1&&isNaN(parseInt(Te[W]))){var we=ee.itemPosition[Te[W]];if(Ae.indexOf(we)==-1)Ae.push(we)}}ee.measureFormula[le].relatedMeasures=Ae;var Oe=pe.split(" ");while(Oe.indexOf("")!=-1){Oe.splice(Oe.indexOf(""),1)}ee.measureFormula[le].PolishNotation=Oe}}var ye=0;var fe=0;var _e=0;for(var S=0;S<K.length;S++){if(this.contains(Z,K[S])!=-1){this.columnNumbers[ye]=S;ye++}if(this.contains(G,K[S])!=-1){this.rowNumbers[fe]=S;fe++}if(this.contains(X,K[S])!=-1){this.filterNumbers[_e]=S;_e++}}var ge=new Array;for(var w=0;w<H.length;w++){ge[w]=H[w]}var be="";for(var S=0;S<jQuery("script").length;S++){var xe=jQuery("script")[S].src;if(xe.indexOf("gxpivotjs")>0){be=xe;break}if(xe.indexOf("oat_loader")>0){be=xe;break}}var Fe=be.substring(0,be.indexOf("QueryViewer/oatPivot"));this.relativePath=Fe;this.fireOnPageChangeTable=function(e,r){setTimeout((function(){var t={QueryviewerId:e,Navigation:r};var a=document.createEvent("Events");a.initEvent("TableOnPageChangeEvent",true,true);a.parameter=t;document.dispatchEvent(a)}),0)};var Se;u=u.replace(/\./g,"");this.query=u;this.translations=t;if(i=="PivotTable"){Se=OAT_JS.pivot.cb(this,this.pivotDiv,l,n,z,r,ge,this.formatValues,this.conditionalFormatsColumns,this.formatValuesMeasures,this.autoResize,this.disableColumnSort,this.UcId,this.IdForQueryViewerCollection,p,y,ee,this.fullRecord,e.ServerPagingPivot,this.pagingData,this.HideDataFilds,this.orderFildsHidden,this.InitMetadata,this.relativePath,this.pivotParams);if(Se=="error"){return}}else{if(i=="Table"){Se=OAT_JS.grid.cb(this.pivotDiv,this.UcId+"_"+u,Y,z,this.forPivotCustomPicture,this.conditionalFormatsColumns,this.formatValues,this.forPivotCustomFormat,ge,H,r,this.pageSize,this.disableColumnSort,this.UcId,this.IdForQueryViewerCollection,p,this)}}if(i=="Table"){this.pageSize=this.previousState?this.previousState.pageSize:c;var ke=this.pageSize;if(Se.rowsPerPage!=undefined&&Se.rowsPerPage!=""){ke=Se.rowsPerPage}if(r[this.UcId]._ControlRenderedTo){jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").remove()}if(this.pageSize){var Ne={currPage:this.ServerPageNumber,ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+this.UcId+"_"+this.query)),optionsForRows:OAT.AddItemToList([10,15,20],this.InitMetadata.RowsPerPage),rowsPerPage:ke!="undefined"?ke:10,jstype:"table",topNav:false,controlName:this.UcId+"_"+this.query,cantPages:this.ServerPageCount,controlUcId:this.UcId,translations:t,control:this};OAT.partialTablePagination(jQuery("#"+this.UcId+"_"+this.query),Ne);var Ie=jQuery("#"+this.UcId+"_"+this.query)[0].clientWidth-1;jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({width:Ie+"px"});if(jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css("display")==="none"){jQuery("#"+this.UcId+"_"+this.query).css({marginBottom:"0px"})}else{jQuery("#"+this.UcId+"_"+this.query).css("margin-bottom","0px")}if(jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom){jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({marginBottom:"0px"})}var De=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4;jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:De+"px"});if(this.serverPaging&&(this.pageSize==10||this.ServerRecordCount<10)){if(this.ServerPageCount<=1){jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({display:"none"})}}}var De=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4;try{if(jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1){De=De+4}}catch(e){}jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:De+"px"});if(self.serverPaging){setInterval((function(){for(var e=0;e<jQuery(".oat_winrect_container .pivot_popup_fix").length;e++){if(!jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display||jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display!="none"){if(jQuery(".oat_winrect_container .pivot_popup_fix").length>0){var r=jQuery(".oat_winrect_container .pivot_popup_fix")[e];var t=r.scrollHeight-r.clientHeight-r.scrollTop;if(t<25){var a=r.getAttribute("ucid");var s=parseInt(r.getAttribute("columnNumber"));OAT_JS.grid.readScrollValue(a,s)}}}}}),250)}}if(!e.ServerPagingPivot){if(this.autoResize){jQuery("#"+this.UcId+"_"+this.query).css({minWidth:"10px"})}}this.getDataForTable=function(e,r,t,a,s,i,f,l,n,o){var u=false;if(a||s!=""||f!=""){OAT_JS.grid.cleanCache(this,e);u=true}if(s!="")OAT_JS.grid.gridData[e].dataFieldOrder=s;if(i!="")OAT_JS.grid.gridData[e].orderType=i;if(f!="")OAT_JS.grid.updateFilterInfo(e,f,l);if(n){OAT_JS.grid.restoreDefaultView(e);t=OAT_JS.grid.gridData[e].rowsPerPage}OAT_JS.grid.gridData[e].rowsPerPage=t;if(a||s!=""||f!=""){OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[e],e,OAT_JS.grid.gridData[e].blackLists,OAT_JS.grid.gridData[e].columnVisible,OAT_JS.grid.gridData[e].columnDataField)}if(t==""){t=undefined;r=0}if(!OAT_JS.grid.pageInCache(e,r)){OAT_JS.grid.lastCallToQueryViewer="getDataForTable";OAT_JS.grid.lastCallData={self:this,UcId:OAT_JS.grid.gridData[e].IdForQueryViewerCollection,RecalculateCantPages:a,DataFieldOrder:s,PageNumber:r,fromExternalRefresh:o};this.requestPageDataForTable(r,t,a,OAT_JS.grid.gridData[e].dataFieldOrder,OAT_JS.grid.gridData[e].orderType,OAT_JS.grid.gridData[e].filterInfo,u,OAT_JS.grid.gridData[e].IdForQueryViewerCollection)}else{OAT_JS.grid.redraw(this,e,OAT_JS.grid.pageInCache(e,r),false,false,r,true)}};this.requestPageDataForTable=function(e,r,t,a,s,i,f,l){setTimeout((function(){var n={PageNumber:e,PageSize:r,RecalculateCantPages:t,DataFieldOrder:a,OrderType:s,Filters:i,LayoutChange:f,QueryviewerId:l};var o=document.createEvent("Events");o.initEvent("RequestPageDataForTable",true,true);o.parameter=n;document.dispatchEvent(o)}),0)};this.getActualCantPages=function(e){return OAT_JS.grid.gridData[e].actualCantPages};this.getValuesForColumn=function(e,r,t){var a=OAT_JS.grid.gridData[e].columnDataField[r];if(t!=""){var s=1;OAT_JS.grid.lastCallToQueryViewer="getValuesForColumn";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,filterValue:t,dataField:a};this.requestAttributeForTable(e,a,s,t,10)}else{OAT_JS.grid.resetScrollValue(e,a,r)}};this.requestAttributeForTable=function(e,r,t,a,s){setTimeout((function(){var i={Page:t,PageSize:s,DataField:r,Filters:a,QueryviewerId:e};var f=document.createEvent("Events");f.initEvent("RequestAttributeForTable",true,true);f.parameter=i;document.dispatchEvent(f)}),0)};this.fireOnFilterChanged=function(e,r){setTimeout((function(){var t={QueryViewerd:e,FilterChangedData:r};var a=document.createEvent("Events");a.initEvent("TableOnFilterChangedEvent",true,true);a.parameter=t;document.dispatchEvent(a)}),0)};s.oat_element=Se};var OAT_JS={};OAT_JS.grid={panel:1,tab:4,div:"",needs:["grid"],gridData:[],cb:function(e,r,t,a,s,i,f,l,n,o,u,v,c,d,m,h,p){this.gridData[d]={};this.gridData[d].div=e;this.gridData[d].controlName=r;this.gridData[d].actualPageNumber=1;this.gridData[d].rowsPerPage=p.previousState?p.previousState.pageSize:v;this.gridData[d].actualCantPages=p.ServerPageCount;this.gridData[d].autoResize=p.autoResize;this.gridData[d].selection={Allow:p.pivotParams.AllowSelection,EntireLine:p.pivotParams.SelectLine,SelectedNode:[]};this.gridData[d].grid=new OAT.Grid(e,r,query,t,n,u,this.gridData[d].rowsPerPage,c,d,m,h,p.serverPaging,p.HideDataFilds,p.orderFildsHidden,p.TableOrderFilds,p.relativePath,this.gridData[d].selection,p.pivotParams.Title,p.translations);this.gridData[d].grid.oat_component=this;this.gridData[d].columnDataField=[];if(p.previousState&&p.previousState.columnDataField){this.gridData[d].columnDataField=p.previousState.columnDataField;var T=[];for(var A=0;A<this.gridData[d].columnDataField.length;A++){var w=this.gridData[d].columnDataField[A];for(var O=0;O<o.length;O++){if(w==o[O].getAttribute("dataField")){T.push(o[O].getAttribute("displayName"))}}}this.gridData[d].grid.createHeader(T,this.gridData[d].columnDataField)}else{for(var y=0;y<o.length;y++){this.gridData[d].columnDataField[y]=o[y].getAttribute("dataField")}this.gridData[d].grid.createHeader(p.header,this.gridData[d].columnDataField)}this.gridData[d].redrawHeader=false;this.gridData[d].defaultValues={};this.gridData[d].defaultValues.rowsPerPage=v;this.gridData[d].defaultValues.dataFieldOrder="";this.gridData[d].defaultValues.orderType="";this.gridData[d].defaultValues.filterInfo=[];this.gridData[d].IdForQueryViewerCollection=m;this.gridData[d].TableOrderFields=p.TableOrderFilds;this.gridData[d].cacheSize=p.gridCacheSize==0?p.ServerPageCount*(this.gridData[d].rowsPerPage>0?this.gridData[d].rowsPerPage:1):p.gridCacheSize;this.gridData[d].gridCache=[];this.gridData[d].gridCache[0]={page:1,pageData:p.dataString};this.gridData[d].nextCachePos=1;this.gridData[d].originalColumnDataField=[];for(var y=0;y<o.length;y++){this.gridData[d].originalColumnDataField[y]=o[y].getAttribute("dataField")}this.gridData[d].columnVisible=[];for(var y=0;y<o.length;y++){this.gridData[d].columnVisible[y]=true;if(p.previousColumnVisible){this.gridData[d].columnVisible[y]=p.previousColumnVisible[y];if(!this.gridData[d].columnVisible[y]){var w=this.gridData[d].originalColumnDataField[y];this.gridData[d].grid.hideColumnHeader(this.gridData[d].columnDataField.indexOf(w))}}else if(p.initialColumnVisible){this.gridData[d].columnVisible[y]=p.initialColumnVisible[y];if(!this.gridData[d].columnVisible[y])this.gridData[d].grid.hideColumnHeader(y)}}this.gridData[d].filterInfo=[];this.gridData[d].differentValues=[];this.gridData[d].blackLists=[];this.gridData[d].differentValuesPaginationInfo=[];this.gridData[d].filteredValuesPaginationInfo=[];for(var y=0;y<o.length;y++){this.gridData[d].differentValues[o[y].getAttribute("dataField")]=[];this.gridData[d].blackLists[o[y].getAttribute("dataField")]={state:"all",visibles:[],hiddens:[],defaultAction:"Include",hasNull:true};this.gridData[d].differentValuesPaginationInfo[o[y].getAttribute("dataField")]={blocked:false,previousPage:0,totalPages:true,filtered:false};this.gridData[d].filteredValuesPaginationInfo[o[y].getAttribute("dataField")]={previousPage:0,totalPages:0,filteredText:"",values:[]}}this.gridData[d].defaultNullText=a.getAttribute("textForNullValues");if(p.previousFilters!=undefined){this.gridData[d].filterInfo=p.previousFilters;for(var _=0;_<this.gridData[d].filterInfo.length;_++){for(var g=0;g<this.gridData[d].filterInfo[_].NotNullValues.Included.length;g++){var b=this.gridData[d].filterInfo[_].NotNullValues.Included[g];if(this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].visibles.indexOf(b)==-1){this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].visibles.push(b)}}for(var g=0;g<this.gridData[d].filterInfo[_].NotNullValues.Excluded.length;g++){var b=this.gridData[d].filterInfo[_].NotNullValues.Excluded[g];if(this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].hiddens.indexOf(b)==-1){this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].hiddens.push(b)}}if(this.gridData[d].filterInfo[_].NotNullValues.Included.length>0){this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].state=""}else{this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].state="none"}this.gridData[d].blackLists[this.gridData[d].filterInfo[_].DataField].defaultAction=this.gridData[d].filterInfo[_].NotNullValues.DefaultAction}}else{if(p.customFilterInfo!=undefined&p.customFilterInfo!=""){this.gridData[d].filterInfo=p.customFilterInfo}}this.gridData[d].dataFieldOrder=p.previousDataFieldOrder!=undefined?p.previousDataFieldOrder:"";this.gridData[d].orderType=p.previousOrderType!=undefined?p.previousOrderType:"";this.gridData[d].customOrderValues=[];for(var x=0;x<o.length;x++){if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")==="custom"){result=this.gridData[d].grid.applyCustomSort(x,o[x],data);data=result[0];this.gridData[d].customOrderValues[x]=result[1]}else{this.gridData[d].customOrderValues[x]=false}}this.gridData[d].rowsMetadata={columnsDataType:t,defaultPicture:a,forPivotCustomPicture:s,conditionalFormatsColumns:i,formatValues:f,forPivotCustomFormat,columns:o};this.gridData[d].rowsData=data;for(var A=0;A<data.length;A++){OAT.CreateGridRow(p.data[A],this.gridData[d])}if(!p.serverPaging){for(var x=0;x<o.length;x++){if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")==="ascending"){this.gridData[d].grid.applySortOrderType(x,2)}if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")==="descending"){this.gridData[d].grid.applySortOrderType(x,3)}if(o[x].getAttribute("order")!=undefined){break}}}else{var F=false;for(var x=0;x<o.length;x++){if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")!=""){this.gridData[d].dataFieldOrder=o[x].getAttribute("dataField");this.gridData[d].orderType=o[x].getAttribute("order")=="descending"?"Descending":"Ascending";F=o[x].getAttribute("order")=="custom";break}}if(this.gridData[d].dataFieldOrder!=""&&!F){var S=0;for(var g=0;g<this.gridData[d].grid.columns.length;g++){if(this.gridData[d].dataFieldOrder==this.gridData[d].columnDataField[g]){S=g;break}}this.gridData[d].grid.applySortOrderType(S,this.gridData[d].orderType.toLowerCase()=="ascending"?2:3)}}for(var x=0;x<o.length;x++){this.gridData[d].grid.applyCustomFilter(x,o[x])}if(p.serverPaging){this.gridData[d].endValueRead=false;qv.collection[this.gridData[d].IdForQueryViewerCollection].CurrentPage=1;if(typeof qv.collection[this.gridData[d].IdForQueryViewerCollection].OnFirstPage=="function")self.fireOnPageChangeTable(this.gridData[d].IdForQueryViewerCollection,"OnFirstPage")}if(!p.serverPaging){this.gridData[d].grid.applySaveState(this.gridData[d].rowsPerPage)}if(p.previousState){var k=this;setTimeout((function(){self.getDataForTable(d,1,k.gridData[d].rowsPerPage,true,k.gridData[d].dataFieldOrder,k.gridData[d].orderType,"","","",false)}),0)}return this.gridData[d].grid},redraw:function(e,r,t,a,s,i,f){if(!this.pageInCache(r,i)){this.gridData[r].gridCache.push({page:i,pageData:t});if(this.gridData[r].gridCache.length>this.gridData[r].cacheSize){this.gridData[r].gridCache.splice(0,1)}}else{var l=-1;for(var n=0;n<this.gridData[r].gridCache.length;n++){if(this.gridData[r].gridCache[n].page==i){l=n}}this.gridData[r].gridCache.splice(l,1);this.gridData[r].gridCache.push({page:i,pageData:t})}e.data=[];e.getDataFromXML(t,this.gridData[r].TableOrderFields);if(e.ServerPageCount>=0){this.gridData[r].actualCantPages=e.ServerPageCount}if(this.gridData[r].redrawHeader){var o=[];for(var u=0;u<this.gridData[r].columnDataField.length;u++){var v=this.gridData[r].columnDataField[u];for(var c=0;c<this.gridData[r].rowsMetadata.columns.length;c++){if(v==this.gridData[r].rowsMetadata.columns[c].getAttribute("dataField")){o.push(this.gridData[r].rowsMetadata.columns[c].getAttribute("displayName"))}}}this.gridData[r].grid.createHeader(o,this.gridData[r].columnDataField);if(this.gridData[r].dataFieldOrder!=""){var d=0;for(var m=0;m<this.gridData[r].grid.columns.length;m++){if(this.gridData[r].dataFieldOrder==this.gridData[r].columnDataField[m]){d=m;break}}this.gridData[r].grid.applySortOrderType(d,this.gridData[r].orderType.toLowerCase()=="ascending"?2:3)}for(var u=0;u<this.gridData[r].columnVisible.length;u++){if(!this.gridData[r].columnVisible[u]){var v=this.gridData[r].originalColumnDataField[u];this.gridData[r].grid.hideColumnHeader(this.gridData[r].columnDataField.indexOf(v))}}}this.gridData[r].grid.removeAllRows();if(a){if(jQuery("#"+this.gridData[r].controlName+"_tablePagination "+"#tablePagination_totalPages").length>0){OAT.replaceTextNode(jQuery("#"+this.gridData[r].controlName+"_tablePagination "+"#tablePagination_totalPages")[0]," "+e.ServerPageCount);if(e.ServerPageCount<=1){jQuery("#"+this.gridData[r].controlName+"_tablePagination ").css({display:"none"})}else{jQuery("#"+this.gridData[r].controlName+"_tablePagination ").css({display:""});if(e.ServerPageCount==1){jQuery("#"+this.gridData[r].controlName+"_tablePagination_paginater").css("display","none")}else{jQuery("#"+this.gridData[r].controlName+"_tablePagination_paginater").css("display","")}}}}if(OAT_JS.grid.gridData[r].actualPageNumber!=i){qv.collection[this.gridData[r].IdForQueryViewerCollection].CurrentPage=i;if(i==1){if(typeof qv.collection[this.gridData[r].IdForQueryViewerCollection].OnFirstPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnFirstPage")}else if(i==this.gridData[r].actualCantPages){if(typeof qv.collection[this.gridData[r].IdForQueryViewerCollection].OnLastPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnLastPage")}else if(i<OAT_JS.grid.gridData[r].actualPageNumber){if(typeof qv.collection[this.gridData[r].IdForQueryViewerCollection].OnPreviousPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnPreviousPage")}else{if(typeof qv.collection[this.gridData[r].IdForQueryViewerCollection].OnNextPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnNextPage")}}if(!f&&qv.collection[OAT_JS.grid.gridData[r].IdForQueryViewerCollection].AutoRefreshGroup!=""){OAT_JS.grid.initValueRead(r,0);var h=function(){if(!OAT_JS.grid.gridData[r].endValueRead){setTimeout(h,100)}else{var e=OAT.createXMLMetadata(OAT_JS.grid.gridData[r],null,true);var t=OAT_JS.grid.gridData[r].IdForQueryViewerCollection;setTimeout((function(){var r={QueryviewerId:t,Metadata:e};var a=document.createEvent("Events");a.initEvent("RequestUpdateLayoutSameGroup",true,true);a.parameter=r;document.dispatchEvent(a)}),50)}};h()}OAT_JS.grid.gridData[r].actualPageNumber=i;currPageNumber[this.gridData[r].controlName]=i;jQuery("#"+this.gridData[r].controlName+"_tablePagination "+"#tablePagination_currPage").val(i);this.gridData[r].rowsData=e.data;for(var u=0;u<e.data.length;u++){OAT.CreateGridRow(e.data[u],this.gridData[r])}OAT.RedrawSelectedNode(this.gridData[r].grid)},getDifferentValues:function(e,r,t){var a=this.gridData[e].columnDataField[r];var s=this.gridData[e].differentValues[a][t];var i=this.gridData[e].originalColumnDataField.indexOf(this.gridData[e].columnDataField[r]);var f=OAT.ApplyPictureValue(s.trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[i],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[i]).replace(/ /g," ");if(this.gridData[e].blackLists[a].hasNull&&s.trimpivot()==this.gridData[e].defaultNullText){s="#NuN#";return false}var l=true;if(this.gridData[e].blackLists[a].state!="all"){if(this.gridData[e].blackLists[a].visibles.indexOf(s)<0){l=false}}return{value:s,checked:l,pict_value:f}},getCantDifferentValues:function(e,r){var t=this.gridData[e].columnDataField[r];return this.gridData[e].differentValues[t].length},cleanCache:function(e,r){for(var t=0;t<this.gridData[r].gridCache.length;t++){this.gridData[r].gridCache[t]={page:-1,pageData:""}}this.gridData[r].nextCachePos=0},pageInCache:function(e,r){for(var t=0;t<this.gridData[e].gridCache.length;t++){if(this.gridData[e].gridCache[t].page==r){return this.gridData[e].gridCache[t].pageData}}return false},updateFilterInfo:function(e,r,t){if(t.op=="all"){var a=-1;for(var s=0;s<this.gridData[e].filterInfo.length;s++){if(r==this.gridData[e].filterInfo[s].DataField){a=s;break}}if(a>-1)this.gridData[e].filterInfo.splice(a,1);this.gridData[e].blackLists[r].state="all";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];this.gridData[e].blackLists[r].defaultAction="Include";return}if(this.gridData[e].blackLists[r].state=="none"){this.gridData[e].blackLists[r].visibles=[];for(var i=0;i<this.gridData[e].differentValues[r].length;i++){if(this.gridData[e].blackLists[r].hiddens.indexOf(this.gridData[e].differentValues[r][i])==-1){this.gridData[e].blackLists[r].hiddens.push(this.gridData[e].differentValues[r][i])}}}else if(this.gridData[e].blackLists[r].state=="all"){this.gridData[e].blackLists[r].hiddens=[];for(var i=0;i<this.gridData[e].differentValues[r].length;i++){if(this.gridData[e].blackLists[r].visibles.indexOf(this.gridData[e].differentValues[r][i])==-1){this.gridData[e].blackLists[r].visibles.push(this.gridData[e].differentValues[r][i])}}}if(t.op=="none"){this.gridData[e].blackLists[r].state="none";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];this.gridData[e].blackLists[r].defaultAction="Exclude"}else{if(t.op=="push"){this.gridData[e].blackLists[r].state="";var a=this.gridData[e].blackLists[r].visibles.indexOf(t.values);if(a>-1)this.gridData[e].blackLists[r].visibles.splice(a,1);if(this.gridData[e].blackLists[r].hiddens.indexOf(t.values)==-1)this.gridData[e].blackLists[r].hiddens.push(t.values)}else if(t.op=="pop"){this.gridData[e].blackLists[r].state="";if(this.gridData[e].blackLists[r].visibles.indexOf(t.values)==-1)this.gridData[e].blackLists[r].visibles.push(t.values);var a=this.gridData[e].blackLists[r].hiddens.indexOf(t.values);if(a>-1)this.gridData[e].blackLists[r].hiddens.splice(a,1)}else if(t.op=="reverse"){if(this.gridData[e].blackLists[r].defaultAction=="Include"){this.gridData[e].blackLists[r].defaultAction="Exclude"}else{this.gridData[e].blackLists[r].defaultAction="Include"}if(this.gridData[e].blackLists[r].state=="none"){var a=-1;for(var s=0;s<this.gridData[e].filterInfo.length;s++){if(r==this.gridData[e].filterInfo[s].DataField){a=s;break}}if(a>-1)this.gridData[e].filterInfo.splice(a,1);this.gridData[e].blackLists[r].state="all";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];return}else if(this.gridData[e].blackLists[r].state=="all"){this.gridData[e].blackLists[r].state="none";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[]}else{var f=[];for(var l=0;l<this.gridData[e].blackLists[r].visibles.length;l++){f.push(this.gridData[e].blackLists[r].visibles[l])}var n=[];for(var l=0;l<this.gridData[e].blackLists[r].hiddens.length;l++){n.push(this.gridData[e].blackLists[r].hiddens[l])}this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];for(var i=0;i<this.gridData[e].differentValues[r].length;i++){var o=this.gridData[e].differentValues[r][i];if(f.indexOf(o)==-1){this.gridData[e].blackLists[r].visibles.push(o)}else{this.gridData[e].blackLists[r].hiddens.push(o)}}for(var i=0;i<n.length;i++){if(this.gridData[e].blackLists[r].visibles.indexOf(n[i])==-1){this.gridData[e].blackLists[r].visibles.push(n[i])}}for(var i=0;i<f.length;i++){if(this.gridData[e].blackLists[r].hiddens.indexOf(f[i])==-1){this.gridData[e].blackLists[r].hiddens.push(f[i])}}}}}var u=false;var v=true;var c=[];for(var d=0;d<this.gridData[e].blackLists[r].visibles.length;d++){if(this.gridData[e].blackLists[r].visibles[d]!="#NuN#"){c.push(this.gridData[e].blackLists[r].visibles[d])}}var m=[];if(this.gridData[e].blackLists[r].state!="none"){for(var d=0;d<this.gridData[e].differentValues[r].length;d++){var o=this.gridData[e].differentValues[r][d];if(o!="#NuN#"&&c.indexOf(o)==-1){m.push(o)}}for(var d=0;d<this.gridData[e].blackLists[r].hiddens.length;d++){if(this.gridData[e].blackLists[r].hiddens[d]!="#NuN#"&&m.indexOf(this.gridData[e].blackLists[r].hiddens[d])==-1){m.push(this.gridData[e].blackLists[r].hiddens[d])}}if(c.length==0&&this.gridData[e].blackLists[r].defaultAction=="Exclude"){m=[]}}if(t.op=="none"){v=false;c=[];m=[]}else{if(this.gridData[e].differentValues[r].indexOf("#NuN#")>-1||m.indexOf(this.gridData[e].blackLists[r].hiddens[d])!=-1){if(this.gridData[e].blackLists[r].visibles.indexOf("#NuN#")==-1){v=false}}else{if(this.gridData[e].blackLists[r].defaultAction=="Exclude"){v=false}}}if(this.gridData[e].blackLists[r].hasNull&&!(t.op=="none")){var h=this.gridData[e].defaultNullText;var p=false;var T=0;for(var i=0;i<this.gridData[e].differentValues[r].length;i++){T=this.gridData[e].differentValues[r][i].length}for(var i=0;i<this.gridData[e].differentValues[r].length;i++){if(this.gridData[e].differentValues[r][i].trimpivot()==this.gridData[e].defaultNullText){h=this.gridData[e].differentValues[r][i];p=true;break}}if(!p){for(var d=0;d<T-this.gridData[e].defaultNullText.length;d++){h=h+" "}}if(!v){if(m.indexOf(h)==-1){m.push(h);if(this.gridData[e].blackLists[r].hiddens.indexOf(h)==-1){this.gridData[e].blackLists[r].hiddens.push(h)}}if(c.indexOf(h)!=-1){c.splice(c.indexOf(h),1)}if(this.gridData[e].blackLists[r].visibles.indexOf(h)!=-1){this.gridData[e].blackLists[r].visibles.splice(this.gridData[e].blackLists[r].visibles.indexOf(h),1)}}else{if(c.indexOf(h)==-1){if(m.indexOf(h)!=-1){m.splice(m.indexOf(h),1);c.push(h)}else{if(this.gridData[e].blackLists[r].defaultAction=="Exclude"){c.push(h)}}if(this.gridData[e].blackLists[r].hiddens.indexOf(h)!=-1){this.gridData[e].blackLists[r].hiddens.splice(this.gridData[e].blackLists[r].hiddens.indexOf(h),1);if(this.gridData[e].blackLists[r].visibles.indexOf(h)==-1){this.gridData[e].blackLists[r].visibles.push(h)}}}}}var A=false;if(this.gridData[e].differentValuesPaginationInfo[r]!=null){A=this.gridData[e].differentValuesPaginationInfo[r].previousPage==this.gridData[e].differentValuesPaginationInfo[r].totalPages}var w=(v||!this.gridData[e].blackLists[r].hasNull)&&m.length==0&&t.op!="none"&&t.op!="push"&&(this.gridData[e].blackLists[r].defaultAction=="Include"||A)&&!(t.op=="reverse");var a=0;for(var d=0;d<this.gridData[e].filterInfo.length;d++){if(this.gridData[e].filterInfo[d].DataField==r){u=true;this.gridData[e].filterInfo[d].NullIncluded=v;this.gridData[e].filterInfo[d].NotNullValues.Included=c;this.gridData[e].filterInfo[d].NotNullValues.Excluded=m;this.gridData[e].filterInfo[d].NotNullValues.DefaultAction=this.gridData[e].blackLists[r].defaultAction;a=d}}if(w){this.gridData[e].filterInfo.splice(a,1)}if(!u&&!w){var O={Included:c,Excluded:m,DefaultAction:this.gridData[e].blackLists[r].defaultAction};filter={DataField:r,NullIncluded:v,NotNullValues:O};this.gridData[e].filterInfo.push(filter)}},readScrollValue:function(e,r){var t=this.gridData[e].columnDataField[r];var a=this.gridData[e].originalColumnDataField.indexOf(this.gridData[e].columnDataField[r]);if(!this.gridData[e].differentValuesPaginationInfo[t].blocked){this.gridData[e].differentValuesPaginationInfo[t].blocked=true;if(!this.gridData[e].differentValuesPaginationInfo[t].filtered){var s=this.gridData[e].differentValuesPaginationInfo[t];var i=s.previousPage+1;this.gridData[e].lastRequestValue=t;OAT_JS.grid.lastCallToQueryViewer="readScrollValue";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,filterValue:"",dataField:t};self.requestAttributeForTable(e,t,i,"",10)}else{var s=this.gridData[e].filteredValuesPaginationInfo[t];var i=s.previousPage+1;this.gridData[e].lastRequestValue=t;var f=s.filteredText;OAT_JS.grid.lastCallToQueryViewer="readScrollValueFilter";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,posColumnNumber:a,filterValue:f,dataField:t,filterText:f};self.requestAttributeForTable(e,t,i,f,10)}}},appendNewValueData:function(e,r,t){var a=this.gridData[e].lastRequestValue;var s=this.gridData[e].differentValuesPaginationInfo[a];if(r.PageNumber>s.previousPage||t){this.gridData[e].differentValuesPaginationInfo[a].previousPage=r.PageNumber;this.gridData[e].differentValuesPaginationInfo[a].totalPages=r.PagesCount;var i=[];if(r.Null){if(this.gridData[e].differentValues[a].indexOf("#NuN#")==-1){this.gridData[e].differentValues[a].push("#NuN#")}}for(var f=0;f<r.NotNullValues.length;f++){var l=r.NotNullValues[f];if(this.gridData[e].differentValues[a].indexOf(l)==-1){this.gridData[e].differentValues[a].push(l);i.push(l)}if(this.gridData[e].blackLists[a].defaultAction=="Include"){if(this.gridData[e].blackLists[a].visibles.indexOf(l)==-1&&this.gridData[e].blackLists[a].hiddens.indexOf(l)==-1){this.gridData[e].blackLists[a].visibles.push(l)}}else{if(this.gridData[e].blackLists[a].visibles.indexOf(l)==-1&&this.gridData[e].blackLists[a].hiddens.indexOf(l)==-1){this.gridData[e].blackLists[a].hiddens.push(l)}}}var n=this.gridData[e].columnDataField.indexOf(a);var o=this.gridData[e].originalColumnDataField.indexOf(a);this.gridData[e].grid.loadDifferentValues(n,this.gridData[e].differentValues[a]);for(var u=0;u<i.length;u++){var v=true;if(this.gridData[e].blackLists[a].state!="all"){if(this.gridData[e].blackLists[a].visibles.indexOf(i[u])<0){v=false}}if(!(this.gridData[e].blackLists[a].hasNull&&i[u].trimpivot()==this.gridData[e].defaultNullText)){var c=OAT.ApplyPictureValue(i[u].trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[o],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[o]).replace(/ /g," ");OAT.appendNewPairToPopUp(this.gridData[e],i[u],n,v,c,a)}}}if(this.gridData[e].differentValuesPaginationInfo[a].previousPage<r.PagesCount)this.gridData[e].differentValuesPaginationInfo[a].blocked=false},resetScrollValue:function(e,r,t){this.gridData[e].differentValuesPaginationInfo[r].filtered=false;this.gridData[e].differentValuesPaginationInfo[r].blocked=true;var t=this.gridData[e].columnDataField.indexOf(r);var a=this.gridData[e].originalColumnDataField.indexOf(r);OAT.removeAllPairsFromPopUp(this.gridData[e],t,OAT_JS.grid.cantPages(e,r)>1);for(var s=0;s<this.gridData[e].differentValues[r].length;s++){var i=true;var f=this.gridData[e].differentValues[r][s];if(this.gridData[e].blackLists[r].state!="all"){if(this.gridData[e].blackLists[r].visibles.indexOf(f)<0){i=false}}var l=OAT.ApplyPictureValue(f.trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[a],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[a]).replace(/ /g," ");if(!(this.gridData[e].blackLists[r].hasNull&&f.trimpivot()==this.gridData[e].defaultNullText)){OAT.appendNewPairToPopUp(this.gridData[e],f,t,i,l,r)}}if(this.gridData[e].differentValuesPaginationInfo[r].previousPage<OAT_JS.grid.cantPages(e,r))this.gridData[e].differentValuesPaginationInfo[r].blocked=false},resetAllScrollValue:function(e){for(var r=0;r<this.gridData[e].grid.columns.length;r++){var t=this.gridData[e].grid.columns[r].getAttribute("dataField");this.gridData[e].differentValuesPaginationInfo[t].filtered=false;this.gridData[e].differentValuesPaginationInfo[t].blocked=true;if(this.gridData[e].differentValuesPaginationInfo[t].previousPage<this.gridData[e].differentValuesPaginationInfo[t].totalPages)this.gridData[e].differentValuesPaginationInfo[t].blocked=false}},appendNewFilteredValueData:function(e,r,t,a){var s=this.gridData[e].lastRequestValue;var t=this.gridData[e].columnDataField.indexOf(s);var i=this.gridData[e].originalColumnDataField.indexOf(s);var f=this.gridData[e].filteredValuesPaginationInfo[s];if((a||a=="")&&f.filteredText!=a){return}if(r.PageNumber>f.previousPage){this.gridData[e].filteredValuesPaginationInfo[s].previousPage=r.PageNumber;this.gridData[e].filteredValuesPaginationInfo[s].totalPages=r.PagesCount;if(r.Null){if(this.gridData[e].differentValues[s].indexOf("#NuN#")==-1){this.gridData[e].differentValues[s].push("#NuN#")}}for(var l=0;l<r.NotNullValues.length;l++){var n=this.gridData[e].differentValues[s].indexOf(r.NotNullValues[l])!=-1;if(this.gridData[e].differentValues[s].indexOf(r.NotNullValues[l])==-1){this.gridData[e].differentValues[s].push(r.NotNullValues[l])}if(this.gridData[e].blackLists[s].defaultAction=="Include"&&!n){if(this.gridData[e].blackLists[s].visibles.indexOf(r.NotNullValues[l])==-1&&this.gridData[e].blackLists[s].hiddens.indexOf(r.NotNullValues[l])==-1){this.gridData[e].blackLists[s].visibles.push(r.NotNullValues[l])}}else{if(this.gridData[e].blackLists[s].visibles.indexOf(r.NotNullValues[l])==-1&&this.gridData[e].blackLists[s].hiddens.indexOf(r.NotNullValues[l])==-1){this.gridData[e].blackLists[s].hiddens.push(r.NotNullValues[l])}}var o=true;if(this.gridData[e].blackLists[s].state!="all"){if(this.gridData[e].blackLists[s].visibles.indexOf(r.NotNullValues[l])<0){o=false}}var u=OAT.ApplyPictureValue(r.NotNullValues[l].trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[i],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[i]).replace(/ /g," ");if(!(this.gridData[e].blackLists[s].hasNull&&r.NotNullValues[l].trimpivot()==this.gridData[e].defaultNullText)){OAT.appendNewPairToPopUp(this.gridData[e],r.NotNullValues[l],t,o,u,s)}}if(this.gridData[e].filteredValuesPaginationInfo[s].previousPage<r.PagesCount)this.gridData[e].differentValuesPaginationInfo[s].blocked=false}},initValueRead:function(e,r,t){if(r>=this.gridData[e].grid.columns.length){this.gridData[e].endValueRead=true;return}else{if(this.gridData[e].grid.columns[r].getAttribute("visible")!="Never"){if(t==undefined){this.gridData[e].grid.lastRequestValue=this.gridData[e].grid.columns[r].getAttribute("dataField")}else{this.gridData[e].grid.lastRequestValue=t}if(this.gridData[e].differentValuesPaginationInfo[this.gridData[e].grid.lastRequestValue].previousPage>0){if(t==undefined){r++;OAT_JS.grid.initValueRead(e,r)}}var a=10;if(qv.collection[this.gridData[e].IdForQueryViewerCollection].AutoRefreshGroup!=""){a=0}OAT_JS.grid.lastCallToQueryViewer="initValueRead";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,filterValue:"",dataField:t};self.requestAttributeForTable(e,this.gridData[e].grid.lastRequestValue,1,"",a)}else{r++;OAT_JS.grid.initValueRead(e,r,t)}}},initValueLoad:function(e,r,t){dataField=this.gridData[r].grid.lastRequestValue;this.gridData[r].differentValuesPaginationInfo[dataField].previousPage=e.PageNumber;this.gridData[r].differentValuesPaginationInfo[dataField].totalPages=e.PagesCount;var a=0;for(var s=0;s<this.gridData[r].grid.columns.length;s++){if(this.gridData[r].grid.lastRequestValue==this.gridData[r].grid.columns[s].getAttribute("dataField")){a=s;break}}if(e.Null){this.gridData[r].blackLists[dataField].hasNull=true;if(this.gridData[r].differentValues[dataField].indexOf("#NuN#")==-1){this.gridData[r].differentValues[dataField].push("#NuN#")}var i=true;for(var f=0;f<this.gridData[r].filterInfo.length;f++){if(this.gridData[r].filterInfo[f].DataField==dataField){if(!this.gridData[r].filterInfo[f].NullIncluded){i=false}}}if(i&&this.gridData[r].blackLists[dataField].visibles.indexOf("#NuN#")==-1){this.gridData[r].blackLists[dataField].visibles.push("#NuN#")}}else{this.gridData[r].blackLists[dataField].hasNull=false}for(var f=0;f<e.NotNullValues.length;f++){if(this.gridData[r].differentValues[dataField].indexOf(e.NotNullValues[f])==-1){this.gridData[r].differentValues[dataField].push(e.NotNullValues[f])}if(this.gridData[r].blackLists[dataField].state=="all"&&this.gridData[r].blackLists[dataField].visibles.indexOf(e.NotNullValues[f])==-1){this.gridData[r].blackLists[dataField].visibles.push(e.NotNullValues[f])}if(this.gridData[r].blackLists[dataField].state=="none"&&this.gridData[r].blackLists[dataField].hiddens.indexOf(e.NotNullValues[f])==-1){this.gridData[r].blackLists[dataField].hiddens.push(e.NotNullValues[f])}if(this.gridData[r].blackLists[dataField].defaultAction=="Exclude"&&this.gridData[r].blackLists[dataField].state==""&&e.NotNullValues[f].trimpivot()!=""&&this.gridData[r].blackLists[dataField].visibles.length>0){for(var l=0;l<this.gridData[r].blackLists[dataField].visibles.length;l++){if(this.gridData[r].blackLists[dataField].visibles[l]==e.NotNullValues[f].trimpivot()){this.gridData[r].blackLists[dataField].visibles[l]=e.NotNullValues[f]}}}}this.gridData[r].grid.loadDifferentValues(a,this.gridData[r].differentValues[dataField]);if(t==undefined){a++;OAT_JS.grid.initValueRead(r,a)}},changeValues:function(e,r,t,a,s){var i=jQuery("#"+e+r)[0];if((i.value||i.value=="")&&i.value!=s){return}var t=this.gridData[e].columnDataField.indexOf(r);var f=this.gridData[e].originalColumnDataField.indexOf(r);this.gridData[e].differentValuesPaginationInfo[r].filtered=true;this.gridData[e].differentValuesPaginationInfo[r].blocked=true;OAT.removeAllPairsFromPopUp(this.gridData[e],t,a.PagesCount>1);this.gridData[e].filteredValuesPaginationInfo[r].previousPage=1;this.gridData[e].filteredValuesPaginationInfo[r].totalPages=a.PagesCount;this.gridData[e].filteredValuesPaginationInfo[r].filteredText=s;for(var l=0;l<a.NotNullValues.length;l++){var n=this.gridData[e].differentValues[r].indexOf(a.NotNullValues[l])!=-1;if(this.gridData[e].differentValues[r].indexOf(a.NotNullValues[l])==-1){this.gridData[e].differentValues[r].push(a.NotNullValues[l])}if(this.gridData[e].blackLists[r].state=="all"||this.gridData[e].blackLists[r].defaultAction=="Include"&&!n){if(this.gridData[e].blackLists[r].visibles.indexOf(a.NotNullValues[l])==-1&&this.gridData[e].blackLists[r].hiddens.indexOf(a.NotNullValues[l])==-1){this.gridData[e].blackLists[r].visibles.push(a.NotNullValues[l])}}var o=true;if(this.gridData[e].blackLists[r].state!="all"){if(this.gridData[e].blackLists[r].visibles.indexOf(a.NotNullValues[l])<0){o=false}}this.gridData[e].filteredValuesPaginationInfo[r].values.push(a.NotNullValues[l]);var u=OAT.ApplyPictureValue(a.NotNullValues[l].trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[f],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[f]).replace(/ /g," ");if(!(this.gridData[e].blackLists[r].hasNull&&a.NotNullValues[l].trimpivot()==this.gridData[e].defaultNullText)){OAT.appendNewPairToPopUp(this.gridData[e],a.NotNullValues[l],t,o,u,r)}}if(a.PagesCount>0)this.gridData[e].differentValuesPaginationInfo[r].blocked=false},setColumnVisibleValue:function(e,r,t){var a=this.gridData[e].originalColumnDataField.indexOf(this.gridData[e].columnDataField[r]);this.gridData[e].columnVisible[a]=t;OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[e],e,OAT_JS.grid.gridData[e].blackLists,OAT_JS.grid.gridData[e].columnVisible,OAT_JS.grid.gridData[e].columnDataField);if(qv.collection[OAT_JS.grid.gridData[e].IdForQueryViewerCollection].AutoRefreshGroup!=""){OAT_JS.grid.initValueRead(e,0);var s=function(){if(!OAT_JS.grid.gridData[e].endValueRead){setTimeout(s,100)}else{var r=OAT.createXMLMetadata(OAT_JS.grid.gridData[e],null,true);var t=OAT_JS.grid.gridData[e].IdForQueryViewerCollection;setTimeout((function(){var e={QueryviewerId:t,Metadata:r};var a=document.createEvent("Events");a.initEvent("RequestUpdateLayoutSameGroup",true,true);a.parameter=e;document.dispatchEvent(a)}),50)}};s()}},getTableWhenServerPagination:function(e,r){var t=r.split("<Recordset");var a="<Recordset"+t[1];var s=a.split("</Page>");var i=s[0]+"</Page>\n</Recordset>";return i},setFilterChangedWhenServerPagination:function(e,r){if(qv.collection[OAT_JS.grid.gridData[e].IdForQueryViewerCollection].FilterChanged||qv.util.isGeneXusPreview()){var t=r.getAttribute("dataField");var a=OAT_JS.grid.gridData[e].differentValues[t];if(OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t].previousPage==OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t].totalPages){var s='<DATA event="FilterChanged" name="'+r.getAttribute("name")+'" displayName="'+r.getAttribute("displayName")+'">';for(var i=0;i<a.length;i++){var f=true;if(OAT_JS.grid.gridData[e].blackLists[t].state!="all"){if(OAT_JS.grid.gridData[e].blackLists[t].visibles.indexOf(a[i])<0){f=false}}if(f){s=s+"<VALUE>"+a[i]+"</VALUE>"}}s=s+"</DATA>";if(qv.util.isGeneXusPreview())window.external.SendText(qv.collection[OAT_JS.grid.gridData[e].IdForQueryViewerCollection].ControlName,s);var l=qv.util.dom.xmlDocument(s);var n=qv.util.dom.selectXPathNode(l,"/DATA");var o={};o.Name=n.getAttribute("name");o.SelectedValues=[];var u=-1;for(var v=0;v<n.childNodes.length;v++)if(n.childNodes[v].nodeName=="VALUE"){u++;o.SelectedValues[u]=n.childNodes[v].firstChild.nodeValue}self.fireOnFilterChanged(e,o)}else{OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t].blocked=true;var c=OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t];var d=c.previousPage+1;OAT_JS.grid.gridData[e].lastRequestValue=t;OAT_JS.grid.lastCallToQueryViewer="filterChange";OAT_JS.grid.lastCallData={self:this,UcId:e,filterValue:"",dataField:t,oatDimension:r};self.requestAttributeForTable(e,t,d,"",0)}}},getAllDataRowsForExport:function(e,r,t,a){OAT_JS.grid.lastCallToQueryViewer="getAllDataRowsForExport";OAT_JS.grid.lastCallData={UcId:e,_selfgrid:r,fileName:t,format:a};self.requestPageDataForTable(1,0,false,OAT_JS.grid.gridData[e].dataFieldOrder,OAT_JS.grid.gridData[e].orderType,OAT_JS.grid.gridData[e].filterInfo,false,OAT_JS.grid.gridData[e].IdForQueryViewerCollection)},restoreDefaultView:function(e){this.gridData[e].redrawHeader=true;this.gridData[e].columnDataField=this.gridData[e].originalColumnDataField;OAT_JS.grid.gridData[e].dataFieldOrder="";OAT_JS.grid.gridData[e].orderType="";this.gridData[e].filterInfo=[];var r=[];for(var t=0;t<OAT_JS.grid.gridData[e].grid.columns.length;t++){r[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")]=this.gridData[e].blackLists[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")].hasNull}for(var t=0;t<OAT_JS.grid.gridData[e].grid.columns.length;t++){this.gridData[e].blackLists[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")]={state:"all",visibles:[],defaultAction:"Include",hiddens:[],hasNull:r[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")]}}var a=0;for(var s=0;s<this.gridData[e].columnVisible.length;s++){this.gridData[e].grid.applySortOrderType(s,1);this.gridData[e].columnVisible[s]=OAT_JS.grid.gridData[e].grid.columns[s].getAttribute("visible").toLowerCase()=="yes";if(this.gridData[e].columnVisible[s]){this.gridData[e].grid.showColumnHeader(a);a=a+1}else{this.gridData[e].grid.hideColumnHeader(a);a=a+1}}this.gridData[e].rowsPerPage=this.gridData[e].defaultValues.rowsPerPage;if(jQuery("#"+this.gridData[e].grid.controlName+"tablePagination_rowsPerPage").length>0){jQuery("#"+this.gridData[e].grid.controlName+"tablePagination_rowsPerPage")[0].value=this.gridData[e].defaultValues.rowsPerPage}},getStateChange:function(e){if(this.gridData[e].rowsPerPage!=this.gridData[e].defaultValues.rowsPerPage){return true}if(this.gridData[e].defaultValues.dataFieldOrder!=OAT_JS.grid.gridData[e].dataFieldOrder||this.gridData[e].defaultValues.orderType!=OAT_JS.grid.gridData[e].orderType){return true}if(this.gridData[e].filterInfo!=undefined&&this.gridData[e].filterInfo.length>0){return true}for(var r=0;r<this.gridData[e].columnVisible.length;r++){var t=OAT_JS.grid.gridData[e].grid.columns[r].getAttribute("visible").toLowerCase()=="yes";if(this.gridData[e].columnVisible[r]!=t){return true}}for(var a=0;a<this.gridData[e].columnDataField.length;a++){if(this.gridData[e].columnDataField[a]!=this.gridData[e].originalColumnDataField[a])return true}return false},refreshPivotWhenServerPagination:function(e,r,t,a){self.getDataForTable(e,1,this.gridData[e].rowsPerPage,true,r,t,"","","",true)},moveToFirstPage:function(e){if(this.gridData[e].actualPageNumber>1){self.getDataForTable(e,1,this.gridData[e].rowsPerPage,false,"","","","",false)}},moveToNextPage:function(e){if(this.gridData[e].actualPageNumber<this.gridData[e].actualCantPages){self.getDataForTable(e,this.gridData[e].actualPageNumber+1,this.gridData[e].rowsPerPage,false,"","","","",false)}},moveToLastPage:function(e){if(this.gridData[e].actualPageNumber<this.gridData[e].actualCantPages){self.getDataForTable(e,this.gridData[e].actualCantPages,this.gridData[e].rowsPerPage,false,"","","","",false)}},moveToPreviousPage:function(e){if(this.gridData[e].actualPageNumber>1){self.getDataForTable(e,this.gridData[e].actualPageNumber-1,this.gridData[e].rowsPerPage,false,"","","","",false)}},cantPages:function(e,r){return this.gridData[e].differentValuesPaginationInfo[r].totalPages},setDataFieldPosition:function(e,r){this.gridData[e].columnDataField=[];this.gridData[e].columnDataField=r;OAT.SaveStateWhenServerPaging(this.gridData[e],e,this.gridData[e].blackLists,this.gridData[e].columnVisible,this.gridData[e].columnDataField);if(qv.collection[OAT_JS.grid.gridData[e].IdForQueryViewerCollection].AutoRefreshGroup!=""){OAT_JS.grid.initValueRead(e,0);var t=function(){if(!OAT_JS.grid.gridData[e].endValueRead){setTimeout(t,100)}else{var r=OAT.createXMLMetadata(OAT_JS.grid.gridData[e],null,true);var a=OAT_JS.grid.gridData[e].IdForQueryViewerCollection;setTimeout((function(){var e={QueryviewerId:a,Metadata:r};var t=document.createEvent("Events");t.initEvent("RequestUpdateLayoutSameGroup",true,true);t.parameter=e;document.dispatchEvent(t)}),50)}};t()}},fireOnItemClickEvent:function(e,r){setTimeout((function(){var t={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection};var a=document.createEvent("Events");a.initEvent("TableOnItemClickEvent",true,true);a.parameter=t;document.dispatchEvent(a)}),0)},requestDataSynForTable:function(e){setTimeout((function(){var r={QueryviewerId:e};var t=document.createEvent("Events");t.initEvent("RequestDataSynForTable",true,true);t.parameter=r;document.dispatchEvent(t)}),0)},addValueToDifferentValues:function(e,r,t){var a=this.gridData[e].originalColumnDataField.indexOf(r);var s=this.gridData[e].grid.columnsDataType[a];var i=false;if(s=="integer"||s=="real"){i=true}var f=[];var l=false;if(t=="#NuN#"){f.push(t);l=true}for(var n=0;n<this.gridData[e].differentValues[r].length;n++){if(!i){if(t<this.gridData[e].differentValues[r][n]&&!l){f.push(t);l=true}f.push(this.gridData[e].differentValues[r][n])}else{if(parseFloat(t)<parseFloat(this.gridData[e].differentValues[r][n])&&!l){f.push(t);l=true}f.push(this.gridData[e].differentValues[r][n])}}if(!l){f.push(t)}this.gridData[e].differentValues[r]=f}};OAT_JS.pivot={panel:1,tab:5,div:"",needs:["pivot","statistics"],cb:function(e,r,t,a,s,i,f,l,n,o,u,v,c,d,m,h,p,T,A,w,O,y,_,g,b){this.div=r;var x=columnNumbers.length+rowNumbers.length+filterNumbers.length;if(measures.length>1){var F=x;x=x+measures.length-1;for(var S=F;S<x;S++){columnNumbers.push(S)}}else{for(var S=0;S<data.length;S++){data[S].push("0")}}var k;try{k=new OAT.Pivot(e,a,t,header,data,columnNumbers,rowNumbers,filterNumbers,x,query,conditionalFormats,c,pageSize,s,i,f,r,l,n,o,measures,u,v,c,d,m,h,p,T,A,w,O,y,_,g,{Allow:b.AllowSelection,EntireLine:b.SelectLine},{TotalForRows:b.TotalForRows,TotalForColumns:b.TotalForColumns},b.Title)}catch(e){}return k}};function parseToIntRegisterValue(e,r){if(e.indexOf(r)>0){var t=e.split(r+'="');if(t.length==1){t=e.split(r+"='");return t[1]?parseInt(t[1].split("'")[0]):-1}return t[1]?parseInt(t[1].split('"')[0]):-1}return-1}function parseToStringRegisterValue(e,r){if(e.indexOf(r)>0){var t=e.split(r+'="');if(t.length==1){t=e.split(r+"='");return t[1]?t[1].split("'")[0]:-1}return t[1]?t[1].split('"')[0]:-1}return-1}function EvaluateExpressionPivotJs(e,r,t){var a=[];for(var s=0;s<e.length;s++){a[s]=e[s]}var i=[];while(a.length!=0){var f=a.shift();if(isOperator(f)){var l=i.pop();var n=i.pop();var o=PerformOperation(parseFloat(l),parseFloat(n),f);i.push(o)}else{if(isNaN(parseInt(f))){if(r[t.itemPosition[f]]=="#NuN#")return"#NuN#";i.push(r[t.itemPosition[f]])}else{i.push(f)}}}return i.pop()}function PerformOperation(e,r,t){switch(t){case"+":return e+r;case"-":return r-e;case"*":return e*r;case"/":return r/e;default:return}}function InfixToPostfix(e){var r=e.split(" ");var t=[];var a=[];while(r.length!=0){var s=r.shift();if(isOperator(s)){while(getAssociativity(s)=="left"&&getPrecedence(s)<=getPrecedence(a[a.length-1])||getAssociativity(s)=="right"&&getPrecedence(s)<getPrecedence(a[a.length-1])){t.push(a.pop())}a.push(s)}else if(s=="("){a.push(s)}else if(s==")"){while(a[a.length-1]!="("){if(a.length==0)throw"";t.push(a.pop())}a.pop()}else{t.push(s)}}while(a.length!=0){if(!a[a.length-1].match(/([()])/))t.push(a.pop());else throw"Parenthesis balancing error! Shame on you!"}return t.join(" ")}function isOperator(e){if(!e.match(/([*+-\/])/))return false;else return true}function getPrecedence(e){switch(e){case"^":return 9;case"*":case"/":case"%":return 8;case"+":case"-":return 6;default:return-1}}function getAssociativity(e){switch(e){case"+":case"-":case"*":case"/":return"left";case"^":return"right"}}function OATSetCookie(e,r,t,a,s,i){document.cookie=e+"="+escape(r)+(t==null?"":"; expires="+t.toGMTString())+(a==null?"":"; path="+a)+(s==null?"":"; domain="+s)+(i==null?"":"; secure")}function OATGetCookie(e){var r=e+"=";var t=document.cookie;if(t.length>0){begin=t.indexOf(r);if(begin!=-1){begin+=r.length;end=t.indexOf(";",begin);if(end==-1)end=t.length;return unescape(t.substring(begin,end))}}return null}function OATGetRowsFromXML(e,r,t){var a=[];var s=e.split("<Rows>");if(s.length){s=s[1].split("</Rows>");s=s[0].split("<Row>");for(var i=1;i<s.length;i++){var f={headers:[],cells:[],subTotal:false,dataField:-1,rowSpan:0};var l=parseToStringRegisterValue(s[i],"Subtotal");if(l=="true"){f.subTotal=true}var n;if(s[i].indexOf("</Header>")>0){n=s[i].split("</Header>")[0].replace("<Header>","")}else{n=s[i].split("/>")[0].replace("<Header","")}f.dataField=parseToStringRegisterValue(n,"DataField");var o=n.replace(/<\//g,"-*-5").replace(/\/>/g,"-*-5");var u=o.split("-*-5");for(var v=1;v<u.length;v++){var c;var d=u[v].split(">")[0];if(d==""){d=u[v-1].split("<")[1].split(" ")[0];c="#NuN#"}else{try{c=u[v-1].split(d+">")[1].split("<")[0]}catch(e){c="#NuN#"}}var m={dataField:d,value:c,rowSpan:1};var h=u.length-1;if(t){h=u.length;if(f.subTotal){h--}}var p=v-h>=0;if(a.length>0&&!p){if(v-1==0||f.headers[v-2].rowSpan==0){if(c==a[i-2].headers[v-1].value){m.rowSpan=0;var T=i-2;while(T>=0){if(a[T].headers[v-1].rowSpan>0){a[T].headers[v-1].rowSpan++;break}T--}}}}f.headers.push(m)}if(t&&f.subTotal){if(i==1||!a[i-2].subTotal||f.headers.length!=a[i-2].headers.length){f.rowSpan=1}else{var T=i-2;while(T>=0){if(a[T].rowSpan>0){a[T].rowSpan++;break}T--}}}var A=s[i].split("<Cells>")[1].split("</Cell>");for(var w=0;w<A.length-1;w++){var O=f.dataField!=-1?f.dataField:r.columnsHeaders[w].dataField;for(var y=1;y<A[w].split("<Cell />").length;y++){var _={value:"#NuN#",dataField:O};f.cells.push(_)}var c=A[w].split("<Cell>")[1];var _={value:c,dataField:O};f.cells.push(_)}for(var y=1;y<A[w].split("<Cell />").length;y++){var _={value:"#NuN#",dataField:O};f.cells.push(_)}a.push(f)}}return a}function OATGetColumnsHeadersFromXML(e){var r=e.split("<Columns>");var t=[];if(r.length>1){r=r[1].split("</Columns>")[0];var a=r.split("<Header");for(var s=1;s<a.length;s++){var i=parseToStringRegisterValue(a[s],"DataField");var f=parseToStringRegisterValue(a[s],"Subtotal");var l=[];var n=a[s].replace('DataField="'+i+'">',"").replace("DataField='"+i+"'>","").replace("</Header>","").replace(/IsNull="true" \/>/g,">#NuN#<F>").replace(/IsNull='true' \/>/g,">#NuN#<F>").replace(/IsNull="true"\/>/g,">#NuN#<F>").split("<");if(n.length>1){for(var o=1;o<n.length-1;o++){if(o%2==1){var u=n[o].split(">")[0];var v=n[o].split(u+">")[1];var c={dataField:u,value:v,colSpan:1};l.push(c)}}}t.push({dataField:i,subTotal:f=="true",subHeaders:l})}}return t}function OATGetNewDataFromXMLForPivot(e,r,t,a){e=e.replace(/<Cell\/>/g,"<Cell />");if(a==undefined||a==""){if(parseToIntRegisterValue(e,"RecordCount")!=-1){r.ServerRecordCount=parseToIntRegisterValue(e,"RecordCount")}if(parseToIntRegisterValue(e,"PageCount")!=-1){r.ServerPageCount=parseToIntRegisterValue(e,"PageCount")}}r.ServerPageNumber=parseToIntRegisterValue(e,"PageNumber");if(e.split("<Columns>").length>1){r.columnsHeaders=OATGetColumnsHeadersFromXML(e)}r.rows=OATGetRowsFromXML(e,r,t);return r}function OATgetDataFromXMLOldFormat(e,r,t){var a=e.split("<Record>");var s=[];var i=[];for(var f=1;f<a.length;f++){var l=[];var n=[];for(var o=0;o<r.length;o++){l[o]="#NuN#";var u=a[f].split("<"+r[o]+">");if(u.length>1){var v=u[1].split("</"+r[o]+">");l[o]=v[0];n[o]=l[o]}}s.push(l);if(t!=undefined){var c=r.length;for(var o=0;o<t.length;o++){n[c+o]=undefined;var u=a[f].split("<"+t[o]+">");if(u.length>1){var v=u[1].split("</"+t[o]+">");n[c+o]=v[0]}}i.push(n)}}if(t!=undefined){return[s,i]}else{return s}}var OATParseMetadata=function(e,r,t,a,s){var i=[];var f=[];var l=[];var n;if(e.indexOf("<OLAPDimension")!=-1){n=e.substring(0,e.indexOf("<OLAPDimension"))}else{n=e.substring(0,e.indexOf("<OLAPMeasure"))}var o=e.substring(e.indexOf("<OLAPDimension"),e.length);var u=o.split("<OLAPDimension");for(var v=1;v<u.length;v++){if(u[v].length>0){if(u[v].indexOf("</OLAPDimension>")!=-1){u[v]=u[v].substring(0,u[v].indexOf("</OLAPDimension>"))}else{u[v]=u[v].substring(0,u[v].indexOf("/>"))+">"}var c=false;if(r!=undefined&&r.length>0){var d=u[v].split('dataField="')[1].split('"')[0];c=r.indexOf(d)!=-1}if((u[v].indexOf('visible="No"')!=-1||u[v].indexOf('visible="Never"')!=-1)&&r==undefined||c&&r!=undefined){try{if(u[v].indexOf("displayName=")!=-1){var m=u[v].substring(u[v].indexOf("displayName=")+13);i.push(m.split('"')[0]);f.push(u[v].substring(u[v].indexOf("dataField=")+11).split('"')[0]);try{l.push(u[v].substring(u[v].indexOf("name=")+6).split('"')[0])}catch(e){}}}catch(e){}u[v]=""}else{u[v]="<OLAPDimension "+u[v]+"</OLAPDimension>"}}else{u[v]=""}}var h=o.split("<OLAPMeasure");var p=true;for(var v=1;v<h.length;v++){var c=false;if(t!=undefined&&t.length>0){var d=h[v].split('dataField="')[1].split('"')[0];c=t.indexOf(d)!=-1}if(!c){if(h[v].indexOf("</OLAPMeasure")!=-1){h[v]="<OLAPMeasure "+h[v].substring(0,h[v].indexOf("</OLAPMeasure>"))+"</OLAPMeasure>"}else if(h[v].indexOf("/>")!=-1){h[v]="<OLAPMeasure "+h[v].substring(0,h[v].indexOf("/>"))+"/>"}else{h[v]=""}p=false}else{h[v]=""}}if(a&&p){h.push('<OLAPMeasure name="Quantity" displayName="'+s.GXPL_QViewerQuantity+'" description="'+s.GXPL_QViewerQuantity+'" dataField="F0" aggregation="count" summarize="yes" align="right" picture="" targetValue="0" defaultPosition="data" validPositions="data" dataType="integer" format="borderThickness:1"> </OLAPMeasure>')}var T="</OLAPCube>";e="";e=n;for(var v=1;v<u.length;v++){if(u[v].length>0){e=e+u[v]}}for(var v=1;v<h.length;v++){if(h[v].length>0){e=e+h[v]}}e=e+T;return[e,i,f,l]};var OATGetColumnsAndMeasureMeatadata=function(e,r,t,a){var s=[];var i=[];var f=[];var l=[];var n=[];var o=[];var u=[];var v=0;var c=0;var d=[];var m=[];var h=[];var p=[];for(var T=0;T<e.length;T++){if(e[T].attributes.getNamedItem("axis").nodeValue.toLowerCase()=="rows"||e[T].attributes.getNamedItem("axis").nodeValue==""){i[v]=e[T].attributes.getNamedItem("displayName").nodeValue;s[T]=i[v];v++}if(e[T].attributes.getNamedItem("axis").nodeValue.toLowerCase()=="columns"){f[c]=e[T].attributes.getNamedItem("displayName").nodeValue;s[T]=f[c];c++}if(e[T].attributes.getNamedItem("axis").nodeValue.toLowerCase()=="pages"){l[c]=e[T].attributes.getNamedItem("displayName").nodeValue;s[T]=l[c];c++}d[T]=e[T].attributes.getNamedItem("dataType").nodeValue;if(e[T].childNodes.length>0){if(e[T].childNodes!=null){for(var A=0;A<e[T].childNodes.length;A++){if(e[T].childNodes[A].localName=="formatValues"){for(var w=0;w<e[T].childNodes[A].childNodes.length;w++){if(e[T].childNodes[A].childNodes[w].localName=="value"){var O={};O.format=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("format").nodeValue;O.recursive=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("recursive").nodeValue;var y=e[T].childNodes[A].childNodes[w].textContent;O.value=y.replace(/^\s+|\s+$/g,"");O.columnNumber=T}}}}}}if(e[T].childNodes.length>0){if(e[T].childNodes!=null){for(var A=0;A<e[T].childNodes.length;A++){if(e[T].childNodes[A].localName=="conditionalFormats"){for(var w=0;w<e[T].childNodes[A].childNodes.length;w++){if(e[T].childNodes[A].childNodes[w].localName=="rule"){var _={};_.format=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("format").nodeValue;_.operation1=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("op1").nodeValue;_.value1=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("value1").nodeValue;if(e[T].childNodes[A].childNodes[w].attributes.getNamedItem("op2")!=null){_.operation2=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("op2").nodeValue;_.value2=e[T].childNodes[A].childNodes[w].attributes.getNamedItem("value2").nodeValue}_.columnNumber=T;n.push(_)}}}}}}h.push(e[T].attributes.getNamedItem("picture").nodeValue);p.push(e[T].attributes.getNamedItem("format").nodeValue);u.push(e[T].attributes.getNamedItem("dataField").nodeValue)}var g=[];for(var T=0;T<r.length;T++){m[T]=r[T].attributes.getNamedItem("displayName").nodeValue;if(r[T].childNodes.length>0){if(r[T].childNodes!=null){for(var A=0;A<r[T].childNodes.length;A++){if(r[T].childNodes[A].localName=="formatValues"){for(var w=0;w<r[T].childNodes[A].childNodes.length;w++){if(r[T].childNodes[A].childNodes[w].localName=="value"){var O={};O.format=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("format").nodeValue;O.recursive=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("recursive").nodeValue;var y=r[T].childNodes[A].childNodes[w].textContent;O.value=y.replace(/^\s+|\s+$/g,"");O.columnNumber=T}}}}}}if(r[T].childNodes.length>0){if(r[T].childNodes!=null){for(var A=0;A<r[T].childNodes.length;A++){if(r[T].childNodes[A].localName=="conditionalFormats"){for(var w=0;w<r[T].childNodes[A].childNodes.length;w++){if(r[T].childNodes[A].childNodes[w].localName=="rule"){var _={};_.format=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("format").nodeValue;_.operation1=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("op1").nodeValue;_.value1=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("value1").nodeValue;if(r[T].childNodes[A].childNodes[w].attributes.getNamedItem("op2")!=null){_.operation2=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("op2").nodeValue;_.value2=r[T].childNodes[A].childNodes[w].attributes.getNamedItem("value2").nodeValue}_.columnNumber=T;o.push(_)}}}}}}if(r[T].attributes.getNamedItem("formula")!=undefined&&r[T].attributes.getNamedItem("formula").nodeValue!=""){g.push({hasFormula:true,textFormula:r[T].attributes.getNamedItem("formula").nodeValue})}else{g.push({hasFormula:false})}h.push(r[T].attributes.getNamedItem("picture").nodeValue);u.push(r[T].attributes.getNamedItem("dataField").nodeValue)}var b={};for(var v=0;v<a.length;v++){b[a[v]]=u.length+v}t.itemPosition=b;t.measureFormula=g;t.cantFormulaMeasures=0;for(var w=0;w<t.measureFormula.length;w++){if(t.measureFormula[w].hasFormula){t.cantFormulaMeasures++;var x=t.measureFormula[w].textFormula;var F=x;var S=["*","-","+","/","(",")"];for(var v=0;v<S.length;v++){var k=F.split(S[v]);if(k.length>1){F="";for(var T=0;T<k.length-1;T++){F=F+k[T]+" "+S[v]+" "}F=F+k[k.length-1]}}var N=InfixToPostfix(F);t.measureFormula[w].polishNotationText=N;var I=N.split(" ");while(I.indexOf("")!=-1){I.splice(I.indexOf(""),1)}var D=[];for(var c=0;c<I.length;c++){if(S.indexOf(I[c])==-1&&isNaN(parseInt(I[c]))){var E=t.itemPosition[I[c]];if(D.indexOf(E)==-1)D.push(E)}}t.measureFormula[w].relatedMeasures=D;var C=N.split(" ");while(C.indexOf("")!=-1){C.splice(C.indexOf(""),1)}t.measureFormula[w].PolishNotation=C}}return[s.concat(m),u,g,o,n,h,p]};var OATgetState=function(query,controlName){if(typeof JSON.retrocycle!=="function"){JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function rez(value){var i,item,name,path;if(value&&typeof value==="object"){if(Object.prototype.toString.apply(value)==="[object Array]"){for(i=0;i<value.length;i+=1){item=value[i];if(item&&typeof item==="object"){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[i]=eval(path)}else{rez(item)}}}}else{for(name in value){if(typeof value[name]==="object"){item=value[name];if(item){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[name]=eval(path)}else{rez(item)}}}}}}})($);return $}}try{var i;if(localStorage.getItem(OAT.getURL()+query+controlName+"HiddenState")!=null){var retrievedObject=localStorage.getItem(OAT.getURL()+query+controlName+"HiddenState");i=JSON.retrocycle(JSON.parse(retrievedObject))}if(i==null){var cookieValue=OATGetCookie('"'+OAT.getURL()+query+controlName+"HiddenState"+"cookie"+'"');if(cookieValue!=null){i=JSON.parse(cookieValue)}}return i}catch(e){try{var cookieValue=OATGetCookie('"'+OAT.getURL()+query+controlName+"HiddenState"+"cookie"+'"');var i=JSON.parse(cookieValue);return i}catch(e){return null}}};OAT.Layers=function(e){var r=this;this.baseOffset=e;this.layers=[];this.currentIndex=0;this.raise=function(e){if(-1!=r.layers.indexOf(e)){for(var t=e.style.zIndex,a=0;a<r.layers.length;a++){var s=r.layers[a];s.style.zIndex>t&&s.style.zIndex--}e.style.zIndex=r.currentIndex}};this.addLayer=function(e,t){var a=OAT.$(e);a&&(r.currentIndex++,a.style.zIndex=r.currentIndex,r.layers.push(a),OAT.Dom.attach(a,t?t:"mousedown",(function(){r.raise(a)})))};this.removeLayer=function(e){e=OAT.$(e);e=r.layers.indexOf(e);-1!=e&&r.layers.splice(e,1)};r.currentIndex=r.baseOffset};(function(){function e(e){e.fn._fadeIn=e.fn.fadeIn;var r=e.noop||function(){};var t=/MSIE/.test(navigator.userAgent);var a=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var s=e.isFunction(document.createElement("div").style.setExpression);e.blockUI=function(e){l(window,e)};e.unblockUI=function(e){n(window,e)};e.growlUI=function(r,t,a,s){var i=e('<div class="growlUI"></div>');if(r)i.append("<h1>"+r+"</h1>");if(t)i.append("<h2>"+t+"</h2>");if(a===undefined)a=3e3;var f=function(r){r=r||{};e.blockUI({message:i,fadeIn:typeof r.fadeIn!=="undefined"?r.fadeIn:700,fadeOut:typeof r.fadeOut!=="undefined"?r.fadeOut:1e3,timeout:typeof r.timeout!=="undefined"?r.timeout:a,centerY:false,showOverlay:false,onUnblock:s,css:e.blockUI.defaults.growlCSS})};f();i.css("opacity");i.mouseover((function(){f({fadeIn:0,timeout:3e4});var r=e(".blockMsg");r.stop();r.fadeTo(300,1)})).mouseout((function(){e(".blockMsg").fadeOut(1e3)}))};e.fn.block=function(r){if(this[0]===window){e.blockUI(r);return this}var t=e.extend({},e.blockUI.defaults,r||{});this.each((function(){var r=e(this);if(t.ignoreIfBlocked&&r.data("blockUI.isBlocked"))return;r.unblock({fadeOut:0})}));return this.each((function(){if(e.css(this,"position")=="static"){this.style.position="relative";e(this).data("blockUI.static",true)}this.style.zoom=1;l(this,r)}))};e.fn.unblock=function(r){if(this[0]===window){e.unblockUI(r);return this}return this.each((function(){n(this,r)}))};e.blockUI.version=2.7;e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.1,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1e3,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var i=null;var f=[];function l(l,o){var v,h;var p=l==window;var T=o&&o.message!==undefined?o.message:undefined;o=e.extend({},e.blockUI.defaults,o||{});if(o.ignoreIfBlocked&&e(l).data("blockUI.isBlocked"))return;o.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,o.overlayCSS||{});v=e.extend({},e.blockUI.defaults.css,o.css||{});if(o.onOverlayClick)o.overlayCSS.cursor="pointer";h=e.extend({},e.blockUI.defaults.themedCSS,o.themedCSS||{});T=T===undefined?o.message:T;if(p&&i)n(window,{fadeOut:0});if(T&&typeof T!="string"&&(T.parentNode||T.jquery)){var A=T.jquery?T[0]:T;var w={};e(l).data("blockUI.history",w);w.el=A;w.parent=A.parentNode;w.display=A.style.display;w.position=A.style.position;if(w.parent)w.parent.removeChild(A)}e(l).data("blockUI.onUnblock",o.onUnblock);var O=o.baseZ;var y,_,g,b;if(t||o.forceIframe)y=e('<iframe class="blockUI" style="z-index:'+O+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+o.iframeSrc+'"></iframe>');else y=e('<div class="blockUI" style="display:none"></div>');if(o.theme)_=e('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+O+++';display:none"></div>');else _=e('<div class="blockUI blockOverlay" style="z-index:'+O+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');if(o.theme&&p){b='<div class="blockUI '+o.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(O+10)+';display:none;position:fixed">';if(o.title){b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"}b+='<div class="ui-widget-content ui-dialog-content"></div>';b+="</div>"}else if(o.theme){b='<div class="blockUI '+o.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(O+10)+';display:none;position:absolute">';if(o.title){b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"}b+='<div class="ui-widget-content ui-dialog-content"></div>';b+="</div>"}else if(p){b='<div class="blockUI '+o.blockMsgClass+' blockPage" style="z-index:'+(O+10)+';display:none;position:fixed"></div>'}else{b='<div class="blockUI '+o.blockMsgClass+' blockElement" style="z-index:'+(O+10)+';display:none;position:absolute"></div>'}g=e(b);if(T){if(o.theme){g.css(h);g.addClass("ui-widget-content")}else g.css(v)}if(!o.theme)_.css(o.overlayCSS);_.css("position",p?"fixed":"absolute");if(t||o.forceIframe)y.css("opacity",0);var x=[y,_,g],F=p?e("body"):e(l);e.each(x,(function(){this.appendTo(F)}));if(o.theme&&o.draggable&&e.fn.draggable){g.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var S=s&&(!e.support.boxModel||e("object,embed",p?null:l).length>0);if(a||S){if(p&&o.allowBodyStretch&&e.support.boxModel)e("html,body").css("height","100%");if((a||!e.support.boxModel)&&!p){var k=m(l,"borderTopWidth"),N=m(l,"borderLeftWidth");var I=k?"(0 - "+k+")":0;var D=N?"(0 - "+N+")":0}e.each(x,(function(e,r){var t=r[0].style;t.position="absolute";if(e<2){if(p)t.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+o.quirksmodeOffsetHack+') + "px"');else t.setExpression("height",'this.parentNode.offsetHeight + "px"');if(p)t.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');else t.setExpression("width",'this.parentNode.offsetWidth + "px"');if(D)t.setExpression("left",D);if(I)t.setExpression("top",I)}else if(o.centerY){if(p)t.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');t.marginTop=0}else if(!o.centerY&&p){var a=o.css&&o.css.top?parseInt(o.css.top,10):0;var s="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+a+') + "px"';t.setExpression("top",s)}}))}if(T){if(o.theme)g.find(".ui-widget-content").append(T);else g.append(T);if(T.jquery||T.nodeType)e(T).show()}if((t||o.forceIframe)&&o.showOverlay)y.show();if(o.fadeIn){var E=o.onBlock?o.onBlock:r;var C=o.showOverlay&&!T?E:r;var P=T?E:r;if(o.showOverlay)_._fadeIn(o.fadeIn,C);if(T)g._fadeIn(o.fadeIn,P)}else{if(o.showOverlay)_.show();if(T)g.show();if(o.onBlock)o.onBlock.bind(g)()}u(1,l,o);if(p){i=g[0];f=e(o.focusableElements,i);if(o.focusInput)setTimeout(c,20)}else d(g[0],o.centerX,o.centerY);if(o.timeout){var j=setTimeout((function(){if(p)e.unblockUI(o);else e(l).unblock(o)}),o.timeout);e(l).data("blockUI.timeout",j)}}function n(r,t){var a;var s=r==window;var l=e(r);var n=l.data("blockUI.history");var v=l.data("blockUI.timeout");if(v){clearTimeout(v);l.removeData("blockUI.timeout")}t=e.extend({},e.blockUI.defaults,t||{});u(0,r,t);if(t.onUnblock===null){t.onUnblock=l.data("blockUI.onUnblock");l.removeData("blockUI.onUnblock")}var c;if(s)c=e("body").children().filter(".blockUI").add("body > .blockUI");else c=l.find(">.blockUI");if(t.cursorReset){if(c.length>1)c[1].style.cursor=t.cursorReset;if(c.length>2)c[2].style.cursor=t.cursorReset}if(s)i=f=null;if(t.fadeOut){a=c.length;c.stop().fadeOut(t.fadeOut,(function(){if(--a===0)o(c,n,t,r)}))}else o(c,n,t,r)}function o(r,t,a,s){var i=e(s);if(i.data("blockUI.isBlocked"))return;r.each((function(e,r){if(this.parentNode)this.parentNode.removeChild(this)}));if(t&&t.el){t.el.style.display=t.display;t.el.style.position=t.position;t.el.style.cursor="default";if(t.parent)t.parent.appendChild(t.el);i.removeData("blockUI.history")}if(i.data("blockUI.static")){i.css("position","static")}if(typeof a.onUnblock=="function")a.onUnblock(s,a);var f=e(document.body),l=f.width(),n=f[0].style.width;f.width(l-1).width(l);f[0].style.width=n}function u(r,t,a){var s=t==window,f=e(t);if(!r&&(s&&!i||!s&&!f.data("blockUI.isBlocked")))return;f.data("blockUI.isBlocked",r);if(!s||!a.bindEvents||r&&!a.showOverlay)return;var l="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(r)e(document).bind(l,a,v);else e(document).unbind(l,v)}function v(r){if(r.type==="keydown"&&r.keyCode&&r.keyCode==9){if(i&&r.data.constrainTabKey){var t=f;var a=!r.shiftKey&&r.target===t[t.length-1];var s=r.shiftKey&&r.target===t[0];if(a||s){setTimeout((function(){c(s)}),10);return false}}}var l=r.data;var n=e(r.target);if(n.hasClass("blockOverlay")&&l.onOverlayClick)l.onOverlayClick(r);if(n.parents("div."+l.blockMsgClass).length>0)return true;return n.parents().children().filter("div.blockUI").length===0}function c(e){if(!f)return;var r=f[e===true?f.length-1:0];if(r)r.focus()}function d(e,r,t){var a=e.parentNode,s=e.style;var i=(a.offsetWidth-e.offsetWidth)/2-m(a,"borderLeftWidth");var f=(a.offsetHeight-e.offsetHeight)/2-m(a,"borderTopWidth");if(r)s.left=i>0?i+"px":"0";if(t)s.top=f>0?f+"px":"0"}function m(r,t){return parseInt(e.css(r,t),10)||0}}{if(typeof jQuery!="undefined"){e(jQuery)}}})();try{OAT.Loader.featureLoaded("layers")}catch(e){}if(GlobalPivotInterval==undefined){var GlobalPivotInterval=[]}OAT.Pivot=function(_mthis,div,filterDiv,headerRow,dataRows,headerRowIndexes,headerColIndexes,filterIndexes,dataColumnIndex,query,condFormats,control,pageSize,defaultPicture,QueryViewerCollection,columns,containerName,formatValue,conditionalFormatsColumns,formatValueMeasures,measures,autoResize,disableColumnSort,UcId,IdForQueryViewerCollection,rememberLayout,ShowMeasuresAsRows,formulaInfo,fullRecord,serverPagination,pageData,hideDataFilds,orderFildsHidden,initMetadata,relativePath,selection,GrandTotalVisibility,pivotTitle){var self=this;this.autoPaging=false;this.nextRowWhenAutopaging=0;this.prevRowWhenAutopaging=0;this.paginationInfo=false;this.TempDataStructForAggStepOptimization=[];this.actualPaginationPage=1;this.allDataWithoutSort=jQuery.extend(true,[],dataRows);this.IdForQueryViewerCollection=IdForQueryViewerCollection;this.UcId=UcId;this.ShowMeasuresAsRows=ShowMeasuresAsRows;this.rememberLayoutStateVersion=serverPagination?"4.3.8SP":"4.3.8";if(measures.length<2){this.ShowMeasuresAsRows=false}this.allRowsPivot="vacio";this.HideDataFilds=hideDataFilds;this.OrderFildsHidden=orderFildsHidden;this.initMetadata=initMetadata;this.relativePath=relativePath;this.selection=selection;this.GrandTotalVisibility=GrandTotalVisibility;this.translations=_mthis.translations;this.isSD=OAT.isSD();fromUndefinedToBlanck(dataRows);if(dataRows[0]!=undefined){if(formulaInfo.cantFormulaMeasures>0){for(var i=0;i<dataRows.length;i++){dataRows[i][headerRow.length]=i}}var sortIntMemory=[];for(var index=headerRow.length-1;index>-1;index--){var sortInt=true;for(var ival=0;ival<dataRows.length;ival++){if(sortInt&&dataRows[ival][index]!=parseInt(dataRows[ival][index])){sortInt=false;break}}sortIntMemory[index]=sortInt}var index=0;if(sortIntMemory[index]){dataRows=dataRows.sort(function(e){return function(r,t){return parseInt(r[e])===parseInt(t[e])?0:parseInt(r[e])<parseInt(t[e])?-1:1}}(index))}else{dataRows=dataRows.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]<t[e]?-1:1}}(index))}var actualVal=dataRows[0][index];var initPos=0;for(var i=0;i<dataRows.length;i++){if(actualVal!=dataRows[i][index]){actualVal=dataRows[i][index];dataRows=OAT.PartialSort(dataRows,initPos,i-1,index+1,headerRow.length,sortIntMemory);initPos=i}else if(i==dataRows.length-1){dataRows=OAT.PartialSort(dataRows,initPos,i,index+1,headerRow.length,sortIntMemory)}}}var tempDataRows=dataRows;dataRows=[];if(tempDataRows.length>0){dataRows[0]=tempDataRows[0]}var act_pos=0;for(var i=1;i<tempDataRows.length;i++){var repeated=true;for(var j=0;j<columns.length;j++){if(tempDataRows[i][j]!=tempDataRows[i-1][j]){repeated=false;break}}if(repeated){for(var j=columns.length;j<columns.length+measures.length;j++){var tot=parseFloat(dataRows[act_pos][j])+parseFloat(tempDataRows[i][j]);if(dataRows[act_pos][j]=="#NuN#"&&tempDataRows[i][j]=="#NuN#"){tot="#NuN#"}else if(dataRows[act_pos][j]=="#NuN#"){tot=tempDataRows[i][j]+""}else if(tempDataRows[i][j]=="#NuN#"){tot=dataRows[act_pos][j]+""}dataRows[act_pos][j]=tot+""}if(formulaInfo.cantFormulaMeasures>0){var filaSumar=dataRows[act_pos][headerRow.length];var filaRepetida=tempDataRows[i][headerRow.length];for(var formulasI=0;formulasI<formulaInfo.measureFormula.length;formulasI++){if(formulaInfo.measureFormula[formulasI].hasFormula){for(var formulasJ=0;formulasJ<formulaInfo.measureFormula[formulasI].relatedMeasures.length;formulasJ++){var pos=formulaInfo.measureFormula[formulasI].relatedMeasures[formulasJ];var tot=parseFloat(fullRecord[filaSumar][pos])+parseFloat(fullRecord[filaRepetida][pos]);fullRecord[filaSumar][pos]=tot+""}}}for(var j=columns.length;j<columns.length+measures.length;j++){var tot=parseFloat(fullRecord[filaSumar][j])+parseFloat(fullRecord[filaRepetida][j]);fullRecord[filaSumar][j]=tot+""}for(var posB=0;posB<headerRow.length;posB++){fullRecord[filaRepetida][posB]=""}}}else{act_pos++;dataRows[act_pos]=tempDataRows[i]}}if(formulaInfo.cantFormulaMeasures>0){if(dataRows[0]!=undefined){for(var it=0;it<dataRows.length;it++){dataRows[it].splice(headerRow.length,1)}}}this.serverPagination=serverPagination;this.pageData=pageData;if(this.serverPagination){this.pageData.PreviousPageNumber=-1;this.pageData.AxisInfo=[];this.pageData.FilterInfo=[]}this.autoPaging=false;this.recordForFormula=fullRecord;this.formulaInfo=formulaInfo;this.filterIndexes=filterIndexes;this.initFilterIndexes=[];for(var i=0;i<this.filterIndexes.length;i++){this.initFilterIndexes[i]=this.filterIndexes[i]}this.getFormulaRowByDataRow=function(e,r,t){var a=false;var s=self.recordForFormula;var i=[];for(var f=0;f<self.formulaInfo.recordDataLength;f++){i[f]=0}for(var l=0;l<s.length;l++){var n=false;for(var o=0;o<e.length;o++){if(self.filterIndexes.indexOf(o)!=-1){var u=self.filterIndexes.indexOf(o);if(self.filterDiv!=undefined){var v=self.filterDiv.selects[u];var c=OAT.$v(v);if(c=="[all]"){n=true}else{n=c==s[l][o];if(!n)break}}else{n=true}}else if(self.filterIndexes.length>0&&o>=e.length-measures.length){n=true}else if(s[l][o]==e[o]||e[o]=="#FoE#"&&s[l][o]==0){n=true}else if(headerRowIndexes!=undefined&&headerRowIndexes.indexOf(o)!=-1&&headerRowIndexes.indexOf(o)>headerRowIndexes.length-measures.length){n=true}else if(dataColumnIndex>0&&dataColumnIndex==o){n=true}else{if(e[o]==undefined&&self.filterIndexes.length>0){n=true}else{n=false;break}}}if(n){for(var d=0;d<self.formulaInfo.measureFormula[r].relatedMeasures.length;d++){var u=self.formulaInfo.measureFormula[r].relatedMeasures[d];i[u]=i[u]+parseFloat(s[l][u])}a=true}}if(a)return i;else return"#NuN#"};for(var mforF=0;mforF<measures.length;mforF++){if(formulaInfo.measureFormula[mforF].hasFormula){for(var rforF=0;rforF<dataRows.length;rforF++){if(dataRows[rforF][dataRows[rforF].length-measures.length+mforF]==0){var formula=this.getFormulaRowByDataRow(dataRows[rforF],mforF,"");var result=EvaluateExpressionPivotJs(formulaInfo.measureFormula[mforF].PolishNotation,formula,formulaInfo);if(result==Infinity||isNaN(result)){dataRows[rforF][dataRows[rforF].length-measures.length+mforF]="#FoE#"}}}}}this.GeneralDataRows=dataRows;this.autoPagingRowsPerPage=pageSize!=undefined?parseInt(pageSize):10;this.TotalPagesPaging=parseInt(dataRows.length/this.autoPagingRowsPerPage);if(dataRows.length%this.autoPagingRowsPerPage!=0){this.TotalPagesPaging++}this.GeneralDistinctValues=[];this.GrandTotalsPaging=[];this.columns=columns;if(dataRows.length>0){fillGeneralDistinctValues(headerRow.length-measures.length,self,dataRows)}this.RowsWhenMoveToFilter=[];this.FilterByTopFilter=false;this.options={headingBefore:1,headingAfter:0,agg:1,aggTotals:1,customType:function(e){return e},showEmpty:0,subtotals:1,totals:1};this.firstTime=true;this.readState=false;this.deleteState=false;this.defaultPicture=defaultPicture;this.gd=new OAT.GhostDrag;this.div=OAT.$(div);this.filterDiv=OAT.$(filterDiv);this.hasShowValuesAs=_mthis.hasShowValuesAs;this.TitleDivId=filterDiv.replace("pivot_page","title_div");if(pivotTitle){this.PivotTitle=pivotTitle;this.TitleDiv=OAT.$(this.TitleDivId);if(!this.TitleDiv){jQuery("#"+this.TitleDivId).remove();this.TitleDiv=OAT.Dom.create("div",{});this.TitleDiv.id=this.TitleDivId;jQuery("#"+containerName).prepend(this.TitleDiv)}}else{jQuery("#"+this.TitleDivId).remove()}this.defCArray=["rgb(153,153,255)","rgb(153,51,205)","rgb(255,255,204)","rgb(204,255,255)","rgb(102,0,102)","rgb(255,128,128)","rgb(0,102,204)","rgb(204,204,255)","rgb(0,0,128)","rgb(255,0,255)","rgb(0,255,255)","rgb(255,255,0)"];this.QueryViewerCollection=QueryViewerCollection;this.containerName=containerName;this.formatValues=formatValue;this.formatValuesMeasures=formatValueMeasures;this.tempBlackLists=[];this.tempCollapsedValues=[];this.oldSortValues=[];this.stateChanged=false;this.rowsPerPage=pageSize;this.headerRow=headerRow;this.allData=dataRows;this.filteredData=[];this.tabularData=[];this.dataColumnIndex=dataColumnIndex;this.rowConditions=headerRowIndexes;this.colConditions=headerColIndexes;this.initRowConditions=[];for(var i=0;i<this.rowConditions.length;i++){this.initRowConditions[i]=this.rowConditions[i]}this.initColConditions=[];for(var i=0;i<this.colConditions.length;i++){this.initColConditions[i]=this.colConditions[i]}if(columns.length==1&&measures.length==0){this.rowConditions=[0]}this.conditions=[];this.filterDiv.selects=[];this.rowStructure={};this.colStructure={};this.colPointers=[];this.rowPointers=[];this.rowTotals=[[],[]];this.colTotals=[[],[]];this.gTotal=[];this.query=query;this.controlName=control;this.conditionalFormats=condFormats;this.conditionalFormatsColumns=conditionalFormatsColumns;this.GreyList=[];this.EmptyValue="#NaV#";this.NullValue="#NuN#";this.initState={};if(typeof JSON.decycle!=="function"){JSON.decycle=function e(r){var t=[],a=[];return function e(r,s){var i,f,l;switch(typeof r){case"object":if(!r){return null}for(i=0;i<t.length;i+=1){if(t[i]===r){return{$ref:a[i]}}}t.push(r);a.push(s);if(Object.prototype.toString.apply(r)==="[object Array]"){l=[];for(i=0;i<r.length;i+=1){l[i]=e(r[i],s+"["+i+"]")}}else{l={};for(f in r){if(Object.prototype.hasOwnProperty.call(r,f)){l[f]=e(r[f],s+"["+JSON.stringify(f)+"]")}}}return l;case"number":case"string":case"boolean":return r}}(r,"$")}}this.saveState=function(e){try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+self.query+self.controlName);localStorage.setItem(OAT.getURL()+self.query+self.controlName,JSON.stringify(JSON.decycle(e)))}else{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"',JSON.stringify(e),null,"/")}}catch(r){try{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"',JSON.stringify(e),null,"/")}catch(e){}}};this.saveHiddenState=function(e){try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+self.query+self.controlName+"HiddenState");localStorage.setItem(OAT.getURL()+self.query+self.controlName+"HiddenState",JSON.stringify(JSON.decycle(e)))}else{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"HiddenState"+"cookie"+'"',JSON.stringify(e),null,"/")}}catch(r){try{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"HiddenState"+"cookie"+'"',JSON.stringify(e),null,"/")}catch(e){}}};this.getState=function(){if(typeof JSON.retrocycle!=="function"){JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function rez(value){var i,item,name,path;if(value&&typeof value==="object"){if(Object.prototype.toString.apply(value)==="[object Array]"){for(i=0;i<value.length;i+=1){item=value[i];if(item&&typeof item==="object"){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[i]=eval(path)}else{rez(item)}}}}else{for(name in value){if(typeof value[name]==="object"){item=value[name];if(item){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[name]=eval(path)}else{rez(item)}}}}}}})($);return $}}try{var i;if(localStorage.getItem(OAT.getURL()+self.query+self.controlName)!=null){var retrievedObject=localStorage.getItem(OAT.getURL()+self.query+self.controlName);i=JSON.retrocycle(JSON.parse(retrievedObject))}if(i==null){var cookieValue=OATGetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"');if(cookieValue!=null){i=JSON.parse(cookieValue)}}return i}catch(e){try{var cookieValue=OATGetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"');var i=JSON.parse(cookieValue);return i}catch(e){return null}}};this.cleanState=function(){for(var e=0;e<self.filterDiv.selects.length;e++){self.filterDiv.selects[e].value="[all]"}for(var r=0;r<=self.conditions.length-1;r++){self.conditions[r].blackList=[];self.conditions[r].whiteList=[];self.conditions[r].greyList=[]}localStorage.removeItem(OAT.getURL()+self.query+self.controlName);self.deleteState=false;var t=new Array;for(var a=0;a<self.initState.colConditions.length;a++){t[a]=self.initState.colConditions[a]}var s=new Array;for(var a=0;a<self.initState.rowConditions.length;a++){s[a]=self.initState.rowConditions[a]}var i=new Array;for(var a=0;a<self.initState.filterIndexes.length;a++){i[a]=self.initState.filterIndexes[a]}this.conditions=jQuery.extend(true,[],self.initState.conditions);this.rowConditions=s;this.colConditions=t;this.filterIndexes=i;this.stateChanged=self.initState.stateChanged;this.rowsPerPage=self.initState.rowsPerPage;var f={query:self.query,conditions:self.conditions,colConditions:self.colConditions,rowConditions:self.rowConditions,filterIndexes:self.filterIndexes,filterDivSelects:[],rowsPerPage:self.rowsPerPage,version:self.rememberLayoutStateVersion};self.saveState(f)};this.cleanStateWhenServerPagination=function(){for(var e=0;e<self.filterDiv.selects.length;e++){self.filterDiv.selects[e].value="[all]"}for(var r=0;r<=self.conditions.length-1;r++){self.conditions[r].blackList=[]}var t=new Array;for(var a=0;a<self.initState.colConditions.length;a++){t[a]=self.initState.colConditions[a]}var s=new Array;for(var a=0;a<self.initState.rowConditions.length;a++){s[a]=self.initState.rowConditions[a]}var i=new Array;for(var a=0;a<self.initState.filterIndexes.length;a++){i[a]=self.initState.filterIndexes[a]}for(var a=0;a<self.conditions.length;a++){if(self.conditions[a]&&self.conditions[a].distinctValues&&self.conditions[a].dataField){var f=-1;for(var l=0;l<self.initState.conditions.length;l++){if(self.initState.conditions[l]){if(self.initState.conditions[l].dataField==self.conditions[a].dataField){f=l}}}if(f>-1){self.initState.conditions[f].distinctValues=[];for(var n=0;n<self.conditions[a].distinctValues.length;n++){if(self.initState.conditions[f]&&self.initState.conditions[f].distinctValues.indexOf(self.conditions[a].distinctValues[n])==-1){self.initState.conditions[f].distinctValues.push(self.conditions[a].distinctValues[n])}}self.initState.conditions[f].previousPage=self.conditions[a].previousPage;self.initState.conditions[f].totalPages=self.conditions[a].totalPages}}}self.conditions=jQuery.extend(true,[],self.initState.conditions);self.pageData.AxisInfo=jQuery.extend(true,[],self.initState.AxisInfo);self.pageData.DataInfo=jQuery.extend(true,[],self.initState.DataInfo);self.pageData.FilterInfo=jQuery.extend(true,[],self.initState.FilterInfo);self.pageData.CollapseInfo=jQuery.extend(true,[],self.initState.CollapseInfo);self.rowConditions=s;self.colConditions=t;self.filterIndexes=i;self.stateChanged=self.initState.stateChanged;self.rowsPerPage=self.initState.rowsPerPage;self.DefaultAction=self.initState.DefaultAction;self.initMetadata=jQuery.extend(true,{},self.initState.InitMetadata);for(var o=0;o<self.initMetadata.Conditions.length;o++){self.initMetadata.Conditions[o]=""}for(var u=0;u<self.initState.conditions.length;u++){var v=self.initState.conditions[u].dataField;if(v){var c=self.initMetadata.DataFields.indexOf(v);self.initMetadata.Conditions[c]=self.conditions[u]}}if(!OAT.isIE()){self.goWhenHide(true)}};this.getDataXML=function(e){var r=e.split("<Recordset")[1];r="<Recordset"+r;return r};this.requestPageDataForPivotTable=function(e,r,t,a,s,i,f,l){setTimeout((function(){var n={PageNumber:e,PageSize:r,ReturnTotPages:t,AxesInfo:a,DataInfo:s,Filters:i,ExpandCollapse:f,LayoutChange:l,QueryviewerId:self.IdForQueryViewerCollection};var o=document.createEvent("Events");o.initEvent("RequestPageDataForPivotTable",true,true);o.parameter=n;document.dispatchEvent(o)}),0)};this.setPageDataForPivotTable=function(e){switch(self.lastCallToQueryViewer){case"initWhenServerPagination":if(!qv.util.anyError(e)||self.QueryViewerCollection[self.IdForQueryViewerCollection].debugServices){self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.preGoWhenServerPagination(true);if(self.filterIndexes.length>0){self.initValueRead(self,0,self.stateLoad)}qv.util.hideActivityIndicator(self.QueryViewerCollection[self.IdForQueryViewerCollection])}else{var r=qv.util.getErrorFromText(e);qv.util.renderError(self.QueryViewerCollection[self.IdForQueryViewerCollection],r)}break;case"callServiceWhenCustomeValues":if(!qv.util.anyError(e)||self.QueryViewerCollection[self.IdForQueryViewerCollection].debugServices){self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.preGoWhenServerPagination(true);qv.util.hideActivityIndicator(self.QueryViewerCollection[self.IdForQueryViewerCollection])}else{var r=qv.util.getErrorFromText(e);qv.util.renderError(self.QueryViewerCollection[self.IdForQueryViewerCollection],r)}break;case"refreshPivot":if(!qv.util.anyError(e)||self.QueryViewerCollection[self.IdForQueryViewerCollection].debugServices){self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.goWhenServerPagination(false,true);qv.util.hideActivityIndicator(self.QueryViewerCollection[self.IdForQueryViewerCollection])}else{var r=qv.util.getErrorFromText(e);qv.util.renderError(self.QueryViewerCollection[self.IdForQueryViewerCollection],r)}break;case"hiddenDimension":if(!qv.util.anyError(e)||self.QueryViewerCollection[self.IdForQueryViewerCollection].debugServices){self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.goWhenServerPagination(false,false);qv.util.hideActivityIndicator(self.QueryViewerCollection[self.IdForQueryViewerCollection])}else{var r=qv.util.getErrorFromText(e);qv.util.renderError(self.QueryViewerCollection[self.IdForQueryViewerCollection],r)}break;case"DataForPivot":self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows,self.ExportTo);self.preGoWhenServerPagination(self.lastNotAutorefreshIndicator);if(self.ExportTo!=""){var t=self.query;if(t==""){t="Query";try{t=self.controlName.split("_")[0]}catch(e){}}if(self.ExportTo=="HTML"){self.ExportToHTMLWhenServerPagination()}if(self.ExportTo=="PDF"){OAT.GeneratePDFOutput(self,t)}if(self.ExportTo=="XLS"){self.ExportToExcel(t)}if(self.ExportTo=="XML"){self.ExportToXMLWhenServerPagination()}if(self.ExportTo=="XLSX"){self.ExportToXLSXWhenServerPagination()}self.cleanGridCache()}qv.util.hideActivityIndicator(self.QueryViewerCollection[self.IdForQueryViewerCollection]);break}};this.requestAttributeValues=function(e,r,t,a){setTimeout((function(){var s={DataField:e,Page:r,PageSize:t,FilterText:a,QueryviewerId:self.IdForQueryViewerCollection};var i=document.createEvent("Events");i.initEvent("RequestAttributeValuesForPivotTable",true,true);i.parameter=s;document.dispatchEvent(i)}),0)};this.setAttributeValuesForPivotTable=function(e){switch(self.lastRequestAttributeValues){case"initValueRead":var r=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;allData=self.lastRequestAttributeAllData;requestDataField=self.lastRequestAttributeRequestDataField;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=false;if(allData){self.conditions[t].distinctValues=[]}if(r.Null){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}var a=true;if(!self.conditions[t].NullIncluded){a=false}if(a&&self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{self.conditions[t].hasNull=false}var i=[];for(var f=0;f<r.NotNullValues.length;f++){var l=r.NotNullValues[f];var n=false;if(self.conditions[t].state=="none"&&self.UserFilterValues.length>0&&self.UserFilterValues[t]!=undefined&&self.UserFilterValues[t].length>0&&self.UserFilterValues[t].indexOf(l.trimpivot())!=-1){n=true;i.push(l)}if(self.conditions[t].distinctValues.indexOf(l)==-1){self.conditions[t].distinctValues.push(l)}if(self.conditions[t].state=="all"&&self.conditions[t].visibles.indexOf(l)==-1){self.conditions[t].visibles.push(l)}if(self.conditions[t].state=="none"&&self.conditions[t].blackList.indexOf(l)==-1&&!n){self.conditions[t].blackList.push(l)}if(allData&&self.UserExpandValues.length>0){if(self.UserExpandValues[t]!=undefined){if(self.UserExpandValues[t][0]=="#ALLCOLLAPSE#"||self.UserExpandValues[t].indexOf(l.trimpivot())==-1){self.conditions[t].collapsedValues.push(l)}}}}for(var f=0;f<i.length;f++){self.createFilterInfo({op:"pop",values:i[f],dim:t},true)}if(requestDataField==undefined){t++;self.initValueRead(self,t,allData)}break;case"DrawFilters":var r=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=true;if(r.Null&&!self.conditions[t].hasNull){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}if(self.conditions[t].defaultAction=="Include"){if(self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{if(self.conditions[t].blackList.indexOf("#NuN#")==-1){self.conditions[t].blackList.push("#NuN#")}}}for(var f=0;f<r.NotNullValues.length;f++){var l=r.NotNullValues[f];if(self.conditions[t].distinctValues.indexOf(l)==-1){self.conditions[t].distinctValues.push(l);if(self.conditions[t].defaultAction=="Include"&&self.conditions[t].visibles.indexOf(l)==-1){self.conditions[t].visibles.push(l)}if(self.conditions[t].state=="Exclude"&&self.conditions[t].blackList.indexOf(l)==-1){self.conditions[t].blackList.push(l)}}}var o=self.conditions[t].distinctValues;for(var u=0;u<o.length;u++){var v=o[u];if(self.conditions[t].filteredShowValues.indexOf(v)==-1){self.conditions[t].filteredShowValues.push(v);if(v!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(v,t),v,s)}catch(e){OAT.Dom.option(v,v,s)}}else{OAT.Dom.option(" ",v,s)}}}break;case"hiddenDimension":var r=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=false;if(r.Null){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}var a=true;if(!self.conditions[t].NullIncluded){a=false}if(a&&self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{self.conditions[t].hasNull=false}var i=[];for(var f=0;f<r.NotNullValues.length;f++){var l=r.NotNullValues[f];var n=false;if(self.conditions[t].state=="none"&&self.UserFilterValues.length>0&&self.UserFilterValues[t]!=undefined&&self.UserFilterValues[t].length>0&&self.UserFilterValues[t].indexOf(l.trimpivot())!=-1){n=true;i.push(l)}if(self.conditions[t].distinctValues.indexOf(l)==-1){self.conditions[t].distinctValues.push(l)}if(self.conditions[t].state=="all"&&self.conditions[t].visibles.indexOf(l)==-1){self.conditions[t].visibles.push(l)}if(self.conditions[t].state=="none"&&self.conditions[t].blackList.indexOf(l)==-1&&!n){self.conditions[t].blackList.push(l)}if(self.UserExpandValues.length>0){if(self.UserExpandValues[t]!=undefined){if(self.UserExpandValues[t][0]=="#ALLCOLLAPSE#"||self.UserExpandValues[t].indexOf(l.trimpivot())==-1){self.conditions[t].collapsedValues.push(l)}}}}for(var f=0;f<i.length;f++){self.createFilterInfo({op:"pop",values:i[f],dim:t},true)}break;case"readScrollValueWithoutFilters":var c=JSON.parse(e);self.appendNewValueData(self.lastRequestValue,c);break;case"readScrollValueWithFilters":var c=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;var d=self.lastRequestAttributeFilterText;self.appendNewFilteredValueData(c,t,d);break;case"ValuesForColumn":var c=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;var m=self.lastRequestAttributeFilterText;var h=self.lastRequestAttributeDataField;var p=self.lastRequestAttributeUcId=p;self.changeValues(p,h,t,c,m);break;case"ExpandCollapse":var r=JSON.parse(e);var t=self.lastColumnNumber;var T=self.lastRequestAttributeValuesElemValue;var A=self.lastRequestAttributeValuesAction;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=true;if(r.Null&&!self.conditions[t].hasNull){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}if(self.conditions[t].defaultAction=="Include"){if(self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{if(self.conditions[t].blackList.indexOf("#NuN#")==-1){self.conditions[t].blackList.push("#NuN#")}}}for(var f=0;f<r.NotNullValues.length;f++){var w=r.NotNullValues[f];if(self.conditions[t].distinctValues.indexOf(w)==-1){self.conditions[t].distinctValues.push(w);if(self.conditions[t].defaultAction=="Include"&&self.conditions[t].visibles.indexOf(w)==-1){self.conditions[t].visibles.push(w)}if(self.conditions[t].state=="Exclude"&&self.conditions[t].blackList.indexOf(w)==-1){self.conditions[t].blackList.push(w)}}}var O=self.ExpandCollapseHandleWhenServerPaginationCreateXML(T,A);O=O.replace(/\&/g,"&amp;");self.getDataForPivot(self.UcId,self.pageData.ServerPageNumber,self.rowsPerPage,true,"","","","",true);setTimeout((function(){self.fireOnItemExpandCollapseEvent(self.QueryViewerCollection[IdForQueryViewerCollection],O,A=="collapse")}),2e3);break;case"FilteredChanged":setTimeout((function(){var r=JSON.parse(e);self.onFilteredChangedEventHandleWhenServerPaginationCreateXML(self.lastColumnNumber,r.NotNullValues,self.conditions[self.lastColumnNumber].blackList)}),200);break}};this.fireOnItemExpandCollapseEvent=function(e,r,t){setTimeout((function(){var a={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection,IsCollapse:t};var s=document.createEvent("Events");s.initEvent("PivotTableOnItemExpandCollapseEvent",true,true);s.parameter=a;document.dispatchEvent(s)}),0)};this.requestCalculatePivottableData=function(){setTimeout((function(){var e=document.createEvent("Events");var r={QueryviewerId:self.IdForQueryViewerCollection};e.initEvent("RequestCalculatePivottableData",true,true);e.parameter=r;document.dispatchEvent(e)}),0)};this.setPivottableDataCalculation=function(e){switch(self.lastRequestCalculation){case"ExportToXML":self.allDataWithoutSort=OATgetDataFromXMLOldFormat(e,self.pageData.dataFields);self.allData=self.allDataWithoutSort;var r=jQuery.extend(true,[],self.conditions);for(var t=0;t<self.conditions.length;t++){if(self.conditions[t]){for(var a=0;a<self.allData.length;a++){var s=self.allData[a][t];if(s==undefined){s=" ";self.allData[a][n]=" "}if(self.conditions[t].distinctValues.indexOf(s)==-1){self.conditions[t].distinctValues.push(s)}}try{self.sort(self.conditions[t],t)}catch(e){}}}self.applyFilters();self.createAggStructure();self.fillAggStructure();self.checkAggStructure();str=self.ExportToXML();self.allDataWithoutSort=[];self.allData=[];self.filteredData=[];self.conditions=r;if(OAT.isSafari()||self.isSD){window.open("data:text/xml,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+str))}else{var i=new Blob([str],{type:"text/xml"});if(self.query!=""){saveAs(i,self.query+".xml")}else{var f="Query";try{f=self.controlName.substr(4).split("_")[0]}catch(e){}saveAs(i,f+".xml")}}break;case"ExportToXLSX":var l=[];for(var t=0;t<self.initMetadata.Dimensions.length;t++){if(self.initMetadata.Dimensions[t].Visible)l.push(self.initMetadata.Dimensions[t].dataField)}for(var t=0;t<self.pageData.AxisInfo.length;t++){if(self.pageData.AxisInfo[t].Axis!=undefined&&self.pageData.AxisInfo[t].Axis.Type=="Hidden"){var n=l.indexOf(self.pageData.AxisInfo[t].DataField);if(n>-1){l.splice(n,1)}}}for(var t=0;t<self.initMetadata.Measures.length;t++){if(self.initMetadata.Measures[t].Visible&&l.indexOf(self.initMetadata.Measures[t].dataField)<0){l.push(self.initMetadata.Measures[t].dataField)}}for(var t=0;t<measures.length;t++){if(measures[t].getAttribute("aggregation")=="average"){self.formulaInfo.measureFormula[t].hasFormula=true;self.formulaInfo.measureFormula[t].textFormula=measures[t].getAttribute("dataField")+"_N/"+measures[t].getAttribute("dataField")+"_D";self.formulaInfo.cantFormulaMeasures++;var o=self.formulaInfo.measureFormula[t].textFormula;var u=o;var v=["*","-","+","/","(",")"];for(var c=0;c<v.length;c++){var d=u.split(v[c]);if(d.length>1){u="";for(var a=0;a<d.length-1;a++){u=u+d[a]+" "+v[c]+" "}u=u+d[d.length-1]}}var m=InfixToPostfix(u);formulaInfo.measureFormula[t].polishNotationText=m;var h=m.split(" ");while(h.indexOf("")!=-1){h.splice(h.indexOf(""),1)}var p=[];for(var T=0;T<h.length;T++){if(v.indexOf(h[T])==-1&&isNaN(parseInt(h[T]))){var A=formulaInfo.itemPosition[h[T]];if(p.indexOf(A)==-1)p.push(A)}}self.formulaInfo.measureFormula[t].relatedMeasures=p;var w=m.split(" ");while(w.indexOf("")!=-1){w.splice(w.indexOf(""),1)}self.formulaInfo.measureFormula[t].PolishNotation=w}}e=e.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&apos;/g,"'").replace(/\&quot/g,'"');var O=OATgetDataFromXMLOldFormat(e,l,self.OrderFildsHidden);self.GeneralDataRows=O[0];self.recordForFormula=O[1];self.allData=self.GeneralDataRows;var r=jQuery.extend(true,[],self.conditions);self.GeneralDistinctValues=[];for(var t=0;t<self.conditions.length;t++){if(self.conditions[t]){self.GeneralDistinctValues[t]=[];for(var a=0;a<self.allData.length;a++){var s=self.allData[a][t];if(s==undefined){s=" ";self.allData[a][n]=" "}if(self.conditions[t].distinctValues.indexOf(s)==-1){self.conditions[t].distinctValues.push(s)}if(self.GeneralDistinctValues[t].indexOf(s)==-1){self.GeneralDistinctValues[t].push(s)}}try{self.sort(self.conditions[t],t)}catch(e){}}}self.applyFilters();self.createAggStructure();self.fillAggStructure();self.checkAggStructure();var y=self.query;if(y==""){y="Query";try{y=self.controlName.split("_")[0]}catch(e){}}OAT.GenerateExcelOutput(y,self,measures);str=self.ExportToXML();self.GeneralDataRows=[];self.allData=[];self.filteredData=[];self.GeneralDistinctValues=[];self.conditions=r;for(var t=0;t<measures.length;t++){if(measures[t].getAttribute("aggregation")=="average"){self.formulaInfo.measureFormula[t]={hasFormula:false};self.formulaInfo.cantFormulaMeasures--}}break}};this.getFilteredDataXML=function(e){temp=e.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&apos;/g,"'").replace(/\&quot/g,'"');var r=temp.split("<Record>");var t=[];for(var a=1;a<r.length;a++){var s=[];var i=[];var f=[];for(var l=0;l<self.pageData.dataFields.length;l++){s[l]="#NuN#";var n=r[a].split("<"+self.pageData.dataFields[l]+">");if(n.length>1){var o=n[1].split("</"+self.pageData.dataFields[l]+">");s[l]=o[0];i[l]=s[l];for(var u=0;u<self.initMetadata.Dimensions.length;u++){if(self.initMetadata.Dimensions[u].dataField==self.pageData.dataFields[l]){var v=self.initMetadata.Dimensions[u].displayName;if(self.headerRow.indexOf(v)!=-1){f.push(o[0])}}}if(l>=self.initMetadata.Dimensions.length){f.push(o[0])}}else{if(r[a].indexOf("<"+self.pageData.dataFields[l]+"/>")>=0){s[l]="";i[l]=""}}}if(self.filterDataXMLOK(f)){t.push(s)}}var c='<Recordset RecordCount="'+t.length+'" PageCount="1">\n';c=c+'<Page PageNumber="1">\n';for(var a=0;a<t.length;a++){c=c+"  <Record>\n";for(var d=0;d<self.initMetadata.DataFields.length;d++){var m=self.initMetadata.DataFields[d];c=c+"    <"+m+">";c=c+(t[a][d]||"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");c=c+"</"+m+">\n"}for(var d=0;d<measures.length;d++){c=c+"    <"+measures[d].getAttribute("dataField")+">";c=c+(t[a][d+self.initMetadata.DataFields.length]||"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");c=c+"</"+measures[d].getAttribute("dataField")+">\n"}c=c+"  </Record>\n"}c=c+"</Page>\n</Recordset>";return c};this.getMetadataXML=function(){xml='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">';var e=this.columns;if(self.initMetadata.Metadata){var r=jQuery.parseXML(self.initMetadata.Metadata);e=[];e=r.getElementsByTagName("OLAPDimension")}var t=0;var a=0;var s=0;var i=0;var f=0;var l=0;for(var n=0;n<e.length;n++){var o=n;if(self.initMetadata.Metadata){o=-1;for(var u=0;u<self.conditions.length;u++){if(self.conditions[u].dataField==self.initMetadata.Dimensions[n].dataField){o=u}}}xml=xml+"<OLAPDimension>";xml=xml+"<name>"+e[n].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+e[n].getAttribute("displayName")+"</displayName> ";xml=xml+"<description>"+e[n].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+e[n].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+e[n].getAttribute("dataType")+"</dataType> ";if(self.initMetadata.Dimensions&&!self.initMetadata.Dimensions[n].Visible){xml=xml+"<hidden>true</hidden>"}xml=xml+"<axis>";var v=0;if(o==-1){if(e[n].getAttribute("visible").toLowerCase()!="never"){xml=xml+e[n].getAttribute("axis").toLowerCase();var c=self.initMetadata.Dimensions[n].defaultPosition;if(c=="Rows"){a=a+1;v=t+1;t=v}if(c=="Columns"){i=i+1;v=s+1;s=v}if(c=="Pages"){l=l+1;v=f+1;f=v}}else{xml=xml+""}}else if(self.rowConditions.indexOf(o)!=-1){xml=xml+"rows";v=self.rowConditions.indexOf(o)+1+a;t=v}else if(self.colConditions.indexOf(o)!=-1){xml=xml+"columns";v=self.colConditions.indexOf(o)+1+i;s=v}else{xml=xml+"pages";v=self.filterIndexes.indexOf(o)+1+l;f=v}xml=xml+"</axis> ";if(e[n].getAttribute("visible").toLowerCase()!="never"){xml=xml+"<position>"+v+"</position> "}else{xml=xml+"<position/>"}var d=e[n].getAttribute("summarize");if(o>=0){d=self.conditions[o].subtotals?"yes":"no"}xml=xml+"<summarize>"+d+"</summarize> ";xml=xml+"<align>"+e[n].getAttribute("align")+"</align> ";if(e[n].getAttribute("picture")===""){xml=xml+"<picture/> "}else{xml=xml+"<picture>"+e[n].getAttribute("picture")+"</picture> "}if(e[n].getAttribute("picture")===""){xml=xml+"<format/> "}else{xml=xml+"<format>"+e[n].getAttribute("format")+"</format> "}var m=-1;if(self.initMetadata.Metadata){m=-1;for(var u=0;u<self.initMetadata.Conditions.length;u++){if(self.initMetadata.Conditions[u].dataField==self.initMetadata.Dimensions[n].dataField){m=u}}}if(e[n].getAttribute("visible").toLowerCase()!="never"){var h=o>-1?self.conditions[o].sort:m>-1?self.initMetadata.Conditions[m].sort:"metadata";if(h=="metadata"){xml=xml+"<order>"+(e[n].getAttribute("order")!=""?e[n].getAttribute("order"):"Ascending")+"</order> "}else{if(h==1)xml=xml+"<order>Ascending</order> ";else if(h==-1)xml=xml+"<order>Descending</order> ";else xml=xml+"<order>Custom</order> "}}else{xml=xml+"<order>"+e[n].getAttribute("order")+"</order> "}xml=xml+"<customOrder/> ";xml=xml+"<filterType>";var p=o>-1?self.conditions[o].blackList:m>-1?self.initMetadata.Conditions[m].blackList:[];if(p.length==0){if(o>-1&&self.conditions[o].defaultAction=="Exclude"){if(self.conditions[o].visibles.length==0)xml=xml+"HideAllValues";else xml=xml+"ShowAllValues"}else{xml=xml+"ShowAllValues"}}else{xml=xml+"ShowSomeValues"}xml=xml+"</filterType>";xml=xml+"<include> ";var T=o>-1?self.filterIndexes.indexOf(o):-1;if(T!=-1&&self.filterDiv.selects.length>T&&self.filterDiv.selects[T].value!="[all]"){xml=xml+"<value>"+self.filterDiv.selects[T].value+"</value> "}else{var A=o>-1?self.conditions[o].distinctValues:m>-1?self.initMetadata.Conditions[m].distinctValues:[];if(!(o>-1&&self.conditions[o].defaultAction=="Exclude"&&p.length==0)){for(var w=0;w<A.length;w++){if(p.indexOf(A[w])===-1){xml=xml+"<value>"+A[w]+"</value> "}}}}xml=xml+"<value>TOTAL</value> </include>";xml=xml+"<collapseType>";var O=o>-1?self.conditions[o].collapsedValues:m>-1?self.initMetadata.Conditions[m].collapsedValues:[];if(O==undefined||O.length==0){xml=xml+"ExpandAllValues";xml=xml+"</collapseType>"}else{xml=xml+"ExpandSomeValues";xml=xml+"</collapseType>";var A=[];A=o>-1?self.conditions[o].distinctValues:m>-1?self.initMetadata.Conditions[m].distinctValues:[];xml=xml+"<includeExpand> ";for(var w=0;w<A.length;w++){if(A[w]!=undefined&&O.indexOf(A[w])==-1){xml=xml+"<value>"+A[w]+"</value>"}}xml=xml+"</includeExpand> "}xml=xml+"</OLAPDimension>"}var y=measures;if(self.initMetadata.Metadata){var r=jQuery.parseXML(self.initMetadata.Metadata);y=[];y=r.getElementsByTagName("OLAPMeasure")}var _=t;for(var n=0;n<y.length;n++){xml=xml+"<OLAPMeasure> ";xml=xml+"<name>"+y[n].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+y[n].getAttribute("displayName")+"</displayName> ";xml=xml+"<description>"+y[n].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+y[n].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+y[n].getAttribute("dataType")+"</dataType> ";xml=xml+"<defaultAggregator>"+y[n].getAttribute("defaultAggregator")+"</defaultAggregator> ";xml=xml+"<validAggregators>"+y[n].getAttribute("validAggregators")+"</validAggregators> ";xml=xml+"<summarize>"+y[n].getAttribute("summarize")+"</summarize> ";if(y[n].getAttribute("format")===""){xml=xml+"<format/> "}else{xml=xml+"<format>"+y[n].getAttribute("format")+"</format> "}xml=xml+"<align>"+y[n].getAttribute("align")+"</align> ";if(y[n].getAttribute("picture")===""){xml=xml+"<picture/> "}else{xml=xml+"<picture>"+y[n].getAttribute("picture")+"</picture> "}if(self.initMetadata.Measures&&!self.initMetadata.Measures[n].Visible){xml=xml+"<hidden>true</hidden>"}if(y[n].getAttribute("visible").toLowerCase()!="never"){_=_+1;xml=xml+"<position>"+_+"</position> "}else{xml=xml+"<position/>"}xml=xml+"</OLAPMeasure>"}xml=xml+"</OLAPCube>";xml=xml.replace(/\&/g,"&amp;");return xml};this.createXMLMetadata=function(){var e='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">';for(var r=0;r<this.columns.length;r++){if(this.conditions[r]!=false&&this.conditions[r]!=undefined){e=e+"<OLAPDimension> ";e=e+"<name>"+this.columns[r].getAttribute("name")+"</name> ";e=e+"<displayName>"+this.columns[r].getAttribute("displayName")+"</displayName> ";e=e+"<description>"+this.columns[r].getAttribute("description")+"</description> ";e=e+"<dataField>"+this.columns[r].getAttribute("dataField")+"</dataField> ";e=e+"<dataType>"+this.columns[r].getAttribute("dataType")+"</dataType> ";e=e+"<summarize>"+this.columns[r].getAttribute("summarize")+"</summarize> ";e=e+"<align>"+this.columns[r].getAttribute("align")+"</align> ";if(this.columns[r].getAttribute("picture")===""){e=e+"<picture/> "}else{e=e+"<picture>"+this.columns[r].getAttribute("picture")+"</picture> "}if(this.columns[r].getAttribute("picture")===""){e=e+"<format/> "}else{e=e+"<format>"+this.columns[r].getAttribute("format")+"</format> "}if(this.conditions[r].sort===1)e=e+"<order>ascending</order> ";else e=e+"<order>descending</order> ";e=e+"<customOrder/> ";e=e+"<include> ";var t=self.filterIndexes.indexOf(r);if(t!=-1&&self.filterDiv.selects[t].value!="[all]"){if(this.conditions[r].blackList.indexOf(self.filterDiv.selects[t].value)===-1){e=e+"<value>"+self.filterDiv.selects[t].value.toString().trimpivot()+"</value> "}}else{if(self.conditions[r].state!="none"){for(var a=0;a<this.conditions[r].distinctValues.length;a++){if(this.conditions[r].blackList.indexOf(this.conditions[r].distinctValues[a])===-1){e=e+"<value>"+this.conditions[r].distinctValues[a].toString().trimpivot()+"</value> "}}}}e=e+"<value>TOTAL</value> </include> <collapse/> ";e=e+"<hide> ";if(self.conditions[r].state=="none"){for(var a=0;a<this.conditions[r].distinctValues.length;a++){e=e+"<value>"+this.conditions[r].distinctValues[a].toString().trimpivot()+"</value> "}}else if(self.conditions[r].state!="all"){for(var s=0;s<this.conditions[r].blackList.length;s++){e=e+"<value>"+this.conditions[r].blackList[s].toString().trimpivot()+"</value> "}}e=e+"</hide> ";if(self.rowConditions.indexOf(r)!=-1){e=e+"<condition>row</condition> ";e=e+"<filterbar>no</filterbar> ";e=e+"<position>"+self.rowConditions.indexOf(r)+"</position>"}else if(self.colConditions.indexOf(r)!=-1){e=e+"<condition>col</condition> ";e=e+"<filterbar>no</filterbar> ";e=e+"<position>"+self.colConditions.indexOf(r)+"</position>"}else{e=e+"<condition>none</condition> ";e=e+"<filterbar>yes</filterbar> "}e=e+"<filterdivs> ";if(t!=-1){e=e+"<value>"+self.filterDiv.selects[t].value.toString().trimpivot()+"</value> "}e=e+"</filterdivs> ";e=e+"<restoreview>no</restoreview> ";e=e+" </OLAPDimension>"}}for(var r=0;r<measures.length;r++){e=e+"<OLAPMeasure> ";e=e+"<name>"+measures[r].getAttribute("name")+"</name> ";e=e+"<displayName>"+measures[r].getAttribute("displayName")+"</displayName> ";e=e+"<description>"+measures[r].getAttribute("description")+"</description> ";e=e+"<dataField>"+measures[r].getAttribute("dataField")+"</dataField> ";e=e+"<dataType>"+measures[r].getAttribute("dataType")+"</dataType> ";e=e+"<defaultAggregator>"+measures[r].getAttribute("defaultAggregator")+"</defaultAggregator> ";e=e+"<validAggregators>"+measures[r].getAttribute("validAggregators")+"</validAggregators> ";e=e+"<summarize>"+measures[r].getAttribute("summarize")+"</summarize> ";if(measures[r].getAttribute("format")===""){e=e+"<format/> "}else{e=e+"<format>"+measures[r].getAttribute("format")+"</format> "}e=e+"<align>"+measures[r].getAttribute("align")+"</align> ";if(measures[r].getAttribute("picture")===""){e=e+"<picture/> "}else{e=e+"<picture>"+measures[r].getAttribute("picture")+"</picture> "}e=e+" </OLAPMeasure>"}e=e+"</OLAPCube>";return e};this.ExportToXML=function(){var e='<EXPORT format="XML" type="pivot">';e=e+"<METADATA>";for(var r=0;r<this.columns.length;r++){var t="row";if(self.rowConditions.indexOf(r)!=-1){t="row"}else if(self.colConditions.indexOf(r)!=-1){t="column"}else{t="filter"}e=e+"<OLAPDimension ";e=e+'name="'+this.columns[r].getAttribute("dataField")+'" ';e=e+'label="'+this.columns[r].getAttribute("displayName")+'" ';e=e+'picture="'+this.columns[r].getAttribute("picture")+'" ';e=e+'datatype="'+this.columns[r].getAttribute("dataType")+'" ';e=e+'showAll="true" ';e=e+'position="'+t+'">';if(this.conditions[r]!=undefined&&this.conditions[r].distinctValues!=undefined){for(var a=0;a<this.conditions[r].distinctValues.length;a++){e=e+"<VALUE CHECKED=";if(this.conditions[r].blackList.indexOf(this.conditions[r].distinctValues[a])===-1){e=e+'"true"'}else{e=e+'"false"'}if(this.conditions[r].collapsedValues.indexOf(this.conditions[r].distinctValues[a])==-1){e=e+' COLLAPSED="false">'}else{e=e+' COLLAPSED="true">'}e=e+this.conditions[r].distinctValues[a]+"</VALUE>"}}e=e+"</OLAPDimension>"}for(var r=0;r<measures.length;r++){e=e+"<OLAPMeasure ";e=e+'name="'+measures[r].getAttribute("dataField")+'" ';e=e+'label="'+measures[r].getAttribute("displayName")+'" ';e=e+'picture="'+measures[r].getAttribute("picture")+'" ';e=e+'datatype="'+measures[r].getAttribute("dataType")+'" ';e=e+'showAll="true" ';e=e+'aggregator="sum"/>'}e=e+"</METADATA>";e=e+"<FLATDATA>";for(var s=0;s<this.allDataWithoutSort.length;s++){e=e+"<ROW ";for(var r=0;r<this.columns.length;r++){e=e+this.columns[r].getAttribute("dataField")+'="'+this.allDataWithoutSort[s][r]+'" '}for(var r=0;r<measures.length;r++){e=e+measures[r].getAttribute("dataField")+'="'+this.allDataWithoutSort[s][r+this.columns.length]+'" '}e=e+"/>"}e=e+"</FLATDATA>";e=e+"<COLITEMS>";var i=e;try{var f=0;var l=this.colConditions.length;if(f===l){for(var r=0;r<measures.length;r++){e=e+'<COLITEM measure="'+measures[r].getAttribute("displayName")+'" type=""';e=e+"/>"}}else{f++;for(var r=0;r<this.colStructure.items.length;r++){e=e+this.createXMLCOLITEMS(this.colStructure.items[r],f,l)}}}catch(r){e=i}e=e+"</COLITEMS>";e=e+"<ROWITEMS>";i=e;try{for(var r=0;r<this.rowStructure.items.length;r++){var f=0;var l=this.columns.length-this.colConditions.length-this.filterIndexes.length-1;if(l>=f){e=e+this.createXMLROWITEMS(this.rowStructure.items[r],f,l)}}}catch(r){e=i}e=e+"</ROWITEMS>";e=e+"<HTML>";e=e+"<HEAD>";e=e+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';e=e+"<STYLE>";e=e+".h2title {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt; height: 44px; color: #E0E0E0;}\n";e=e+".h2titlewhite {background-color: #ffffff; font-family: Verdana; font-size: 10pt; font-weight: normal; height: 25px; color: black;}\n";e=e+".even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\n";e=e+".h2subtitle {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt;\theight: 22px; color: #E0E0E0;}\n";e=e+".gtotal {background-color: #EBEBEB; font-weight: normal; font-family: Verdana; font-size: 10pt;}\n";e=e+".pivot_table td.total {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n";e=e+".pivot_table td.subtotal {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n";e=e+"</STYLE>";e=e+"</HEAD>";e=e+"<BODY>";e=e+'<TABLE border="2">';for(var s=0;s<jQuery("#"+self.controlName+"_"+self.query+" tr").length;s++){e=e+"<TR>";var n=jQuery("#"+self.controlName+"_"+self.query+" tr")[s];for(var o=0;o<n.children.length;o++){var u=OAT.removeIconFont(n.children[o].textContent).trim();var v=n.children[o].getAttribute("hidden");var c="";if(n.children[o].getAttribute("style")!=undefined&&n.children[o].getAttribute("style")!=null){c=' style="'+n.children[o].getAttribute("style")+'" '}var d="";if(n.children[o].getAttribute("class")!=undefined&&n.children[o].getAttribute("class")!=null){d=' class="'+n.children[o].getAttribute("class")+'" '}if(v===null){var m=n.children[o].getAttribute("rowspan");var h=n.children[o].getAttribute("colspan");if(m===null&&h===null||o===n.children.length-1){e=e+"<TD "+d+" "+c+">"+u+"</TD>"}else if(h===null){e=e+"<TD "+d+" "+'rowspan="'+m+'" '+c+" >"+u+"</TD>"}else if(m===null){e=e+"<TD "+d+" "+'colspan="'+h+'" '+c+" >"+u+"</TD>"}else{e=e+"<TD "+d+" "+'colspan="'+h+'" rowspan="'+m+'" '+c+" >"+u+"</TD>"}}}e=e+"</TR>"}e=e+"</TABLE>";e=e+"</BODY>";e=e+"</HTML>";e=e+"</EXPORT>";return e.replace(/\&/g,"&amp;")};this.createXMLROWITEMS=function(e,r,t){var a=e.parent==undefined||e.parent.collapsed==undefined?false:e.parent.collapsed;var s='<ROWITEM dimension="'+columns[r].getAttribute("dataField")+'" collapsed="'+e.collapsed+'" parentCollapsed="'+a+'" value="'+e.value+'" level="'+r+'"';if(r===t){return s+"/>"}else{r++;s=s+">";for(var i=0;i<e.items.length;i++){s=s+this.createXMLROWITEMS(e.items[i],r,t)}s=s+"</ROWITEM>";return s}};this.createXMLCOLITEMS=function(e,r,t){var a="";if(r===t){for(var s=0;s<measures.length;s++){a=a+'<COLITEM measure="'+measures[s].getAttribute("displayName")+'" type="">';var i=self.rowConditions.length-measures.length+1;a=a+'<VALITEM dimension="'+columns[r-1+i].getAttribute("dataField")+'" value="'+e.value+'"/>';var f=e;while(f.parent.depth!=-1){f=f.parent;a=a+'<VALITEM dimension="'+columns[r-1+i].getAttribute("dataField")+'" value="'+f.value+'"/>'}a=a+"</COLITEM>"}return a}else{r++;for(var l=0;l<e.items.length;l++){a=a+this.createXMLCOLITEMS(e.items[l],r,t)}return a}};this.ExportToExcel=function(e){var r='<table border="2">';for(var t=0;t<jQuery("#"+self.controlName+"_"+self.query+" tr").length;t++){r=r+"<tr>";var a=jQuery("#"+self.controlName+"_"+self.query+" tr")[t];for(var s=0;s<a.children.length;s++){var i=OAT.removeIconFont(a.children[s].textContent.replace(/^\s+|\s+$/g,"")).trim();var f=a.children[s].getAttribute("hidden");var l="";if(a.children[s].getAttribute("style")!=undefined&&a.children[s].getAttribute("style")!=null){l=' style="'+a.children[s].getAttribute("style")+'" '}var n="";var o=false;for(var u=0;u<i.length;u++){if(i.charCodeAt(u)<1e3){if(o){n=n+" "+i[u]}else{n=n+i[u]}o=false}else{var v=i.charCodeAt(u).toString(16);n=n+"&#x"+v;o=true}}if(f===null){var c=a.children[s].getAttribute("rowspan");var d=a.children[s].getAttribute("colspan");if(c===null&&d===null||s===a.children.length-1){r=r+"<td "+l+">"+n+"</td>"}else if(d===null){r=r+'<td rowspan="'+c+'" '+l+" >"+n+"</td>"}else if(c===null){r=r+'<td colspan="'+d+'" '+l+" >"+n+"</td>"}else{r=r+'<td colspan="'+d+'" rowspan="'+c+'" '+l+" >"+n+"</td>"}}}r=r+"</tr>"}r=r+"</table>";var m='<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></head><body>';r=m+r+"</body>";var h=r;if(OAT.isSafari()||self.isSD){window.open("data:application/vnd.ms-excel,"+encodeURIComponent(h))}else{var p=new Blob([h],{type:"application/vnd.ms-excel"});saveAs(p,e+".xls")}};this.lightOn=function(){for(var e=0;e<self.gd.targets.length;e++){var r=self.gd.targets[e][0];if(OAT.isIE()){r.className+=" drag-drop"}else{r.classList.add("drag-drop")}}};this.lightOff=function(){for(var e=0;e<self.gd.targets.length;e++){var r=self.gd.targets[e][0];try{r.classList.remove("drag-drop")}catch(e){}}};self.gd.onFail=self.lightOff;this.process=function(e){self.lightOn();var r=OAT.Dom.create("div");var t=OAT.Dom.create("div");r.setAttribute("class","drag_drop_indicator");t.setAttribute("class","drag_drop_arrow");OAT.addImageNode(r,"drag_indicator","");OAT.addImageNode(t,"arrow_drop_up","");e.className="att_drag_drop";e.appendChild(t);e.appendChild(r)};this.filterOK=function(e){for(var r=0;r<self.filterIndexes.length;r++){var t=self.filterIndexes[r];var a=self.filterDiv.selects[r];if(a.selectedIndex&&OAT.$v(a)!=e[t]){return false}}for(var r=0;r<self.rowConditions.length;r++){var s=e[self.rowConditions[r]];var i=self.conditions[self.rowConditions[r]];if(i.blackList.length>0&&i.blackList.indexOf(s)!=-1){return false}}for(var r=0;r<self.colConditions.length;r++){var s=e[self.colConditions[r]];var i=self.conditions[self.colConditions[r]];if(i.blackList.length>0&&i.blackList.indexOf(s)!=-1){return false}}return true};this.filterDataXMLOK=function(e){for(var r=0;r<self.filterIndexes.length;r++){var t=self.filterIndexes[r];var a=self.filterDiv.selects[r];if(a.selectedIndex&&OAT.$v(a)!=e[t]){return false}}for(var r=0;r<self.rowConditions.length;r++){var s=e[self.rowConditions[r]];var i=self.conditions[self.rowConditions[r]];if(i.state=="none"){return false}if(i.defaultAction=="Exclude"){if(i.visibles.indexOf(s)==-1){return false}}else{if(i.blackList.indexOf(s)!=-1){return false}}}for(var r=0;r<self.colConditions.length;r++){var s=e[self.colConditions[r]];var i=self.conditions[self.colConditions[r]];if(i.state=="none"){return false}if(i.defaultAction=="Exclude"){if(i.visibles.indexOf(s)==-1){return false}}else{if(i.blackList.indexOf(s)!=-1){return false}}}return true};this.sort=function(e,r){var t;var a=e.sort;if(e.sort==0){a=1}if(e.sort==2){a=-1}var s=function(e,r){if(e==r){return 0}return a*(parseInt(e)>parseInt(r)?1:-1)};var i=function(e,r){if(e==r){return 0}return a*(e>r?1:-1)};if(e.distinctValues==undefined)return;var f=true;for(var l=0;l<e.distinctValues.length;l++){if(f&&e.distinctValues[l]!=parseInt(e.distinctValues[l])){f=false}}if(f){t=s}else{t=i}if(e.sort!=0&&e.sort!=2){e.distinctValues.sort(t)}else{if(r!=undefined&&self.columns[r]!=undefined){e.distinctValues.sort(t);var n=[];for(var o=0;o<e.distinctValues.length;o++){n[o]=e.distinctValues[o]}e.distinctValues=[];if(e.sort==0){for(var o=0;o<self.columns[r].childNodes.length;o++){if(self.columns[r].childNodes[o]!=undefined&&self.columns[r].childNodes[o].localName!=undefined&&self.columns[r].childNodes[o].localName==="customOrder"){for(var u=0;u<self.columns[r].childNodes[o].childNodes.length;u++){if(self.columns[r].childNodes[o].childNodes[u].localName=="Value"){var v=self.columns[r].childNodes[o].childNodes[u].textContent;for(var c=0;c<n.length;c++){if(n[c].trimpivot()==v.trimpivot()){e.distinctValues.push(n[c])}}}}}}}else{for(var o=0;o<self.columns[r].childNodes.length;o++){if(self.columns[r].childNodes[o]!=undefined&&self.columns[r].childNodes[o].localName!=undefined&&self.columns[r].childNodes[o].localName==="customOrder"){for(var u=self.columns[r].childNodes[o].childNodes.length-1;u>=0;u--){if(self.columns[r].childNodes[o].childNodes[u].localName=="Value"){var v=self.columns[r].childNodes[o].childNodes[u].textContent;for(var c=0;c<n.length;c++){if(n[c].trimpivot()==v.trimpivot()){e.distinctValues.push(n[c])}}}}}}}if(e.distinctValues.length<n.length){for(var o=0;o<n.length;o++){if(e.distinctValues.indexOf(n[o])==-1){e.distinctValues.push(n[o])}}}}}if(columns.length==1||(measures.length=0)){if(e.sort==1){self.allData.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]<t[e]?-1:1}}(0))}else if(e.sort==-1){self.allData.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]>t[e]?-1:1}}(0))}}};this.initCondition=function(e){if(e==self.dataColumnIndex&&(columns.length>1||measures.length>0)){self.conditions.push(false);return}var r=1;var t=1;var a=false;var s="filters;rows;columns;hidden";var i=false;if(self.columns[e]!=undefined){i=true;if(self.columns[e].getAttribute("order")!=undefined&&self.columns[e].getAttribute("order")==="ascending"){r=1}if(self.columns[e].getAttribute("order")!=undefined&&self.columns[e].getAttribute("order")==="descending"){r=-1}if(self.columns[e].getAttribute("order")!=undefined&&self.columns[e].getAttribute("order")==="custom"){r=1}if(self.columns[e].getAttribute("summarize")!=undefined&&self.columns[e].getAttribute("summarize")==="yes"){t=1;for(var f=0;f<self.columns[e].childNodes.length;f++){if(self.columns[e].childNodes[f]!=undefined&&self.columns[e].childNodes[f].localName!=undefined&&self.columns[e].childNodes[f].localName==="include"){t=false;for(var l=0;l<self.columns[e].childNodes[f].childNodes.length;l++){if(self.columns[e].childNodes[f].childNodes[l].localName!=null&&self.columns[e].childNodes[f].childNodes[l].localName.toLowerCase()==="value"){if(self.columns[e].childNodes[f].childNodes[l].textContent=="TOTAL"){t=true}}}}else if(self.columns[e].childNodes[f]!=undefined&&self.columns[e].childNodes[f].localName!=undefined&&self.columns[e].childNodes[f].localName==="exclude"){t=false}}}if(self.columns[e].getAttribute("summarize")!=undefined&&self.columns[e].getAttribute("summarize")==="no"){t=false;a=true}var s="";var n=self.columns[e].getAttribute("visible");if(n!="Never"){s=self.columns[e].getAttribute("canDragToPages")=="true"?"filters;":"";s=s+"rows;columns;hidden"}}var o={distinctValues:[],blackList:[],whiteList:[],greyList:[],collapsedValues:[],sort:r,subtotals:t,hideSubtotalOption:a,validPosition:s,dataRowPosition:e,isDimension:i,topFilterValue:self.translations.GXPL_QViewerJSAllOption};o.topFilterValue="[all]";o.topFilterString=self.translations.GXPL_QViewerJSAllOption;self.conditions.push(o);if(self.columns[e]!=undefined){for(var f=0;f<self.columns[e].childNodes.length;f++){if(self.columns[e].childNodes[f]!=undefined&&self.columns[e].childNodes[f].localName!=undefined&&self.columns[e].childNodes[f].localName==="include"){for(var l=0;l<self.columns[e].childNodes[f].childNodes.length;l++){if(self.columns[e].childNodes[f].childNodes[l].localName!=null&&self.columns[e].childNodes[f].childNodes[l].localName.toLowerCase()==="value"){if(self.columns[e].childNodes[f].childNodes[l].textContent!="TOTAL"){self.conditions[e].topFilterValue=self.columns[e].childNodes[f].childNodes[l].textContent}}}}}}};this.restoreSubtotalsAndSortLayout=function(e){try{if(rememberLayout){mState=self.getState();if(mState!=undefined&&mState.version!=undefined&&mState.version===self.rememberLayoutStateVersion){if(mState.query==self.query&&self.conditions.length==mState.conditions.length){self.conditions[e].subtotals=mState.conditions[e].subtotals;self.conditions[e].sort=mState.conditions[e].sort;self.conditions[e].collapsedValues=mState.conditions[e].collapsedValues}}}}catch(e){}};this.applyCustomFilters=function(e){try{if(e==self.dataColumnIndex){return}if(self.columns[e]!=undefined){for(var r=0;r<self.columns[e].childNodes.length;r++){if(self.columns[e].childNodes[r]!=undefined&&self.columns[e].childNodes[r].localName!=undefined&&self.columns[e].childNodes[r].localName==="include"){self.createFilterInfo({op:"none",values:"",dim:e});for(var t=0;t<self.columns[e].childNodes[r].childNodes.length;t++){if(self.columns[e].childNodes[r].childNodes[t].localName!=null&&self.columns[e].childNodes[r].childNodes[t].localName.toLowerCase()==="value"){if(self.columns[e].childNodes[r].childNodes[t].textContent!="TOTAL"){if(self.UserFilterValues[e]==undefined)self.UserFilterValues[e]=[];self.UserFilterValues[e].push(self.columns[e].childNodes[r].childNodes[t].textContent.trimpivot())}}}}var a=self.rowConditions.indexOf(e);var s=self.colConditions.indexOf(e);if(s<self.colConditions.length-1&&s!=-1||a<self.rowConditions.length-measures.length&&a!=-1){if(self.columns[e].childNodes[r]!=undefined&&self.columns[e].childNodes[r].localName!=undefined&&self.columns[e].childNodes[r].localName==="expand"){for(var t=0;t<self.columns[e].childNodes[r].childNodes.length;t++){if(self.columns[e].childNodes[r].childNodes[t].localName!=null&&self.columns[e].childNodes[r].childNodes[t].localName.toLowerCase()==="value"){if(self.UserExpandValues[e]==undefined)self.UserExpandValues[e]=[];self.UserExpandValues[e].push(self.columns[e].childNodes[r].childNodes[t].textContent.trimpivot())}}if(self.UserExpandValues[e]==undefined){self.UserExpandValues[e]=["#ALLCOLLAPSE#"]}}}}}}catch(e){}};this.initWhenServerPagination=function(){self.propPage=OAT.Dom.create("div",{});if(self.QueryViewerCollection[self.IdForQueryViewerCollection].AutoRefreshGroup==""){jQuery(".oat_winrect_container").remove()}self.UserFilterValues=[];self.UserExpandValues=[];for(var e=0;e<self.headerRow.length;e++){self.initCondition(e);if(self.conditions[e]&&self.columns[e]){self.conditions[e].dataField=self.columns[e].getAttribute("dataField");self.conditions[e].state="all";self.conditions[e].defaultAction="Include";self.conditions[e].visibles=[];self.conditions[e].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}self.applyCustomFilters(e)}var r=jQuery.extend(true,[],self.conditions);var t=new Array;for(var e=0;e<self.initRowConditions.length;e++){t[e]=self.initRowConditions[e]}var a=new Array;for(var e=0;e<self.initColConditions.length;e++){a[e]=self.initColConditions[e]}var s=new Array;for(var e=0;e<self.initFilterIndexes.length;e++){s[e]=self.initFilterIndexes[e]}var i=jQuery.extend(true,{},self.initMetadata);self.initState={query:self.query,conditions:r,colConditions:a,rowConditions:t,filterDivSelects:[],filterIndexes:s,stateChanged:false,rowsPerPage:pageSize,AxisInfo:self.createAxisInfo(""),NewAxisInfo:self.createNewAxisInfo(""),DataInfo:self.createDataInfo(),NewDataInfo:self.createNewDataInfo(),CollapseInfo:[],FilterInfo:[],InitMetadata:i};for(var e=0;e<self.headerRow.length;e++){self.restoreSubtotalsAndSortLayout(e)}var f;if(rememberLayout){f=self.getState()}else{f=null}var l=[];self.stateLoad=false;if(f!=null){if(f.version!=undefined&&f.version===self.rememberLayoutStateVersion){if(f.query==self.query&&self.conditions.length==f.conditions.length){self.stateLoad=true;self.UserFilterValues=[];for(var n=0;n<=f.conditions.length-1;n++){if(f.conditions[n]!=false&&self.conditions[n]!=false){for(var o=0;o<f.conditions[n].distinctValues.length;o++){if(self.conditions[n].distinctValues.indexOf(f.conditions[n].distinctValues[o])==-1){self.conditions[n].distinctValues.push(f.conditions[n].distinctValues[o])}}for(var o=0;o<f.conditions[n].blackList.length;o++){if(self.conditions[n].blackList.indexOf(f.conditions[n].blackList[o])==-1){self.conditions[n].blackList.push(f.conditions[n].blackList[o])}}if(f.conditions[n].visibles){for(var o=0;o<f.conditions[n].visibles.length;o++){if(self.conditions[n].visibles.indexOf(f.conditions[n].visibles[o])==-1){self.conditions[n].visibles.push(f.conditions[n].visibles[o])}}}for(var o=0;o<f.conditions[n].collapsedValues.length;o++){if(self.conditions[n].collapsedValues.indexOf(f.conditions[n].collapsedValues[o])==-1){self.conditions[n].collapsedValues.push(f.conditions[n].collapsedValues[o])}}try{self.conditions[n].sort=f.conditions[n].sort;self.oldSortValues[n]=f.conditions[n].sort;self.conditions[n].subtotals=f.conditions[n].subtotals;self.conditions[n].defaultAction=f.conditions[n].defaultAction;self.conditions[n].state=f.conditions[n].state;self.conditions[n].topFilterValue=f.conditions[n].topFilterValue;self.conditions[n].totalPages=f.conditions[n].totalPages;self.conditions[n].previousPage=f.conditions[n].previousPage;self.conditions[n].blocked=f.conditions[n].blocked}catch(e){}}}self.rowConditions=f.rowConditions;self.colConditions=f.colConditions;self.rowsPerPage=f.rowsPerPage;self.filterIndexes=f.filterIndexes;if(f.filterDivSelects!=undefined){for(var u=0;u<f.filterDivSelects.length;u++){l[u]=f.filterDivSelects[u]}}self.stateChanged=true}}}try{if(f!=null&&f.version===self.rememberLayoutStateVersion&&f.filterIndexes.length>0){var v=false;for(var e=0;e<self.conditions.length;e++){var c=[];if(self.conditions[e]&&self.conditions[e].blackList){for(var d=0;d<self.conditions[e].blackList.length;d++){c.push(self.conditions[e].blackList[d]);v=true}}self.tempBlackLists.push([c]);var m=[];if(self.conditions[e]&&self.conditions[e].collapsedValues){for(var d=0;d<self.conditions[e].collapsedValues.length;d++){m.push(self.conditions[e].collapsedValues[d]);v=true}}self.tempCollapsedValues.push([m])}if(!v){self.tempBlackLists=false}}else{self.tempBlackLists=false}}catch(e){self.tempBlackLists=false}self.gd.clearSources();self.gd.clearTargets();if(GlobalPivotInterval[UcId]!=undefined){clearInterval(GlobalPivotInterval[UcId])}var h=0;var p=0;GlobalPivotInterval[UcId]=setInterval((function(){var e=0;var r=jQuery("#"+UcId+"_"+self.query+"_pivot_page").find(".inner_filter_div");var t=0;for(var a=0;a<r.length;a++){if(t<r[a].offsetWidth){t=r[a].offsetWidth}}t=t>0?t+8:t;if(jQuery("#"+self.controlName+"_"+self.query+"tablePagination_rowsPerPage").length>0){e=parseInt(jQuery("#"+self.controlName+"_"+self.query+"tablePagination_rowsPerPage")[0].value);if(!isNaN(e)){if(jQuery("#"+self.controlName+"_"+self.query)[0].getAttribute("class")==="pivot_table"){if(!autoResize){var s=jQuery("#"+self.containerName)[0].clientWidth;if(s<t){jQuery("#"+self.controlName+"_"+self.query).css({width:t+"px"})}else{jQuery("#"+self.controlName+"_"+self.query).css({width:s+"px"})}}var i=jQuery("#"+self.controlName+"_"+self.query)[0].offsetWidth;if(i>=t){var f=jQuery("#"+self.controlName+"_"+self.query+"_tablePagination")[0].clientWidth;if(f>t+1||f<t-1){jQuery("#"+UcId+"_"+self.query+"_title_div").css({width:i+"px"});jQuery("#"+UcId+"_"+self.query+"_pivot_page").css({width:i+"px"});jQuery("#"+self.controlName+"_"+self.query+"_tablePagination").css({width:i+"px"});p=h;h=i}}else{jQuery("#"+UcId+"_"+self.query+"_title_div").css({width:t+"px"});jQuery("#"+UcId+"_"+self.query+"_pivot_page").css({width:t+"px"});jQuery("#"+self.controlName+"_"+self.query+"_tablePagination").css({width:t+"px"});jQuery("#"+self.controlName+"_"+self.query).css({width:t+"px"});p=h;h=t}}}}else{if(jQuery("#"+self.controlName+"_"+self.query)[0]!=undefined){if(jQuery("#"+self.controlName+"_"+self.query)[0].getAttribute("class")==="pivot_table"){if(!autoResize){var s=jQuery("#"+self.containerName)[0].clientWidth;if(s<t){jQuery("#"+self.controlName+"_"+self.query).css({width:t+"px"})}else{jQuery("#"+self.controlName+"_"+self.query).css({width:s+"px"})}}var i=jQuery("#"+self.controlName+"_"+self.query)[0].offsetWidth;if(i<t){if(p==0||p==h||(h>t+6||h<t-6||p>h+6||p<h-6)){jQuery("#"+UcId+"_"+self.query+"_title_div").css({width:t+"px"});jQuery("#"+UcId+"_"+self.query+"_pivot_page").css({width:t+"px"});p=h;h=t;jQuery("#"+self.controlName+"_"+self.query).css({width:t+"px"})}}else{if(p==0||p==h||(h>i+6||h<i-6||p>h+6||p<h-6)){jQuery("#"+UcId+"_"+self.query+"_title_div").css({width:i+"px"});jQuery("#"+UcId+"_"+self.query+"_pivot_page").css({width:i+"px"});p=h;h=i}}}}}}),20);var T;if(f!=null&&f.AxisInfo!=null){self.pageData.AxisInfo=f.AxisInfo;T=jQuery.extend(true,{},f.NewAxisInfo)}else{self.pageData.AxisInfo=self.createAxisInfo("");T=self.createNewAxisInfo("")}var A;if(f!=null&&f.DataInfo!=null){self.pageData.DataInfo=f.DataInfo;A=jQuery.extend(true,{},f.NewDataInfo)}else{self.pageData.DataInfo=self.createDataInfo();A=self.createNewDataInfo()}if(f!=null&&f.FilterInfo!=null){self.pageData.FilterInfo=f.FilterInfo}if(self.UserFilterValues.length==0&&self.UserExpandValues.length==0){self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");self.lastCallToQueryViewer="initWhenServerPagination";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,T,A,self.pageData.FilterInfo,self.pageData.CollapseInfo,true)}else{self.initValueRead(self,0,true)}setInterval((function(){for(var e=0;e<jQuery(".oat_winrect_container .pivot_popup_fix").length;e++){if(!jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display||jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display!="none"){if(jQuery(".oat_winrect_container .pivot_popup_fix").length>0){var r=jQuery(".oat_winrect_container .pivot_popup_fix")[e];var t=r.scrollHeight-r.clientHeight-r.scrollTop;if(t<25){var a=r.getAttribute("ucid");var s=parseInt(r.getAttribute("columnNumber"));if(a==self.UcId){self.readScrollValue(s)}}}}}}),250)};this.initValueRead=function(e,r,t,a){if(r>=e.columns.length){try{for(var s=0;s<jQuery("#"+e.UcId+"_"+e.query+"_pivot_page").find("select").length;s++){var i=jQuery("#"+e.UcId+"_"+e.query+"_pivot_page").find("select")[s];var f=parseInt(i.getAttribute("id").replace("page_select_",""));var l=e.filterIndexes[f];if(e.conditions[l].filteredShowValues==undefined){e.conditions[l].filteredShowValues=[]}var n=e.conditions[l].distinctValues;for(var o=0;o<n.length;o++){var u=n[o];if(e.conditions[l].filteredShowValues.indexOf(u)==-1){e.conditions[l].filteredShowValues.push(u);if(u!="#NuN#"){OAT.Dom.option(u,u,i)}else{OAT.Dom.option(" ",u,i)}}}if(e.conditions[l].topFilterValue!="[all]"){var u=e.conditions[l].topFilterValue;var v=-1;for(var c=0;c<e.conditions[l].filteredShowValues.length;c++){if(String(e.conditions[l].filteredShowValues[c]).trim()==String(u).trim()){v=c}}if(v>-1){i.selectedIndex=v+1}else{e.conditions[l].filteredShowValues.push(u);if(u!="#NuN#"){OAT.Dom.option(u,u,i)}else{OAT.Dom.option(" ",u,i)}i.selectedIndex=1}}}}catch(e){}if(t){e.callServiceWhenCustomeValues()}return}else{var d=10;if(e.QueryViewerCollection[e.IdForQueryViewerCollection].AutoRefreshGroup!=""||t){d=0}e.lastRequestValue=r;e.lastRequestAttributeValues="initValueRead";e.lastRequestAttributeColumnNumber=r;e.lastRequestAttributeAllData=t;e.lastRequestAttributeRequestDataField=a;e.requestAttributeValues(e.columns[r].getAttribute("dataField"),1,d,"")}};this.callServiceWhenCustomeValues=function(){self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");var e=self.createNewAxisInfo();var r=self.createNewDataInfo();self.lastCallToQueryViewer="callServiceWhenCustomeValues";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,e,r,self.pageData.FilterInfo,self.pageData.CollapseInfo,true)};this.getOrderReference=function(e,r,t,a){return function(s,i,f){if(self.conditions[e].validPosition!=undefined&&self.conditions[e].validPosition.indexOf("filters")==-1){return}self.lightOff();var l=e;var n=s.conditionIndex;if(l!=n&&self.conditions[0].previousPage==undefined){self.initValueRead(self,0,self.stateLoad)}if(s==self.filterDiv){self.stateChanged=true;var o=false;for(var u=0;u<self.filterIndexes.length&&!o;u++){if(self.filterIndexes[u]>e){self.filterIndexes.splice(u,0,e);o=true}}if(!o){self.filterIndexes.push(e)}self.conditions[e].blackList=[];for(var v=0;v<self.rowConditions.length;v++){if(self.rowConditions[v]==e){self.rowConditions.splice(v,1)}}for(var v=0;v<self.colConditions.length;v++){if(self.colConditions[v]==e){self.colConditions.splice(v,1)}}self.onDragundDropEventHandle(e,"pages",self.filterIndexes.indexOf(e));self.DiseablePivot();setTimeout((function(){self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,{op:"all",value:"",dim:e},"","");self.EneablePivot()}),200);return}var c=self.rowConditions.indexOf(e)>-1;if(l==n){if(OAT.isWebkit()){if(r!=undefined){r.displayRef2([i,f]);t([i,f,a])}}return}var d=false;var m=-1;var h=false;var p=-1;for(var v=0;v<self.rowConditions.length;v++){if(self.rowConditions[v]==l){d=self.rowConditions;m=v}if(self.rowConditions[v]==n){h=self.rowConditions;p=v}}for(var v=0;v<self.colConditions.length;v++){if(self.colConditions[v]==l){d=self.colConditions;m=v}if(self.colConditions[v]==n){h=self.colConditions;p=v}}if(d==h){if(m+1==p){h.splice(p+1,0,l);h.splice(m,1)}else{h.splice(m,1);h.splice(p,0,l)}self.changesrowposition=true;self.onDragundDropEventHandle(e,c?"rows":"columns",c?self.rowConditions.indexOf(e):self.colConditions.indexOf(e))}else{d.splice(m,1);h.splice(p,0,l);self.onDragundDropEventHandle(e,c?"columns":"rows",c?self.colConditions.indexOf(e):self.rowConditions.indexOf(e))}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,"","","")}};this.getOrderReferenceProg=function(e){if(self.conditions[e].validPosition!=undefined&&self.conditions[e].validPosition.indexOf("filters")==-1){return}self.stateChanged=true;if(self.filterIndexes.indexOf(e)<0){self.filterIndexes.push(e)}self.conditions[e].blackList=[];for(var r=0;r<self.rowConditions.length;r++){if(self.rowConditions[r]==e){self.rowConditions.splice(r,1)}}for(var r=0;r<self.colConditions.length;r++){if(self.colConditions[r]==e){self.colConditions.splice(r,1)}}self.onDragundDropEventHandle(e,"pages",self.filterIndexes.indexOf(e));self.DiseablePivot();setTimeout((function(){self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,{op:"all",value:"",dim:e},"","");self.EneablePivot()}),200);return};this.getClickReference=function(e,r,t){var a=OAT.Anchor.assign(t,{title:" ",content:self.propPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(self.QueryViewerCollection[self.IdForQueryViewerCollection])+" FilterPopup "});jQuery(t).data("anchorRef",a);return[function(t){if(self.conditions[r].previousPage==undefined){self.initValueRead(self,r,self.stateLoad,self.conditions[r].dataField);jQuery(".oat_winrect_container").css({left:"-10000000px",top:"-10000000px"});var a=jQuery.extend(true,{},t);var s=function(){if(self.conditions[r].previousPage==undefined){setTimeout(s,100)}else{self.ShowPopUp(e,r,a)}};s()}else{self.ShowPopUp(e,r,t)}},a]};this.ShowPopUp=function(e,r,t){var a=function(){jQuery(".oat_winrect_container").css({display:"none"})};var s;var i;if(t.currentTarget!=undefined){s=t.currentTarget;i=OAT.Dom.eventPos(t)}else{s=t[2];i=[t[0],t[1]]}var f=[];self.propPage.style.left=i[0]+"px";self.propPage.style.top=i[1]+"px";if(self.isSD){jQuery(".oat_winrect_container").css({left:"-1500px",top:jQuery(s).offset().top+"px"});jQuery(".oat_winrect_container").addClass("oat_winrect_container_small")}else{jQuery(".oat_winrect_container").css({left:jQuery(s).offset().left+"px",top:jQuery(s).offset().top+"px"})}self.propPage.setAttribute("id","pop-up");self.propPage.setAttribute("class","oat_pop-up");OAT.Dom.clear(self.propPage);f.push(self.propPage);jQuery(".oat_winrect_title").find(".winrect_title_label").remove();var l=OAT.Dom.create("label");if(self.isSD){l.setAttribute("class","winrect_title_label winrect_title_label_small")}else{l.setAttribute("class","winrect_title_label")}OAT.addTextNode(l,self.columns[r].getAttribute("displayName"));jQuery(".oat_winrect_title").append(l);if(!disableColumnSort){var n=document.createElement("div");n.setAttribute("class","first_popup_subdiv");var o=OAT.Dom.radio("order");var u="pivot_order_asc"+"_"+self.containerName+"_"+self.columns[r].getAttribute("dataField");o.id=u;o.className="input_radio_popup";OAT.Dom.attach(o,"change",(function(){try{var t='<DATA event="OrderChanged" name="'+self.columns[r].getAttribute("name")+'" displayName="'+self.columns[r].getAttribute("displayName")+'"  order="ascending">';t=t+"</DATA>";if(qv.util.isGeneXusPreview())window.external.SendText(self.QueryViewerCollection[self.IdForQueryViewerCollection].ControlName,t)}catch(e){}e.sort=1;self.stateChanged=true;self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");var a="i_"+this.getAttribute("id");var s=document.getElementById(a);s.textContent="radio_button_checked";var i=document.getElementById(a.replace("asc","desc"));i.textContent="radio_button_unchecked"}));n.appendChild(o);var v=OAT.isIE()?"top:-10px;":"";var c=OAT.Dom.create("label");c.className="first_div_label";c.htmlFor=u;n.appendChild(c);n.appendChild(OAT.Dom.create("br"));OAT.addImageNode(c,e.sort==1?"radio_button_checked":"radio_button_unchecked",v,"i_"+u);OAT.addTextNode(c,self.translations.GXPL_QViewerJSAscending);var d=OAT.Dom.radio("order");var m="pivot_order_desc"+"_"+self.containerName+"_"+self.columns[r].getAttribute("dataField");d.id=m;d.className="input_radio_popup";OAT.Dom.attach(d,"change",(function(){try{var t='<DATA event="OrderChanged" name="'+self.columns[r].getAttribute("name")+'" displayName="'+self.columns[r].getAttribute("displayName")+'"  order="descending">';t=t+"</DATA>";if(qv.util.isGeneXusPreview())window.external.SendText(self.QueryViewerCollection[self.IdForQueryViewerCollection].ControlName,t)}catch(e){}e.sort=-1;self.stateChanged=true;self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");var a="i_"+this.getAttribute("id");var s=document.getElementById(a);s.textContent="radio_button_checked";var i=document.getElementById(a.replace("desc","asc"));i.textContent="radio_button_unchecked"}));n.appendChild(d);var h=OAT.Dom.create("label");h.className="first_div_label";h.htmlFor=m;n.appendChild(h);OAT.addImageNode(h,e.sort==1?"radio_button_unchecked":"radio_button_checked",v,"i_"+m);OAT.addTextNode(h,self.translations.GXPL_QViewerJSDescending);f.push(n);var p=OAT.Dom.create("hr",{});f.push(p)}var T=OAT.Dom.create("hr",{});var A=OAT.Dom.create("hr",{});if((e.hideSubtotalOption===undefined||!e.hideSubtotalOption)&&(!self.autoPaging||self.colConditions.length==0)){var w=OAT.Dom.create("div");if(disableColumnSort){w.setAttribute("class","first_popup_subdiv")}var O=document.createElement("div");var y=e.subtotals?"check_item_img":"uncheck_item_img";if(self.isSD){var y=e.subtotals?"check_item_img_small":"uncheck_item_img_small"}O.setAttribute("class",y);OAT.Dom.attach(O,"click",(function(){var t="check_item_img";var a="uncheck_item_img";if(self.isSD){t="check_item_img_small";a="uncheck_item_img_small"}e.subtotals=!(this.getAttribute("class")===t);var s=this.getAttribute("class")===t?a:t;this.setAttribute("class",s);jQuery(this).find("i")[0].textContent=e.subtotals?"check_box":"check_box_outline_blank";self.stateChanged=true;try{var i='<DATA event="SubtotalsChanged" name="'+self.columns[r].getAttribute("name")+'" displayName="'+self.columns[r].getAttribute("displayName")+'"  subtotals="'+e.subtotals+'">';i=i+"</DATA>";if(qv.util.isGeneXusPreview())window.external.SendText(self.QueryViewerCollection[self.IdForQueryViewerCollection].ControlName,i)}catch(e){}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","")}));var _=OAT.Dom.create("label");OAT.addImageNode(_,e.subtotals?"check_box":"check_box_outline_blank","");OAT.addTextNode(_,self.translations.GXPL_QViewerJSSubtotals);_.htmlFor="pivot_checkbox_subtotals";O.appendChild(_);OAT.Dom.append([w,O]);f.push(w);f.push(T)}if(self.stateChanged||self.pivotStateChanged()){var g=OAT.Dom.create("div");var b=document.createElement("div");OAT.Dom.attach(b,"click",(function(){self.cleanStateWhenServerPagination();self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");a();self.stateChanged=false}));var x=OAT.Dom.create("label");OAT.addTextNode(x,self.translations.GXPL_QViewerJSRestoreDefaultView);x.setAttribute("id","restore_default_view");x.htmlFor="pivot_checkbox_restoreview";x.setAttribute("class","pivot_checkbox_restoreview");b.appendChild(x);OAT.Dom.append([g,b]);f.push(g)}var F=false;if(measures.length>0){var S=OAT.Dom.create("div");var k=document.createElement("div");OAT.Dom.attach(k,"click",(function(){self.stateChanged=true;self.changedFromColumnToRow(r);self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");a()}));var N=OAT.Dom.create("label");if(self.rowConditions.indexOf(r)!=-1)OAT.addTextNode(N,self.translations.GXPL_QViewerJSPivotDimensionToColumn);else OAT.addTextNode(N,self.translations.GXPL_QViewerJSPivotDimensionToRow);N.htmlFor="pivot_checkbox_restoreview";N.setAttribute("class","pivot_checkbox_restoreview");N.setAttribute("id","move_to_column");k.appendChild(N);OAT.Dom.append([S,k]);f.push(S);F=true}if(measures.length>0){if(OAT.isSD()){if(self.filterIndexes.indexOf(r)===-1){var I=OAT.Dom.create("div");var D=document.createElement("div");OAT.Dom.attach(D,"click",(function(){self.getOrderReferenceProg(r);a()}));var E=OAT.Dom.create("label");OAT.addTextNode(E,self.translations.GXPL_QViewerJSMoveToFilterBar);E.htmlFor="pivot_checkbox_movetocolumn";D.appendChild(E);OAT.Dom.append([I,D]);f.push(I);F=true}}}if(F)f.push(A);var C=OAT.Dom.create("div");C.setAttribute("class","last_div_popup");if(!OAT.isIE()){OAT.Dom.create("br");OAT.Dom.create("br");OAT.Dom.create("br")}else{OAT.Dom.create("span");OAT.Dom.create("span");OAT.Dom.create("span")}f.push(C);OAT.Dom.append(f);self.distinctDivs(e,C,r);if(!disableColumnSort){o.checked=e.sort==1||e.sort==0;o.__checked=o.checked;d.checked=e.sort==-1||e.sort==2;d.__checked=d.checked}if(self.isSD){setTimeout((function(){var e=window.innerWidth;var r=jQuery(".oat_winrect_container")[0].clientWidth;if(r==0){var t=jQuery(".oat_winrect_container").length;r=jQuery(".oat_winrect_container")[t-1].clientWidth}if(r<245){r=245}var a=(e-r)/2+jQuery(window).scrollLeft();jQuery(".oat_winrect_container").css({left:a+"px",width:r+"px"})}),50)}};this.updateRowConditions=function(e,r,t){var a=false;var s=self.initRowConditions.length+self.initColConditions.length<=self.rowConditions.length+self.colConditions.length;if(s)a=true;var i=[];for(var f=0;f<self.initRowConditions.length-(r.length-1);f++){if(self.initRowConditions[f]==e){i.push(e)}if(self.rowConditions.indexOf(self.initRowConditions[f])>-1){i.push(self.initRowConditions[f])}}for(var f=0;f<self.initColConditions.length;f++){if(self.initColConditions[f]==e){i.push(e)}if(self.rowConditions.indexOf(self.initColConditions[f])>-1){i.push(self.initColConditions[f])}}for(var f=0;f<self.initFilterIndexes.length;f++){if(self.initFilterIndexes[f]==e&&i.indexOf(e)==-1){i.push(e)}if(self.rowConditions.indexOf(self.initFilterIndexes[f])>-1){if(i.indexOf(self.initFilterIndexes[f])==-1)i.push(self.initFilterIndexes[f])}}if(i.indexOf(e)<0){i.push(e)}if(a){for(var l=0;l<self.rowConditions.length;l++){if(i.indexOf(self.rowConditions[l])<0){i.push(self.rowConditions[l])}}}i.sort(function(){return function(e,r){return e==r?0:e<r?-1:1}}());for(var f=self.initRowConditions.length-(r.length-1);f<Math.min(self.initRowConditions.length,self.dataColumnIndex);f++){if(i.indexOf(self.initRowConditions[f])<0)i.push(self.initRowConditions[f])}self.rowConditions=[];for(var f=0;f<i.length;f++){self.rowConditions[f]=i[f]}};this.changedFromColumnToRow=function(e){var r=self.rowConditions.indexOf(e);var t="columns";var a=0;if(r!=-1){self.rowConditions.splice(r,1);if(measures.length>1)self.colConditions=[e].concat(self.colConditions);else self.colConditions.push(e);a=self.colConditions.indexOf(e)}else{t="rows";r=self.colConditions.indexOf(e);self.colConditions.splice(r,1);self.updateRowConditions(e,measures,false);a=self.rowConditions.indexOf(e)}self.onDragundDropEventHandle(e,t,a)};this.getDelFilterReference=function(e){return function(){var r=self.filterIndexes.indexOf(e);if(r!=-1){self.filterIndexes.splice(r,1)}self.updateRowConditions(e,measures,true);for(var t=0;t<self.filterDiv.selects.length;t++){if(e==self.filterDiv.selects[t].filterIndex){self.filterDiv.selects.splice(t,1);break}}self.stateChanged=true;self.onDragundDropEventHandle(e,"rows",self.rowConditions.indexOf(e));self.DiseablePivot();setTimeout((function(){self.conditions[e].topFilterValue="[all]";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,{op:"all",values:"",dim:e},"","");self.EneablePivot()}),200)}};this.valueIsShowed=function(e,r){if(self.conditions[r].state=="all"){return true}else if(self.conditions[r].state=="none"){return false}else if(self.conditions[r].blackList.indexOf(e)!=-1){return false}else if(self.conditions[r].distinctValues.indexOf(e)!=-1){return true}else if(self.conditions[r].defaultAction=="Exclude"){return false}else{return true}};this.distinctDivs=function(e,r,t,a){var s=function(r,a){var s=OAT.Dom.create("div");var i="check_item_img";var f="uncheck_item_img";if(self.isSD){i="check_item_img_small";f="uncheck_item_img_small"}OAT.addImageNode(s,self.valueIsShowed(A,t)?"check_box":"check_box_outline_blank","");var l=e.blackList.indexOf(A)==-1&&self.valueIsShowed(A,t)?i:f;var l=self.valueIsShowed(A,t)?i:f;s.setAttribute("class",l);var n=OAT.Dom.create("input");n.type="checkbox";n.id=a;var o=OAT.Dom.create("label");OAT.addTextNode(o,r);o.htmlFor=a;s.appendChild(o);return[s,n]};var i=function(e,r){setTimeout((function(){var a="pop";if(!e){a="push"}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:a,values:r,dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.EneablePivot()}),200)};var f=function(){self.DiseablePivot();setTimeout((function(){var a="all";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:a,values:"",dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.distinctDivs(e,r,t);self.EneablePivot();return}),200)};var l=function(){self.DiseablePivot();setTimeout((function(){var a="none";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:a,values:"",dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.distinctDivs(e,r,t);self.EneablePivot();return}),200)};var n=function(){self.DiseablePivot();setTimeout((function(){var a="reverse";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:a,values:"",dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.distinctDivs(e,r,t);self.EneablePivot();return}),200)};var o=function(){self.getValuesForColumn(self.UcId,t,this.value)};OAT.Dom.clear(r);var u=OAT.Dom.create("div");u.setAttribute("class","div_buttons_popup");var v=document.createElement("button");v.textContent=self.translations.GXPL_QViewerJSAll;v.setAttribute("class","btn");jQuery(v).click(f);var c=document.createElement("button");c.textContent=self.translations.GXPL_QViewerJSNone;c.setAttribute("class","btn");jQuery(c).click(l);var d=document.createElement("button");d.textContent=self.translations.GXPL_QViewerJSReverse;d.setAttribute("class","btn");jQuery(d).click(n);OAT.Dom.append([u,v,c,d],[r,u]);var m=OAT.Dom.create("div");m.setAttribute("class","div_filter_input");var h=document.createElement("input");OAT.addImageNode(m,"search","");h.textContent="none";h.setAttribute("class","search_input");h.setAttribute("type","text");h.setAttribute("label",self.translations.GXPL_QViewerSearch);h.setAttribute("title",self.translations.GXPL_QViewerSearch);h.setAttribute("placeholder",self.translations.GXPL_QViewerSearch);h.setAttribute("id",self.UcId+t);jQuery(h).keyup(o);OAT.Dom.append([m,h],[r,m]);var p=OAT.Dom.create("div");e=self.conditions[t];if(e.distinctValues.length<=9){p.setAttribute("class","pivot_popup_auto")}else{p.setAttribute("class","pivot_popup_fix")}for(var T=0;T<e.distinctValues.length;T++){var A=e.distinctValues[T];if(!(self.conditions[t].hasNull&&A.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){var w=self.dimensionPictureValue(A,t);w=w.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(w.length>33){var O=w.substring(32,w.length).trimpivot().length>0?"...":"";w=w.substring(0,32)+O}w=w.replace(/ /g," ")+"     ";var y=s(w,"pivot_distinct_"+T);y[0].setAttribute("value",A);p.appendChild(y[0]);OAT.Dom.attach(y[0],"click",(function(){self.DiseablePivot();var e="check_item_img";var r="uncheck_item_img";if(self.isSD){e="check_item_img_small";r="uncheck_item_img_small"}var t=!(this.getAttribute("class")===e);var a=this.getAttribute("class")===e?r:e;this.setAttribute("class",a);jQuery(this).find("i")[0].textContent=t?"check_box":"check_box_outline_blank";i(t,this.getAttribute("value"))}))}}p.setAttribute("ucid",self.UcId);p.setAttribute("columnnumber",t);p.setAttribute("id","values_"+self.UcId+"_"+t);r.appendChild(p)};this.DiseablePivot=function(){try{var e=jQuery('<div class="disable_popup" ></div>');if(jQuery("#"+self.containerName).length>0){var r=Math.min(jQuery("#"+UcId+"_"+self.query+"_pivot_page")[0].clientHeight+jQuery("#"+UcId+"_"+self.query+"_pivot_content")[0].clientHeight,jQuery("#"+self.containerName)[0].clientHeight);var t=Math.min(jQuery("#"+UcId+"_"+self.query)[0].clientWidth,jQuery("#"+self.containerName)[0].clientWidth);if(jQuery("#"+self.containerName).closest(".gxwebcomponent").length>0){if(jQuery("#"+UcId+"_"+self.query+"_tablePagination").length>0){r=r+jQuery("#"+UcId+"_"+self.query+"_tablePagination")[0].clientHeight}jQuery(e).css({width:t,height:r,position:"absolute",top:jQuery("#"+self.containerName)[0].offsetTop,left:jQuery("#"+self.containerName)[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99})}else{jQuery(e).css({width:t,height:r,position:"absolute",top:jQuery("#"+self.containerName)[0].offsetTop,left:jQuery("#"+UcId+"_"+self.query).offset().left,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":999})}jQuery("#"+self.containerName).append(e)}else{var r=Math.min(jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").find(".pivot_filter_div")[0].clientHeight+jQuery("#"+UcId+"_"+self.query).closest(".conteiner_table_div")[0].clientHeight,jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].clientHeight);var t=Math.min(jQuery("#"+UcId+"_"+self.query)[0].clientWidth,jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].clientWidth);if(jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").find(".pivot_pag_div").length>0){r=r+jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").find(".pivot_pag_div")[0].clientHeight}jQuery(e).css({width:t,height:r,position:"absolute",top:jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].offsetTop,left:jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99});jQuery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").append(e)}jQuery(".oat_winrect_container").block({message:null})}catch(e){}};this.EneablePivot=function(){jQuery(".disable_popup").remove();while(jQuery(".disable_popup").length>0){jQuery(".disable_popup").remove()}jQuery(".oat_winrect_container").unblock()};this.addExpandCollapseFunctionality=function(e,r,t,a,s){{var i=OAT.Dom.create("div",{});if(a){i.className+=" expanded";OAT.addImageNode(i,"remove","")}else{i.className+=" collapsed";OAT.addImageNode(i,"add","")}e.insertBefore(i,e.firstChild);e.style.paddingLeft="0px";var f=jQuery(e).find("#span_txt_pivot")[0];if(s){self.setExpandCollapseEventHandlers(i,r.value,"DIMENSION",self.rowConditions[t],r);if(self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemDoubleClick==undefined&&self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemClick==undefined&&!self.selection.Allow){self.setExpandCollapseEventHandlers(f,r.value,"DIMENSION",self.rowConditions[t],r);jQuery(f).css({cursor:"pointer"})}}else{self.setExpandCollapseEventHandlers(i,r.value,"DIMENSION",self.colConditions[t],r);if(self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemDoubleClick==undefined&&self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemClick==undefined&&!self.selection.Allow){self.setExpandCollapseEventHandlers(f,r.value,"DIMENSION",self.colConditions[t],r);jQuery(f).css({cursor:"pointer"})}}}return e};this.setClickEventHandlers=function(e,r,t,a,s){if(!self.ShowMeasuresAsRows||self.h<500){var i=jQuery(e).find("#span_txt_pivot")[0];if(i){jQuery(i).data("itemValue",r);jQuery(i).data("typeMorD",t);jQuery(i).data("numberMorD",a);jQuery(i).data("itemInfo",s);jQuery(e).data("itemValue",r);jQuery(e).data("typeMorD",t);jQuery(e).data("numberMorD",a);jQuery(e).data("itemInfo",s);var f=self.QueryViewerCollection[IdForQueryViewerCollection];var l=t=="DIMENSION"?f.Metadata.Axes[a].RaiseItemClick:f.Metadata.Data[a].RaiseItemClick;if(f.ItemClick&&l){i.onclick=function(){self.onClickEventHandle(this);if(self.selection.Allow){self.onClickSelectNode(this)}};i.classList.add("gx-qv-clickable-element")}else if(self.selection.Allow){i.onclick=function(){self.onClickSelectNode(this)}}}}};this.setExpandCollapseEventHandlers=function(e,r,t,a,s){if(!self.ShowMeasuresAsRows||self.h<500){jQuery(e).data("itemValue",r);jQuery(e).data("numberMorD",a);jQuery(e).data("itemInfoEC",s);e.onclick=function(){self.onClickExpandCollapse(this)}}};this.getPerFilterValue=function(e,r){var t=false;for(var a=0;a<e.length;a++){if(e[a]!=null){t=true}}if(!t)return false;var s=[];for(var a=0;a<self.GeneralDataRows.length;a++){var i=true;for(var f=0;f<e.length;f++){if(e[f]!=null){if(self.GeneralDataRows[a][self.filterIndexes[f]]!=e[f]){i=false}}}if(i){s.push(self.GeneralDataRows[a][self.filterIndexes[r]])}}return s};this.drawTitleDiv=function(){if(self.PivotTitle){OAT.Dom.clear(self.TitleDiv);var e=navigator.userAgent.toLowerCase();e.indexOf("android")>-1;if(OAT.isIE()||OAT.isAndroid()){self.TitleDiv.className+=" pivot_title_div"}else{self.TitleDiv.classList.add("pivot_title_div")}OAT.addTextNode(self.TitleDiv,self.PivotTitle)}};this.drawFilters=function(){var e=[];var r=self.filterDiv;var t=OAT.Dom.create("div");var a=OAT.Dom.create("span");var s=navigator.userAgent.toLowerCase();s.indexOf("android")>-1;if(OAT.isIE()||OAT.isAndroid()){self.filterDiv.className+=" pivot_filter_div"}else{self.filterDiv.classList.add("pivot_filter_div")}if(!self.isSD&&self.filterIndexes.length==0){t.href="#";t.setAttribute("class","filterInfoUser");a.setAttribute("class","spanHoverLabel");a.setAttribute("id","filterSpanInfo");OAT.addImageNode(t,"info","");OAT.addTextNode(a,self.translations.GXPL_QViewerInfoUser)}for(var i=0;i<r.selects.length;i++){e.push([r.selects[i].filterIndex,r.selects[i].selectedIndex,r.selects[i].value])}OAT.Dom.clear(r);self.gd.addTarget(r);r.selects=[];if(!self.filterIndexes.length){var f=self.translations.GXPL_QViewerJSDropFiltersHere;if(self.isSD){f=""}if(f[f.length-1]==='"'||f[f.length-1]==="'"||f[f.length-1]==="]"||f[f.length-1]==="}"||f[f.length-1]==="`"){f=f.substring(0,f.length-1)}if(f!=""){var l=document.createElement("span");l.textContent=f;r.appendChild(l)}}var n=function(){var e=this;var r=self.conditions[this.filterIndex].distinctValues;for(var t=0;t<r.length;t++){var a=r[t];if(self.conditions[this.filterIndex].filteredShowValues.indexOf(a)==-1){self.conditions[this.filterIndex].filteredShowValues.push(a);if(a!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(a,this.filterIndex),a,e)}catch(r){OAT.Dom.option(a,a,e)}}else{OAT.Dom.option(" ",a,e)}}}self.lastRequestValue=this.filterIndex;var s=this.filterIndex;if(self.conditions[s].previousPage<self.conditions[s].totalPages){self.lastRequestAttributeValues="DrawFilters";self.lastRequestAttributeColumnNumber=s;self.requestAttributeValues(self.columns[this.filterIndex].getAttribute("dataField"),1,0,"")}};var o=function(){self.stateChanged=true;self.DiseablePivot();self.conditions[this.filterIndex].topFilterValue=this.value;self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[this.filterIndex].dataField,{op:"pagefilter",values:this.value,dim:this.filterIndex},"","");self.EneablePivot();return};var u=[];var v=[];for(var i=0;i<self.filterIndexes.length;i++){if(v.indexOf(self.filterIndexes[i])<0){v.push(self.filterIndexes[i]);var c=self.filterIndexes[i];var d=OAT.Dom.create("select");d.setAttribute("id","page_select_"+i);OAT.Dom.option(self.translations.GXPL_QViewerJSAllOption,"[all]",d);var m;m=[];if(self.GeneralDistinctValues.length>0){for(var h=0;h<self.GeneralDistinctValues[c].length;h++){var p=self.GeneralDistinctValues[c][h];if(!m){if(p!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(p,c),p,d)}catch(e){OAT.Dom.option(p,p,d)}}else{OAT.Dom.option(" ",p,d)}}else{if(m.indexOf(p)!=-1){if(p!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(p,c),p,d)}catch(e){OAT.Dom.option(p,p,d)}}else{OAT.Dom.option(" ",p,d)}}}}try{var T=0;for(var h=0;h<self.GeneralDistinctValues[c].length;h++){var p=self.GeneralDistinctValues[c][h];if(self.conditions[c].topFilterValue===p){d.selectedIndex=T+1}if(!m){T++}else{if(m.indexOf(p)!=-1){T++}}}}catch(e){}}self.conditions[c].filteredShowValues=[];var m=self.conditions[c].distinctValues;for(var h=0;h<m.length;h++){var p=m[h];if(self.conditions[c].filteredShowValues.indexOf(p)==-1){self.conditions[c].filteredShowValues.push(p);if(p!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(p,c),p,d)}catch(e){OAT.Dom.option(p,p,d)}}else{OAT.Dom.option(" ",p,d)}}}if(self.conditions[c].topFilterValue!="[all]"){var p=self.conditions[c].topFilterValue;var A=-1;for(var w=0;w<self.conditions[c].filteredShowValues.length;w++){if(String(self.conditions[c].filteredShowValues[w]).trim()==String(p).trim()){A=w}}if(A>-1){d.selectedIndex=A+1}else{self.conditions[c].filteredShowValues.push(p);if(p!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(p,c),p,d)}catch(e){OAT.Dom.option(p,p,d)}}else{OAT.Dom.option(" ",p,d)}d.selectedIndex=1}}d.filterIndex=c;for(var h=0;h<e.length;h++){if(e[h][0]==c){for(var O=0;O<d.length;O++){if(d[O].value==e[h][2]){d.selectedIndex=O}}}}if(d.selectedIndex>0){u[i]=d.value}else{u[i]=null}OAT.Dom.attach(d,"click",n);OAT.Dom.attach(d,"change",o);r.selects.push(d);var y=OAT.Dom.create("div");y.setAttribute("class","inner_filter_div");OAT.addTextNode(y,self.headerRow[c]);var _=document.createElement("div");_.setAttribute("class","close_span_filter");OAT.addImageNode(_,"close","");_.style.cursor="pointer";var g=self.getDelFilterReference(c);OAT.Dom.attach(_,"click",g);OAT.Dom.append([self.filterDiv,y],[y,d,_])}}var b=OAT.Dom.create("div");b.href="#";if(self.isSD){b.setAttribute("class","exportOptionsAnchor exportOptionsAnchor_small")}else{b.setAttribute("class","exportOptionsAnchor")}OAT.addImageNode(b,"menu","");self.filterIcon=OAT.Dom.create("div",{});self.exportPage=OAT.Dom.create("div",{});var x=function(e){source=OAT.Event.source(e);var r=false;var t=false;for(var a=0;a<jQuery(".oat_winrect_container").length;a++){var s=jQuery(".oat_winrect_container")[a];if(!(source==s)&&!OAT.Dom.isChild(source,s)){r=true}else{r=false;break}}for(var a=0;a<jQuery(".oat_winrect_container").length;a++){if(jQuery(".oat_winrect_container")[a].style.display!="none"){t=true}}if((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,s))&&t){self.resetAllScrollValue(self.UcId)}if(r){jQuery(".oat_winrect_container").css({display:"none"})}};var F=function(e){source=OAT.Event.source(e);var r=false;var t=false;for(var a=0;a<jQuery(".oat_winrect_container").length;a++){var s=jQuery(".oat_winrect_container")[a];if(!(source==s)&&!OAT.Dom.isChild(source,s)){r=true}else{r=false;break}}for(var a=0;a<jQuery(".oat_winrect_container").length;a++){if(jQuery(".oat_winrect_container")[a].style.display!="none"){t=true}}if((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,s))&&t){self.resetAllScrollValue(self.UcId)}if(r){jQuery(".oat_winrect_container").css({display:"none"})}};OAT.Dom.attach(document,"mousedown",x);OAT.Dom.attach(document,"onmouseout",F);OAT.Anchor.assign(b,{title:" ",content:self.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(self.QueryViewerCollection[self.IdForQueryViewerCollection])+" ExportPopup "});var S=function(e){var r=OAT.Event.position(e);self.exportPage.style.left=r[0]+"px";self.exportPage.style.top=r[1]+"px";self.exportPage.id="exportOptionsContainer";Math.max(jQuery(".ExportPopup")[0].clientWidth,300);jQuery(e.currentTarget).offset().left;var t=e.currentTarget;jQuery(".oat_winrect_title").find(".winrect_title_label").remove();var a=OAT.Dom.create("label");if(self.isSD){jQuery(".oat_winrect_container").addClass("oat_winrect_container_small");a.setAttribute("class","winrect_title_label winrect_title_label_small")}else{a.setAttribute("class","winrect_title_label")}OAT.addTextNode(a,self.translations.GXPL_QViewerPopupTitle);jQuery(".oat_winrect_title").append(a);jQuery(".ExportPopup").css({left:-2500+"px",top:0+"px"});OAT.Dom.clear(self.exportPage);var s=document.createElement("div");s.setAttribute("class","upper_container");jQuery("#divtoxml").remove();jQuery("#divtoxls").remove();jQuery("#divtoxlsx").remove();jQuery("#divtoexport").remove();jQuery("#divtohtml").remove();var i=false;self.appendExportToXmlOption(s,i);self.appendExportToHtmlOption(s,i);self.appendExportToPdfOption(s,i);self.appendExportToExcelOption(s,i);self.appendExportToExcel2010Option(s,i);self.exportPage.appendChild(s);if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXML||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToHTML||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToPDF||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLS||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLSX){var f=OAT.Dom.create("hr",{});self.exportPage.appendChild(f)}var l=document.createElement("div");l.setAttribute("class","down_container");self.exportPage.appendChild(l);var n=document.createElement("span");n.textContent=self.translations.GXPL_QViewerJSVisibleColumns;var o=document.createElement("div");o.setAttribute("class","div_label_win");o.appendChild(n);l.appendChild(o);var u=function(e,r){if(r&&self.initMetadata.Dimensions[e].validPosition==""){return false}if(!r&&self.initMetadata.Measures[e].validPosition=="hidden"){return false}var t;var a;if(r){t=self.initMetadata.Dimensions[e].dataField;a=self.initMetadata.Dimensions[e].displayName}else{t=self.initMetadata.Measures[e].dataField;a=self.initMetadata.Measures[e].displayName}var s=self.headerRow.indexOf(a)!=-1;var i=OAT.Dom.create("div");var f=s?"check_item_img":"uncheck_item_img";if(self.isSD){f=s?"check_item_img_small":"uncheck_item_img_small"}OAT.addImageNode(i,s?"check_box":"check_box_outline_blank","");i.setAttribute("class",f);i.setAttribute("dataField",a);i.setAttribute("isDimension",r);i.setAttribute("index",e);var l=OAT.Dom.create("span");if(r){OAT.addTextNode(l," "+self.initMetadata.Dimensions[e].displayName)}else{OAT.addTextNode(l," "+self.initMetadata.Measures[e].displayName)}var n=self.formulaInfo.itemPosition[t]==undefined||self.formulaInfo.cantFormulaMeasures==0;if(r){n=n&&self.initMetadata.Dimensions[e].validPosition!="hidden"}else{n=n&&self.initMetadata.Measures[e].validPosition!="hidden"}if(n){i.appendChild(l);OAT.Event.attach(i,"click",(function(){var e=i.getAttribute("isDimension")=="true";i.getAttribute("dataField");var r=parseInt(i.getAttribute("index"));var t="check_item_img";var a="uncheck_item_img";if(self.isSD){t="check_item_img_small";a="uncheck_item_img_small"}var s=this.getAttribute("class")===t?a:t;this.setAttribute("class",s);jQuery(this).find("i")[0].textContent=this.getAttribute("class")===t?"check_box":"check_box_outline_blank";if(e){self.initMetadata.Dimensions[r].Visible=!self.initMetadata.Dimensions[r].Visible;self.preGoWhenShowHideDimension(r)}else{self.initMetadata.Measures[r].Visible=!self.initMetadata.Measures[r].Visible;self.preGoWhenShowHideMeasures(r)}}))}return i};var v=self.autoNumber?1:0;for(var c=v;c<self.initMetadata.Dimensions.length;c++){var d=u(c,true);if(d)l.appendChild(d)}for(var c=v;c<self.initMetadata.Measures.length;c++){var d=u(c,false);if(d)l.appendChild(d)}setTimeout((function(){var e=window.innerWidth;var r=jQuery(".ExportPopup")[0].clientWidth;if(r==0){var a=jQuery(".ExportPopup").length;r=jQuery(".ExportPopup")[a-1].clientWidth}if(self.isSD){if(r<240){r=240}var s=(e-r)/2+jQuery(window).scrollLeft();jQuery(".ExportPopup").css({left:s+"px",top:jQuery(t).offset().top+"px",width:r+"px"})}else{var i=jQuery(t).offset().left;if(i+r+15<e){jQuery(".ExportPopup").css({left:jQuery(t).offset().left+"px",top:jQuery(t).offset().top+"px"})}else{jQuery(".ExportPopup").css({left:i-r+16+"px",top:jQuery(t).offset().top+"px"})}}}),50)};OAT.Event.attach(b,"click",S);self.filterDiv.appendChild(b);t.appendChild(a);self.filterDiv.appendChild(t)};this.appendExportToXmlOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXML){t=OAT.Dom.create("div");exportXMLButtonSub=self.createExportButton(t);var a=OAT.Dom.create("label");OAT.addTextNode(a,self.translations.GXPL_QViewerContextMenuExportXml);a.htmlFor="pivot_checkbox_restoreview";a.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(a);var s=document.createElement("span");t.appendChild(s);OAT.Dom.attach(exportXMLButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","XML","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.ExportToXMLWhenServerPagination=function(){self.lastRequestPivotDataCalculation="";self.lastRequestCalculation="ExportToXML";self.requestCalculatePivottableData()};this.ExportToHTMLWhenServerPagination=function(){var e=OAT.resourceURL(self.relativePath+"QueryViewer/oatPivot/css/pivot.css");var r="<!DOCTYPE><HTML><BODY>";r=r+"<HEAD>";r=r+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';r=r+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+e+'" />';for(var t=0;t<jQuery("link").length;t++){if(jQuery("link")[t].href.indexOf("QueryViewer.css")<0){r=r+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+jQuery("link")[t].href+'" />'}}r=r+'</HEAD><DIV style="margin-bottom: 5px;">';r=r+'<div class="gx_usercontrol qv-pivottable QueryViewer-pivottable">';r=r+'<table class="pivot_table" style="width: 100%;">';r=r+OAT.removeIconFont(jQuery("#"+self.controlName+"_"+self.query)[0].innerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,""));r=r+"</table>";r=r+"</div>";r=r+"</DIV></BODY></HTML>";if(OAT.isSafari()||self.isSD){window.open("data:text/html,"+r)}else{var a=new Blob([r],{type:"text/html"});if(self.query!=""){saveAs(a,self.query+".html")}else{var s="Query";try{s=self.controlName.substr(4).split("_")[0]}catch(e){}saveAs(a,s+".html")}}};this.appendExportToHtmlOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToHTML){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var a=OAT.Dom.create("label");OAT.addTextNode(a,self.translations.GXPL_QViewerContextMenuExportHtml);a.htmlFor="pivot_checkbox_restoreview";a.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(a);OAT.Dom.attach(exportButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","HTML","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.appendExportToPdfOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToPDF){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var a=OAT.Dom.create("label");OAT.addTextNode(a,self.translations.GXPL_QViewerContextMenuExportPdf);a.htmlFor="pivot_checkbox_restoreview";a.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(a);var s=self.query;if(s==""){s="Query";try{s=self.controlName.split("_")[0]}catch(e){}}OAT.Dom.attach(exportButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","PDF","","",true)}));e.appendChild(t)}};this.appendExportToExcelOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLS){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var a=OAT.Dom.create("label");OAT.addTextNode(a,self.translations.GXPL_QViewerContextMenuExportXls2003);a.htmlFor="pivot_checkbox_restoreview";a.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(a);var s=self.query;if(s==""){s="Query";try{s=self.controlName.split("_")[0]}catch(e){}}OAT.Dom.attach(exportButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","XLS","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.ExportToXLSXWhenServerPagination=function(){self.lastRequestCalculation="ExportToXLSX";self.requestCalculatePivottableData()};this.appendExportToExcel2010Option=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLSX&&(self.allData.length>0||self.serverPagination)){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var a=OAT.Dom.create("label");OAT.addTextNode(a,self.translations.GXPL_QViewerContextMenuExportXlsx);a.htmlFor="pivot_checkbox_restoreview";a.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(a);var s=self.query;if(s==""){s="Query";try{s=self.controlName.split("_")[0]}catch(e){}}OAT.Dom.attach(t,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","XLSX","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.createExportButton=function(e){var r=OAT.Dom.create("div",{});r.setAttribute("id","divtoxml");e.appendChild(r);if(self.isSD){r.setAttribute("class","download_file_img_small")}else{r.setAttribute("class","download_file_img")}OAT.addImageNode(r,"download","");e.setAttribute("class","export_item_div");if(self.isSD){e.setAttribute("class","export_item_div export_item_div_small")}return e};this._drawCorner=function(e,r){if(measures.length>0){OAT.addTextNode(e,self.headerRow[self.dataColumnIndex]);e.className="h2titlewhite";this.setTitleTexrtAlign(e,e.textContent)}};this._drawRowConditionsHeadingsCustom=function(e){for(var r=0;r<self.rowConditions.length;r++){var t=self.conditions[self.rowConditions[r]];if(self.isMeasureByName(self.headerRow[self.rowConditions[r]],t.dataField,t.isDimension)){if(!self.ShowMeasuresAsRows){var a=OAT.Dom.create("th",{},"h2titlewhite");var s=OAT.Dom.create("div");OAT.addTextNode(s,self.headerRow[self.rowConditions[r]]);this.setTitleTexrtAlign(s,self.headerRow[self.rowConditions[r]]);a.rowSpan=self.colConditions.length+2}}else{var a=OAT.Dom.create("th",{},"h2title");var i=OAT.Dom.create("div",{position:"relative"});var s=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(s,self.headerRow[self.rowConditions[r]].replace(/ /g," ")+"    ");if(self.GeneralDataRows.length>0||self.serverPagination){var f=self.getClickReference(t,self.rowConditions[r],s);var l=f[0];var n=f[1];OAT.Dom.attach(a,"click",l);var o=self.getOrderReference(self.rowConditions[r],n,l,s);self.gd.addSource(s,self.process,o);self.gd.addTarget(a)}a.conditionIndex=self.rowConditions[r];if(!self.ShowMeasuresAsRows){a.rowSpan=self.colConditions.length+2}else{a.rowSpan=self.colConditions.length+1}var u=OAT.Dom.create("div",{position:"absolute",right:"-6px",bottom:"0px"});OAT.addImageNode(u,"arrow_drop_down","");var v=OAT.Dom.create("div");v.className="div_settings";OAT.addImageNode(v,"settings","");try{this.updateSortImage(u,t.sort)}catch(e){}OAT.Dom.append([a,i],[i,s],[i,u],[s,v],[e,a])}}if(self.ShowMeasuresAsRows){var c=80;var a=OAT.Dom.create("th",{},"h2title");var i=OAT.Dom.create("div",{position:"relative",minWidth:c+"px"});var s=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(s,self.translations.GXPL_QViewerJSMeasures+"   ");OAT.Dom.append([a,i],[i,s],[e,a]);a.rowSpan=self.colConditions.length+1;OAT.Dom.append([a,s],[e,a])}};this.isMeasureByName=function(e,r,t){var a=false;for(var s=0;s<measures.length-1;s++){if(measures[s].attributes.getNamedItem("displayName").nodeValue==e){a=true}}if(r){var a=false;for(var i=0;i<self.pageData.DataInfo.length;i++){if(r==self.pageData.DataInfo[i].DataField)a=true}}return a};this.setTitleTexrtAlign=function(e,r){for(var t=0;t<measures.length;t++){if(measures[t].getAttribute("displayName")===r){if(measures[t].getAttribute("dataType")==="integer"||measures[t].getAttribute("dataType")==="real"){e.style.textAlign="left"}if(measures[t].getAttribute("date")==="integer"){e.style.textAlign="right"}}}};this.updateSortImage=function(e,r){var t="none";switch(r){case 0:t="asc";break;case 1:t="asc";break;case-1:t="desc";break;case 2:t="desc";break}if(OAT.isIE()||OAT.isAndroid()){e.className.replace("sort-none");e.className.replace("sort-asc");e.className.replace("sort-desc")}else{e.classList.remove("sort-none");e.classList.remove("sort-asc");e.classList.remove("sort-desc")}if(OAT.isIE()||OAT.isAndroid()){e.className+=" sort-"+t}else{e.classList.add("sort-"+t)}jQuery(e).find("i")[0].textContent=t=="asc"?"arrow_drop_up":"arrow_drop_down"};this._drawRowConditionsHeadings=function(e){var r=OAT.Dom.create("tr");for(var t=0;t<self.rowConditions.length;t++){var a=self.conditions[self.rowConditions[t]];if(self.isMeasureByName(self.headerRow[self.rowConditions[t]],a.dataField,a.isDimension)){if(!self.ShowMeasuresAsRows){var s=OAT.Dom.create("th",{},"h2titlewhite");var i=OAT.Dom.create("div");OAT.addTextNode(i,self.headerRow[self.rowConditions[t]]);self.setTitleTexrtAlign(i,self.headerRow[self.rowConditions[t]]);OAT.Dom.append([s,i],[r,s])}}else{var f=self.headerRow[self.rowConditions[t]].length>8?self.headerRow[self.rowConditions[t]].length*10:80;var s=OAT.Dom.create("th",{},"h2title");var l=OAT.Dom.create("div",{position:"relative",minWidth:f+"px"});var i=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(i,self.headerRow[self.rowConditions[t]]+"   ");var n=self.getClickReference(a,self.rowConditions[t],i);var o=n[0];var u=n[1];OAT.Dom.attach(s,"click",o);var v=self.getOrderReference(self.rowConditions[t],u,o,i);self.gd.addSource(i,self.process,v);self.gd.addTarget(s);s.conditionIndex=self.rowConditions[t];var c=OAT.Dom.create("div",{position:"absolute",right:"-6px",bottom:"0px"});OAT.addImageNode(c,"arrow_drop_down","");var d=OAT.Dom.create("div");d.className="div_settings";OAT.addImageNode(d,"settings","");if(a!=undefined){this.updateSortImage(c,a.sort)}else{this.updateSortImage(c,0)}OAT.Dom.append([s,l],[l,i],[l,c],[i,d],[r,s])}}if(self.ShowMeasuresAsRows){var f=80;var s=OAT.Dom.create("th",{},"h2title");var l=OAT.Dom.create("div",{position:"relative",minWidth:f+"px"});var i=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(i,self.translations.GXPL_QViewerJSMeasures+"   ");OAT.Dom.append([s,l],[l,i],[r,s]);var s=OAT.Dom.create("th",{},"h2titlewhite");var i=OAT.Dom.create("div");OAT.addTextNode(i,self.translations.GXPL_QViewerJSValue);s.style.textAlign="end";OAT.Dom.append([s,i],[r,s])}var s=OAT.Dom.create("th");if(!self.colConditions.length){self._drawCorner(s,true);s.conditionIndex=-1}else{s.style.border="none"}if(self.colStructure.span!=null){s.colSpan=self.colStructure.span+(self.options.headingBefore?1:0)+(self.options.totals?1:0)}else{s.colSpan=(self.options.headingBefore?1:0)+(self.options.totals?1:0)}if(measures.length>0&&!self.ShowMeasuresAsRows){r.appendChild(s)}if(self.colConditions.length){var s=OAT.Dom.create("th",{border:"none",width:"0px;"});r.appendChild(s)}self.appendRowToTable(e,r,true);if(measures.length>0&&r.cells[1]!=undefined&&r.cells[1].textContent==""){var m=document.getElementById(self.controlName+"_"+self.query+"_toolbar");if(m.rows[0])m.rows[0].appendChild(r.cells[0])}};this._drawColConditionsHeadingsCustom=function(e,r,t){var a=self.conditions[self.colConditions[r]];var s=OAT.Dom.create("th",{cursor:"pointer"},"h2title");var i=self.headerRow[self.colConditions[r]].length>8?(self.headerRow[self.colConditions[r]].length+3)*10:80;var f=OAT.Dom.create("div",{position:"relative",minWidth:i+"px"});if(t){s.style.borderRightColor="transparent"}var l=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(l,self.headerRow[self.colConditions[r]].replace(/ /g," ")+"   ");if(self.GeneralDataRows.length>0||self.serverPagination){var n=self.getClickReference(a,self.colConditions[r],l);var o=n[0];var u=n[1];OAT.Dom.attach(s,"click",o);var v=self.getOrderReference(self.colConditions[r],u,o,l);self.gd.addSource(l,self.process,v);self.gd.addTarget(s)}var c=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});OAT.addImageNode(c,"arrow_drop_down","");var d=OAT.Dom.create("div");d.className="div_settings";OAT.addImageNode(d,"settings","");try{this.updateSortImage(c,a.sort)}catch(e){}f.appendChild(l);l.appendChild(d);f.appendChild(c);s.conditionIndex=self.colConditions[r];s.appendChild(f);e.appendChild(s);return e};this._drawColConditionsHeadings=function(e,r){var t=self.conditions[self.colConditions[r]];var a=OAT.Dom.create("th",{cursor:"pointer"},"even gx-pv-even-row");var s=OAT.Dom.create("div");OAT.addTextNode(s,self.headerRow[self.colConditions[r]]);var i=self.getClickReference(t,self.colConditions[r],s);var f=i[0];var l=i[1];OAT.Dom.attach(a,"click",f);var n=self.getOrderReference(self.colConditions[r],l,f,s);self.gd.addSource(s,self.process,n);self.gd.addTarget(a);a.conditionIndex=self.colConditions[r];a.appendChild(s);a.hidden=true;if(a.textContent==self.headerRow[self.colConditions[r]]){var o=document.getElementById(self.controlName+"_"+self.query+"_toolbar");a.hidden=false;if(o.rows[0])o.rows[0].appendChild(a)}};this.getClassName=function(e,r){return"even gx-pv-even-row"};this.setStyleValues=function(e,r){function t(e){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(r,(function(e,r,t,a){return r+r+t+t+a+a}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var a=r.split(";");for(var s=0;s<a.length;s++){var i=a[s].split(":");var f=qv.util.trim(i[0]);var l=qv.util.trim(i[1]);switch(f){case"color":if(l[0]!=undefined&&l[0]==="#"){e.style.color="rgb("+t(l).r+","+t(l).g+","+t(l).b+")"}else{e.style.color=l}break;case"fontStyle":e.style.fontStyle=l;break;case"backgroundColor":e.style.backgroundColor=l;break;case"textDecoration":e.style.textDecoration=l;break;case"fontWeight":e.style.fontWeight=l;break;case"fontFamily":e.style.fontFamily=l;break;case"fontVariant":e.style.fontVariant=l;break;case"fontSize":e.style.fontSize=l.replace("px","")+"px";break;case"textAlign":e.style.textAlign=l;break;case"lineHeight":e.style.lineHeight=l;break;case"textIndent":e.style.textIndent=l;break;case"verticalAlign":e.style.verticalAlign=l;break;case"wordSpacing":e.style.wordSpacing=l;break;case"display":e.style.display=l;break;case"borderThickness":e.style.borderThickness=l;e.style.borderWidth=l+"px";break;case"borderColor":e.style.borderColor=l;break;case"borderWith":e.style.borderWith=l;break;case"borderStyle":e.style.borderStyle=l;break;case"padding":e.style.padding=l;break;case"paddingBottom":e.style.paddingBottom=l;break;case"paddingLeft":e.style.paddingLeft=l;break;case"paddingRight":e.style.paddingRight=l;break;case"paddingTop":e.style.paddingTop=l;break}}return e};this.underRecursionStyle=[];this.applyFormatValues=function(e,r,t){var a=self.columns[t].getAttribute("dataType");if(a=="date"){r=self.dimensionPictureValue(r,t)}var s=self.columns[t].getAttribute("format");if(s!=null&&s!=""){e=self.setStyleValues(e,s)}self.underRecursionStyle=[];for(var i=0;i<self.formatValues.length;i++){if(self.formatValues[i].columnNumber==t){if(self.formatValues[i].value===r.trimpivot()){e=self.setStyleValues(e,self.formatValues[i].format);if(self.formatValues[i].recursive!=undefined&&self.formatValues[i].recursive=="yes"){self.underRecursionStyle.push(self.formatValues[i])}}}}var f=self.columns[t].getAttribute("dataType");var l=[];var n=[];var o=[];var u=[];var v=[];var c=[];var u=[];var d=[];for(var i=0;i<self.conditionalFormatsColumns.length;i++){if(self.conditionalFormatsColumns[i].columnNumber==t){if(self.conditionalFormatsColumns[i].operation1=="equal"){if(f==="real"||f==="integer"){l[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{l[0]=self.conditionalFormatsColumns[i].value1}l[1]=self.conditionalFormatsColumns[i].format}if(self.conditionalFormatsColumns[i].operation1=="notequal"){if(f==="real"||f==="integer"){n[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{n[0]=self.conditionalFormatsColumns[i].value1}n[1]=self.conditionalFormatsColumns[i].format}if(self.conditionalFormatsColumns[i].operation1=="less"){if(f==="real"||f==="integer"){v[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{v[0]=self.conditionalFormatsColumns[i].value1}v[1]=self.conditionalFormatsColumns[i].format}if(self.conditionalFormatsColumns[i].operation1=="greater"){if(f==="real"||f==="integer"){o[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{o[0]=self.conditionalFormatsColumns[i].value1}o[1]=self.conditionalFormatsColumns[i].format}if(self.conditionalFormatsColumns[i].operation1=="greaterequal"&&self.conditionalFormatsColumns[i].operation2==undefined){if(f==="real"||f==="integer"){u[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{u[0]=self.conditionalFormatsColumns[i].value1}o[1]=self.conditionalFormatsColumns[i].format}if(self.conditionalFormatsColumns[i].operation1=="lessequal"){if(f==="real"||f==="integer"){c[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{c[0]=self.conditionalFormatsColumns[i].value1}v[1]=self.conditionalFormatsColumns[i].format}if(self.conditionalFormatsColumns[i].operation2&&self.conditionalFormatsColumns[i].operation1=="greaterequal"){if(f==="real"||f==="integer"){d[0]=parseFloat(self.conditionalFormatsColumns[i].value1)}else{d[0]=self.conditionalFormatsColumns[i].value1}if(self.conditionalFormatsColumns[i].operation2&&self.conditionalFormatsColumns[i].operation2=="lessequal"){if(f==="real"||f==="integer"){d[1]=parseFloat(self.conditionalFormatsColumns[i].value2)}else{d[1]=self.conditionalFormatsColumns[i].value2}d[2]=self.conditionalFormatsColumns[i].format}}}}new Array(3);e.style.textAlign="start";if(f==="real"){e.style.textAlign="start";r=parseFloat(r)}if(f==="integer"){e.style.textAlign="right";r=parseInt(r)}if(f==="real"){e.style.textAlign="end"}if(f!="date"){if(l[0]!=undefined&&r==l[0]){e=self.setStyleValues(e,l[1])}if(n[0]!=undefined&&r!=n[0]){e=self.setStyleValues(e,n[1])}if(o[0]!=undefined&&r>o[0]||u[0]!=undefined&&r>=u[0]){e=self.setStyleValues(e,o[1])}if(v[0]!=undefined&&r<v[0]||c[0]!=undefined&&r<=c[0]){e=self.setStyleValues(e,v[1])}if(d[0]!=undefined&&d[1]!=undefined&&(r>=d[0]&&r<=d[1])){e=self.setStyleValues(e,d[2])}return e}if(f==="date"){e.style.textAlign="right";var m=r.split("-");if(self.defaultPicture.getAttribute("dateFormat")!=undefined&&self.defaultPicture.getAttribute("dateFormat")!=null){picture=self.defaultPicture.getAttribute("dateFormat").split("")}var h=new Array(3);h[0]=parseInt(m[0]);h[1]=parseInt(m[1]);h[2]=parseInt(m[2]);if(o[0]!=undefined){var p=o[0].split("-");var T=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);if(T[0]<h[0]||T[0]<=h[0]&&T[1]<h[1]||T[0]<=h[0]&&T[1]<=h[1]&&T[2]<h[2]){e=self.setStyleValues(e,o[1])}}if(v[0]!=undefined){var p=v[0].split("-");T=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);if(T[0]>h[0]||T[0]>=h[0]&&T[1]>h[1]||T[0]>=h[0]&&T[1]>=h[1]&&T[2]>h[2]){e=self.setStyleValues(e,v[1])}}if(d[0]!=undefined&&d[1]!=undefined){var p=d[0].split("-");var A=d[1].split("-");T=new Array(3);cmparElements2=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);cmparElements2[1]=parseInt(A[1]);cmparElements2[2]=parseInt(A[2]);cmparElements2[0]=parseInt(A[0]);if((T[0]<=h[0]||T[0]<=h[0]&&T[1]<h[1]||T[0]<=h[0]&&T[1]<=h[1]&&T[2]<h[2])&&(cmparElements2[0]>h[0]||cmparElements2[0]>=h[0]&&cmparElements2[1]>h[1]||cmparElements2[0]>=h[0]&&cmparElements2[1]>=h[1]&&cmparElements2[2]>h[2])){e=self.setStyleValues(e,d[2])}}}if(r>o[0]){e=self.setStyleValues(e,o[1])}else{if(r<v[0]){e=self.setStyleValues(e,v[1])}else{if(r>=d[0]&&r<=d[1]){e=self.setStyleValues(e,d[2])}}}return e};this.applyConditionalFormats=function(e,r,t,a){if(measures.length>0){var s;var i;if(t){a=measures.length-1;i=measures[measures.length-1].getAttribute("dataType");s=measures[measures.length-1].getAttribute("format")}else{i=measures[a].getAttribute("dataType");s=measures[a].getAttribute("format")}if(s!=null&&s!=""){e=self.setStyleValues(e,s)}for(var f=0;f<self.formatValuesMeasures.length;f++){if(self.formatValuesMeasures[f].columnNumber==a){if(self.formatValuesMeasures[f].value===r){e=self.setStyleValues(e,self.formatValuesMeasures[f].format)}}}if(self.underRecursionStyle){for(var f=0;f<self.underRecursionStyle.length;f++){e=self.setStyleValues(e,self.underRecursionStyle[f].format)}}var l=[];var n=[];var o=[];var u=[];var v=[];var c=[];var u=[];var d=[];for(var f=0;f<self.conditionalFormats.length;f++){if(self.conditionalFormats[f].columnNumber==a){if(self.conditionalFormats[f].operation1=="equal"){if(i==="real"||i==="integer"){l[0]=parseFloat(self.conditionalFormats[f].value1)}else{l[0]=self.conditionalFormats[f].value1}l[1]=self.conditionalFormats[f].format}if(self.conditionalFormats[f].operation1=="notequal"){if(i==="real"||i==="integer"){n[0]=parseFloat(self.conditionalFormats[f].value1)}else{n[0]=self.conditionalFormats[f].value1}n[1]=self.conditionalFormats[f].format}if(self.conditionalFormats[f].operation1=="less"){if(i==="real"||i==="integer"){v[0]=parseFloat(self.conditionalFormats[f].value1)}else{v[0]=self.conditionalFormats[f].value1}v[1]=self.conditionalFormats[f].format}if(self.conditionalFormats[f].operation1=="lessequal"&&!self.conditionalFormats[f].operation2){if(i==="real"||i==="integer"){c[0]=parseFloat(self.conditionalFormats[f].value1)}else{c[0]=self.conditionalFormats[f].value1}v[1]=self.conditionalFormats[f].format}if(self.conditionalFormats[f].operation1=="greater"){if(i==="real"||i==="integer"){o[0]=parseFloat(self.conditionalFormats[f].value1)}else{o[0]=self.conditionalFormats[f].value1}o[1]=self.conditionalFormats[f].format}if(self.conditionalFormats[f].operation1=="greaterequal"&&!self.conditionalFormats[f].operation2){if(i==="real"||i==="integer"){u[0]=parseFloat(self.conditionalFormats[f].value1)}else{u[0]=self.conditionalFormats[f].value1}o[1]=self.conditionalFormats[f].format}if(self.conditionalFormats[f].operation2&&self.conditionalFormats[f].operation1=="greaterequal"){if(i==="real"||i==="integer"){d[0]=parseFloat(self.conditionalFormats[f].value1)}else{d[0]=self.conditionalFormats[f].value1}if(self.conditionalFormats[f].operation2&&self.conditionalFormats[f].operation2=="lessequal"){if(i==="real"||i==="integer"){d[1]=parseFloat(self.conditionalFormats[f].value2)}else{d[1]=self.conditionalFormats[f].value2}d[2]=self.conditionalFormats[f].format}}}}if(i!="date"){if(l[0]!=undefined&&r==l[0]){e=self.setStyleValues(e,l[1])}if(n[0]!=undefined&&r!=n[0]){e=self.setStyleValues(e,n[1])}if(o[0]!=undefined&&r>o[0]||u[0]!=undefined&&r>=u[0]){e=self.setStyleValues(e,o[1])}if(v[0]!=undefined&&r<v[0]||c[0]!=undefined&&r<=c[0]){e=self.setStyleValues(e,v[1])}if(d[0]!=undefined&&d[1]!=undefined&&(r>=d[0]&&r<=d[1])){e=self.setStyleValues(e,d[2])}}if(i==="date"){var m=r.split("-");if(self.defaultPicture.getAttribute("dateFormat")!=undefined&&self.defaultPicture.getAttribute("dateFormat")!=null){picture=self.defaultPicture.getAttribute("dateFormat").split("")}var h=new Array(3);h[0]=parseInt(m[0]);h[1]=parseInt(m[1]);h[2]=parseInt(m[2]);try{if(l[0]!=undefined||u[0]!=undefined||c[0]!=undefined){var p;if(l[0]!=undefined){p=l[0].split("-")}else if(u[0]!=undefined){p=u[0].split("-")}else if(u[0]!=undefined){p=c[0].split("-")}var T=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);if(T[0]==h[0]||T[0]==h[0]&&T[1]==h[1]){if(l[1]!=undefined)e=self.setStyleValues(e,l[1]);else if(o[1]!=undefined)e=self.setStyleValues(e,o[1]);else if(v[1]!=undefined)e=self.setStyleValues(e,v[1])}}if(n[0]!=undefined){var p=n[0].split("-");var T=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);if(T[0]!=h[0]||T[0]!=h[0]&&T[1]!=h[1]){e=self.setStyleValues(e,n[1])}}if(o[0]!=undefined||u[0]!=undefined){var p;if(o[0].split("-")!=undefined){p=o[0].split("-")}else{p=u[0].split("-")}var T=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);if(T[0]<h[0]||T[0]<=h[0]&&T[1]<h[1]||T[0]<=h[0]&&T[1]<=h[1]&&T[2]<h[2]){e=self.setStyleValues(e,o[1])}}if(v[0]!=undefined||c[0]!=undefined){var p;if(v[0].split("-")!=undefined){p=v[0].split("-")}else{p=c[0].split("-")}T=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);if(T[0]>h[0]||T[0]>=h[0]&&T[1]>h[1]||T[0]>=h[0]&&T[1]>=h[1]&&T[2]>h[2]){e=self.setStyleValues(e,v[1])}}if(d[0]!=undefined&&d[1]!=undefined){var p=d[0].split("-");var A=d[1].split("-");T=new Array(3);cmparElements2=new Array(3);T[1]=parseInt(p[1]);T[2]=parseInt(p[2]);T[0]=parseInt(p[0]);cmparElements2[1]=parseInt(A[1]);cmparElements2[2]=parseInt(A[2]);cmparElements2[0]=parseInt(A[0]);if((T[0]<=h[0]||T[0]<=h[0]&&T[1]<h[1]||T[0]<=h[0]&&T[1]<=h[1]&&T[2]<h[2])&&(cmparElements2[0]>h[0]||cmparElements2[0]>=h[0]&&cmparElements2[1]>h[1]||cmparElements2[0]>=h[0]&&cmparElements2[1]>=h[1]&&cmparElements2[2]>h[2])){e=self.setStyleValues(e,d[2])}}}catch(e){}}}return e};this.dimensionPictureValue=function(e,r){if(e=="#NuN#"){var t=self.defaultPicture.getAttribute("textForNullValues");if(t!=undefined){return t}return""}var a;var s;a=self.columns[r].getAttribute("dataType");s=self.columns[r].getAttribute("picture");var i=OAT.ApplyPictureValue(e,a,self.defaultPicture,s);return i};this.getMeasureNumber=function(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("dataField")==e){return t}}};this.getMeasureName=function(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("dataField")==e){return r[t].getAttribute("displayName")}}};this.defaultPictureValue=function(e,r,t){if(e=="#NuN#"){var a=self.defaultPicture.getAttribute("textForNullValues");if(a!=undefined){return a}return""}if(e=="#NaV#"||isNaN(e)){return"-"}var s;var i;if(measures.length>0){if(r){s=measures[measures.length-1].getAttribute("dataType");i=measures[measures.length-1].getAttribute("picture")}else{s=measures[t].getAttribute("dataType");i=measures[t].getAttribute("picture")}var f=OAT.ApplyPictureValue(e,s,self.defaultPicture,i);return f}else{return e}};this.countedRows=0;this.appendRowToTable=function(e,r,t){if(pageSize&&!self.serverPagination){if(!t){self.countedRows++}if(self.countedRows>pageSize){r.style.display="none"}}if(self.serverPagination&&self.ExportTo){if(!t){self.countedRows++}if(self.countedRows>self.rowsPerPage){r.style.display="none"}}if(t){r.setAttribute("title_row",true)}e.appendChild(r)};this.drawTableWhenServerPagination=function(){OAT.Dom.clear(self.div);self.div.setAttribute("class","conteiner_table_div");var e=OAT.Dom.create("table",{},"");e.id=self.controlName+"_"+self.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");self.div.appendChild(e);var r=OAT.Dom.create("table",{},"pivot_table");r.id=this.controlName+"_"+this.query;var t=OAT.Dom.create("tbody");self.drawTitleDiv();self.drawFilters();self.countedRows=0;if(OAT.isIE()){var a=document.createElement("div");a.setAttribute("class","divIeContainer");self.div.appendChild(a);OAT.Dom.append([r,t],[a,r]);r.style.marginBottom="0px"}else{OAT.Dom.append([r,t],[self.div,r])}self.countedRows=0;var s;if(self.colConditions.length>0){var i=0;var f=OAT.Dom.create("tr");self._drawRowConditionsHeadingsCustom(f);for(var l=0;l<self.colConditions.length;l++){f=self._drawColConditionsHeadingsCustom(f,l,l===self.colConditions.length-1)}self.appendRowToTable(t,f,true);s=f}try{for(var i=0;i<self.colConditions.length;i++){var f=OAT.Dom.create("tr");var n=0;while(n<self.pageData.columnsHeaders.length){var o;if(!self.pageData.columnsHeaders[n].subTotal){o=n;var u=1;var v=self.pageData.columnsHeaders[n].subHeaders.length>i?self.pageData.columnsHeaders[n].subHeaders[i].value:"";while(n+1<self.pageData.columnsHeaders.length&&(!self.pageData.columnsHeaders[n+1].subTotal||i<self.pageData.columnsHeaders[n+1].subHeaders.length-1)&&(self.pageData.columnsHeaders[n+1].subHeaders.length>i&&self.pageData.columnsHeaders[n+1].subHeaders[i].value==v)){u++;n++}n++;var c=OAT.Dom.create("th",{},"even gx-pv-even-row");c.colSpan=u;OAT.addTextNode(c,self.dimensionPictureValue(v.trimpivot(),self.colConditions[i]));self.setClickEventHandlers(c,v,"DIMENSION",self.colConditions[i],{axis:"columns",columnnumber:o,columndimension:self.pageData.columnsHeaders[o],rownumber:i});c=self.applyFormatValues(c,v.trimpivot(),self.colConditions[i]);f.appendChild(c)}else{var d=self.GrandTotalVisibility.TotalForColumns=="No"?measures.length:0;var m=n>=self.pageData.columnsHeaders.length-measures.length+d;if(self.ShowMeasuresAsRows){m=n>=self.pageData.columnsHeaders.length-1&&self.GrandTotalVisibility.TotalForColumns=="Yes"}if(m){if(self.GrandTotalVisibility.TotalForColumns=="Yes"){if(i==0){var c=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(c,self.translations.GXPL_QViewerJSTotal);c.rowSpan=self.colConditions.length;if(!self.ShowMeasuresAsRows){c.colSpan=measures.length}f.appendChild(c)}}if(!self.ShowMeasuresAsRows){n=n+measures.length}else{n++}}else{if(i<self.pageData.columnsHeaders[n].subHeaders.length){var c=OAT.Dom.create("th",{},"h2subtitle ");var v=self.pageData.columnsHeaders[n].subHeaders.length>i?self.pageData.columnsHeaders[n].subHeaders[i].value:"";OAT.addTextNode(c,self.translations.GXPL_QViewerJSTotalFor+" "+self.dimensionPictureValue(v.trimpivot(),self.colConditions[i]));self.setClickEventHandlers(c,self.translations.GXPL_QViewerJSTotalFor+" "+self.dimensionPictureValue(v.trimpivot(),self.colConditions[i]),"DIMENSION",self.colConditions[i],["PtrTotals",v,"",o,"columns",i]);c.rowSpan=self.colConditions.length-i;if(!self.ShowMeasuresAsRows){c.colSpan=measures.length}f.appendChild(c)}if(!self.ShowMeasuresAsRows){n=n+measures.length}else{n++}}}}self.appendRowToTable(t,f,true)}if(self.colConditions.length>0){if(self.pageData.columnsHeaders.length-self.colConditions.length>0){var c=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(c,"");c.colSpan=self.pageData.columnsHeaders.length-self.colConditions.length;c.style.borderLeftColor="transparent";s.appendChild(c)}if(!self.ShowMeasuresAsRows){var f=OAT.Dom.create("tr");var h=self.pageData.columnsHeaders.length/measures.length;for(var n=0;n<h;n++){for(var p=0;p<measures.length;p++){var c=OAT.Dom.create("th",{},"h2titlewhite");c.colSpan=1;OAT.addTextNode(c,measures[p].attributes.getNamedItem("displayName").nodeValue);self.setTitleTexrtAlign(c,c.textContent);f.appendChild(c)}}self.appendRowToTable(t,f,true)}}if(self.rowConditions.length&&self.options.headingBefore&&self.colConditions.length===0){self._drawRowConditionsHeadings(t)}else if(self.rowConditions.length==0&&self.options.headingBefore&&self.colConditions.length===0){try{self._drawRowConditionsHeadings(t)}catch(e){}}var T=measures.length>1;var u;if(T){u=self.rowConditions.length-(measures.length-1)}else{u=self.rowConditions.length}if(self.colConditions.length>0)self.underRecursionStyle=[];var A=false;for(var i=0;i<self.pageData.rows.length;i++){var f=OAT.Dom.create("tr");var w=self.pageData.rows[i];for(var n=0;n<w.headers.length;n++){var O=w.headers[n];if(O.rowSpan>0){var c=OAT.Dom.create("th",{},"even gx-pv-even-row");c.rowSpan=O.rowSpan;OAT.addTextNode(c,self.dimensionPictureValue(O.value.trimpivot(),self.rowConditions[n]));c=self.applyFormatValues(c,O.value,self.rowConditions[n]);self.setClickEventHandlers(c,O.value,"DIMENSION",self.rowConditions[n],{cell:n,row:w});if(n<self.rowConditions.length-(measures.length-1)-1&&!self.ShowMeasuresAsRows){var y=self.conditions[self.rowConditions[n]].collapsedValues.indexOf(O.value)!=-1;c=self.addExpandCollapseFunctionality(c,O,n,!y,true)}f.appendChild(c)}}if(w.headers.length<self.rowConditions.length-(measures.length-1)){var _=self.rowConditions.length-(measures.length-1)-w.headers.length;for(var g=0;g<_;g++){var c=OAT.Dom.create("th",{},"even gx-pv-even-row");OAT.addTextNode(c,"");f.appendChild(c)}}if(self.ShowMeasuresAsRows){var b=OAT.Dom.create("td",{},"even gx-pv-even-row");var x=self.getMeasureName(w.dataField,measures);OAT.addTextNode(b,x);b.style.textAlign="start";self.setClickEventHandlers(b,x,"MEASURE",getMeasureNumberByName(x,measures),"GrandTotal");f.appendChild(b)}new Array;if(!w.subTotal){for(var F=0;F<w.cells.length;F++){var S=w.cells[F].value;if(self.colConditions.length>0&&self.pageData.columnsHeaders[F].subTotal){var b=OAT.Dom.create("td",{},"subtotal");if(S!=self.EmptyValue){var k=self.getMeasureNumber(w.cells[F].dataField,measures);OAT.addTextNode(b,self.defaultPictureValue(S,false,k));b=self.applyConditionalFormats(b,S,false,k);self.setClickEventHandlers(b,S,"MEASURE",k,["PtrTotals",S,w,F])}else{OAT.addTextNode(b,"")}f.appendChild(b)}else{var b=OAT.Dom.create("td",{},"even gx-pv-even-row");if(S!=self.EmptyValue){var k=self.getMeasureNumber(w.cells[F].dataField,measures);OAT.addTextNode(b,self.defaultPictureValue(S,false,k));b=self.applyConditionalFormats(b,S,false,k);self.setClickEventHandlers(b,S,"MEASURE",k,{cell:F,row:w})}else{OAT.addTextNode(b,"")}f.appendChild(b)}}}else{var f=OAT.Dom.create("tr");if(w.headers.length==0){if(self.GrandTotalVisibility.TotalForRows!="Yes"){A=true}else{var c=OAT.Dom.create("th",{},"h2subtitle grandtotaltitle");OAT.addTextNode(c,self.translations.GXPL_QViewerJSTotal);c.colSpan=u;if(self.ShowMeasuresAsRows){if(w.rowSpan>0){c.rowSpan=w.rowSpan;f.appendChild(c)}}else{f.appendChild(c)}}}else{if(i==0){for(var o=0;o<w.headers.length-1;o++){var O=w.headers[o];var c=OAT.Dom.create("th",{},"even gx-pv-even-row");c.rowSpan=O.rowSpan;OAT.addTextNode(c,self.dimensionPictureValue(O.value.trimpivot(),self.rowConditions[o]));c=self.applyFormatValues(c,O.value,self.rowConditions[o]);self.setClickEventHandlers(c,O.value,"DIMENSION",self.rowConditions[o],{cell:o,row:w,isTotal:false});f.appendChild(c)}}var N=w.headers.length==1?"subtitleFirstLevel":"";var c=OAT.Dom.create("th",{},"h2subtitle "+N);c.colSpan=u-(w.headers.length-1);var S=w.headers[w.headers.length-1].value.trimpivot();if(S=="#NuN#"){OAT.addTextNode(c,self.translations.GXPL_QViewerJSTotalFor+" "+self.defaultPicture.getAttribute("textForNullValues"))}else{OAT.addTextNode(c,self.translations.GXPL_QViewerJSTotalFor+" "+self.dimensionPictureValue(OAT.Dom.fromSafeXML(S),self.rowConditions[w.headers.length-1]))}self.setClickEventHandlers(c,self.translations.GXPL_QViewerJSTotalFor+" "+O.value,"DIMENSION",getMeasureNumberByDataField(O.dataField,columns),["PtrTotals",S,w,-1]);if(self.ShowMeasuresAsRows){if(w.rowSpan>0){c.rowSpan=w.rowSpan;f.appendChild(c)}}else{f.appendChild(c)}}if(self.ShowMeasuresAsRows){var I=w.headers.length==0?"grandtotalvalue":w.headers.length==1?"firstlevelvalue":"";var b=OAT.Dom.create("td",{},"gtotal "+I);var x=self.getMeasureName(w.dataField,measures);OAT.addTextNode(b,x);b.style.textAlign="start";f.appendChild(b)}for(var D=0;D<w.cells.length;D++){var S=w.cells[D].value;var k=self.getMeasureNumber(w.cells[D].dataField,measures);var I=w.headers.length==0?"grandtotalvalue":w.headers.length==1?"firstlevelvalue":"";var b=OAT.Dom.create("td",{},"gtotal "+I);OAT.addTextNode(b,self.defaultPictureValue(S,false,k));if(w.headers.length==0&&self.colConditions.length==0){self.underRecursionStyle=[];b=self.applyConditionalFormats(b,S,false,k);self.setClickEventHandlers(b,S,"MEASURE",k,"GrandTotal")}else{b=self.applyConditionalFormats(b,S,false,k);self.setClickEventHandlers(b,S,"MEASURE",k,["PtrTotals",S,w,D])}f.appendChild(b)}}if(!A)self.appendRowToTable(t,f,false);if(self.colConditions.length>0)self.underRecursionStyle=[]}}catch(e){}};this.drawTableWhenShowMeasuresAsRows=function(){OAT.Dom.clear(self.div);self.div.setAttribute("class","conteiner_table_div");var e=OAT.Dom.create("table",{},"");e.id=self.controlName+"_"+self.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");self.div.appendChild(e);var r=OAT.Dom.create("table",{},"pivot_table");r.id=this.controlName+"_"+this.query;var t=OAT.Dom.create("tbody");self.drawTitleDiv();self.drawFilters();self.countedRows=0;if(OAT.isIE()){var a=document.createElement("div");a.setAttribute("class","divIeContainer");self.div.appendChild(a);OAT.Dom.append([r,t],[a,r]);r.style.marginBottom="0px"}else{OAT.Dom.append([r,t],[self.div,r])}if(self.autoPaging&&self.allData.length<self.filteredData.length&&self.colPointers.length>1){self.allData=self.filteredData}else if(self.autoPaging&&self.filteredData.length>self.allData.length&&self.colPointers.length===0){self.filteredData=self.allData}var s;var i=self.colConditions.length;if(self.colConditions.length>0){var f=0;var l=OAT.Dom.create("tr");self._drawRowConditionsHeadingsCustom(l);for(var n=0;n<self.colConditions.length;n++){l=self._drawColConditionsHeadingsCustom(l,n,n===self.colConditions.length-1)}l.setAttribute("title_row",true);self.appendRowToTable(t,l,true);s=l}try{var o=0-i;var u=[false,0,0];var v=[];var c=[];var d=[];for(var f=0;f<measures.length;f++){d[f]=false}for(var f=0;f<self.colConditions.length;f++){var l=OAT.Dom.create("tr");var m=self.colPointers[f];for(var h=0;h<m.length;h++){var p=m[h];var T=OAT.Dom.create("th",{},"even gx-pv-even-row");if(p.span===0)p.span=1;T.colSpan=p.span;if(f==0){if(p.span===0){o++}else{o=o+p.span*measures.length}}OAT.addTextNode(T,self.dimensionPictureValue(p.value,self.colConditions[f]));T=self.applyFormatValues(T,p.value,self.colConditions[f]);var A=p;var w=false;var O=false;while(A.parent){if(A.parent.collapsed==undefined){u[0]=false;break}if(A.parent.collapsed){if(!u[0]||A.parent!=u[1]){O=true;if(f==self.colConditions.length-1){c.push(h)}}else{u[2]++}if(f==self.colConditions.length-1&&!O){v.push(h)}u[0]=true;u[1]=A.parent;OAT.addTextNode(T,"");w=true;T.colSpan=1;break}else{A=A.parent}}if(!w||O){l.appendChild(T)}}if(self.options.totals&&f==0&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var T=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(T,self.translations.GXPL_QViewerJSTotal);T.rowSpan=self.colConditions.length;if(self.colConditions.length>0){T.colSpan=measures.length;o=o+self.colConditions.length+(measures.length-1)}else{o=o+self.colConditions.length}totalSpan=self.colConditions.length;l.appendChild(T)}if(self.options.headingAfter){self._drawColConditionsHeadings(l,f)}l.setAttribute("title_row",true);self.appendRowToTable(t,l,true)}if(o>2){var T=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(T,"");if(o<1e3){T.colSpan=o}T.style.borderLeftColor="transparent";s.appendChild(T)}if(self.rowConditions.length&&self.options.headingBefore&&self.colConditions.length===0){self._drawRowConditionsHeadings(t)}var y=measures.length>1;var _;if(y){_=self.rowConditions.length-(measures.length-1)}else{_=self.rowConditions.length}var g=[false,9999,true,0];var b=[];for(var x=0;x<measures.length;x++){b[x]=[];b[x][0]=[]}var F=[];for(var x=0;x<measures.length;x++){F[x]=[];F[x][0]=[]}var S=[];for(var x=0;x<self.recordForFormula.length;x++){S[x]=self.recordForFormula[x]}var k=[];if(self.colConditions.length>0){k=[];for(var x=0;x<self.allData.length;x++){k[x]=self.allData[x]}}var N=[];for(var f=0;f<self.h;f++){var l=OAT.Dom.create("tr");if(self.rowConditions.length){var I=self.rowConditions.length-(measures.length-1);var p=self.rowPointers[I][f];var D=[];var E=p;while(E.parent){D.unshift(E);E=E.parent}}else{var D=[self.rowPointers[0][0]]}for(var h=0;h<self.rowConditions.length-(measures.length-1);h++){var p=D[h];if(p!=undefined&&p.offset==f){var C=self.conditions[self.rowConditions[h]].collapsedValues.indexOf(p.value)!=-1;if(h>=self.rowConditions.length-(measures.length-1)-1){C=false}var T=OAT.Dom.create("th",{},"even gx-pv-even-row");if(!g[0]||g[1]>=h){T.rowSpan=D[h].span;OAT.addTextNode(T,self.dimensionPictureValue(p.value,self.rowConditions[h]));T=self.applyFormatValues(T,p.value,self.rowConditions[h]);self.setClickEventHandlers(T,p.value,"DIMENSION",self.rowConditions[h],p)}else{T.rowSpan=1;OAT.addTextNode(T,"")}if(g[1]>=h){g[0]=C;g[3]=p;if(C){g[1]=h}else{g[1]=9999}g[2]=true}l.appendChild(T)}}var P=measures.length;if(P===0){P=1}var j=OAT.Dom.create("td",{},"even gx-pv-even-row");var p=D[self.rowConditions.length-(P-1)];if(p.value!=self.EmptyValue){if(!g[0]){OAT.addTextNode(j,p.value);j.style.textAlign="start";self.setClickEventHandlers(j,p.value,"MEASURE",getMeasureNumberByName(q,measures),"GrandTotal")}}else{OAT.addTextNode(j,"")}l.appendChild(j);var Q=new Array;var R=[];var q=p.value;var M=getMeasureNumberByName(q,measures);if(self.colConditions.length==0){var L=p.items[0];var j=OAT.Dom.create("td",{},"even gx-pv-even-row");if(L!=self.EmptyValue){if(!g[0]){OAT.addTextNode(j,self.defaultPictureValue(L.value,false,M));j=self.applyConditionalFormats(j,L.value,false,M);self.setClickEventHandlers(j,L.value,"MEASURE",M,[Math.floor(p.row/measures.length)]);if(self.formulaInfo.measureFormula[M].hasFormula){var V=self.getFormulaRowByCoord(p,[],M,"MeasureInRows",S);if(V!=self.EmptyValue){F[M][0].push(V);b[M][0].push([V,-1])}}else{var B=L.value!="#NuN#"?parseFloat(L.value):"#NuN#";F[M][0].push(B);b[M][0].push([B,-1])}}}else{OAT.addTextNode(j,"")}if(g[0]&&!d[ji]){d[ji]=j}Q.push([[L.value,[L.row]]]);if(self.colConditions.length===0){l.appendChild(j)}}else{var J=self.colPointers.length-1;if(self.colPointers[self.colPointers.length-1].length==0)J--;if(self.colPointers[J]!=undefined){if(M==0){if(N.length>0&&!isNaN(N[0])){k.splice(N[0],1)}N=[]}for(var h=0;h<self.colPointers[J].length;h++){var U=self.colPointers[J][h];var z=p;var H;if(M>0){try{if(N[h]!=self.EmptyValue){H=[k[N[h]][self.headerRow.indexOf(q)],N[h]]}else{H=self.EmptyValue}}catch(e){}}else{H=self.getMeasureValueCoord(z,U,self.headerRow.indexOf(q),k);if(H!=self.EmptyValue&&M==0){N.push(H[1])}else if(M==0){N.push(self.EmptyValue)}}var j=OAT.Dom.create("td",{},"even gx-pv-even-row");if(H!=self.EmptyValue){OAT.addTextNode(j,self.defaultPictureValue(H[0],false,M));j=self.applyConditionalFormats(j,H[0],false,M);self.setClickEventHandlers(j,H[0],"MEASURE",M,[H[1]]);var Z=parseFloat(H[0]);if(H[0]=="#NuN#"){Z="#NuN#"}if(self.formulaInfo.measureFormula[M].hasFormula){Z=self.getFormulaRowByCoord(z,U,M,"MeasureInRows",S);if(Z==self.EmptyValue){Z=NaN}}if(F[M][h]==undefined){F[M][h]=[Z]}else{F[M][h].push(Z)}if(b[M][h]==undefined){b[M][h]=[[Z,-1]]}else{b[M][h].push([Z,-1])}R.push(Z)}else{OAT.addTextNode(j,"");if(F[M][h]==undefined){F[M][h]=[0]}else{F[M][h].push(0)}if(b[M][h]==undefined){b[M][h]=[[NaN,-1]]}else{b[M][h].push([NaN,-1])}}l.appendChild(j)}}}if(self.colConditions.length&&f==0&&self.options.headingAfter){var T=OAT.Dom.create("th");if(!self.rowConditions.length){self._drawCorner(T,true);T.conditionIndex=-2}else{T.style.border="none"}T.rowSpan=self.rowStructure.span+(self.options.totals&&self.rowConditions.length?1:0);l.appendChild(T)}if(g[0]&&!g[2]);else{self.appendRowToTable(t,l,false);g[2]=false}if(self.options.totals&&self.colConditions.length&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var j=OAT.Dom.create("td",{},"total");se=0;if(R.length>0){if(self.formulaInfo.measureFormula[getMeasureNumberByName(q,measures)].hasFormula){se=self.calculateFormulaTotal(R,getMeasureNumberByName(q,measures),"MeasureInRows")}else{se=R.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}));if(isNaN(se)&&se!="#NuN#"&&se!="#FoE#")se=0}}if(se!=0){OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,getMeasureNumberByName(q,measures)));j=self.applyConditionalFormats(j,se.toString(),false,getMeasureNumberByName(q,measures))}else{OAT.addTextNode(j,"")}l.appendChild(j)}R=[];if(self.options.totals){if(self.rowConditions.length-(measures.length-1)>1){var G=self.rowConditions.length-(measures.length-1)-2;for(var X=G;X>=0;X--){var Y=false;if(f+1<self.rowPointers[I].length){var $=self.rowPointers[I][f+1];var W=[];var K=$;while(K.parent){W.unshift(K);K=K.parent}for(var ee=X;ee>=0;ee--){if(W[ee].value!=D[ee].value){Y=true}}}else{Y=true}Y=Y&&self.conditions[self.rowConditions[X]].subtotals==1;if(Y){for(var re=0;re<measures.length;re++){var l=OAT.Dom.create("tr");if(re==0){var T=OAT.Dom.create("th",{},"h2subtitle");T.colSpan=self.rowConditions.length-(measures.length-1)-X;T.rowSpan=measures.length;OAT.addTextNode(T,self.translations.GXPL_QViewerJSTotalFor+" "+D[X].value);l.appendChild(T)}var j=OAT.Dom.create("td",{},"total");var H=measures[re].getAttribute("displayName");OAT.addTextNode(j,H);j.style.textAlign="start";self.setClickEventHandlers(j,H,"MEASURE",re,"GrandTotal");l.appendChild(j);if(self.colConditions.length==0){var j=OAT.Dom.create("td",{},"total");var te=[];for(var ae=0;ae<b[re][0].length;ae++){if(b[re][0][ae][1]==-1||b[re][0][ae][1]>X){if(!isNaN(b[re][0][ae][0])||b[re][0][ae][0]=="#NuN#"||self.formulaInfo.measureFormula[re].hasFormula){te.push(b[re][0][ae][0]);b[re][0][ae][1]=X}}}var se=0;if(te.length!=0){if(self.formulaInfo.measureFormula[re].hasFormula){se=self.calculateFormulaTotal(te,re,"MeasureInRows")}else{if(self.IsReduceNuN(te))se="#NuN#";else se=te.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}));if(isNaN(se)&&se!="#NuN#"&&se!="#FoE#")se=0}}R.push(parseFloat(se));if(se!=0){OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,re));j=self.applyConditionalFormats(j,se.toString(),false,re)}else{OAT.addTextNode(j,"")}l.appendChild(j)}else{var J=self.colPointers.length-1;if(self.colPointers[self.colPointers.length-1].length==0)J--;if(self.colPointers[J]!=undefined){for(var ie=0;ie<self.colPointers[J].length;ie++){var j=OAT.Dom.create("td",{},"total");var te=[];for(var ae=0;ae<b[re][ie].length;ae++){if(b[re][ie][ae][1]==-1||b[re][ie][ae][1]>X){if(!isNaN(b[re][ie][ae][0])||b[re][ie][ae][0]=="#NuN#"||self.formulaInfo.measureFormula[re].hasFormula){te.push(b[re][ie][ae][0]);b[re][ie][ae][1]=X}}}var se=0;if(te.length!=0){if(self.formulaInfo.measureFormula[re].hasFormula){se=self.calculateFormulaTotal(te,re,"MeasureInRows")}else{if(self.IsReduceNuN(te))se="#NuN#";else se=te.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}));if(isNaN(se)&&se!="#NuN#"&&se!="#FoE#")se=0}}if(se!=0&&(!isNaN(se)||se=="#NuN#"||se=="#FoE#")){if(self.formulaInfo.measureFormula[re].hasFormula){R.push(te)}else{R.push(parseFloat(se))}OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,re));j=self.applyConditionalFormats(j,se.toString(),false,re)}else{OAT.addTextNode(j,"")}l.appendChild(j)}}if(self.colConditions.length&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var j=OAT.Dom.create("td",{},"gtotal");var se=0;if(R.length!=0){if(self.formulaInfo.measureFormula[re].hasFormula){se=self.calculateFormulaTotal(R,re,"MeasureInRows")}else{if(self.IsReduceNuN(R))se="#NuN#";else se=R.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,re));j=self.applyConditionalFormats(j,se.toString(),false,re);l.appendChild(j);R=[]}}self.appendRowToTable(t,l,false)}}}}}}if(measures.length>0&&self.rowConditions.length-measures.length+1>0&&self.GrandTotalVisibility.TotalForRows=="Yes"){if(self.options.totals&&self.rowConditions.length&&(!self.autoPaging||self.TotalPagesPaging==self.actualPaginationPage||self.FilterByTopFilter)){for(var fe=0;fe<measures.length;fe++){var l=OAT.Dom.create("tr");if(_!=0&&fe==0){var T=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(T,self.translations.GXPL_QViewerJSTotal);T.colSpan=_;T.rowSpan=measures.length;l.appendChild(T)}var j=OAT.Dom.create("td",{},"gtotal");var H=measures[fe].getAttribute("displayName");if(H!=self.EmptyValue){OAT.addTextNode(j,H);j.style.textAlign="start";self.setClickEventHandlers(j,H,"MEASURE",fe,"GrandTotal")}else{OAT.addTextNode(j,"")}l.appendChild(j);var R=[];if(self.colConditions.length==0){var j=OAT.Dom.create("td",{},"gtotal");var se=0;if(F[fe][0].length>0){if(self.formulaInfo.measureFormula[fe].hasFormula){se=self.calculateFormulaTotal(F[fe][0],fe,"MeasureInRows")}else{if(self.IsReduceNuN(F[fe][0]))se="#NuN#";else se=F[fe][0].reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}if(!isNaN(se)||se=="#NuN#"||se=="#FoE#"){OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,fe));j=self.applyConditionalFormats(j,se.toString(),false,fe)}else{OAT.addTextNode(j,"")}l.appendChild(j)}else{var J=self.colPointers.length-1;if(self.colPointers[self.colPointers.length-1].length==0)J--;if(self.colPointers[J]!=undefined){for(var h=0;h<self.colPointers[J].length;h++){var j=OAT.Dom.create("td",{},"gtotal");var se=0;if(F[fe][h]!=undefined&&F[fe][h].length>0){if(self.formulaInfo.measureFormula[fe].hasFormula){se=self.calculateFormulaTotal(F[fe][h],fe,"MeasureInRows")}else{if(self.IsReduceNuN(F[fe][h]))se="#NuN#";else se=F[fe][h].reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}if(!isNaN(se)||se=="#NuN#"||se=="#FoE#"){OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,fe));j=self.applyConditionalFormats(j,se.toString(),false,fe)}else{OAT.addTextNode(j,"")}l.appendChild(j);if(self.formulaInfo.measureFormula[fe].hasFormula){R.push(F[fe][h])}else{if(!isNaN(se)){R.push(parseFloat(se))}}}}}if(self.options.totals&&self.colConditions.length&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var j=OAT.Dom.create("td",{},"gtotal");var se=0;if(R.length!=0){if(self.formulaInfo.measureFormula[fe].hasFormula){se=self.calculateFormulaTotal(R,fe,"MeasureInRows")}else{if(self.IsReduceNuN(R))se="#NuN#";else se=R.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}OAT.addTextNode(j,self.defaultPictureValue(se.toString(),false,fe));j=self.applyConditionalFormats(j,se.toString(),false,fe);l.appendChild(j)}self.appendRowToTable(t,l,false)}}}}catch(e){}};this.IsReduceNuN=function(e){isNuN=false;for(var r=0;r<e.length;r++){if(e[r]!="#NuN#"&&e[r]!=0){return false}if(e[r]=="#NuN#")isNuN=true}return isNuN};this.applyFilters=function(){self.filteredData=[];for(var e=0;e<self.allData.length;e++){if(self.filterOK(self.allData[e])){self.filteredData.push(self.allData[e])}}};this.createTempDataStructForAggStepOptimization=function(){try{for(var e=0;e<self.GeneralDataRows.length;e++){for(var r=0;r<self.GeneralDataRows[0].length;r++){for(var t=0;t<self.GeneralDataRows[0].length;t++){if(self.TempDataStructForAggStepOptimization[self.GeneralDataRows[e][r]]==undefined){self.TempDataStructForAggStepOptimization[self.GeneralDataRows[e][r]]=[]}self.TempDataStructForAggStepOptimization[self.GeneralDataRows[e][r]][self.GeneralDataRows[e][t]]=true}}}}catch(e){}};this.getMeasureValue=function(e,r,t){var a=e;var s=[];var i=[];for(var f=0;f<t.length-measures.length+1;f++){i[f]=t[t.length-measures.length+1-(f+1)]}for(var f=0;f<i.length;f++){s[i[f]]=a.value;a=a.parent}var l="";var n=false;var o=self.allData;if(self.filterIndexes.length>0){o=self.filteredData}for(var f=0;f<o.length;f++){var u=false;for(var v=0;v<i.length;v++){if(o[f][i[v]]==s[i[v]]){u=true}else{u=false;break}}if(u){l=o[f][t.length+self.filterIndexes.length-measures.length+1+r];n=true;break}}if(n)return l;else return self.EmptyValue};this.getMeasureValueCoord=function(e,r,t,a){var s=[];var i=[];for(var f=0;f<self.rowConditions.length-measures.length+1;f++){i[f]=self.rowConditions[self.rowConditions.length-measures.length+1-(f+1)]}for(var f=self.colConditions.length-1;f>=0;f--){s[self.colConditions[f]]=r.value;r=r.parent}var l=e.parent;for(var f=0;f<i.length;f++){s[i[f]]=l.value;l=l.parent}var n="";var o=false;var u=0;var v=a;for(var f=0;f<v.length;f++){var c=false;for(var d=0;d<s.length;d++){if(v[f][d]==s[d]){c=true}else{if(s[d]==undefined&&self.filterIndexes.length>0){c=true}else{c=false;break}}}if(c){n=v[f][t];u=f;o=true;break}}if(o){return[n,u]}else return self.EmptyValue};this.getFormulaRowByCoord=function(e,r,t,a,s){var i=[];var f=[];for(var l=0;l<self.rowConditions.length-measures.length+1;l++){f[l]=self.rowConditions[self.rowConditions.length-measures.length+1-(l+1)]}if(r){for(var l=self.colConditions.length-1;l>=0;l--){i[self.colConditions[l]]=r.value;r=r.parent}}var n=e.parent;for(var l=0;l<f.length;l++){i[f[l]]=n.value;n=n.parent}for(var l=0;l<self.filterIndexes.length;l++){var o=self.filterDiv.selects[l];var u=OAT.$v(o);if(u=="[all]"){i[self.filterIndexes[l]]=undefined}else{i[self.filterIndexes[l]]=u}}var v=false;if(s!=undefined){c=s}else{var c=self.recordForFormula}var d=[];var m=[];for(var h=0;h<self.formulaInfo.recordDataLength;h++){m[h]=0}for(var l=0;l<c.length;l++){var p=false;for(var T=0;T<i.length;T++){if(c[l][T]==i[T]){p=true}else{if(i[T]==undefined&&self.filterIndexes.indexOf(T)!=-1){p=true}else{p=false;break}}}if(p){for(var A=0;A<self.formulaInfo.measureFormula[t].relatedMeasures.length;A++){var w=self.formulaInfo.measureFormula[t].relatedMeasures[A];if(c[l][w]==undefined){if(m[w]==0)m[w]="#NuN#"}else{if(m[w]=="#NuN#")m[w]=0;m[w]=m[w]+parseFloat(c[l][w])}}v=true;d.push(l)}}if(v){if(self.formulaInfo.cantFormulaMeasures==1){for(var O=0;O<d.length;O++){s.splice(d[O],1)}}return m}else return self.EmptyValue};this.calculateFormulaTotal=function(e,r,t){try{var a=[];if(e.length==0)return"#NuN#";for(var s=0;s<e.length;s++){if(e[s]!=self.EmptyValue&&e[s]!=0&&(e[s]!="#NuN#"||self.ShowMeasuresAsRows)){for(var i=0;i<e[s].length;i++){if(a[i]==undefined){a[i]=0}if(!isNaN(e[s][i])&&e[s][i]!="#NuN#"){if(a[i]=="#NuN#")a[i]=0;a[i]=a[i]+e[s][i]}if(e[s][i]=="#NuN#"&&a[i]==0){a[i]="#NuN#"}}}}if(!self.ShowMeasuresAsRows){if(a.length==0)return"#NuN#"}else{if(a.length==0)return NaN}var f=EvaluateExpressionPivotJs(self.formulaInfo.measureFormula[r].PolishNotation,a,self.formulaInfo);if(f==Infinity||isNaN(f)){return"#FoE#"}return f}catch(e){return self.EmptyValue}};this.addToStack=function(e,r,t,a){if(self.GeneralDataRows.length>3e3)return true;if(e<1)return true;if(r.value==undefined)return true;var s=self.conditions[a[e]].dataRowPosition;var i=self.conditions[a[e-1]].dataRowPosition;if(self.allData.length>800&&self.filterIndexes.length>0){return true}for(var f=0;f<self.allData.length;f++){if(self.allData[f][s]==t){if(r.value==self.allData[f][i]){return true}}}if(self.rowConditions.length<8){for(var f=0;f<self.GeneralDataRows.length;f++){if(self.GeneralDataRows[f][s]==t){if(r.value==self.GeneralDataRows[f][i]){return true}}}}return false};this.createAggStructure=function(){function e(e,r,t,a){e.items=false;e.depth=-1;var s=[e];var i=r.length;if(self.ShowMeasuresAsRows&&t){i-=measures.length-1}for(var f=0;f<i;f++){var l=self.conditions[r[f]];var n=self.conditions[r[f]].dataRowPosition;var o=n;var u=l.sort;if(f>=1&&self.rowConditions.length>16&&self.GeneralDataRows.length>1200){l=self.conditions[r[f-1]];n=self.conditions[r[f-1]].dataRowPosition;o=n;u=l.sort}if(u!=0&&u!=2){var v=true;for(var c=0;c<l.distinctValues.length;c++){if(v&&l.distinctValues[c]!=parseInt(l.distinctValues[c])){v=false;break}}if(v){a.sort(function(e){return function(r,t){return u*(parseInt(r[e])===parseInt(t[e])?0:parseInt(r[e])<parseInt(t[e])?-1:1)}}(o))}else{a.sort(function(e){return function(r,t){return u*(r[e]===t[e]?0:r[e]<t[e]?-1:1)}}(o))}}var d=[];var m=l.distinctValues.length;if(f>=1&&self.rowConditions.length>16&&self.GeneralDataRows.length>1200){var h=self.conditions[r[f]].dataRowPosition;var p=[];for(var T=0;T<s.length;T++){var A=[];for(var w=0;w<a.length;w++){x=a[w][h];var O=self.addToStack3(f,s[T],a[w],r,u,v);if(O=="break")break;if(p.indexOf(x)==-1){if(O){p.push(x);var y=false;if(l.collapsedValues.indexOf(x)!=-1)y=true;var _={value:x,parent:s[T],used:false,items:false,depth:f,collapsed:y,conditionNumber:r[f]};A.push(_);d.push(_)}}}p=[];s[T].items=A}}else{for(var T=0;T<s.length;T++){var A=[];var g=[0];for(var b=0;b<m;b++){var x=l.distinctValues[b];if(l.blackList.indexOf(x)==-1){if(self.addToStack2(f,s[T],x,r,a,g,u,v)){var y=false;if(l.collapsedValues.indexOf(x)!=-1)y=true;var _={value:x,parent:s[T],used:false,items:false,depth:f,collapsed:y,conditionNumber:r[f]};A.push(_);d.push(_)}}}s[T].items=A}}s=d}if(self.ShowMeasuresAsRows&&t){var d=[];for(var T=0;T<s.length;T++){var A=[];var m=measures.length;for(var b=0;b<m;b++){var F=measures[b].getAttribute("displayName");var y=false;var _={value:F,parent:s[T],used:false,items:false,depth:i,collapsed:y};var S=false;if(self.colConditions.length==0){var k=self.getMeasureValue(s[T],b,r);if(k==self.EmptyValue){S=true}else{var N={value:k,parent:_,used:false,items:false,depth:i+1,collapsed:y};_.items=[];_.items.push(N)}}if(!S){A.push(_);if(self.colConditions.length==0){d.push(N)}else{d.push(_)}}}s[T].items=A}s=d}}var r=[];for(var t=0;t<self.allData.length;t++){r.push(self.allData[t])}e(self.rowStructure,self.rowConditions,true,r);e(self.colStructure,self.colConditions,false,r)};this.addToStack3=function(e,r,t,a,s,i){if(r.value==undefined)return true;var f=self.conditions[a[e-1]].dataRowPosition;if(r.value==t[f]){var l=r;var n=true;for(var o=1;o<e;o++){var u=self.conditions[a[e-1-o]].dataRowPosition;l=l.parent;if(l.value!=t[u]){n=false;break}}if(n)return true}else{if(s==0||s==2||s==1&&!i&&t[f]<=r.value||s==-1&&!i&&t[f]>=r.value||s==1&&i&&parseInt(t[f])<=parseInt(r.value)||s==-1&&i&&parseInt(t[f])>=parseInt(r.value)){return false}else{return"break"}}};this.addToStack2=function(e,r,t,a,s,i,f,l){if(self.GeneralDataRows.length>3e3)return true;if(e<1)return true;if(r.value==undefined)return true;var n=self.conditions[a[e]].dataRowPosition;var o=self.conditions[a[e-1]].dataRowPosition;if(self.allData.length>1e3&&self.filterIndexes.length>0&&self.rowConditions.length<8){return true}var u=true;for(var v=i[0];v<s.length;v++){if(f==0||f==2||f==1&&!l&&s[v][n]<=t||f==-1&&!l&&s[v][n]>=t||f==1&&l&&parseInt(s[v][n])<=parseInt(t)||f==-1&&l&&parseInt(s[v][n])>=parseInt(t)){if(s[v][n]==t){if(u&&f!=0&&f!=2){i[0]=v;u=false}if(r.value==s[v][o]){var c=r;var d=true;for(var m=1;m<e;m++){var h=self.conditions[a[e-1-m]].dataRowPosition;c=c.parent;if(c.value!=s[v][h]){d=false;break}}if(d)return true}}}else{break}}if(self.GeneralDataRows.length<500&&self.GeneralDataRows.length>self.allData.length){for(var v=0;v<self.GeneralDataRows.length;v++){if(self.GeneralDataRows[v][n]==t){if(r.value==self.GeneralDataRows[v][o]){if(e>1){var h=self.conditions[a[e-2]].dataRowPosition;if(r.parent.value==self.GeneralDataRows[v][h]){return true}}else{return true}}}}}return false};this.fillAggStructure=function(){function e(e,r,t,a){if(!self.ShowMeasuresAsRows){var s=e;for(var i=0;i<r.length;i++){var f=r[i];var l=t[f];var n=false;for(var o=0;o<s.items.length;o++){if(s.items[o].value==l){n=s.items[o];s.items[o].row=a;break}}if(n)s=n}s.used=true}else{var u=t.length-measures.length;t.splice(u,0,"");for(var v=0;v<measures.length;v++){var c=measures[v].getAttribute("displayName");t[u]=c;var s=e;for(var i=0;i<r.length;i++){var f=r[i];var l=t[f];var n=false;for(var o=0;o<s.items.length;o++){if(s.items[o].value==l){n=s.items[o];break}}if(!self.autoPaging){if(n)s=n}else{if(n)s=n}}s.used=true}t.splice(u,1)}}function r(e){var t=e;if(!t.items){t.used=true;return}for(var a=0;a<t.items.length;a++){r(t.items[a])}}if(self.options.showEmpty){r(self.rowStructure);r(self.colStructure)}else{for(var t=0;t<self.filteredData.length;t++){var a=self.filteredData[t];e(self.rowStructure,self.rowConditions,a,t);e(self.colStructure,self.colConditions,a,t)}}};this.checkAggStructure=function(){function e(r){if(!self.ShowMeasuresAsRows){if(!r.items){return r.used}for(var t=r.items.length-1;t>=0;t--){if(!e(r.items[t])){r.items.splice(t,1)}}return r.items.length>0}else{if(self.colConditions>0){var a=r;if(!a.items){return a.used}var s=a.items.length;var i;for(i=s-1;i>-1;i--){if(i>-1){var f=e(a.items[i]);if(f!=undefined&&!f){a.items.splice(i,1)}}}return a.items.length>0}}}e(self.rowStructure);if(!self.ShowMeasuresAsRows){e(self.colStructure)}};this.applyDefaultFormats=function(e,r){var t=typeof r;switch(t){case"number":r=OAT.charReplace(r.toString(),".",gx.decimalPoint);OAT.addTextNode(e,r);break}return e};this.refreshPivot=function(e,r,t){if(e!=""&&r!=""){var a=new DOMParser;var s=a.parseFromString(e,"text/xml");var i=s.getElementsByTagName("OLAPDimension");var f;for(var l=0;l<self.conditions.length;l++){if(self.conditions[l]){var n=jQuery.extend(true,[],self.conditions[l].blackList);for(var o=0;o<n.length;o++){self.createFilterInfo({op:"pop",values:n[o],dim:l})}}self.conditions[l].blackList=[]}var u=[];var v=[];for(var c=0;c<i.length;c++){var d=i[c].getElementsByTagName("name")[0].childNodes[0].nodeValue;var m=-1;for(var h=0;h<self.columns.length;h++){if(self.columns[h].attributes.getNamedItem("name").nodeValue===d)m=h}if(m!=-1){var p=i[c].getElementsByTagName("condition")[0].childNodes[0].nodeValue;if(p==="row"){f=self.colConditions.indexOf(m);if(f!=-1){self.colConditions.splice(f,1);if(measures.length>1)self.rowConditions=[m].concat(self.rowConditions);else self.rowConditions.push(m)}else{f=self.filterIndexes.indexOf(m);if(f!=-1){self.filterIndexes.splice(f,1);if(measures.length>1)self.rowConditions=[m].concat(self.rowConditions);else self.rowConditions.push(m)}}u[parseInt(i[c].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=m}else if(p==="col"){f=self.rowConditions.indexOf(m);if(f!=-1){self.rowConditions.splice(f,1);if(measures.length>1)self.colConditions=[m].concat(self.colConditions);else self.colConditions.push(m)}else{f=self.filterIndexes.indexOf(m);if(f!=-1){self.filterIndexes.splice(f,1);if(measures.length>1)self.colConditions=[m].concat(self.colConditions);else self.colConditions.push(m)}}v[parseInt(i[c].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=m}else if(p==="none"){f=self.colConditions.indexOf(m);if(f!=-1){self.colConditions.splice(f,1);if(measures.length>1)self.filterIndexes=[m].concat(self.filterIndexes);else self.filterIndexes.push(m)}else{f=self.rowConditions.indexOf(m);if(f!=-1){self.rowConditions.splice(f,1);if(measures.length>1)self.filterIndexes=[m].concat(self.filterIndexes);else self.filterIndexes.push(m)}}}var T=i[c].getElementsByTagName("order")[0].childNodes[0].nodeValue;if(T=="descending"){self.conditions[m].sort=-1}else{self.conditions[m].sort=1}var A=i[c].getElementsByTagName("hide")[0].childNodes;for(var w=0;w<A.length;w++){if(A[w].tagName==="value"){var f=self.conditions[m].blackList.indexOf(A[w].textContent);if(f===-1){for(var O=0;O<self.conditions[m].distinctValues.length;O++){var y=self.conditions[m].distinctValues[O].toString().trimpivot();if(y==A[w].textContent){self.createFilterInfo({op:"push",values:self.conditions[m].distinctValues[O],dim:m})}}}}}if(i[c].getElementsByTagName("filterdivs").length>0){var _=i[c].getElementsByTagName("filterdivs")[0].childNodes;for(var w=0;w<_.length;w++){if(_[w].tagName==="value"){var g=self.filterIndexes.indexOf(m);if(g!=-1){if(self.filterDiv.selects[g]!=undefined){self.filterDiv.selects[g].value=_[w].textContent}}}}}}}if(self.rowConditions.length-(measures.length-1)==u.length){for(var b=0;b<u.length;b++){self.rowConditions[b]=u[b]}}if(self.colConditions.length==v.length){for(var b=0;b<v.length;b++){self.colConditions[b]=v[b]}}for(var x=0;x<self.columns.length;x++){self.pageData.AxisInfo=self.createAxisInfo(self.columns[x].getAttribute("dataField"))}self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");self.pageData.DataInfo=self.createDataInfo();var F=self.createNewDataInfo();var S=self.createNewAxisInfo();self.lastCallToQueryViewer="refreshPivot";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,S,F,self.pageData.FilterInfo,self.pageData.CollapseInfo,true)}};this.getRowFromDimensionRow=function(e,r){for(var t=0;t<r.length;t++){var a=true;for(var s=0;s<e.length;s++){if(e[s]!=undefined){if(e[s]!=r[t][s]){a=false;break}}}if(a){return r[t]}}return null};this.notInBlackList=function(e,r){var t=false;for(var a=0;a<e.length;a++){if(r[a]!=undefined&&r[a].blackList!=undefined&&r[a].blackList.indexOf(e[a])!=-1){t=true}}return t};this.preGoWhenShowHideMeasures=function(e){var r=self.initMetadata.Measures[e].displayName;self.headerRow.indexOf(r);if(!self.initMetadata.Measures[e].Visible){if(measures.length>1){self.rowConditions.splice(self.rowConditions.length-1,1);self.dataColumnIndex=self.dataColumnIndex-1}}else{var t=measures.length-1;for(var a=0;a<t;a++){self.rowConditions.splice(self.rowConditions.length-1,1)}if(t>=0&&measures[0].getAttribute("dataField")!="F0"){var s=self.rowConditions.length+self.colConditions.length+self.filterIndexes.length;if(measures.length>0){var i=s;s=s+measures.length;for(var f=i;f<s;f++){self.rowConditions.push(f)}}}}for(var f=0;f<self.columns.length;f++){var l=self.columns[f].getAttribute("dataField");var e=self.initMetadata.DataFields.indexOf(l);self.initMetadata.Conditions[e]=self.conditions[f]}this.goWhenHide()};this.preGoWhenShowHideDimension=function(e){for(var r=0;r<self.columns.length;r++){var t=self.columns[r].getAttribute("dataField");var a=self.initMetadata.DataFields.indexOf(t);self.initMetadata.Conditions[a]=self.conditions[r]}var s;var i=self.initMetadata.DataFields[e];for(var r=0;r<self.columns.length;r++){var t=self.columns[r].getAttribute("dataField");if(i==t){s=r}}if(!self.initMetadata.Dimensions[e].Visible){self.initMetadata.DimensionPosition[e]="row";if(self.colConditions.indexOf(s)>-1){self.initMetadata.DimensionPosition[e]="col"}if(self.filterIndexes.indexOf(s)>-1){self.initMetadata.DimensionPosition[e]="fil"}}var f=self.initMetadata.Dimensions[e].displayName;var l=self.headerRow.indexOf(f);if(!self.initMetadata.Dimensions[e].Visible){if(self.rowConditions.indexOf(l)>-1){self.rowConditions.splice(self.rowConditions.indexOf(l),1)}else if(self.colConditions.indexOf(l)>-1){self.colConditions.splice(self.colConditions.indexOf(l),1)}else if(self.filterIndexes.indexOf(l)>-1){self.filterIndexes.splice(self.filterIndexes.indexOf(l),1)}self.dataColumnIndex=self.dataColumnIndex-1;for(var n=0;n<self.rowConditions.length;n++){if(self.rowConditions[n]>l){self.rowConditions[n]=self.rowConditions[n]-1}}for(var n=0;n<self.colConditions.length;n++){if(self.colConditions[n]>l){self.colConditions[n]=self.colConditions[n]-1}}for(var n=0;n<self.filterIndexes.length;n++){if(self.filterIndexes[n]>l){self.filterIndexes[n]=self.filterIndexes[n]-1}}}else{var o=self.initMetadata.DimensionPosition[e];if(o==undefined){var u=self.initMetadata.Dimensions[e].defaultPosition.toLowerCase();if(u.indexOf("rows")>-1)o="row";else if(u.indexOf("columns")>-1)o="col";else if(u.indexOf("filters")>-1||u.indexOf("pages")>-1)o="fil";else o="row"}var v=0;for(var n=0;n<e;n++){if(self.initMetadata.Dimensions[n].Visible)v=v+1}e=v;if(o=="row"){var c=[];var d=self.rowConditions.indexOf(e)>-1;for(var m=0;m<self.rowConditions.length;m++){if(self.rowConditions[m]<e){c.push(self.rowConditions[m])}else if(self.rowConditions[m]==e){c.push(e);c.push(e+1);d=true}else{if(!d){c.push(e);d=true}c.push(self.rowConditions[m]+1)}}if(!d){c.push(e)}self.rowConditions=[];self.rowConditions=c;self.dataColumnIndex=self.dataColumnIndex+1;var h=[];for(var m=0;m<self.colConditions.length;m++){if(self.colConditions[m]>=e){h.push(self.colConditions[m]+1)}else{h.push(self.colConditions[m])}}self.colConditions=[];self.colConditions=h;var p=[];for(var m=0;m<self.filterIndexes.length;m++){if(self.filterIndexes[m]>=e){p.push(self.filterIndexes[m]+1)}else{p.push(self.filterIndexes[m])}}self.filterIndexes=[];self.filterIndexes=p}else if(o=="col"){var c=[];for(var m=0;m<self.rowConditions.length;m++){if(self.rowConditions[m]>=e){c.push(self.rowConditions[m]+1)}else{c.push(self.rowConditions[m])}}self.rowConditions=[];self.rowConditions=c;self.dataColumnIndex=self.dataColumnIndex+1;var h=[];var d=self.colConditions.indexOf(e)>-1;for(var m=0;m<self.colConditions.length;m++){if(self.colConditions[m]<e){h.push(self.colConditions[m])}else if(self.colConditions[m]==e){h.push(e);h.push(e+1);d=true}else{if(!d){h.push(e);d=true}h.push(self.colConditions[m]+1)}}if(!d){h.push(e)}self.colConditions=[];self.colConditions=h;var p=[];for(var m=0;m<self.filterIndexes.length;m++){if(self.filterIndexes[m]>=e){p.push(self.filterIndexes[m]+1)}else{p.push(self.filterIndexes[m])}}self.filterIndexes=[];self.filterIndexes=p}else if(o=="fil"){var c=[];for(var m=0;m<self.rowConditions.length;m++){if(self.rowConditions[m]>=e){c.push(self.rowConditions[m]+1)}else{c.push(self.rowConditions[m])}}self.rowConditions=[];self.rowConditions=c;self.dataColumnIndex=self.dataColumnIndex+1;var h=[];for(var m=0;m<self.colConditions.length;m++){if(self.colConditions[m]>=e){h.push(self.colConditions[m]+1)}else{h.push(self.colConditions[m])}}self.colConditions=[];self.colConditions=h;var p=[];var d=self.filterIndexes.indexOf(e)>-1;for(var m=0;m<self.filterIndexes.length;m++){if(self.filterIndexes[m]<e){p.push(self.filterIndexes[m])}else if(self.filterIndexes[m]==e){p.push(e);p.push(e+1);d=true}else{if(!d){p.push(e);d=true}p.push(self.filterIndexes[m]+1)}}if(!d){p.push(e)}self.filterIndexes=[];self.filterIndexes=p}}self.initRowConditions=[];for(var n=0;n<self.rowConditions.length;n++){self.initRowConditions.push(self.rowConditions[n])}this.goWhenHide()};this.goWhenHide=function(e){var r=[];for(var t=0;t<self.initMetadata.Dimensions.length;t++){if(!self.initMetadata.Dimensions[t].Visible){r.push(self.initMetadata.Dimensions[t].dataField)}}var a=[];for(var t=0;t<self.initMetadata.Measures.length;t++){if(!self.initMetadata.Measures[t].Visible){a.push(self.initMetadata.Measures[t].dataField)}}var s={DataFields:self.initMetadata.DataFields,Dimensions:self.initMetadata.Dimensions,Measures:self.initMetadata.Measures,DimensionPosition:self.initMetadata.DimensionPosition,Conditions:self.initMetadata.Conditions,version:self.rememberLayoutStateVersion};self.saveHiddenState(s);var i=OATParseMetadata(self.initMetadata.Metadata,r,a,self.serverPagination);var f=i[0];self.HideDataFilds=i[2];self.OrderFildsHidden=i[1];var l=jQuery.parseXML(f);measures=l.getElementsByTagName("OLAPMeasure");self.columns=l.getElementsByTagName("OLAPDimension");var i=OATGetColumnsAndMeasureMeatadata(self.columns,measures,self.formulaInfo,self.OrderFildsHidden);self.headerRow=i[0];self.formulaInfo.measureFormula=i[2];self.conditionalFormats=i[3];self.conditionalFormatsColumns=i[4];if(measures.length>0){self.dataColumnIndex=self.headerRow.length-1}self.conditions=[];for(var t=0;t<self.headerRow.length;t++){self.initCondition(t);if(self.conditions[t]&&self.columns[t]){self.conditions[t].dataField=self.columns[t].getAttribute("dataField");self.conditions[t].state="all";self.conditions[t].defaultAction="Include";self.conditions[t].visibles=[];self.conditions[t].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}self.applyCustomFilters(t)}for(var t=0;t<self.columns.length;t++){var n=self.columns[t].getAttribute("dataField");var o=self.initMetadata.DataFields.indexOf(n);if(self.initMetadata.Conditions[o]!=""){self.initMetadata.Conditions[o].dataRowPosition=self.conditions[t].dataRowPosition;self.conditions[t]=self.initMetadata.Conditions[o]}}self.cleanGridCache();self.pageData.AxisInfo=self.createAxisInfo();var u=self.createNewAxisInfo();self.pageData.DataInfo=self.createDataInfo();var v=self.createNewDataInfo();self.lastCallToQueryViewer="hiddenDimension";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,u,v,self.pageData.FilterInfo,self.pageData.CollapseInfo,true);if(e){self.initValueRead(self,0)}else{for(var t=0;t<self.columns.length;t++){if(self.conditions[t].totalPages==undefined){var c=10;if(self.QueryViewerCollection[self.IdForQueryViewerCollection].AutoRefreshGroup!=""){c=0}var d=t;self.lastRequestAttributeValues="hiddenDimension";self.lastRequestAttributeColumnNumber=d;self.requestAttributeValues(self.columns[d].getAttribute("dataField"),1,c,"")}}}};this.canBeConsiderNoNew=function(e,r,t){if(self.colConditions.length>0){var a=false;for(var s=0;s<r.length;s++){var i=true;for(var f=0;f<self.rowConditions.length;f++){if(r[s][self.rowConditions[f]]!=e[self.rowConditions[f]]){i=false}}if(i==true){a=true;break}}}if(self.filterIndexes.length>0){var a=false;for(var s=0;s<t.length;s++){var i=true;for(var f=0;f<self.rowConditions.length-measures.length+1;f++){if(t[s][self.rowConditions[f]]!=e[self.rowConditions[f]]){i=false}}if(i==true){a=true;break}}if(!a){t.push(e)}}return a};this.preGoWhenMoveTopFilter=function(e,r){if(r==undefined){for(var t=0;t<self.filterDiv.selects.length;t++){self.filterDiv.selects[t].value="[all]"}}else{var a=false;for(var t=0;t<self.filterDiv.selects.length;t++){if(self.filterDiv.selects[t].value!="[all]"){a=true}}if(a)return}self.FilterByTopFilter=false;var s=[];for(var t=0;t<columns.length;t++){var i=t;if(i!=e&&self.filterIndexes.indexOf(i)==-1){s.push(i)}}var f=self.GeneralDataRows;var l=[];for(var t=0;t<f.length;t++){var n=false;var o=0;for(var u=0;u<l.length;u++){var v=true;for(var c=0;c<s.length;c++){if(f[t][s[c]]!=l[u][s[c]]){v=false;break}}if(v){o=u;n=true;break}}if(!n){var d=[];for(var m=0;m<f[t].length;m++){d.push([f[t][m]])}l.push([d]);for(var h=0;h<measures.length;h++){var i;if(h<measures.length-1){i=self.rowConditions[self.rowConditions.length-measures.length+1+h]}else{i=self.dataColumnIndex}if(self.formulaInfo.measureFormula[h].hasFormula&&self.filterIndexes.length>0){var p=self.getFormulaRowByDataRow(f[t],h,"");if(p!=self.EmptyValue&&p!="#NuN#"){var T=self.calculateFormulaTotal([p],h,"MeasureInRows");if(!isNaN(T)){d[i]=T.toString()}}}}}else{if(measures.length>0){if(!self.formulaInfo.measureFormula[measures.length-1].hasFormula){if(l[o][self.dataColumnIndex]!="#NuN#"&&f[t][self.dataColumnIndex]!="#NuN#"){l[o][self.dataColumnIndex]=(parseFloat(l[o][self.dataColumnIndex])+parseFloat(f[t][self.dataColumnIndex])).toString()}else if(l[o][self.dataColumnIndex]=="#NuN#"){l[o][self.dataColumnIndex]=f[t][self.dataColumnIndex]}}}for(var h=0;h<measures.length-1;h++){var i=self.rowConditions[self.rowConditions.length-measures.length+1+h];if(self.formulaInfo.measureFormula[h].hasFormula&&self.filterIndexes.length>0);else{l[o][i]=(parseFloat(l[o][i])+parseFloat(f[t][i])).toString()}}}}self.allData=l;self.conditions=[];for(var t=0;t<self.headerRow.length;t++){self.initCondition(t)}for(var t=0;t<self.headerRow.length;t++){self.restoreSubtotalsAndSortLayout(t)}};this.isNotFilterByTopFilter=function(e){for(var r=0;r<self.filterIndexes.length;r++){var t=self.filterIndexes[r];var a=self.filterDiv.selects[r];if(a!=undefined&&(a.selectedIndex&&OAT.$v(a)!="[all]"&&OAT.$v(a)!=e[t])){return false}}return true};this.preGoWhenFilterByTopFilter=function(e){self.FilterByTopFilter=true;self.allData=self.GeneralDataRows;self.conditions=[];for(var r=0;r<self.headerRow.length;r++){self.initCondition(r)}for(var r=0;r<self.headerRow.length;r++){self.restoreSubtotalsAndSortLayout(r)}};this.gridCache=[];this.cleanGridCache=function(){self.gridCache=[]};this.addPageToCache=function(e,r){self.gridCache.push({page:e,data:r})};this.getPageDataFromCache=function(e){for(var r=0;r<self.gridCache.length;r++){if(self.gridCache[r].page==e){return self.gridCache[r].data}}return false};this.fireOnPageChange=function(e){setTimeout((function(){var r={QueryviewerId:self.IdForQueryViewerCollection,Navigation:e};var t=document.createEvent("Events");t.initEvent("PivotTableOnPageChangeEvent",true,true);t.parameter=r;document.dispatchEvent(t)}),0)};this.goWhenServerPagination=function(e,r){if(!self.getPageDataFromCache(self.pageData.ServerPageNumber)){self.addPageToCache(self.pageData.ServerPageNumber,self.pageData.rows)}if(self.pageData.ServerPageNumber!=self.pageData.PreviousPageNumber){self.QueryViewerCollection[self.IdForQueryViewerCollection].CurrentPage=self.pageData.ServerPageNumber;if(self.pageData.ServerPageNumber==1){if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnFirstPage=="function")self.fireOnPageChange("OnFirstPage")}else if(self.pageData.ServerPageNumber==self.pageData.ServerPageCount){if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnLastPage=="function")self.fireOnPageChange("OnLastPage")}else if(self.pageData.ServerPageNumber<self.pageData.PreviousPageNumber){if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnPreviousPage=="function")self.fireOnPageChange("OnPreviousPage")}else{if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnNextPage=="function")self.fireOnPageChange("OnNextPage")}self.pageData.PreviousPageNumber=self.pageData.ServerPageNumber}if(!e){self.gd.clearSources();self.gd.clearTargets();self.drawFilters();if(self.QueryViewerCollection[self.IdForQueryViewerCollection].AutoRefreshGroup!=""){if(r===undefined||r===null||!r){if(!self.firstTime||self.getState()&&self.getState().version==self.rememberLayoutStateVersion){var t;t=self.getMetadataXML();t=t.replace(/\&amp;/g,"&");setTimeout((function(){var e={QueryviewerId:self.IdForQueryViewerCollection,Metadata:t};var r=document.createEvent("Events");r.initEvent("RequestUpdateLayoutSameGroup",true,true);r.parameter=e;document.dispatchEvent(r)}),50)}}}}var a=new Array;for(var s=0;s<self.filterDiv.selects.length;s++){a[s]=self.filterDiv.selects[s].value}if(!self.firstTime){var i={query:self.query,conditions:self.conditions,colConditions:self.colConditions,rowConditions:self.rowConditions,filterIndexes:self.filterIndexes,filterDivSelects:a,rowsPerPage:self.rowsPerPage,AxisInfo:self.pageData.AxisInfo,FilterInfo:self.pageData.FilterInfo,version:self.rememberLayoutStateVersion,DataInfo:self.pageData.DataInfo,NewAxisInfo:self.createNewAxisInfo(),NewDataInfo:self.createNewDataInfo()};if(!self.deleteState){self.saveState(i)}else{self.cleanState()}self.readState=true}else{self.firstTime=false}self.drawTableWhenServerPagination();if(self.pageData.ServerPageCount>0&&(self.pageData.ServerPageCount>1||self.pageData.rows.length>10)&&self.rowsPerPage>0){var f={currPage:self.pageData.ServerPageNumber,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+this.controlName+"_"+self.query)),optionsForRows:OAT.AddItemToList([10,15,20],initMetadata.RowsPerPage),rowsPerPage:self.rowsPerPage,topNav:false,controlName:this.controlName+"_"+self.query,cantPages:self.pageData.ServerPageCount,controlUcId:UcId,translations:self.translations,control:self};OAT.partialTablePagination(jQuery("#"+self.controlName+"_"+self.query),f);jQuery("#"+this.controlName+"_"+self.query).css("margin-bottom","0px")}if(jQuery("#"+this.controlName+"_"+self.query).length>0&&!autoResize){var l=jQuery("#"+this.containerName)[0].clientWidth;jQuery("#"+this.controlName+"_"+self.query).css({width:l-4+"px"})}try{var n=jQuery("#"+this.controlName+"_"+self.query)[0].offsetWidth-4;if(jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1){n=n+4}}catch(e){}try{var o=jQuery("#"+this.controlName+"_"+self.query)[0].offsetWidth-1;jQuery("#"+UcId+"_"+self.query+"_title_div").css({width:n+"px"});jQuery("#"+UcId+"_"+self.query+"_pivot_page").css({width:n+"px"});jQuery("#"+this.controlName+"_"+self.query+"_tablePagination").css({width:o+"px"});if(jQuery("#"+this.controlName+"_"+self.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+self.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+self.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom){jQuery("#"+this.controlName+"_"+self.query+"_tablePagination")}}catch(e){}self.RedrawSelectedNode();setInterval((function(){if(jQuery("#"+self.controlName+"_"+self.query).length>0&&jQuery("#"+self.controlName+"_"+self.query)[0].getAttribute("class")==="pivot_table"){if(jQuery("#"+self.controlName+"_"+self.query+"_tablePagination_paginater").length>0&&jQuery("#"+self.controlName+"_"+self.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+self.controlName+"_"+self.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom){jQuery("#"+this.controlName+"_"+self.query+"_tablePagination")}}}),150)};this.getDataForPivot=function(e,r,t,a,s,i,f,l,n,o){if(a){self.cleanGridCache()}if(a&&t>-1){self.rowsPerPage=t}self.pageData.PreviousPageNumber=self.pageData.ServerPageNumber;if(!a&&self.getPageDataFromCache(r)){self.pageData.ServerPageNumber=r;self.pageData.rows=self.getPageDataFromCache(self.pageData.ServerPageNumber);self.preGoWhenServerPagination(true)}else{if(s!=""){self.pageData.AxisInfo=self.createAxisInfo(s)}if(i!=""){self.createFilterInfo(i)}self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");self.ExportTo="";if(t<0){t=0;self.ExportTo=f}var u=true;if(r>1||!a){u=false}if(n!=undefined&&n!=""){u=true}self.pageData.AxisInfo=self.createAxisInfo(s);var v=self.createNewAxisInfo(s);self.pageData.DataInfo=self.createDataInfo();var c=self.createNewDataInfo();self.lastCallToQueryViewer="DataForPivot";self.lastNotAutorefreshIndicator=o;self.requestPageDataForPivotTable(r,t,a,v,c,self.pageData.FilterInfo,self.pageData.CollapseInfo,u)}};this.CreateExpandCollapseInfo=function(e){var r=[];var t={};for(var a=0;a<self.columns.length;a++){var s=-1;for(var i=0;i<self.conditions.length;i++){if(self.conditions[i].dataField==self.columns[a].getAttribute("dataField")){s=i}}if(self.conditions[s].collapsedValues.length){var f={Expanded:[],Collapsed:self.conditions[s].collapsedValues,DefaultAction:"Expand"};var t={DataField:self.conditions[s].dataField,NullExpanded:true,NotNullValues:f};r.push(t)}}return r};this.createAxisInfo=function(e){var r=[];var t=1;for(var a=0;a<self.initMetadata.Dimensions.length;a++){var s=-1;var i=!self.initMetadata.Dimensions[a].Visible;var f="Rows";var l=1;var n="Ascending";var o=true;if(!i){for(var u=0;u<self.conditions.length;u++){if(self.conditions[u].dataField==self.initMetadata.Dimensions[a].dataField){s=u}}n=self.conditions[s].sort==1?"Ascending":"Descending";o=self.conditions[s].subtotals==1||self.conditions[s].subtotals?true:false;if(self.rowConditions.indexOf(s)>-1){l=self.rowConditions.indexOf(s)+1}if(self.colConditions.indexOf(s)>-1){f="Columns";l=self.colConditions.indexOf(s)+1}if(self.filterIndexes.indexOf(s)>-1){f="Pages";l=self.filterIndexes.indexOf(s)+1}}else{f="Hidden";l=t;t=t+1}var v={DataField:self.initMetadata.Dimensions[a].dataField,Order:n,Axis:{Type:f,Position:l},Subtotals:o};r.push(v)}return r};this.createNewAxisInfo=function(e){var r=[];var t=0;var a=0;var s=0;var i=0;var f=0;var l=0;for(var n=0;n<self.initMetadata.Dimensions.length;n++){var o=-1;var u=!self.initMetadata.Dimensions[n].Visible;var v="Rows";var c=1;var d="Ascending";var m=true;if(!u){for(var h=0;h<self.conditions.length;h++){if(self.conditions[h].dataField==self.initMetadata.Dimensions[n].dataField){o=h}}d=self.conditions[o].sort==1?"Ascending":"Descending";m=self.conditions[o].subtotals==1||self.conditions[o].subtotals?true:false;if(self.rowConditions.indexOf(o)>-1){if(self.changesrowposition){c=self.rowConditions.indexOf(o)+1+a;t=c;var p=self.rowConditions.indexOf(o);var T=0;var A=true;for(var w=p+1;w<self.rowConditions.length&&A;w++){T++;if(self.rowConditions[w]<o){dataFieldRC=self.conditions[self.rowConditions[w]].dataField;for(var O=0;O<r.length;O++){if(dataFieldRC==r[O].DataField)positionDF=r[O].Axis.Position}c=positionDF-T;t=c;A=false}}}else{c=self.rowConditions.indexOf(o)+1+a;t=c}}if(self.colConditions.indexOf(o)>-1){v="Columns";c=self.colConditions.indexOf(o)+1+i;s=c}if(self.filterIndexes.indexOf(o)>-1){v="Pages";c=self.filterIndexes.indexOf(o)+1+l;f=c}}else{if(self.initMetadata.Dimensions[n].defaultPosition!="hidden"){v=self.initMetadata.Dimensions[n].defaultPosition;if(v=="Rows"){a=a+1;c=t+1;t=c}if(v=="Columns"){i=i+1;c=s+1;s=c}if(v=="Pages"){l=l+1;c=f+1;f=c}}else{v="";c=""}}var y={DataField:self.initMetadata.Dimensions[n].dataField,Order:d,Axis:{Type:v,Position:c},Subtotals:m,Hidden:u};r.push(y)}return r};this.createDataInfo=function(){var e=[];var r=1;var t=1;for(var a=0;a<self.initMetadata.Measures.length;a++){var s=self.initMetadata.Measures[a].Visible?"Data":"Hidden";var i=self.initMetadata.Measures[a].Visible?t:r;var f={DataField:self.initMetadata.Measures[a].dataField,Axis:{Type:s,Position:i}};e.push(f);if(self.initMetadata.Measures[a].Visible){t=t+1}else{r=r+1}}return e};this.createNewDataInfo=function(){var e=[];for(var r=0;r<self.initMetadata.Measures.length;r++){var t=!self.initMetadata.Measures[r].Visible;var a={DataField:self.initMetadata.Measures[r].dataField,Hidden:t,Position:r+1};e.push(a)}return e};this.createFilterInfo=function(e,r){DataFieldFilter=self.conditions[e.dim].dataField;if(e.op=="all"||e.op=="pagefilter"&&e.values=="[all]"){var t=-1;for(var a=0;a<self.pageData.FilterInfo.length;a++){if(DataFieldFilter==self.pageData.FilterInfo[a].DataField){t=a;break}}if(t>-1)self.pageData.FilterInfo.splice(t,1);self.conditions[e.dim].state="all";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];self.conditions[e.dim].defaultAction="Include";return}if(self.conditions[e.dim].state=="none"){self.conditions[e.dim].visibles=[];for(var s=0;s<self.conditions[e.dim].distinctValues.length;s++){if(self.conditions[e.dim].blackList.indexOf(self.conditions[e.dim].distinctValues[s])==-1){self.conditions[e.dim].blackList.push(self.conditions[e.dim].distinctValues[s])}}}else if(self.conditions[e.dim].state=="all"){self.conditions[e.dim].blackList=[];for(var s=0;s<self.conditions[e.dim].distinctValues.length;s++){if(self.conditions[e.dim].visibles.indexOf(self.conditions[e.dim].distinctValues[s])==-1){self.conditions[e.dim].visibles.push(self.conditions[e.dim].distinctValues[s])}}}if(e.op=="none"){self.conditions[e.dim].state="none";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];self.conditions[e.dim].defaultAction="Exclude"}else{if(e.op=="push"){self.conditions[e.dim].state="";var t=self.conditions[e.dim].visibles.indexOf(e.values);if(t>-1)self.conditions[e.dim].visibles.splice(t,1);if(self.conditions[e.dim].blackList.indexOf(e.values)==-1)self.conditions[e.dim].blackList.push(e.values)}else if(e.op=="pop"){self.conditions[e.dim].state="";if(self.conditions[e.dim].visibles.indexOf(e.values)==-1)self.conditions[e.dim].visibles.push(e.values);var t=self.conditions[e.dim].blackList.indexOf(e.values);if(t>-1)self.conditions[e.dim].blackList.splice(t,1)}else if(e.op=="pagefilter"){self.conditions[e.dim].state="";self.conditions[e.dim].defaultAction="Exclude";self.conditions[e.dim].visibles=[];self.conditions[e.dim].visibles.push(e.values);for(var a=0;a<self.conditions[e.dim].distinctValues.length;a++){var i=self.conditions[e.dim].distinctValues[a];if(self.conditions[e.dim].blackList.indexOf(i)==-1&&i!=e.values){self.conditions[e.dim].blackList.push(i)}}}else if(e.op=="reverse"){if(self.conditions[e.dim].defaultAction=="Include"){self.conditions[e.dim].defaultAction="Exclude"}else{self.conditions[e.dim].defaultAction="Include"}if(self.conditions[e.dim].state=="none"){var t=-1;for(var a=0;a<self.pageData.FilterInfo.length;a++){if(DataFieldFilter==self.pageData.FilterInfo[a].DataField){t=a;break}}if(t>-1)self.pageData.FilterInfo.splice(t,1);self.conditions[e.dim].state="all";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];return}else if(self.conditions[e.dim].state=="all"){self.conditions[e.dim].state="none";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[]}else{var f=[];for(var l=0;l<self.conditions[e.dim].visibles.length;l++){f.push(self.conditions[e.dim].visibles[l])}var n=[];for(var l=0;l<self.conditions[e.dim].blackList.length;l++){n.push(self.conditions[e.dim].blackList[l])}self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];for(var s=0;s<self.conditions[e.dim].distinctValues.length;s++){var i=self.conditions[e.dim].distinctValues[s];if(f.indexOf(i)==-1){self.conditions[e.dim].visibles.push(i)}else{self.conditions[e.dim].blackList.push(i)}}for(var s=0;s<n.length;s++){if(self.conditions[e.dim].visibles.indexOf(n[s])==-1){self.conditions[e.dim].visibles.push(n[s])}}for(var s=0;s<f.length;s++){if(self.conditions[e.dim].blackList.indexOf(f[s])==-1){self.conditions[e.dim].blackList.push(f[s])}}}}}var o=false;var u=true;var v=[];for(var c=0;c<self.conditions[e.dim].visibles.length;c++){if(self.conditions[e.dim].visibles[c]!="#NuN#"){v.push(self.conditions[e.dim].visibles[c])}}var d=[];if(self.conditions[e.dim].state!="none"){for(var c=0;c<self.conditions[e.dim].distinctValues.length;c++){var i=self.conditions[e.dim].distinctValues[c];if(i!="#NuN#"&&v.indexOf(i)==-1){d.push(i)}}for(var c=0;c<self.conditions[e.dim].blackList.length;c++){if(self.conditions[e.dim].blackList[c]!="#NuN#"&&d.indexOf(self.conditions[e.dim].blackList[c])==-1){d.push(self.conditions[e.dim].blackList[c])}}if(v.length==0&&self.conditions[e.dim].defaultAction=="Exclude"){d=[]}}if(e.op=="none"){u=false;v=[];d=[]}else{if(self.conditions[e.dim].distinctValues.indexOf("#NuN#")>-1||d.indexOf(self.conditions[e.dim].blackList[c])!=-1){if(self.conditions[e.dim].visibles.indexOf("#NuN#")==-1){u=false}}else{if(self.conditions[e.dim].defaultAction=="Exclude"){u=false}}}if(self.conditions[e.dim].hasNull&&!(e.op=="none")){var m=self.defaultPicture.getAttribute("textForNullValues");var h=false;var p=0;for(var s=0;s<self.conditions[e.dim].distinctValues.length;s++){p=self.conditions[e.dim].distinctValues[s].length}for(var s=0;s<self.conditions[e.dim].distinctValues.length;s++){if(self.conditions[e.dim].distinctValues[s].trimpivot()==self.defaultPicture.getAttribute("textForNullValues")){m=self.conditions[e.dim].distinctValues[s];h=true;break}}if(!h){for(var c=0;c<p-self.defaultPicture.getAttribute("textForNullValues").length;c++){m=m+" "}}if(!u){if(d.indexOf(m)==-1){d.push(m);if(self.conditions[e.dim].blackList.indexOf(m)==-1){self.conditions[e.dim].blackList.push(m)}}if(v.indexOf(m)!=-1){v.splice(v.indexOf(m),1)}if(self.conditions[e.dim].visibles.indexOf(m)!=-1){self.conditions[e.dim].visibles.splice(self.conditions[e.dim].visibles.indexOf(m),1)}}else{if(v.indexOf(m)==-1){if(d.indexOf(m)!=-1){d.splice(d.indexOf(m),1);v.push(m)}else{if(self.conditions[e.dim].defaultAction=="Exclude"){v.push(m)}}if(self.conditions[e.dim].blackList.indexOf(m)!=-1){self.conditions[e.dim].blackList.splice(self.conditions[e.dim].blackList.indexOf(m),1);if(self.conditions[e.dim].visibles.indexOf(m)==-1){self.conditions[e.dim].visibles.push(m)}}}}}var T=self.conditions[e.dim].previousPage==self.conditions[e.dim].totalPages;var A=(u||!self.conditions[e.dim].hasNull)&&d.length==0&&e.op!="none"&&e.op!="push"&&(self.conditions[e.dim].defaultAction=="Include"||T)&&!r&&!(e.op=="reverse");var t=0;var w=false;for(var c=0;c<self.pageData.FilterInfo.length;c++){if(self.pageData.FilterInfo[c].DataField==DataFieldFilter){o=true;w=true;self.pageData.FilterInfo[c].NullIncluded=u;self.pageData.FilterInfo[c].NotNullValues.Included=v;self.pageData.FilterInfo[c].NotNullValues.Excluded=d;self.pageData.FilterInfo[c].NotNullValues.DefaultAction=self.conditions[e.dim].defaultAction;t=c}}if(A&&w){self.pageData.FilterInfo.splice(t,1)}if(!o&&!A){var O={Included:v,Excluded:d,DefaultAction:self.conditions[e.dim].defaultAction};filter={DataField:DataFieldFilter,NullIncluded:u,NotNullValues:O};self.pageData.FilterInfo.push(filter)}};this.moveToNextPage=function(){if(this.pageData.ServerPageNumber<this.pageData.ServerPageCount){this.getDataForPivot(this.UcId,this.pageData.ServerPageNumber+1,this.rowsPerPage,false,"","","","")}};this.moveToFirstPage=function(){if(this.pageData.ServerPageNumber>1){this.getDataForPivot(this.UcId,1,this.rowsPerPage,false,"","","","")}};this.moveToLastPage=function(){if(this.pageData.ServerPageNumber<this.pageData.ServerPageCount){this.getDataForPivot(this.UcId,this.pageData.ServerPageCount,this.rowsPerPage,false,"","","","")}};this.moveToPreviousPage=function(){if(this.pageData.ServerPageNumber>1){self.getDataForPivot(UcId,this.pageData.ServerPageNumber-1,this.rowsPerPage,false,"","","","")}};this.preGoWhenServerPagination=function(e){self.goWhenServerPagination(e,false)};this.readScrollValue=function(e){var r=self.conditions[e].dataField;if(!self.conditions[e].blocked){self.conditions[e].blocked=true;if(!self.conditions[e].filtered){var t=self.conditions[e].previousPage+1;self.lastRequestValue=e;self.lastRequestAttributeValues="readScrollValueWithoutFilters";self.requestAttributeValues(r,t,10,"")}else{var a=self.conditions[e].searchInfo;var t=a.previousPage+1;self.lastRequestValue=r;var s=a.filteredText;self.lastRequestAttributeValues="readScrollValueWithFilters";self.lastRequestAttributeColumnNumber=e;self.lastRequestAttributeFilterText=s;self.requestAttributeValues(r,t,10,a.filteredText)}}};this.getValuesForColumn=function(e,r,t){var a=self.conditions[r].dataField;if(t!=""){var s=1;var i=t.replace(/\\/g,"\\\\");self.lastRequestAttributeValues="ValuesForColumn";self.lastRequestAttributeColumnNumber=r;self.lastRequestAttributeFilterText=i;self.lastRequestAttributeDataField=a;self.lastRequestAttributeUcId=e;self.requestAttributeValues(a,s,10,i)}else{self.resetScrollValue(e,a,r)}};this.appendNewValueData=function(e,r){if(r.PageNumber>self.conditions[e].previousPage){self.conditions[e].previousPage=r.PageNumber;self.conditions[e].totalPages=r.PagesCount;var t=[];if(r.Null){if(self.conditions[e].indexOf("#NuN#")==-1){self.conditions[e].distinctValues.push("#NuN#")}}for(var a=0;a<r.NotNullValues.length;a++){var s=r.NotNullValues[a];if(self.conditions[e].distinctValues.indexOf(s)==-1){self.conditions[e].distinctValues.push(s);t.push(s)}if(self.conditions[e].defaultAction=="Include"){if(self.conditions[e].visibles.indexOf(s)==-1&&self.conditions[e].blackList.indexOf(s)==-1){self.conditions[e].visibles.push(s)}}else{if(self.conditions[e].visibles.indexOf(s)==-1&&self.conditions[e].blackList.indexOf(s)==-1){self.conditions[e].blackList.push(s)}}}for(var i=0;i<t.length;i++){var f=true;if(self.conditions[e].state!="all"){if(self.conditions[e].blackList.indexOf(t[i])!=-1){f=false}}if(!(self.conditions[e].hasNull&&t[i].trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(t[i],e,f)}}}if(self.conditions[e].previousPage<r.PagesCount)self.conditions[e].blocked=false};this.changeValues=function(e,r,t,a,s){var i=jQuery("#"+e+t)[0];var f=i.value;if(i.value){f=f.replace(/\\/g,"\\\\")}if((i.value||i.value=="")&&f!=s){return}self.conditions[t].filtered=true;self.conditions[t].blocked=true;self.removeAllPairsFromPopUp(t,a.PagesCount>1);self.conditions[t].searchInfo.previousPage=1;self.conditions[t].searchInfo.totalPages=a.PagesCount;self.conditions[t].searchInfo.filteredText=s;for(var l=0;l<a.NotNullValues.length;l++){var n=a.NotNullValues[l];var o=self.conditions[t].distinctValues.indexOf(n)!=-1;if(self.conditions[t].distinctValues.indexOf(n)==-1){self.conditions[t].distinctValues.push(n)}if(self.conditions[t].state=="all"||self.conditions[t].defaultAction=="Include"&&!o){if(self.conditions[t].visibles.indexOf(n)==-1&&self.conditions[t].blackList.indexOf(n)==-1){self.conditions[t].visibles.push(n)}}var u=true;if(self.conditions[t].state!="all"){if(self.conditions[t].visibles.indexOf(n)<0){u=false}}self.conditions[t].searchInfo.values.push(n);if(!(self.conditions[t].hasNull&&n.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(n,t,u)}}if(a.PagesCount>0)self.conditions[t].blocked=false};this.resetScrollValue=function(e,r,t){self.conditions[t].filtered=false;self.conditions[t].blocked=true;self.removeAllPairsFromPopUp(t,data.PagesCount>1);for(var a=0;a<self.conditions[t].distinctValues.length;a++){var s=true;var i=self.conditions[t].distinctValues[a];if(self.conditions[t].state!="all"){if(self.conditions[t].visibles.indexOf(i)<0){s=false}}if(!(self.conditions[t].hasNull&&i.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(i,t,s)}}if(self.conditions[t].previousPage<self.conditions[t].totalPages)self.conditions[t].blocked=false};this.resetAllScrollValue=function(e){for(var r=0;r<self.conditions.length;r++){self.conditions[r].filtered=false;self.conditions[r].blocked=true;if(self.conditions[r].previousPage<self.conditions[r].totalPages)self.conditions[r].blocked=false}};this.appendNewFilteredValueData=function(e,r,t){var a=self.conditions[r].searchInfo;if((t||t=="")&&a.filteredText!=t){return}if(e.PageNumber>a.previousPage){self.conditions[r].searchInfo.previousPage=e.PageNumber;self.conditions[r].searchInfo.totalPages=e.PagesCount;if(e.Null){if(self.conditions[r].distinctValues.indexOf("#NuN#")==-1){self.conditions[r].distinctValues.push("#NuN#")}}for(var s=0;s<e.NotNullValues.length;s++){var i=e.NotNullValues[s];var f=self.conditions[r].distinctValues.indexOf(i)!=-1;if(self.conditions[r].distinctValues.indexOf(i)==-1){self.conditions[r].distinctValues.push(i)}if(self.conditions[r].defaultAction=="Include"&&!f){if(self.conditions[r].visibles.indexOf(i)==-1&&self.conditions[r].blackList.indexOf(i)==-1){self.conditions[r].visibles.push(i)}}else{if(self.conditions[r].visibles.indexOf(i)==-1&&self.conditions[r].blackList.indexOf(i)==-1){self.conditions[r].blackList.push(i)}}var l=true;if(self.conditions[r].state!="all"){if(self.conditions[r].visibles.indexOf(i)<0){l=false}}if(!(self.conditions[r].hasNull&&i.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(i,r,l)}}if(self.conditions[r].searchInfo.previousPage<self.conditions[r].searchInfo.totalPages)self.conditions[r].blocked=false}},this.appendNewPairToPopUp=function(e,r,t){var a=function(e,r,t){var a=OAT.Dom.create("div");var s=t?"check_item_img":"uncheck_item_img";if(self.isSD){s=t?"check_item_img_small":"uncheck_item_img_small"}OAT.addImageNode(a,t?"check_box":"check_box_outline_blank","");a.setAttribute("class",s);var i=OAT.Dom.create("input");i.type="checkbox";i.id=r;var f=OAT.Dom.create("label");OAT.addTextNode(f,e);f.htmlFor=r;a.appendChild(f);return[a,i]};var s=function(e,t){var a="pop";if(!e){a="push"}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[r].dataField,{op:a,values:t,dim:r},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(r);self.EneablePivot();return};var f=self.dimensionPictureValue(e,r);if(e=="#NuN#"){f=" "}f=f.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(f.length>33){var l=f.substring(32,f.length).trimpivot().length>0?"...":"";f=f.substring(0,32)+l}f=f.replace(/ /g," ")+"     ";var n=a(f,"pivot_distinct_"+i,t);n[0].setAttribute("value",e);var o=jQuery("#values_"+self.UcId+"_"+r)[0];o.appendChild(n[0]);if(o.children.length>9){o.setAttribute("class","pivot_popup_fix")}OAT.Dom.attach(n[0],"click",(function(){self.DiseablePivot();var e="check_item_img";var r="uncheck_item_img";if(self.isSD){e="check_item_img_small";r="uncheck_item_img_small"}var t=!(this.getAttribute("class")===e);var a=this.getAttribute("class")===e?r:e;jQuery(this).find("i")[0].textContent=t?"check_box":"check_box_outline_blank";this.setAttribute("class",a);s(t,this.getAttribute("value"))}))};this.removeAllPairsFromPopUp=function(e,r){var t="check_item_img";var a="uncheck_item_img";if(self.isSD){t="check_item_img_small";a="uncheck_item_img_small"}jQuery("#values_"+self.UcId+"_"+e).find("."+t).remove();jQuery("#values_"+self.UcId+"_"+e).find("."+a).remove();jQuery(".last_div_popup ."+t).remove();jQuery(".last_div_popup ."+a).remove();if(r){jQuery("#values_"+self.UcId+"_"+e).removeClass("pivot_popup_auto");jQuery("#values_"+self.UcId+"_"+e).addClass("pivot_popup_fix")}else{jQuery("#values_"+self.UcId+"_"+e).removeClass("pivot_popup_fix");jQuery("#values_"+self.UcId+"_"+e).addClass("pivot_popup_auto")}};this.onClickEventHandle=function(e,r,t,a){self.ClickHandle(e)};this.onClickExpandCollapse=function(e){var r=jQuery(e).data("itemValue");var t=jQuery(e).data("numberMorD");jQuery(e).data("itemInfoEC");if(self.conditions[t].collapsedValues.indexOf(r)==-1){self.conditions[t].collapsedValues.push(r);self.ExpandCollapseHandleWhenServerPagination(e,"collapse")}else{self.conditions[t].collapsedValues.splice(self.conditions[t].collapsedValues.indexOf(r),1);self.ExpandCollapseHandleWhenServerPagination(e,"expande")}};this.cleanValueForNull=function(e){if(e=="#NuN#"){var r=self.defaultPicture.getAttribute("textForNullValues");if(r!=undefined){return r}return""}return e};this.isClickedRow=function(e,r,t,a,s,i){if(!i){if(self.rowConditions.indexOf(s)==-1){return true}for(var f=0;f<t;f++){var l=self.rowConditions[f];if(e[l]!=a[l]){return false}}}else{if(self.colConditions.indexOf(s)==-1){return true}for(var f=0;f<t;f++){var l=self.colConditions[f];if(e[l]!=a[l]){return false}}}return true};this.isClickedRowMeasure=function(e,r,t){for(var a=0;a<e.length;a++){if(e[a]!=undefined&&e[a]!=t[a]){return false}}return true};this.onClickSelectNode=function(e){var r=jQuery(e).data("itemValue");var t=jQuery(e).data("typeMorD");var a=jQuery(e).data("numberMorD");var s=jQuery(e).data("itemInfo");self.selection.SelectedNode=[];self.SelectNodes(r,t,a,s)};this.requestDataSynForPivotTable=function(){setTimeout((function(){var e={QueryviewerId:self.IdForQueryViewerCollection};var r=document.createEvent("Events");r.initEvent("RequestDataSynForPivotTable",true,true);r.parameter=e;document.dispatchEvent(r)}),0)};this.ClickHandle=function(e){self.LastElemValue=e;self.requestDataSynForPivotTable()};this.setDataSynForPivotTable=function(e){var r=self.LastElemValue;var t=e;var a=jQuery(r).data("itemValue");var s=jQuery(r).data("typeMorD");var i=jQuery(r).data("numberMorD");var f=jQuery(r).data("itemInfo");var l=OAT.IsNodeSelected(r.parentElement);var n='<DATA><ITEM type="'+s+'" ';if(s==="MEASURE"){n=n+'name="'+measures[i].getAttribute("name")+'" ';n=n+'displayName="'+measures[i].getAttribute("displayName")+'" ';n=n+'selected="'+l.toString()+'" ';n=n+'location="data">';n=n+self.cleanValueForNull(a)}else{n=n+'name="'+self.columns[i].getAttribute("name")+'" ';n=n+'displayName="'+self.columns[i].getAttribute("displayName")+'" ';n=n+'selected="'+l.toString()+'" ';if(f!=""&&(f.axis!=undefined&&f.axis=="columns"||f[4]=="columns"))n=n+'location="columns">';else n=n+'location="rows">';n=n+self.cleanValueForNull(a)}n=n+"</ITEM>";n=n+"<CONTEXT>";n=n+"<RELATED>";var o=n;try{var u=[];for(var v=0;v<self.conditions.length;v++){if(self.conditions[v].dataField!=undefined){u.push(self.conditions[v].dataField)}}for(var v=0;v<measures.length;v++){if(measures[v].getAttribute("dataField")!=undefined){u.push(measures[v].getAttribute("dataField"))}}self.allRowsPivot=[];self.allFullRowsPivot=[];var c=t.split("<Record>");for(var v=1;v<c.length;v++){var d=[];var m=[];for(var h=0;h<u.length;h++){d[h]="#NuN#";var p=c[v].split("<"+u[h]+">");if(p.length>1){var T=p[1].split("</"+u[h]+">");d[h]=T[0];m[h]=d[h]}else{if(c[v].indexOf("<"+u[h]+"/>")>=0){d[h]="";m[h]=""}else{d[h]="#NuN#";m[h]="#NuN#"}}}if(s=="MEASURE"&&self.formulaInfo.cantFormulaMeasures&&self.formulaInfo.measureFormula[i].hasFormula){d[i+this.columns.length]=parseFloat(d[i+this.columns.length]).toFixed(15).toString();m[i+this.columns.length]=parseFloat(m[i+this.columns.length]).toFixed(15).toString()}self.allRowsPivot.push(d);for(var h=0;h<self.HideDataFilds.length;h++){var p=c[v].split("<"+self.HideDataFilds[h]+">");if(p.length>1){var T=p[1].split("</"+self.HideDataFilds[h]+">");m[m.length]=T[0]}else{if(c[v].indexOf("<"+self.HideDataFilds[h]+"/>")>=0){m[m.length]=""}else{m[m.length]="#NuN#"}}}self.allFullRowsPivot.push(m)}var A=false;if(f.row){A=!f.row.subTotal;if(!A&&f.isTotal!=undefined&&!f.isTotal){A=true}}var w=f.axis!=undefined&&f.axis=="columns";if(w){A=true}if((f.row!=undefined||w)&&A){var O=f.row;var y=f.cell;self.pageData.rows.indexOf(O);var _=f.cell;var g=self.pageData.columnsHeaders[_];if(w){y=f.rownumber;_=f.columnnumber;g=self.pageData.columnsHeaders[_]}var b=[];for(var v=0;v<self.pageData.dataFields.length;v++){b[v]=undefined}if(f.row!=undefined){for(var v=0;v<O.headers.length;v++){var x=u.indexOf(O.headers[v].dataField);if(O.headers[v]!=undefined&&O.headers[v].value!=undefined){b[x]=O.headers[v].value}}}if(g!=undefined){for(var v=0;v<g.subHeaders.length;v++){if(w&&f.rownumber<v)break;if(g.subHeaders[v]!=undefined){var x=self.pageData.dataFields.indexOf(g.subHeaders[v].dataField);if(g.subHeaders[v].value!=undefined){b[x]=g.subHeaders[v].value}}}}for(var v=0;v<this.columns.length;v++){n=n+'<ITEM name="'+this.columns[v].getAttribute("name")+'">';n=n+"<VALUES";var F=false;var S="";if(s==="MEASURE"){if(b[v]!=undefined){if(b[v]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(b[v])+"</VALUE>"}else{F=true}}else{if(self.filterIndexes.indexOf(v)!=-1){var k=[];for(var N=0;N<self.allRowsPivot.length;N++){if(k.indexOf(self.allRowsPivot[N][v])===-1&&self.filterOK(self.allRowsPivot[N])&&self.isClickedRowMeasure(b,a,self.allRowsPivot[N])){k=k.concat(self.allRowsPivot[N][v]);if(self.allRowsPivot[N][v]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[N][v])+"</VALUE>"}else{F=true}}}}}}else{var k=[];for(var N=0;N<self.allRowsPivot.length;N++){if(self.allRowsPivot[N][i]===a&&self.isClickedRow(b,a,y,self.allRowsPivot[N],i,w)&&k.indexOf(self.allRowsPivot[N][v])===-1&&self.filterOK(self.allRowsPivot[N])){k=k.concat(self.allRowsPivot[N][v]);if(self.allRowsPivot[N][v]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[N][v])+"</VALUE>"}else{F=true}}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}for(var v=0;v<measures.length;v++){n=n+'<ITEM name="'+measures[v].getAttribute("name")+'">';n=n+"<VALUES";var F=false;var S="";if(s==="MEASURE"){if(b[v+this.columns.length]!=undefined){if(b[v+this.columns.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(b[v+this.columns.length])+"</VALUE>"}else{F=true}}else{if(i==v){if(a!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(a)+"</VALUE>"}else{F=true}}else{var k=[];for(var N=0;N<self.allRowsPivot.length;N++){if(parseFloat(self.allRowsPivot[N][i+this.columns.length])===parseFloat(a)&&self.isClickedRowMeasure(b,a,self.allRowsPivot[N])&&self.filterOK(self.allRowsPivot[N])&&k.indexOf(self.allRowsPivot[N][v+this.columns.length])===-1){if(self.allRowsPivot[N][v+this.columns.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[N][v+this.columns.length])+"</VALUE>"}else{F=true}}}}}}else{var k=[];for(var N=0;N<self.allRowsPivot.length;N++){if(self.allRowsPivot[N][i]===a&&self.isClickedRow(b,a,y,self.allRowsPivot[N],i,w)&&self.filterOK(self.allRowsPivot[N])&&k.indexOf(self.allRowsPivot[N][v+this.columns.length])===-1){k=k.concat(self.allRowsPivot[N][v+this.columns.length]);if(self.allRowsPivot[N][v+this.columns.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[N][v+this.columns.length])+"</VALUE>"}else{F=true}}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}for(var v=0;v<self.HideDataFilds.length;v++){n=n+'<ITEM name="'+self.OrderFildsHidden[v]+'">';n=n+"<VALUES";var F=false;var S="";var I=function(e,r){for(var t=0;t<e.length;t++){if(e[t]!=undefined&&e[t]!=r[t]){return false}}return true};var S="";if(s==="MEASURE"){var k=[];for(var N=0;N<self.allFullRowsPivot.length;N++){if(I(b,self.allFullRowsPivot[N])&&self.isClickedRowMeasure(b,a,self.allFullRowsPivot[N])&&self.filterOK(self.allFullRowsPivot[N])&&k.indexOf(self.allFullRowsPivot[N][v+this.columns.length+measures.length])===-1){k=k.concat(self.allFullRowsPivot[N][v+this.columns.length+measures.length]);if(self.allFullRowsPivot[N][v+this.columns.length+measures.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allFullRowsPivot[N][v+this.columns.length+measures.length])+"</VALUE>"}else{F=true}}}}else{var k=[];for(var N=0;N<self.allFullRowsPivot.length;N++){if(self.allFullRowsPivot[N][i]===a&&self.isClickedRow(b,a,y,self.allFullRowsPivot[N],i,w)&&self.filterOK(self.allFullRowsPivot[N])&&k.indexOf(self.allFullRowsPivot[N][v+this.columns.length+measures.length])===-1){k=k.concat(self.allFullRowsPivot[N][v+this.columns.length+measures.length]);if(self.allFullRowsPivot[N][v+this.columns.length+measures.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allFullRowsPivot[N][v+this.columns.length+measures.length])+"</VALUE>"}else{F=true}}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}}else{if(f==="GrandTotal"){for(var v=0;v<this.columns.length;v++){n=n+'<ITEM name="'+this.columns[v].getAttribute("name")+'">';n=n+"<VALUES";var F=false;var S="";var k=[];for(var N=0;N<self.allRowsPivot.length;N++){if(k.indexOf(self.allRowsPivot[N][v])===-1&&self.filterOK(self.allRowsPivot[N])){k=k.concat(self.allRowsPivot[N][v]);if(self.allRowsPivot[N][v]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[N][v])+"</VALUE>"}else{F=true}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}for(var v=0;v<self.HideDataFilds.length;v++){n=n+'<ITEM name="'+self.OrderFildsHidden[v]+'">';n=n+"<VALUES";var F=false;var S="";var k=[];for(var N=0;N<self.allFullRowsPivot.length;N++){if(k.indexOf(self.allFullRowsPivot[N][v+this.columns.length+measures.length])===-1&&self.filterOK(self.allFullRowsPivot[N])){k=k.concat(self.allFullRowsPivot[N][v+this.columns.length+measures.length]);if(self.allFullRowsPivot[N][v+this.columns.length+measures.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allFullRowsPivot[N][v+this.columns.length+measures.length])+"</VALUE>"}else{F=true}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}for(var v=0;v<measures.length;v++){n=n+'<ITEM name="'+measures[v].getAttribute("name")+'">';n=n+"<VALUES";var F=false;var S="";var k=[];for(var N=0;N<self.allRowsPivot.length;N++){if(k.indexOf(self.allRowsPivot[N][v+this.columns.length])===-1&&self.filterOK(self.allRowsPivot[N])){k=k.concat(self.allRowsPivot[N][v+this.columns.length]);if(self.allRowsPivot[N][v+this.columns.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[N][v+this.columns.length])+"</VALUE>"}else{F=true}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}}else if(f[0]==="PtrTotals"){var O=f[2];var _=f[3];if(_>-1){var g=self.pageData.columnsHeaders[_]}w=f[4]=="columns";var D=f[5];var b=[];for(var v=0;v<self.pageData.dataFields.length;v++){b[v]=undefined}if(!w){for(var v=0;v<O.headers.length;v++){var x=self.pageData.dataFields.indexOf(O.headers[v].dataField);if(O.headers[v]!=undefined&&O.headers[v].value!=undefined){b[x]=O.headers[v].value}}}if(_>-1){for(var v=0;v<g.subHeaders.length;v++){if(g.subHeaders[v]!=undefined){if(w&&D<v)break;var x=self.pageData.dataFields.indexOf(g.subHeaders[v].dataField);if(g.subHeaders[v].value!=undefined){b[x]=g.subHeaders[v].value}}}}var E=[];var C=[];for(var v=0;v<self.allRowsPivot.length;v++){if(self.filterOK(self.allRowsPivot[v])){if(self.isClickedRowMeasure(b,a,self.allRowsPivot[v])){E.push(self.allRowsPivot[v]);if(self.HideDataFilds.length>0){C.push(self.allFullRowsPivot[v])}}}}for(var v=0;v<this.columns.length;v++){n=n+'<ITEM name="'+this.columns[v].getAttribute("name")+'">';n=n+"<VALUES";var F=false;var S="";var k=[];for(var h=0;h<E.length;h++){if(k.indexOf(E[h][v])===-1){k=k.concat(E[h][v]);if(E[h][v]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(E[h][v])+"</VALUE>"}else{F=true}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}for(var v=0;v<self.HideDataFilds.length;v++){n=n+'<ITEM name="'+self.OrderFildsHidden[v]+'">';n=n+"<VALUES";var F=false;var S="";var k=[];for(var h=0;h<E.length;h++){if(k.indexOf(E[h][v])===-1){k=k.concat(E[h][v]);if(C[h][v+this.columns.length+measures.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(C[h][v+this.columns.length+measures.length])+"</VALUE>"}else{F=true}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}for(var v=0;v<measures.length;v++){n=n+'<ITEM name="'+measures[v].getAttribute("name")+'">';n=n+"<VALUES";var F=false;var S="";var k=[];for(var N=0;N<E.length;N++){if(k.indexOf(E[N][v+this.columns.length])===-1){k=k.concat(E[N][v+this.columns.length]);if(E[N][v+this.columns.length]!="#NuN#"){S=S+"<VALUE>"+self.cleanValueForNull(E[N][v+this.columns.length])+"</VALUE>"}else{F=true}}}if(F){n=n+' Null="true"'}n=n+">"+S;n=n+"</VALUES>";n=n+"</ITEM>"}}}}catch(e){n=o}n=n+"</RELATED>";n=n+"<FILTERS>";o=n;try{for(var v=0;v<self.filterIndexes.length;v++){n=n+'<ITEM name="'+this.columns[self.filterIndexes[v]].getAttribute("name")+'" displayName="'+this.columns[self.filterIndexes[v]].getAttribute("displayName")+'">';n=n+"<VALUES>";n=n+"<VALUE>";if(self.filterDiv.selects[v].value==="[all]"){n=n+self.translations.GXPL_QViewerJSAllOption}else{n=n+self.cleanValueForNull(self.filterDiv.selects[v].value)}n=n+"</VALUE>";n=n+"</VALUES>";n=n+"</ITEM>"}}catch(e){n=o}n=n+"</FILTERS>";n=n+"</CONTEXT>";n=n+"</DATA>";self.fireOnItemClickEvent(self.QueryViewerCollection[IdForQueryViewerCollection],n)};this.fireOnItemClickEvent=function(e,r){setTimeout((function(){var t={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection};var a=document.createEvent("Events");a.initEvent("PivotTableOnItemClickEvent",true,true);a.parameter=t;document.dispatchEvent(a)}),0)};this.SelectNodes=function(e,r,t,a,s,i,f){var l=false;var n=r=="DIMENSION"?self.columns[t].getAttribute("dataField"):measures[t].getAttribute("dataField");for(var o=0;o<jQuery("#"+self.controlName+"_"+self.query+" tr").length&&!l;o++){var u=jQuery("#"+self.controlName+"_"+self.query+" tr")[o];for(var v=0;v<u.children.length&&!l;v++){var c=jQuery(u.children[v]).data("itemValue");var d=jQuery(u.children[v]).data("typeMorD");var m=jQuery(u.children[v]).data("numberMorD");var h=jQuery(u.children[v]).data("itemInfo");if(h&&t==m&&r==d){if(a=="GrandTotal"&&h=="GrandTotal"){if(OAT.IsNodeSelected(u.children[v])){if(!s){OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{if(!s){OAT.SetSelectedNodeBackgroundColor(u.children[v],self.selection.Color,jQuery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[v],self.selection.Color)}if(!s)self.selection.SelectedNode.push({value:e,dataField:n,type:r,rowData:["GrandTotal"],clicked:true});if(self.selection.EntireLine){selectedCellOffset=u.children[v].offsetLeft;var p=self.colConditions.length>0?self.colConditions.length+1:0;for(var T=p+1;T<jQuery("#"+self.controlName+"_"+self.query+" tr").length;T++){var A=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];OAT.SelectAllRow(A,self.selection.Color)}}}}else if(a[0]=="PtrTotals"&&h!="GrandTotal"&&h.length>0&&r=="MEASURE"){var w=a[2].headers.length==h[2].headers.length&&a[3]==h[3];if(w){for(var O=0;O<a[2].headers.length;O++){if(a[2].headers[O].value!=h[2].headers[O].value){w=false}}}if(w){l=true;if(OAT.IsNodeSelected(u.children[v])){if(!s){OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{if(!s){OAT.SetSelectedNodeBackgroundColor(u.children[v],self.selection.Color,jQuery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[v],self.selection.Color)}if(!s)self.selection.SelectedNode.push({value:e,dataField:n,type:r,rowData:[a],clicked:true});if(self.selection.EntireLine){var y=false;for(var _=0;_<u.children.length&&!y;_++){var g=jQuery(u.children[_]).data("typeMorD");var b=jQuery(u.children[_]).data("itemInfo");if(g=="DIMENSION"&&b[0]!=undefined&&b[0]=="PtrTotals"){OAT.SetNodeBackgroundColor(u.children[_],self.selection.Color);OAT.SelectAllRow(u,self.selection.Color,_);selectedCellOffset=u.children[_].offsetLeft;selectedRowOffset=u.children[0].offsetLeft;var x=false;var F=-1;var p=self.colConditions.length>0?self.colConditions.length+1:0;for(var T=o-1;T>p&&!x;T--){var A=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];var S=A.children[0].offsetLeft;if(jQuery(A.children[0]).hasClass("h2subtitle")){if(S<=selectedRowOffset){x=true;F=T}}if(!x){OAT.SelectAllRow(A,self.selection.Color)}}for(var T=F;T>=0;T--){var k=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];if(!jQuery(k.children[0]).hasClass("h2subtitle")){for(var N=0;N<k.children.length;N++){var I=parseInt(jQuery(k.children[N]).attr("rowspan"));if(T+I>o){OAT.SetNodeBackgroundColor(k.children[N],self.selection.Color)}}}}}}}}}}else if(self.sameValue(e,c,r,t,a)){if(a.cell!=undefined&&a.cell==h.cell){if(a.row!=undefined&&h.row!=undefined){var w=a.row.headers.length==h.row.headers.length;for(var O=0;O<a.row.headers.length;O++){if(a.row.headers[O].value!=h.row.headers[O].value){w=false}}if(w){l=true;if(OAT.IsNodeSelected(u.children[v])){if(!s){OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{if(!s){OAT.SetSelectedNodeBackgroundColor(u.children[v],self.selection.Color,jQuery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[v],self.selection.Color)}if(!s)self.selection.SelectedNode.push({value:e,dataField:n,type:r,rowData:[self.createDataRowFromItem(h,r)],clicked:true});if(self.selection.EntireLine){OAT.SelectAllRow(u,self.selection.Color,v);for(var T=o-1;T>=0;T--){var k=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];for(var N=0;N<k.children.length;N++){var I=parseInt(jQuery(k.children[N]).attr("rowspan"));if(T+I>o){OAT.SetNodeBackgroundColor(k.children[N],self.selection.Color)}}}var D=parseInt(jQuery(u.children[v]).attr("rowspan"));if(D>=1){for(var E=o+1;E<o+D;E++){var C=jQuery("#"+self.controlName+"_"+self.query+" tr")[E];OAT.SelectAllRow(C,self.selection.Color)}var E=o+D;var C=jQuery("#"+self.controlName+"_"+self.query+" tr")[E];if(C!=undefined&&jQuery(C.children[0]).hasClass("h2subtitle")&&!jQuery(C.children[0]).hasClass("grandtotaltitle")){selectedCellOffset=u.children[v].offsetLeft;rowOffset=C.children[0].offsetLeft;if(rowOffset==selectedCellOffset){OAT.SelectAllRow(C,self.selection.Color)}}}if(self.colConditions.length>0&&r=="MEASURE"){selectedCellOffset=u.children[v].offsetLeft;for(var T=1;T<jQuery("#"+self.controlName+"_"+self.query+" tr").length;T++){if(T!=o){var x=false;var A=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];for(var P=0;P<A.children.length&&!x;P++){var j=A.children[P].offsetLeft+A.children[P].offsetWidth;if(j>selectedCellOffset+1){x=true;OAT.SetNodeBackgroundColor(A.children[P],self.selection.Color)}}}}}}}}}}else if(a[0]=="PtrTotals"&&a[1]==h[1]&&r=="DIMENSION"){var w=a[2].headers.length==h[2].headers.length&&a[3]==h[3];if(w){for(var O=0;O<a[2].headers.length;O++){if(a[2].headers[O].value!=h[2].headers[O].value){w=false}}}if(w){l=true;if(OAT.IsNodeSelected(u.children[v])){if(!s){OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));if(!s){OAT.SetSelectedNodeBackgroundColor(u.children[v],self.selection.Color,jQuery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[v],self.selection.Color)}if(!s)self.selection.SelectedNode.push({value:e,dataField:n,type:r,rowData:[a],clicked:true});if(self.selection.EntireLine){OAT.SelectAllRow(u,self.selection.Color,v);selectedCellOffset=u.children[v].offsetLeft;selectedRowOffset=u.children[0].offsetLeft;var x=false;var F=-1;var p=self.colConditions.length>0?self.colConditions.length+1:0;for(var T=o-1;T>p&&!x;T--){var A=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];var S=A.children[0].offsetLeft;if(jQuery(A.children[0]).hasClass("h2subtitle")){if(S<=selectedRowOffset){x=true;F=T}}if(!x){OAT.SelectAllRow(A,self.selection.Color)}}for(var T=F;T>=0;T--){var k=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];if(!jQuery(k.children[0]).hasClass("h2subtitle")){for(var N=0;N<k.children.length;N++){var I=parseInt(jQuery(k.children[N]).attr("rowspan"));if(T+I>o){OAT.SetNodeBackgroundColor(k.children[N],self.selection.Color)}}}}}}}}else if(a=="EventSelection"){if(self.sameValue(e,c,r,t,a)){if(!jQuery(u.children[0]).hasClass("h2subtitle")&&!jQuery(u.children[v]).hasClass("gtotal")&&!jQuery(u.children[v]).hasClass("subtotal")){if(self.checkConditions(f,h)){OAT.SetNodeBackgroundColor(u.children[v],self.selection.Color,jQuery("#"+self.controlName+"_"+self.query));if(self.selection.SelectedNode.length<=i){self.selection.SelectedNode.push({value:e,dataField:n,type:r,rowData:[self.createDataRowFromItem(h,r)],clicked:false})}else{self.selection.SelectedNode[i].rowData.push(self.createDataRowFromItem(h,r))}if(self.selection.EntireLine){OAT.SelectAllRow(u,self.selection.Color,v);for(var Q=o-1;Q>0;Q--){var P=jQuery("#"+self.controlName+"_"+self.query+" tr")[Q];for(var R=0;R<P.children.length;R++){var I=parseInt(jQuery(P.children[R]).attr("rowspan"));if(Q+I>o){OAT.SetNodeBackgroundColor(P.children[R],self.selection.Color)}}}var q=parseInt(jQuery(u.children[v]).attr("rowspan"));if(q>=1){for(var Q=o+1;Q<o+q;Q++){OAT.SelectAllRow(jQuery("#"+self.controlName+"_"+self.query+" tr")[Q],self.selection.Color)}var Q=o+q;var P=jQuery("#"+self.controlName+"_"+self.query+" tr")[Q];if(P!=undefined&&jQuery(P.children[0]).hasClass("h2subtitle")&&!jQuery(P.children[0]).hasClass("grandtotaltitle")){selectedCellOffset=u.children[v].offsetLeft;rowOffset=P.children[0].offsetLeft;if(rowOffset==selectedCellOffset){OAT.SelectAllRow(P,self.selection.Color)}}}if(self.colConditions.length>0&&r=="MEASURE"){selectedCellOffset=u.children[v].offsetLeft;for(var T=1;T<jQuery("#"+self.controlName+"_"+self.query+" tr").length;T++){if(T!=o){var x=false;var A=jQuery("#"+self.controlName+"_"+self.query+" tr")[T];for(var P=0;P<A.children.length&&!x;P++){var j=A.children[P].offsetLeft+A.children[P].offsetWidth;if(j>selectedCellOffset){x=true;OAT.SetNodeBackgroundColor(A.children[P],self.selection.Color)}}}}}}}}}}}}}}};this.getRowInitialShift=function(e,r){var t=0;for(var a=r-1;a>=0;a--){var s=e[a];for(var i=0;i<s.children.length;i++){var f=parseInt(jQuery(s.children[i]).attr("rowspan"));if(a+f>r){t=t+1}}}return t};this.getCellPositionSpanWithSpans=function(e,r,t){var a=e[r];var s=0;var i=t;var f=0;for(var l=0;l<a.children.length&&s<t;l++){var n=parseInt(jQuery(a.children[l]).attr("colspan"));if(n>1){i<n?i=i-n:(i=i-n,f=f+1);s=s+n}else{s=s+1;f=f+1}}return f};this.RedrawSelectedNode=function(){if(self.selection.SelectedNode){for(var e=0;e<self.selection.SelectedNode.length;e++){var r;if(self.selection.SelectedNode[e].type=="DIMENSION"){for(var t=0;t<self.columns.length;t++){if(self.selection.SelectedNode[e].dataField==self.columns[t].getAttribute("dataField")){r=t}}}else{for(var t=0;t<measures.length;t++){if(self.selection.SelectedNode[e].dataField==measures[t].getAttribute("dataField")){r=t}}}if(self.selection.SelectedNode[e].rowData[0]=="GrandTotal"){self.SelectNodes(self.selection.SelectedNode[e].value,self.selection.SelectedNode[e].type,r,"GrandTotal",true)}else if(self.selection.SelectedNode[e].rowData[0].length>0&&self.selection.SelectedNode[e].rowData[0][0]=="PtrTotals"){self.SelectNodes(self.selection.SelectedNode[e].value,self.selection.SelectedNode[e].type,r,self.selection.SelectedNode[e].rowData[0],true)}else{for(var t=0;t<jQuery("#"+self.controlName+"_"+self.query+" tr").length;t++){var a=jQuery("#"+self.controlName+"_"+self.query+" tr")[t];for(var s=0;s<a.children.length;s++){var i=jQuery(a.children[s]).data("itemValue");var f=jQuery(a.children[s]).data("typeMorD");var l=jQuery(a.children[s]).data("numberMorD");var n=jQuery(a.children[s]).data("itemInfo");if(self.sameValue(self.selection.SelectedNode[e].value,i,self.selection.SelectedNode[e].type,r,n)&&r==l&&self.selection.SelectedNode[e].type==f){if(n.row!=undefined){var o=self.createDataRowFromItem(n,f);for(var u=0;u<self.selection.SelectedNode[e].rowData.length;u++){var v=true;for(var c=0;c<self.selection.SelectedNode[e].rowData[u].length;c++){if(self.selection.SelectedNode[e].rowData[u][c]!=undefined&&o[c]!=undefined&&!(self.filterIndexes.indexOf(c)>-1)&&!(self.colConditions.indexOf(c)>-1)){if(self.selection.SelectedNode[e].rowData[u][c]!="[all]"&&o[c]!="[all]"&&self.selection.SelectedNode[e].rowData[u][c].trim()!=o[c].trim()){v=false}}}if(v)self.SelectNodes(self.selection.SelectedNode[e].value,self.selection.SelectedNode[e].type,r,n,true,e)}}}}}}}}};this.sameValue=function(e,r,t,a,s){try{var i=false;if(r!=undefined){var f=t=="DIMENSION"?self.columns[a].getAttribute("dataType"):measures[a].getAttribute("dataType");if(f=="real"||f=="integer"){i=parseFloat(e)==parseFloat(r);if(!i&&t=="DIMENSION"&&s[0]!=undefined&&s[0]=="PtrTotals"&&e.trim()==r.trim())return true}else{i=e.trim()==r.trim()}}return i}catch(e){return false}};this.checkConditions=function(e,r){var t=true;for(var a=0;a<e.length;a++){if(!r.row||!r.row.headers)return false;for(var s=0;s<r.row.headers.length;s++){if(r.row.headers[s].dataField==e[a].DataField){var i;for(var f=0;f<self.columns.length;f++){if(r.row.headers[s].dataField==self.columns[f].getAttribute("dataField")){i=f}}if(!self.sameValue(e[a].Value,r.row.headers[s].value,"DIMENSION",i,r)){return false}}}for(var l=0;l<r.row.cells.length;l++){var i;var n;for(var f=0;f<measures.length;f++){if(r.row.cells[l].dataField==measures[f].getAttribute("dataField")){i=f;n=measures[f].getAttribute("name")}}if(n==e[a].Name){if(!self.sameValue(e[a].Value,r.row.cells[l].value,"MEASURE",i,r)){return false}}}}return t};this.selectValue=function(e){OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[];var r=-2;var t=-2;var a;var s;for(var i=0;i<e.length;i++){var f;var l;for(var n=0;n<measures.length;n++){if(e[i].Name==measures[n].getAttribute("name")){f="MEASURE";l=n}}for(var n=0;n<self.columns.length;n++){if(e[i].Name==self.columns[n].getAttribute("name")){f="DIMENSION";l=n}}if(self.rowConditions.indexOf(l)>=t){r=i;t=self.rowConditions.indexOf(l);a=f;s=l}}self.SelectNodes(e[r].Value,a,s,"EventSelection",false,0,e)};this.deselectValue=function(){OAT.ClearSelectedNodes(jQuery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]};this.createDataRowFromItem=function(e,r){var t=e.row;self.pageData.rows.indexOf(t);var a=e.cell;var s=self.pageData.columnsHeaders[a];var i=[];for(var f=0;f<self.pageData.dataFields.length;f++){i[f]=undefined}if(t!=undefined&&t.headers!=undefined){for(var f=0;f<t.headers.length;f++){var l=self.pageData.dataFields.indexOf(t.headers[f].dataField);if(t.headers[f]!=undefined&&t.headers[f].value!=undefined){i[l]=t.headers[f].value}}}if(r!="DIMENSION"){if(s!=undefined){for(var f=0;f<s.subHeaders.length;f++){if(s.subHeaders[f]!=undefined){var l=self.pageData.dataFields.indexOf(s.subHeaders[f].dataField);if(s.subHeaders[f].value!=undefined){i[l]=s.subHeaders[f].value}}}}}for(var f=0;f<self.filterIndexes.length;f++){i[self.filterIndexes[f]]=self.filterDiv.selects[f].value}return i};this.ExpandCollapseHandle=function(e,r){var t=jQuery(e).data("itemValue");jQuery(e).data("typeMorD");var a=jQuery(e).data("numberMorD");var s=jQuery(e).data("itemInfo");var i='<DATA event="'+r+'"><ITEM ';i=i+'name="'+columns[a].getAttribute("name")+'" ';i=i+'displayName="'+columns[a].getAttribute("displayName")+'" ';i=i+">";i=i+self.cleanValueForNull(t);i=i+"</ITEM>";i=i+"<CONTEXT>";i=i+"<EXPANDEDVALUES>";var f=i;try{if(s!=""){var l=[];for(var n=0;n<this.GeneralDataRows.length;n++){if(l.indexOf(this.GeneralDataRows[n][a])==-1){l=l.concat(this.GeneralDataRows[n][a]);if(self.conditions[a].collapsedValues.indexOf(this.GeneralDataRows[n][a])===-1){i=i+"<VALUE>"+self.cleanValueForNull(this.GeneralDataRows[n][a])+"</VALUE>"}}}}}catch(e){i=f}i=i+"</EXPANDEDVALUES>";i=i+"</CONTEXT>";i=i+"</DATA>";return i};this.ExpandCollapseHandleWhenServerPagination=function(e,r){if(typeof self.QueryViewerCollection[IdForQueryViewerCollection].ItemExpand=="function"||qv.util.isGeneXusPreview()){var t=jQuery(e).data("numberMorD");if(self.conditions[t].previousPage>=self.conditions[t].totalPages){var a=self.ExpandCollapseHandleWhenServerPaginationCreateXML(e,r);a=a.replace(/\&/g,"&amp;");self.fireOnItemExpandCollapseEvent(self.QueryViewerCollection[IdForQueryViewerCollection],a,r=="collapse");self.getDataForPivot(self.UcId,self.pageData.ServerPageNumber,self.rowsPerPage,true,"","","","",true)}else{self.lastColumnNumber=t;self.lastRequestAttributeValues="ExpandCollapse";self.lastRequestAttributeValuesElemValue=e;self.lastRequestAttributeValuesAction=r;self.requestAttributeValues(self.columns[t].getAttribute("dataField"),1,0,"")}}else{self.getDataForPivot(self.UcId,self.pageData.ServerPageNumber,self.rowsPerPage,true,"","","","",true)}};this.ExpandCollapseHandleWhenServerPaginationCreateXML=function(e,r){var t=jQuery(e).data("itemValue");jQuery(e).data("typeMorD");var a=jQuery(e).data("numberMorD");jQuery(e).data("itemInfo");actionName='event="ItemExpand"';if(r=="collapse"){actionName='event="ItemCollapse"'}var s="<DATA "+actionName+"><ITEM ";s=s+'name="'+columns[a].getAttribute("name")+'" ';s=s+'displayName="'+columns[a].getAttribute("displayName")+'" ';s=s+">";s=s+t;s=s+"</ITEM>";s=s+"<CONTEXT>";s=s+"<EXPANDEDVALUES>";for(var i=0;i<self.conditions[a].distinctValues.length;i++){if(self.conditions[a].collapsedValues.indexOf(self.conditions[a].distinctValues[i])==-1){s=s+"<VALUE>"+self.conditions[a].distinctValues[i]+"</VALUE>"}}s=s+"</EXPANDEDVALUES>";s=s+"</CONTEXT>";s=s+"</DATA>";return s};this.onFilteredChangedEventHandleWhenServerPagination=function(e){if(self.QueryViewerCollection[IdForQueryViewerCollection].FilterChanged||qv.util.isGeneXusPreview()){if(self.conditions[e].previousPage>=self.conditions[e].totalPages){self.onFilteredChangedEventHandleWhenServerPaginationCreateXML(e,self.conditions[e].distinctValues,self.conditions[e].blackList)}else{self.lastColumnNumber=e;self.lastRequestAttributeValues="FilteredChanged";self.requestAttributeValues(self.columns[e].getAttribute("dataField"),1,0,"")}}};this.fireOnFilterChangedEvent=function(e,r){setTimeout((function(){var t={QueryviewerId:e,FilterChangedData:r};var a=document.createEvent("Events");a.initEvent("PivotTableOnFilterChangedEvent",true,true);a.parameter=t;document.dispatchEvent(a)}),0)};this.onFilteredChangedEventHandleWhenServerPaginationCreateXML=function(e,r,t){var a='<DATA event="FilterChanged" name="'+self.columns[e].getAttribute("name")+'" displayName="'+self.columns[e].getAttribute("displayName")+'">';for(var s=0;s<r.length;s++){var i=r[s];var f=true;if(self.conditions[e].state=="all"){f=true}else if(self.conditions[e].state=="none"){f=false}else if(self.conditions[e].blackList.indexOf(i)!=-1){f=false}else if(r.indexOf(i)!=-1){f=true}else if(self.conditions[e].defaultAction=="Exclude"){f=false}if(f){a=a+"<VALUE>"+i+"</VALUE>"}}a=a+"</DATA>";if(qv.util.isGeneXusPreview())window.external.SendText(self.QueryViewerCollection[self.IdForQueryViewerCollection].ControlName,a);if(self.QueryViewerCollection[IdForQueryViewerCollection].FilterChanged){a=a.replace(/\&/g,"&amp;");var l=qv.util.dom.xmlDocument(a);var n=qv.util.dom.selectXPathNode(l,"/DATA");var o={};o.Name=n.getAttribute("name");o.SelectedValues=[];var u=-1;for(var s=0;s<n.childNodes.length;s++){if(n.childNodes[s].nodeName=="VALUE"){u++;o.SelectedValues[u]=n.childNodes[s].firstChild.nodeValue}}self.fireOnFilterChangedEvent(IdForQueryViewerCollection,o)}};this.onDragundDropEventHandle=function(e,r,t){var a='<DATA event="DragAndDrop" name="'+this.columns[e].getAttribute("name")+'" displayName="'+this.columns[e].getAttribute("displayName")+'" axis="'+r+'"  position="'+(t+1)+'" />';a=a.replace(/\&/g,"&amp;");self.fireOnDragundDropEvent(this.QueryViewerCollection[IdForQueryViewerCollection],a)};this.fireOnDragundDropEvent=function(e,r){setTimeout((function(){var t={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection};var a=document.createEvent("Events");a.initEvent("PivotTableOnDragundDropEvent",true,true);a.parameter=t;document.dispatchEvent(a)}),0)};this.pivotStateChanged=function(){for(var e=0;e<self.pageData.AxisInfo.length;e++){if(self.pageData.AxisInfo[e].Axis.Type!=self.initState.AxisInfo[e].Axis.Type)return true}for(var r=0;r<self.pageData.DataInfo.length;r++){if(self.pageData.DataInfo[r].Axis.Type!=self.initState.DataInfo[r].Axis.Type)return true}if(self.initState.CollapseInfo.length!=self.pageData.CollapseInfo.length)return true;var t=JSON.stringify(self.initState.CollapseInfo);var a=JSON.stringify(self.pageData.CollapseInfo);if(t!=a)return true;return false};self.initWhenServerPagination()};try{OAT.Loader.featureLoaded("pivot")}catch(e){}function sortUnidimensionalArray(e,r,t){var a;var s=1;var i=function(e,r){if(e==r){return 0}return s*(parseInt(e)>parseInt(r)?1:-1)};var f=function(e,r){if(e==r){return 0}return s*(e>r?1:-1)};var l=true;for(var n=0;n<e.length;n++){if(l&&e[n]!=parseInt(e[n])){l=false}}if(l){a=i}else{a=f}e.sort(a);for(var o=0;o<t.columns[r].childNodes.length;o++){if(t.columns[r].childNodes[o]!=undefined&&t.columns[r].childNodes[o].localName!=undefined&&t.columns[r].childNodes[o].localName==="customOrder"){e=[];for(var u=0;u<t.columns[r].childNodes[o].childNodes.length;u++){if(t.columns[r].childNodes[o].childNodes[u].localName=="Value"){e.push(t.columns[r].childNodes[o].childNodes[u].textContent)}}}}return e}function fillGeneralDistinctValues(e,r,t){r.GeneralDistinctValues=[];for(var a=0;a<e;a++){var s=[];for(var i=0;i<t.length;i++){if(t[i][a]==undefined){if(s.indexOf(" ")==-1){s.push(" ")}}else{if(s.indexOf(t[i][a])==-1){s.push(t[i][a])}}}r.GeneralDistinctValues[a]=sortUnidimensionalArray(s,a,r)}}function fromUndefinedToBlanck(e){for(var r=0;r<e.length;r++){for(var t=0;t<e[r].length;t++){if(e[r][t]==undefined){e[r][t]=" "}}}}function getMeasureNumberByName(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("displayName")==e){return t}}return 0}function getMeasureNumberByDataField(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("dataField")==e){return t}}return 0}OAT.Statistics={list:[{longDesc:"Count",shortDesc:"COUNT",func:"count"},{longDesc:"Sum",shortDesc:"SUM",func:"sum"},{longDesc:"Product",shortDesc:"PRODUCT",func:"product"},{longDesc:"Arithmetic mean",shortDesc:"MEAN",func:"amean"},{longDesc:"Maximum",shortDesc:"MAX",func:"max"},{longDesc:"Minimum",shortDesc:"MIN",func:"min"},{longDesc:"Distinct values",shortDesc:"DISTINCT",func:"distinct"},{longDesc:"Variance",shortDesc:"VAR",func:"variance"},{longDesc:"Standard deviation",shortDesc:"STDDEV",func:"deviation"},{longDesc:"Median",shortDesc:"MEDIAN",func:"median"},{longDesc:"Mode",shortDesc:"MODE",func:"mode"}],count:function(e){return e.length},sum:function(e){if(e=="#FoE#")return"#NaV#";var r=e.length>0;for(var t=0,a=0;a<e.length;a++){if(e[a]!="#NuN#")r=false;if(!isNaN(e[a]))t+=e[a]}if(r)return"#NuN#";return t},product:function(e){for(var r=1,t=0;t<e.length;t++)r*=e[t];return r},amean:function(e){for(var r=0,t=0;t<e.length;t++)r+=e[t];return r=e.length?r/e.length:0},max:function(e){for(var r=Number.MIN_VALUE,t=0;t<e.length;t++)e[t]>r&&(r=e[t]);return r},min:function(e){for(var r=Number.MAX_VALUE,t=0;t<e.length;t++)e[t]<r&&(r=e[t]);return r},distinct:function(e){for(var r=0,t={},a=0;a<e.length;a++)t[e[a]]=1;for(p in t)r++;return r},deviation:function(e){e=OAT.Statistics.variance(e);return Math.sqrt(e)},variance:function(e){if(2>e.length)return 0;for(var r=0,t=OAT.Statistics.amean(e),a=0;a<e.length;a++)r+=(e[a]-t)*(e[a]-t);return r/(e.length-1)},median:function(e){return e.sort((function(e,r){return e-r}))[Math.floor(e.length/2)]},mode:function(e){for(var r={},t=0;t<e.length;t++){var a=e[t]+"";a in r?r[a]++:r[a]=1}var e=0,t="",s;for(s in r)a=r[s],a>e&&(e=a,t=s);return parseFloat(t)}};try{OAT.Loader.featureLoaded("statistics")}catch(e){}OAT.WinData={TYPE_TEMPLATE:-1,TYPE_AUTO:0,TYPE_MS:1,TYPE_MAC:2,TYPE_ROUND:3,TYPE_RECT:4,TYPE_ODS:5};OAT.Win=function(e){var r=this;this.options={title:"",x:0,y:0,visibleButtons:"cmMfr",enabledButtons:"cmMfr",innerWidth:0,innerHeight:0,outerWidth:350,outerHeight:!1,stackGroupBase:100,type:OAT.WinData.TYPE_AUTO,template:!1,className:!1};for(var t in e)this.options[t]=e[t];r.dom={buttons:{c:!1,m:!1,M:!1,f:!1,r:!1},container:!1,content:!1,title:!1,caption:!1,status:!1,resizeContainer:!1};r.moveTo=function(e,t){r.dom.container.style.left=e+"px";r.dom.container.style.top=t+"px"};r.innerResizeTo=function(){};r.outerResizeTo=function(){};r.show=function(){document.body.appendChild(r.dom.container);OAT.Dom.show(r.dom.container)};r.hide=function(){OAT.Dom.hide(r.dom.container)};r.close=r.hide();r.minimize=function(){};r.maximize=function(){};r.flip=function(){};r.accomodate=function(e){e=OAT.Dom.getWH(e);r.innerResizeTo(e[0],e[1])};r.options.type==OAT.WinData.TYPE_TEMPLATE&&OAT.WinTemplate(r);r.options.type==OAT.WinData.TYPE_MS&&OAT.WinMS(r);r.options.type==OAT.WinData.TYPE_MAC&&OAT.WinMAC(r);r.options.type==OAT.WinData.TYPE_RECT&&OAT.WinRECT(r,e.containerQuery);r.options.type==OAT.WinData.TYPE_ROUND&&OAT.WinROUND(r);r.options.type==OAT.WinData.TYPE_ODS&&OAT.WinODS(r);-1!=r.options.enabledButtons.indexOf("m")&&r.dom.buttons.m&&OAT.Dom.attach(r.dom.buttons.m,"click",r.minimize);-1!=r.options.enabledButtons.indexOf("M")&&r.dom.buttons.M&&OAT.Dom.attach(r.dom.buttons.M,"click",r.maximize);-1!=r.options.enabledButtons.indexOf("c")&&r.dom.buttons.c&&OAT.Dom.attach(r.dom.buttons.c,"click",r.hide);-1!=r.options.enabledButtons.indexOf("f")&&r.dom.buttons.f&&OAT.Dom.attach(r.dom.buttons.f,"click",r.flip);-1!=r.options.enabledButtons.indexOf("r")&&r.dom.buttons.r&&OAT.Resize.create(r.dom.buttons.r,r.dom.resizeContainer,OAT.Resize.TYPE_XY);r.dom.title&&OAT.Drag.create(r.dom.title,r.dom.container);r.moveTo(r.options.x,r.options.y);(r.options.outerWidth||r.options.outerHeight)&&r.outerResizeTo(r.options.outerWidth,r.options.outerHeight);(r.options.innerWidth||r.options.innerHeight)&&r.innerResizeTo(r.options.innerWidth,r.options.innerHeight);r.dom.caption&&OAT.addTextNode(r.dom.caption,r.options);r.options.stackGroupBase&&OAT.WinManager.addWindow(r.options.stackGroupBase,r.dom.container);r.hide()};OAT.WinTemplate=function(e){var r=e.options.template;if(r){for(var t="function"==typeof r?r():OAT.$(r).cloneNode(!0),a={oat_w_ctr:"container",oat_w_title_ctr:"title",oat_w_title_t_ctr:"caption",oat_w_content:"content",oat_w_max_b:["buttons","M"],oat_w_min_b:["buttons","m"],oat_w_close_b:["buttons","c"],oat_w_flip_b:["buttons","f"],oat_w_resize_handle:["buttons","r"]},s=[t],r=t.getElementsByTagName("*"),t=0;t<r.length;t++)s.push(r[t]);for(t=0;t<s.length;t++){var r=s[t],i;for(i in a)if(OAT.Dom.isClass(r,i)){var f=a[i];f instanceof Array?e.dom[f[0]][f[1]]=r:e.dom[f]=r}}e.moveTo=function(r,t){e.dom.container.style.left=r+"px";e.dom.container.style.top=t+"px"};e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"};e.innerResizeTo=function(r,t){e.dom.content.style.width=r?r+"px":"auto";e.dom.content.style.height=t?t+"px":"auto"}}else alert("OAT Window cannot be created, as a template is required but not specified!")};OAT.WinMS=function(e){OAT.Style.include("winms.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winms_container");e.dom.resizeContainer=e.dom.container;e.dom.content=OAT.Dom.create("div",{},"oat_winms_content");e.dom.title=OAT.Dom.create("div",{},"oat_winms_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winms_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winms_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winms_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("M")&&(e.dom.buttons.M=OAT.Dom.create("div",{},"oat_winms_max_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.M]));-1!=e.options.visibleButtons.indexOf("m")&&(e.dom.buttons.m=OAT.Dom.create("div",{},"oat_winms_min_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.m]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winms_resize_b"),OAT.Dom.append([e.dom.container,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinMAC=function(e){OAT.Style.include("winmac.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winmac_container");e.dom.resizeContainer=e.dom.container;e.dom.content=OAT.Dom.create("div",{},"oat_winmac_content");e.dom.title=OAT.Dom.create("div",{},"oat_winmac_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winmac_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winmac_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);e.dom.buttons.lc=OAT.Dom.create("div",{},"oat_winmac_leftCorner");OAT.Dom.append([e.dom.title,e.dom.buttons.lc]);e.dom.buttons.rc=OAT.Dom.create("div",{},"oat_winmac_rightCorner");OAT.Dom.append([e.dom.title,e.dom.buttons.rc]);-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winmac_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("M")&&(e.dom.buttons.M=OAT.Dom.create("div",{},"oat_winmac_max_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.M]));-1!=e.options.visibleButtons.indexOf("m")&&(e.dom.buttons.m=OAT.Dom.create("div",{},"oat_winmac_min_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.m]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winmac_resize_b"),OAT.Dom.append([e.dom.container,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t-8+"px":"auto"}};OAT.WinRECT=function(e,r){if(r!=undefined)e.dom.container=OAT.Dom.create("div",{position:"absolute"},r+" oat_winrect_container");else e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winrect_container");e.dom.resizeContainer=e.dom.container;if(OAT.isSD()){e.dom.content=OAT.Dom.create("div",{},"oat_winrect_content oat_winrect_content_small");e.dom.title=OAT.Dom.create("div",{},"oat_winrect_title oat_winrect_title_small")}else{e.dom.content=OAT.Dom.create("div",{},"oat_winrect_content");e.dom.title=OAT.Dom.create("div",{},"oat_winrect_title")}e.dom.caption=OAT.Dom.create("span",{},"oat_winrect_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winrect_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);if(OAT.isSD()){e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winrect_close_b oat_winrect_close_small")}else{e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winrect_close_b")}OAT.addImageNode(e.dom.buttons.c,"close","");OAT.Dom.append([e.dom.title,e.dom.buttons.c]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinROUND=function(e){OAT.Style.include("winround.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winround_container");e.dom.resizeContainer=e.dom.container;e.dom.table=OAT.Dom.create("table",{},"oat_winround_wrapper");e.dom.tr_t=OAT.Dom.create("tr",{});e.dom.td_lt=OAT.Dom.create("td",{},"oat_winround_lt");e.dom.td_t=OAT.Dom.create("td",{},"oat_winround_t");e.dom.td_rt=OAT.Dom.create("td",{},"oat_winround_rt");e.dom.tr_m=OAT.Dom.create("tr",{});e.dom.td_l=OAT.Dom.create("td",{},"oat_winround_l");e.dom.td_m=OAT.Dom.create("td",{},"oat_winround_m");e.dom.td_r=OAT.Dom.create("td",{},"oat_winround_r");e.dom.tr_b=OAT.Dom.create("tr",{});e.dom.td_lb=OAT.Dom.create("td",{},"oat_winround_lb");e.dom.td_b=OAT.Dom.create("td",{},"oat_winround_b");e.dom.td_rb=OAT.Dom.create("td",{},"oat_winround_rb");e.dom.content=OAT.Dom.create("div",{},"oat_winround_content");e.dom.title=OAT.Dom.create("div",{},"oat_winround_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winround_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winround_status");-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winround_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winround_resize_b"),OAT.Dom.append([e.dom.td_rb,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);OAT.Browser.isIE?(OAT.addTextNode(e.dom.container,'<table class="oat_winround_wrapper"><tr><td class="oat_winround_lt"></td><td class="oat_winround_t"></td><td class="oat_winround_rt"></td></tr><tr><td class="oat_winround_l"></td><td class="oat_winround_m"></td><td class="oat_winround_r"></td></tr><tr><td class="oat_winround_lb"></td><td class="oat_winround_b"></td><td class="oat_winround_rb"></td></tr></table>'),e.dom.container.childNodes[0].childNodes[0].childNodes[0].childNodes[1].appendChild(e.dom.title),e.dom.container.childNodes[0].childNodes[0].childNodes[1].childNodes[1].appendChild(e.dom.content),e.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[1].appendChild(e.dom.status),e.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[2].appendChild(e.dom.buttons.r)):(OAT.Dom.append([e.dom.tr_t,e.dom.td_lt,e.dom.td_t,e.dom.td_rt]),OAT.Dom.append([e.dom.tr_m,e.dom.td_l,e.dom.td_m,e.dom.td_r]),OAT.Dom.append([e.dom.tr_b,e.dom.td_lb,e.dom.td_b,e.dom.td_rb]),OAT.Dom.append([e.dom.table,e.dom.tr_t,e.dom.tr_m,e.dom.tr_b]),OAT.Dom.append([e.dom.td_t,e.dom.title]),OAT.Dom.append([e.dom.td_m,e.dom.content]),OAT.Dom.append([e.dom.td_b,e.dom.status]),OAT.Dom.append([e.dom.container,e.dom.table]));e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinODS=function(e){OAT.Style.include("winods.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winods_container");e.dom.resizeContainer=e.dom.container;e.dom.content=OAT.Dom.create("div",{},"oat_winods_content");e.dom.title=OAT.Dom.create("div",{},"oat_winods_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winods_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winods_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winods_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winods_resize_b"),OAT.Dom.append([e.dom.container,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinManager={stackingGroups:{},addWindow:function(e,r){if(e in OAT.WinManager.stackingGroups)var t=OAT.WinManager.stackingGroups[e];else t=new OAT.Layers(e),OAT.WinManager.stackingGroups[e]=t;t.addLayer(r,"click")},removeWindow:function(){if(zI in OAT.WinManager.stackingGroups)var e=OAT.WinManager.stackingGroups[zI];else e=new OAT.Layers(zI),OAT.WinManager.stackingGroups[zI]=e;e.removeLayer(container)}};try{OAT.Loader.featureLoaded("win")}catch(e){}OAT.Resize={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,element:[],mouse_x:0,mouse_y:0,move:function(e){if(OAT.Resize.element.length){for(var r=e.clientX-OAT.Resize.mouse_x,t=e.clientY-OAT.Resize.mouse_y,a=1,s=0;s<OAT.Resize.element.length;s++){var i=OAT.Resize.element[s][0],i=OAT.Dom.getWH(i),f=OAT.Resize.element[s][2],l=r,n=t;switch(OAT.Resize.element[s][1]){case OAT.Resize.TYPE_X:n=0;break;case-OAT.Resize.TYPE_X:l=-r;n=0;break;case OAT.Resize.TYPE_Y:l=0;break;case-OAT.Resize.TYPE_Y:l=0;n=-t;break;case-OAT.Resize.TYPE_XY:l=-r,n=-t}f(i[0]+l,i[1]+n)&&(a=0)}if(a){for(s=0;s<OAT.Resize.element.length;s++)switch(i=OAT.Resize.element[s][0],OAT.Resize.element[s][1]){case OAT.Resize.TYPE_X:OAT.Dom.resizeBy(i,r,0);break;case-OAT.Resize.TYPE_X:OAT.Dom.resizeBy(i,-r,0);break;case OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(i,0,t);break;case-OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(i,0,-t);break;case OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(i,r,t);break;case-OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(i,-r,-t)}OAT.Resize.mouse_x=e.clientX;OAT.Resize.mouse_y=e.clientY}}},up:function(){for(var e=0;e<OAT.Resize.element.length;e++)OAT.Resize.element[e][3]();OAT.Resize.element=[]},create:function(e,r,t,a,s){var i=OAT.$(e),e=OAT.$(r),r=function(){return!1},f=function(){return!1};a&&(r=a);s&&(f=s);switch(t){case OAT.Resize.TYPE_XY:i.style.cursor="nw-resize";break;case OAT.Resize.TYPE_X:i.style.cursor="w-resize";break;case OAT.Resize.TYPE_Y:i.style.cursor="n-resize"}a=function(e){OAT.Resize.element=i._Resize_movers;OAT.Resize.mouse_x=e.clientX;OAT.Resize.mouse_y=e.clientY;e.cancelBubble=!0};i._Resize_movers||(OAT.Dom.attach(i,"mousedown",a),i._Resize_movers=[]);i._Resize_movers.push([e,t,r,f])},remove:function(e,r){var t=OAT.$(e);OAT.$(r);if(t._Resize_movers){for(var a=-1,s=0;s<t._Resize_movers.length;s++)t._Resize_movers[s][0]==r&&(a=s);-1!=a&&t._Resize_movers.splice(a,1)}},removeAll:function(e){e=OAT.$(e);e._Resize_movers&&(e._Resize_movers=[])},createDefault:function(e,r,t){if(OAT.Preferences.allowDefaultResize){var a=OAT.Dom.create("div",{position:"absolute",width:"10px",height:"10px",right:"0px",fontSize:"1px",bottom:"0px"});e.appendChild(a);OAT.Resize.create(a,e,OAT.Resize.TYPE_XY,r,t);OAT.Dom.hide(a);var s=function(){a._Resize_pending&&OAT.Dom.hide(a)};OAT.Dom.attach(e,"mouseover",(function(){OAT.Dom.show(a);a._Resize_pending=0}));OAT.Dom.attach(e,"mouseout",(function(){a._Resize_pending=1;setTimeout(s,2e3)}))}}};if(typeof document!="undefined"){OAT.Dom.attach(document,"mousemove",OAT.Resize.move);OAT.Dom.attach(document,"mouseup",OAT.Resize.up)}try{OAT.Loader.featureLoaded("resize")}catch(e){}OAT.XMLHTTP=function(){this.obj=this.iframe=!1;this.open=function(e,r,t){this.iframe?this.temp_src=r:this.obj.open(e,r,t)};this.send=function(e){this.iframe?this.ifr.src=this.temp_src:this.obj.send(e)};this.setResponse=function(e){this.iframe?OAT.Dom.attach(this.ifr,"load",e):this.obj.onreadystatechange=e};this.getResponseText=function(){};this.getResponseXML=function(){return this.iframe?(alert("IFRAME mode active -> XML data not supported"),""):this.obj.responseXML};this.getReadyState=function(){return this.iframe?4:this.obj.readyState};this.getStatus=function(){return this.iframe?200:this.obj.status};this.setRequestHeader=function(e,r){this.iframe||this.obj.setRequestHeader(e,r)};this.getAllResponseHeaders=function(){return!this.iframe?this.obj.getAllResponseHeaders():{}};this.isIframe=function(){return this.iframe};window.XMLHttpRequest?this.obj=new XMLHttpRequest:window.ActiveXObject&&(this.obj=new ActiveXObject("Microsoft.XMLHTTP"));this.obj||(this.iframe=!0,this.ifr=OAT.Dom.create("iframe"),this.ifr.style.display="none",this.ifr.src="javascript:;",document.body.appendChild(this.ifr))};OAT.XMLHTTP_supported=function(){return!(new OAT.XMLHTTP).isIframe()};try{OAT.Loader.featureLoaded("ajax")}catch(e){}OAT.AnchorData={active:!1,window:!1};OAT.Anchor={appendContent:function(e){if(e.content&&e.window){"function"==typeof e.content&&(e.content=e.content());var r=e.window;OAT.Dom.clear(r.dom.content);r.dom.content.appendChild(e.content);OAT.Anchor.fixSize(r)}},callForData:function(e,r){var t=e.window;e.stat=1;e.status&&OAT.addTextNode(t.dom.status,e.status);var a=e.datasource;if(a){a.connection=e.connection;var s=e.elm.innerHTML,i=function(){t.dom.caption.innerHTML=e.elm.innerHTML;if(e.title)t.dom.caption.innerHTML=e.title};a.bindRecord(i);a.bindEmpty(i)}switch(e.result_control){case"grid":i=new OAT.FormObject.grid(0,0,0,1);i.showAll=!0;e.content=i.elm;i.elm.style.position="relative";i.init();a.bindRecord(i.bindRecordCallback);a.bindPage(i.bindPageCallback);a.bindHeader(i.bindHeaderCallback);break;case"form":var f=!1;e.content=OAT.Dom.create("div");f=new OAT.Form(e.content,{onDone:function(){t.resizeTo(f.totalWidth+5,f.totalHeight+5);e.anchorTo(r[0],r[1])}});a.bindFile((function(e){e=OAT.Xml.createXmlDoc(e);f.createFromXML(e)}));break;case"timeline":i=new OAT.FormObject.timeline(0,20,0);e.content=i.elm;i.elm.style.position="relative";i.elm.style.width=e.width-5+"px";i.elm.style.height=e.height-65+"px";i.init();for(var l=0;l<i.datasources[0].fieldSets.length;l++)i.datasources[0].fieldSets[l].realIndexes=[l];a.bindPage(i.bindPageCallback)}OAT.Anchor.appendContent(e);if(a){a.options.query=a.options.query.replace(/\$link_name/g,s);e.connection.options.endpoint=e.href;e.connection.options.url=e.href;switch(a.type){case OAT.DataSourceData.TYPE_SPARQL:s=new OAT.SparqlQuery;s.fromString(a.options.query);s=s.variables.length?"format=xml":"format=rdf";a.options.query="query="+encodeURIComponent(a.options.query)+"&"+s;break;case OAT.DataSourceData.TYPE_GDATA:a.options.query=a.options.query?"q="+encodeURIComponent(a.options.query):""}a.advanceRecord(0)}},fixSize:function(e){setTimeout((function(){}),50)},assign:function(e,r){var t=OAT.$(e),a={href:!1,newHref:"javascript:void(0)",connection:!1,datasource:!1,content:!1,status:!1,title:!1,result_control:"grid",activation:"hover",width:340,height:!1,elm:t,window:!1,arrow:!1,type:OAT.WinData.TYPE_RECT,visibleButtons:"cr",enabledButtons:"cr",template:!1},s;for(s in r)a[s]=r[s];var i=new OAT.Win({outerWidth:a.width,outerHeight:a.height,title:"",type:a.type,status:a.status,visibleButtons:a.visibleButtons,enabledButtons:a.enabledButtons,template:a.template,containerQuery:a.containerQuery});OAT.Dom.attach(i.dom.container,"mouseover",(function(){var e=OAT.AnchorData.active;e&&"hover"==e.activation&&e.endClose()}));OAT.Dom.attach(i.dom.container,"mouseout",(function(){var e=OAT.AnchorData.active;e&&"hover"==e.activation&&e.startClose()}));s=OAT.Dom.create("div",{});a.window=i;i.close=function(){OAT.Dom.hide(i.dom.container)};i.onclose=i.close;i.close();a.stat=0;!a.href&&"href"in t&&(a.href=t.href);"a"==t.tagName.toString().toLowerCase()&&OAT.Dom.changeHref(t,a.newHref);a.displayRef=function(e){var r=a.window;r.hide();OAT.AnchorData.active=a;e=OAT.Dom.eventPos(e);OAT.AnchorData.window=r;a.stat?OAT.Anchor.appendContent(a):OAT.Anchor.callForData(a,e);a.activation=="focus"&&(e=OAT.Dom.position(t));a.anchorTo(e[0],e[1]);r.show();a.anchorTo(e[0],e[1])};a.displayRef2=function(e){var r=a.window;r.hide();OAT.AnchorData.active=a;OAT.AnchorData.window=r;a.stat?OAT.Anchor.appendContent(a):OAT.Anchor.callForData(a,e);a.activation=="focus"&&(e=OAT.Dom.position(t));a.anchorTo(e[0],e[1]);r.show();a.anchorTo(e[0],e[1])};a.anchorTo=function(e,r){var t=a.window,s=OAT.Dom.getFreeSpace(e,r),i=OAT.Dom.getWH(t.dom.container);if(s[1])var f=r-30-i[1];else{f=r+30}if(s[0]){s=e+20-i[0]}else{s=e-30}s<0&&(s=10);f<0&&(f=10);t.moveTo(s,f-20)};a.closeRef=function(){if(a.closeFlag){a.window.hide();OAT.AnchorData.active=false}};a.close=function(){a.window.hide()};a.startClose=function(){a.closeFlag=1;setTimeout(a.closeRef,1e3)};a.endClose=function(){a.closeFlag=0};switch(a.activation){case"hover":OAT.Dom.attach(t,"mouseover",a.displayRef);OAT.Dom.attach(t,"mouseout",a.startClose);break;case"click":OAT.Dom.attach(t,"click",a.displayRef);break;case"dblclick":OAT.Dom.attach(t,"dblclick",a.displayRef);break;case"focus":OAT.Dom.attach(t,"focus",a.displayRef),OAT.Dom.attach(t,"blur",a.close)}return a},close:function(e,r){e=OAT.$(e);"BODY"!=e.tagName&&(e.className.match(/^oat_win.+_container$/)?(OAT.Dom.hide(e),r&&this.close(e.parentNode)):this.close(e.parentNode))},openAnchor:function(){var r=this.window;r.hide();OAT.AnchorData.active=this;b=OAT.Dom.eventPos(b);OAT.AnchorData.window=r;a.stat?OAT.Anchor.appendContent(a):OAT.Anchor.callForData(a,b);a.activation=="focus"&&(b=OAT.Dom.position(e));a.anchorTo(b[0],b[1]);r.show();a.anchorTo(b[0],b[1])}};try{OAT.Loader.featureLoaded("anchor")}catch(e){}OAT.Animation=function(e,r){var t=this;this.elm=OAT.$(e);this.options={delay:50,startFunction:function(){},conditionFunction:function(){},stepFunction:function(){},stopFunction:function(){}};for(var a in r)t.options[a]=r[a];this.step=function(){setTimeout((function(){t.running&&(t.options.conditionFunction(t)?(t.running=0,t.options.stopFunction(t),OAT.MSG.send(t,OAT.MSG.ANIMATION_STOP,t)):(t.options.stepFunction(t),t.step(t)))}),t.options.delay)};this.start=function(){t.running=1;t.options.startFunction(t);t.step()};this.stop=function(){t.running=0}};OAT.AnimationSize=function(e,r){var t=this;this.options={width:-1,height:-1,delay:50,speed:1};for(var a in r)t.options[a]=r[a];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e.stepX=0;e.stepY=0;var r=OAT.Dom.getWH(e.elm);e.width=r[0];e.height=r[1];e.diffX=-1==t.options.width?0:t.options.width-r[0];e.diffY=-1==t.options.height?0:t.options.height-r[1];e.signX=0<=e.diffX?1:-1;e.signY=0<=e.diffY?1:-1;var r=e.diffX*e.diffX,a=e.diffY*e.diffY;e.stepX=e.signX*Math.sqrt(t.options.speed*t.options.speed*r/(r+a));e.stepY=e.signY*Math.sqrt(t.options.speed*t.options.speed*a/(r+a))},stopFunction:function(e){-1!=t.options.width&&(e.elm.style.width=t.options.width+"px");-1!=t.options.height&&(e.elm.style.height=t.options.height+"px")},conditionFunction:function(e){var r=0<e.signX?e.width>=t.options.width:e.width<=t.options.width,e=0<e.signY?e.height>=t.options.height:e.height<=t.options.height;-1==t.options.width&&(r=1);-1==t.options.height&&(e=1);return r&&e},stepFunction:function(e){e.width+=e.stepX;e.height+=e.stepY;var r=parseInt(e.width),a=parseInt(e.height);-1!=t.options.width&&(e.elm.style.width=(0<=r?r:0)+"px");-1!=t.options.height&&(e.elm.style.height=(0<=a?a:0)+"px")}});this.start=t.animation.start;this.stop=t.animation.stop};OAT.AnimationPosition=function(e,r){var t=this;this.options={left:-1,top:-1,delay:50,speed:1};for(var a in r)t.options[a]=r[a];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e.stepX=0;e.stepY=0;var r=OAT.Dom.getLT(e.elm);e.left=r[0];e.top=r[1];e.diffX=-1==t.options.left?0:t.options.left-r[0];e.diffY=-1==t.options.top?0:t.options.top-r[1];e.signX=0<=e.diffX?1:-1;e.signY=0<=e.diffY?1:-1;var r=e.diffX*e.diffX,a=e.diffY*e.diffY;e.stepX=e.signX*Math.sqrt(t.options.speed*t.options.speed*r/(r+a));e.stepY=e.signY*Math.sqrt(t.options.speed*t.options.speed*a/(r+a))},stopFunction:function(e){-1!=t.options.left&&(e.elm.style.left=t.options.left+"px");-1!=t.options.top&&(e.elm.style.top=t.options.top+"px")},conditionFunction:function(e){var r=0<e.signX?e.left>=t.options.left:e.left<=t.options.left,e=0<e.signY?e.top>=t.options.top:e.top<=t.options.top;-1==t.options.left&&(r=1);-1==t.options.top&&(e=1);return r&&e},stepFunction:function(e){e.left+=e.stepX;e.top+=e.stepY;var r=parseInt(e.left),a=parseInt(e.top);-1!=t.options.left&&(e.elm.style.left=r+"px");-1!=t.options.top&&(e.elm.style.top=a+"px")}});this.start=t.animation.start;this.stop=t.animation.stop};OAT.AnimationOpacity=function(e,r){var t=this;this.options={opacity:1,delay:50,speed:.1};for(var a in r)t.options[a]=r[a];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e.opacity=1;!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i)&&(e.opacity=parseFloat(OAT.Dom.style(e.elm,"opacity")));if(OAT.isIE()){var r=OAT.Dom.style(e.elm,"filter").match(/alpha\(opacity=([^\)]+)\)/);r&&(e.opacity=parseFloat(r[1])/100)}e.step_=1;e.diff=t.options.opacity-e.opacity;e.sign=0<=e.diff?1:-1;e.step_=e.sign*t.options.speed},stopFunction:function(e){OAT.Style.opacity(e.elm,t.options.opacity)},conditionFunction:function(e){return 0<e.sign?e.opacity+1e-4>=t.options.opacity:e.opacity-1e-4<=t.options.opacity},stepFunction:function(e){e.opacity+=e.step_;OAT.Style.opacity(e.elm,e.opacity)}});this.start=t.animation.start;this.stop=t.animation.stop};OAT.AnimationCSS=function(e,r){var t=this;this.options={delay:50,property:!1,start:0,step:1,stop:10};for(var a in r)t.options[a]=r[a];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e[t.options.property]=t.options.start;e.elm.style[t.options.property]=t.options.start},stopFunction:function(e){e.elm.style[t.options.property]=t.options.stop},conditionFunction:function(e){return e[t.options.property]==t.options.stop},stepFunction:function(e){e[t.options.property]+=t.options.step;e.elm.style[t.options.property]=e[t.options.property]}});this.start=t.animation.start;this.stop=t.animation.stop};try{OAT.Loader.featureLoaded("animation")}catch(e){}OAT.getURL=function(){try{var e=location.href.substring(0,location.href.lastIndexOf("/"));var r=e;if(r.substr(0,7)=="http://")r=r.substr(7);var t="";var a=r.indexOf("/");if(a>-1){t=r.substr(a+1);r=r.substr(0,a)}var s=location.href.substring(e.length+1,location.href.length+1);var a=s.indexOf("?");if(a>-1){s=s.substring(0,a)}a=s.indexOf("#");if(a>-1){s=s.substring(0,a)}var i="";a=s.indexOf(".");if(a>-1){i=s.substring(a+1);s=s.substr(0,a)}var f=s;if(i!="")f+="."+i;if(f=="")s="index";args=location.search.substr(1).split("?");return t+s}catch(e){return""}};OAT.PartialSort=function(e,r,t,a,s,i){var f=[];for(var l=0;l<=t-r;l++){f[l]=e[r+l]}if(i[a]){f.sort(function(e){return function(r,t){return parseInt(r[e])===parseInt(t[e])?0:parseInt(r[e])<parseInt(t[e])?-1:1}}(a))}else{f.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]<t[e]?-1:1}}(a))}if(a<s-1){var n=f[0][a];var o=0;for(var u=0;u<f.length;u++){if(n!=f[u][a]){n=f[u][a];f=OAT.PartialSort(f,o,u-1,a+1,s,i);o=u}else if(u==f.length-1){f=OAT.PartialSort(f,o,u,a+1,s,i)}}}for(var l=r;l<=t;l++){e[l]=f[l-r]}return e};var currPageNumber=[];OAT.partialTablePagination=function(e,r){var t={rowsPerPage:5,currPage:1,jstype:"pivot",optionsForRows:[5,10,25,50,100],ignoreRows:[],topNav:false,cantPages:10};r=jQuery.extend(t,r);return e.each((function(){var e=jQuery(this)[0];var a,s,i,f,l,n,o;a="#tablePagination_totalPages";s="#tablePagination_currPage";i="#"+r.controlName+"tablePagination_rowsPerPage";f="#tablePagination_firstPage";l="#tablePagination_prevPage";n="#tablePagination_nextPage";o="#tablePagination_lastPage";var u=t.topNav?"prev":"next";try{t.rowsPerPage=parseInt(t.rowsPerPage)}catch(e){t.rowsPerPage=10}var v=jQuery.makeArray(jQuery("tbody tr",e));jQuery.grep(v,(function(e,r){return jQuery.inArray(e,t.ignoreRows)==-1}),false);var c=d();currPageNumber[r.controlName]=t.currPage>c?1:t.currPage;if(jQuery.inArray(t.rowsPerPage,t.optionsForRows)==-1)t.optionsForRows.push(t.rowsPerPage);function d(){return t.cantPages}function m(a,i){if(a<1||a>jQuery("#"+r.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].innerHTML.replace("&nbsp;",""))return;currPageNumber[r.controlName]=a;jQuery(e)[u]().find(s).val(currPageNumber[r.controlName]);currPageNumber[r.controlName]>1?jQuery("#tablePagination_firstPage,#tablePagination_prevPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_firstPage,#tablePagination_prevPage").addClass("disabled_pivot_button");currPageNumber[r.controlName]!=c?jQuery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button");if(r.control&&r.jstype=="table"){var f=i?t.rowsPerPage:OAT_JS.grid.gridData[r.controlUcId].rowsPerPage;r.control.getDataForTable(r.controlUcId,a,f,i,"","","","","",true);setTimeout((function(){c=r.control.getActualCantPages(r.controlUcId);currPageNumber[r.controlName]!=c?jQuery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button")}),500)}else if(r.control){var f=i?t.rowsPerPage:r.control.rowsPerPage;r.control.getDataForPivot(r.controlUcId,a,f,i,"","","","","",true)}}function h(){var a=t.optionsForRows;a.sort((function(e,r){return e-r}));var s=jQuery(e)[u]().find(i)[0];s.length=0;for(var f=0;f<a.length;f++){if(a[f]==t.rowsPerPage){s.options[f]=new Option(a[f],a[f],true,true)}else{s.options[f]=new Option(a[f],a[f])}}if(c==1||c==0){jQuery("#"+r.controlName+"_tablePagination_paginater").css("display","none")}else{jQuery("#"+r.controlName+"_tablePagination_paginater").css("display","")}}function p(){var e=1;try{var t=100;if(OAT.isWebkit()&&!(jQuery("#"+r.controlName).closest(".gxwebcomponent").length>0)){t=t*100}if(currPageNumber[r.controlName]>t*10){if(jQuery("#"+r.controlName).closest(".gxwebcomponent").length>0){e=e+2}var a=currPageNumber[r.controlName]/t;while(a>10){a=a/10;e++}}}catch(e){}var s=currPageNumber[r.controlName]==1?" disabled_pivot_button":"";var i=currPageNumber[r.controlName]==c?" disabled_pivot_button":"";var f=navigator.userAgent.toLowerCase();f.indexOf("android")>-1;if(!OAT.isSD()){var l=[];l.push("<div id='"+r.controlName+"_tablePagination' class='pivot_pag_div'>");l.push("<span id='tablePagination_perPage'>");l.push("<select id='"+r.controlName+"tablePagination_rowsPerPage'></select>");l.push(" "+r.translations.GXPL_QViewerJSPerPage+" ");l.push("</span>");l.push("<span id='"+r.controlName+"_tablePagination_paginater'>");l.push("<div class='pagefirst "+s+"' id='tablePagination_firstPage' >");l.push('<i class="material-icons">first_page</i>');l.push("</div>");l.push("<div class='pageprev "+s+"' id='tablePagination_prevPage' >");l.push('<i class="material-icons">navigate_before</i>');l.push("</div>");l.push("<span style=''>&nbsp;"+r.translations.GXPL_QViewerJSPage+"&nbsp;</span>");l.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[r.controlName]+"' size='"+e+"'>");l.push("<span>&nbsp;"+r.translations.GXPL_QViewerJSOf+"</span><span id='tablePagination_totalPages'>&nbsp;"+c+"</span>");l.push("<div class='pagenext "+i+"' id='tablePagination_nextPage' >");l.push('<i class="material-icons">navigate_next</i>');l.push("</div>");l.push("<div class='pagelast "+i+"' id='tablePagination_lastPage'>");l.push('<i class="material-icons">last_page</i>');l.push("</div>");l.push("</span>");l.push("</div>");return l.join("").toString()}else{var l=[];l.push("<div id='"+r.controlName+"_tablePagination' class='pivot_pag_div pivot_pag_div_sd'>");l.push("<span id='tablePagination_perPage'>");l.push("<select id='"+r.controlName+"tablePagination_rowsPerPage'><option value='5'>5</option></select>");l.push(" "+r.translations.GXPL_QViewerJSPerPage+" ");l.push("</span>");l.push("<span id='"+r.controlName+"_tablePagination_paginater'>");l.push("<div class='pagefirst "+s+"' id='tablePagination_firstPage' >");l.push('<i class="material-icons">first_page</i>');l.push("</div>");l.push("<div class='pageprev "+s+"' id='tablePagination_prevPage' >");l.push('<i class="material-icons">navigate_before</i>');l.push("</div>");l.push("<span style=''>&nbsp;"+r.translations.GXPL_QViewerJSPage+"&nbsp;</span>");l.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[r.controlName]+"' size='"+e+"'>");l.push("<span>&nbsp;"+r.translations.GXPL_QViewerJSOf+"</span><span id='tablePagination_totalPages'>&nbsp;"+c+"</span>");l.push("<div class='pagenext "+i+"' id='tablePagination_nextPage' >");l.push('<i class="material-icons">navigate_next</i>');l.push("</div>");l.push("<div class='pagelast "+i+"' id='tablePagination_lastPage'>");l.push('<i class="material-icons">last_page</i>');l.push("</div>");l.push("</span>");l.push("</div>");return l.join("").toString()}}if(jQuery(e)[u]().find(a).length==0){if(t.topNav){jQuery(this).before(p())}else{jQuery(this).after(p())}}else{jQuery(e)[u]().find(s).val(currPageNumber[r.controlName])}h();jQuery(e)[u]().find(f).bind("click",(function(e){m(1,false)}));jQuery(e)[u]().find(l).bind("click",(function(e){m(currPageNumber[r.controlName]-1,false)}));jQuery(e)[u]().find(n).bind("click",(function(e){m(parseInt(currPageNumber[r.controlName])+1,false)}));jQuery(e)[u]().find(o).bind("click",(function(e){m(parseInt(jQuery("#"+r.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].textContent.replace("&nbsp;","")),false)}));jQuery(e)[u]().find(s).bind("change",(function(e){m(parseInt(this.value,10),false)}));jQuery(e)[u]().find(i).bind("change",(function(e){t.rowsPerPage=parseInt(this.value,10);c=d();m(1,true)}))}))}}));const myPivotScss="#QUERYVIEWER1Container{width:100%;height:100%;overflow:auto}";const Pivot=class{constructor(e){registerInstance(this,e);this.metadata='<?xml version = "1.0" encoding = "UTF-8"?>\n\r\n<OLAPCube Version="2" format="compact" decimalSeparator="." thousandsSeparator="," dateFormat="MDY" textForNullValues="" ShowDataLabelsIn="Columns">\n\t<OLAPDimension name="Element1" displayName="Datos Dsc" description="Datos Dsc" dataField="F1" visible="Yes" axis="Rows" canDragToPages="true" summarize="yes" align="left" picture="" dataType="character" format="">\n\t</OLAPDimension>\n\t<OLAPDimension name="Element2" displayName="Datos Codigo" description="Datos Codigo" dataField="F2" visible="Yes" axis="Rows" canDragToPages="true" summarize="yes" align="left" picture="" dataType="character" format="">\n\t</OLAPDimension>\n\t<OLAPMeasure name="Element3" displayName="Datos Valor" description="Datos Valor" dataField="F3" visible="Yes" aggregation="" align="right" picture="ZZZ9" targetValue="0" maximumValue="0" dataType="integer" format="">\n\t</OLAPMeasure>\n</OLAPCube>\n';this.data=undefined;this.qv={collection:{QUERYVIEWER1_Queryviewer1:{AutoRefreshGroup:"",debugServices:false,ControlName:"Queryviewer1",Metadata:{Axes:[{RaiseItemClick:true},{RaiseItemClick:true}],Data:[{RaiseItemClick:true},{RaiseItemClick:true}]}}},fadeTimeouts:{}};this.qViewer={xml:{metadata:this.metadata},pivotParams:{page:"QUERYVIEWER1_Queryviewer1_GeneralQuery1_pivot_page",content:"QUERYVIEWER1_Queryviewer1_GeneralQuery1_pivot_content",container:document.getElementById("QUERYVIEWER1Container"),RealType:"PivotTable",ObjectName:"General.Query1",ControlName:"Queryviewer1",PageSize:20,metadata:this.metadata,UcId:"QUERYVIEWER1_Queryviewer1",AutoResize:false,DisableColumnSort:false,RememberLayout:true,ShowDataLabelsIn:"Columns",ServerPaging:true,ServerPagingPivot:true,ServerPagingCacheSize:0,UseRecordsetCache:true,AllowSelection:false,SelectLine:true,TotalForColumns:"Yes",Title:""}};this.QueryViewerTranslations={GXPL_QViewerSinceTheBeginningTrend:"Trend Since The Beginning",GXPL_QViewerLastDayTrend:"Trend Last Day",GXPL_QViewerLastHourTrend:"Trend Last hour",GXPL_QViewerJSAllOption:"Todos",GXPL_QViewerJSAscending:"Ascending",GXPL_QViewerJSDescending:"Descendiente",GXPL_QViewerJSSubtotals:"Subtotal",GXPL_QViewerJSRestoreDefaultView:"Restore",GXPL_QViewerJSPivotDimensionToColumn:"To COlumns",GXPL_QViewerJSPivotDimensionToRow:"To Dimensions",GXPL_QViewerJSMoveToFilterBar:"To Filters",GXPL_QViewerJSAll:"ALL",GXPL_QViewerJSNone:"NONE",GXPL_QViewerJSReverse:"Revert",GXPL_QViewerSearch:"Search",GXPL_QViewerInfoUser:"User Info",GXPL_QViewerJSDropFiltersHere:"Drop her filters",GXPL_QViewerPopupTitle:"Title p",GXPL_QViewerJSVisibleColumns:"Visible columns",GXPL_QViewerContextMenuExportXml:"Export to XML",GXPL_QViewerContextMenuExportHtml:"To Html",GXPL_QViewerContextMenuExportPdf:"To PDF",GXPL_QViewerContextMenuExportXls2003:"To xls",GXPL_QViewerContextMenuExportXlsx:"To Xlsx",GXPL_QViewerJSMeasures:"Measures",GXPL_QViewerJSValue:"Value",GXPL_QViewerJSTotal:"Grand Total",GXPL_QViewerJSTotalFor:"Total for",GXPL_QViewerJSPerPage:"Roes:",GXPL_QViewerJSPage:"Pags:",GXPL_QViewerJSOf:"of",GXPL_QViewerJSMoveColumnToLeft:"to left",GXPL_QViewerJSMoveColumnToRight:"to right"}}handledataforpivottable(e){let r='<?xml version = "1.0" encoding = "UTF-8"?>\n\r\n<Recordset RecordCount="50" PageCount="3">\n\t<Page PageNumber="1">\n\t\t<Columns>\n\t\t\t<Header DataField="F3">\n\t\t\t</Header>\n\t\t</Columns>\n\t\t<Rows>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>151                 </F1>\n\t\t\t\t\t<F2>1129                </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>29</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>151                 </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>29</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>51                  </F1>\n\t\t\t\t\t<F2>15                  </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>15</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>51                  </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>15</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>51P                 </F1>\n\t\t\t\t\t<F2>156                 </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>1</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>51P                 </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>1</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>5P                  </F1>\n\t\t\t\t\t<F2>352                 </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>2</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>5P                  </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>2</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>89                  </F1>\n\t\t\t\t\t<F2>1895                </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>15</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>89                  </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>15</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>AAB                 </F1>\n\t\t\t\t\t<F2>A32                 </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>32</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>AAB                 </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>32</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>AAM                 </F1>\n\t\t\t\t\t<F2>31                  </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>31</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>AAM                 </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>31</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>AB36                </F1>\n\t\t\t\t\t<F2>36                  </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>36</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>AB36                </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>36</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>AC32                </F1>\n\t\t\t\t\t<F2>32                  </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>32</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>AC32                </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>32</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header>\n\t\t\t\t\t<F1>AC34                </F1>\n\t\t\t\t\t<F2>34                  </F2>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>34</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t\t<Row>\n\t\t\t\t<Header Subtotal="true">\n\t\t\t\t\t<F1>AC34                </F1>\n\t\t\t\t</Header>\n\t\t\t\t<Cells>\n\t\t\t\t\t<Cell>34</Cell>\n\t\t\t\t</Cells>\n\t\t\t</Row>\n\t\t</Rows>\n\t</Page>\n</Recordset>\n';let t=r;if(typeof e.parameter.callback=="function")e.parameter.callback(t)}render(){oat_pivotTable.renderJSPivot(this.qViewer.pivotParams,this.qv.collection,this.QueryViewerTranslations,this.qViewer);return h("div",{class:"gx_usercontrol qv-pivottable QueryViewer-pivottable",id:"QUERYVIEWER1Container"},h("div",{id:"QUERYVIEWER1_Queryviewer1_GeneralQuery1_pivot_page",class:"pivot_filter_div"}),h("div",{id:"QUERYVIEWER1_Queryviewer1_GeneralQuery1_pivot_content",class:"conteiner_table_div"}))}};Pivot.style=myPivotScss;export{Pivot as my_pivot};