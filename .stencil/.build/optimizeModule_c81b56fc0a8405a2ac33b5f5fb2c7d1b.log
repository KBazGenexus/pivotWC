import{r as registerInstance,h}from"./p-18edb0b8.js";var commonjsGlobal=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function createCommonjsModule(e,r,t){return t={path:r,exports:{},require:function(e,r){return commonjsRequire()}},e(t,t.exports),t.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var jquery=createCommonjsModule((function(e){
/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */
(function(r,t){{e.exports=r.document?t(r,true):function(e){if(!e.document){throw new Error("jQuery requires a window with a document")}return t(e)}}})(typeof window!=="undefined"?window:commonjsGlobal,(function(e,r){var t=[];var i=Object.getPrototypeOf;var a=t.slice;var s=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)};var n=t.push;var f=t.indexOf;var l={};var o=l.toString;var u=l.hasOwnProperty;var c=u.toString;var v=c.call(Object);var d={};var h=function e(r){return typeof r==="function"&&typeof r.nodeType!=="number"&&typeof r.item!=="function"};var p=function e(r){return r!=null&&r===r.window};var m=e.document;var T={type:true,src:true,nonce:true,noModule:true};function A(e,r,t){t=t||m;var i,a,s=t.createElement("script");s.text=e;if(r){for(i in T){a=r[i]||r.getAttribute&&r.getAttribute(i);if(a){s.setAttribute(i,a)}}}t.head.appendChild(s).parentNode.removeChild(s)}function y(e){if(e==null){return e+""}return typeof e==="object"||typeof e==="function"?l[o.call(e)]||"object":typeof e}var w="3.7.1",O=/HTML$/i,g=function(e,r){return new g.fn.init(e,r)};g.fn=g.prototype={jquery:w,constructor:g,length:0,toArray:function(){return a.call(this)},get:function(e){if(e==null){return a.call(this)}return e<0?this[e+this.length]:this[e]},pushStack:function(e){var r=g.merge(this.constructor(),e);r.prevObject=this;return r},each:function(e){return g.each(this,e)},map:function(e){return this.pushStack(g.map(this,(function(r,t){return e.call(r,t,r)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(g.grep(this,(function(e,r){return(r+1)%2})))},odd:function(){return this.pushStack(g.grep(this,(function(e,r){return r%2})))},eq:function(e){var r=this.length,t=+e+(e<0?r:0);return this.pushStack(t>=0&&t<r?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:n,sort:t.sort,splice:t.splice};g.extend=g.fn.extend=function(){var e,r,t,i,a,s,n=arguments[0]||{},f=1,l=arguments.length,o=false;if(typeof n==="boolean"){o=n;n=arguments[f]||{};f++}if(typeof n!=="object"&&!h(n)){n={}}if(f===l){n=this;f--}for(;f<l;f++){if((e=arguments[f])!=null){for(r in e){i=e[r];if(r==="__proto__"||n===i){continue}if(o&&i&&(g.isPlainObject(i)||(a=Array.isArray(i)))){t=n[r];if(a&&!Array.isArray(t)){s=[]}else if(!a&&!g.isPlainObject(t)){s={}}else{s=t}a=false;n[r]=g.extend(o,s,i)}else if(i!==undefined){n[r]=i}}}}return n};g.extend({expando:"jQuery"+(w+Math.random()).replace(/\D/g,""),isReady:true,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var r,t;if(!e||o.call(e)!=="[object Object]"){return false}r=i(e);if(!r){return true}t=u.call(r,"constructor")&&r.constructor;return typeof t==="function"&&c.call(t)===v},isEmptyObject:function(e){var r;for(r in e){return false}return true},globalEval:function(e,r,t){A(e,{nonce:r&&r.nonce},t)},each:function(e,r){var t,i=0;if(_(e)){t=e.length;for(;i<t;i++){if(r.call(e[i],i,e[i])===false){break}}}else{for(i in e){if(r.call(e[i],i,e[i])===false){break}}}return e},text:function(e){var r,t="",i=0,a=e.nodeType;if(!a){while(r=e[i++]){t+=g.text(r)}}if(a===1||a===11){return e.textContent}if(a===9){return e.documentElement.textContent}if(a===3||a===4){return e.nodeValue}return t},makeArray:function(e,r){var t=r||[];if(e!=null){if(_(Object(e))){g.merge(t,typeof e==="string"?[e]:e)}else{n.call(t,e)}}return t},inArray:function(e,r,t){return r==null?-1:f.call(r,e,t)},isXMLDoc:function(e){var r=e&&e.namespaceURI,t=e&&(e.ownerDocument||e).documentElement;return!O.test(r||t&&t.nodeName||"HTML")},merge:function(e,r){var t=+r.length,i=0,a=e.length;for(;i<t;i++){e[a++]=r[i]}e.length=a;return e},grep:function(e,r,t){var i,a=[],s=0,n=e.length,f=!t;for(;s<n;s++){i=!r(e[s],s);if(i!==f){a.push(e[s])}}return a},map:function(e,r,t){var i,a,n=0,f=[];if(_(e)){i=e.length;for(;n<i;n++){a=r(e[n],n,t);if(a!=null){f.push(a)}}}else{for(n in e){a=r(e[n],n,t);if(a!=null){f.push(a)}}}return s(f)},guid:1,support:d});if(typeof Symbol==="function"){g.fn[Symbol.iterator]=t[Symbol.iterator]}g.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,r){l["[object "+r+"]"]=r.toLowerCase()}));function _(e){var r=!!e&&"length"in e&&e.length,t=y(e);if(h(e)||p(e)){return false}return t==="array"||r===0||typeof r==="number"&&r>0&&r-1 in e}function b(e,r){return e.nodeName&&e.nodeName.toLowerCase()===r.toLowerCase()}var x=t.pop;var S=t.sort;var I=t.splice;var k="[\\x20\\t\\r\\n\\f]";var q=new RegExp("^"+k+"+|((?:^|[^\\\\])(?:\\\\.)*)"+k+"+$","g");g.contains=function(e,r){var t=r&&r.parentNode;return e===t||!!(t&&t.nodeType===1&&(e.contains?e.contains(t):e.compareDocumentPosition&&e.compareDocumentPosition(t)&16))};var F=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function P(e,r){if(r){if(e==="\0"){return"ï¿½"}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e}g.escapeSelector=function(e){return(e+"").replace(F,P)};var N=m,D=n;(function(){var r,i,s,n,l,o=D,c,v,h,p,m,T=g.expando,A=0,y=0,w=re(),O=re(),_=re(),F=re(),P=function(e,r){if(e===r){l=true}return 0},E="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|"+"loop|multiple|open|readonly|required|scoped",C="(?:\\\\[\\da-fA-F]{1,6}"+k+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",j="\\["+k+"*("+C+")(?:"+k+"*([*^$|!~]?=)"+k+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+C+"))|)"+k+"*\\]",R=":("+C+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|"+".*"+")\\)|)",M=new RegExp(k+"+","g"),J=new RegExp("^"+k+"*,"+k+"*"),L=new RegExp("^"+k+"*([>+~]|"+k+")"+k+"*"),V=new RegExp(k+"|>"),B=new RegExp(R),U=new RegExp("^"+C+"$"),z={ID:new RegExp("^#("+C+")"),CLASS:new RegExp("^\\.("+C+")"),TAG:new RegExp("^("+C+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+k+"*(even|odd|(([+-]|)(\\d*)n|)"+k+"*(?:([+-]|)"+k+"*(\\d+)|))"+k+"*\\)|)","i"),bool:new RegExp("^(?:"+E+")$","i"),needsContext:new RegExp("^"+k+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+k+"*((?:-\\d)?\\d*)"+k+"*\\)|)(?=[^-]|$)","i")},H=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,X=/[+~]/,$=new RegExp("\\\\[\\da-fA-F]{1,6}"+k+"?|\\\\([^\\r\\n\\f])","g"),Q=function(e,r){var t="0x"+e.slice(1)-65536;if(r){return r}return t<0?String.fromCharCode(t+65536):String.fromCharCode(t>>10|55296,t&1023|56320)},Y=function(){oe()},W=de((function(e){return e.disabled===true&&b(e,"fieldset")}),{dir:"parentNode",next:"legend"});function K(){try{return c.activeElement}catch(e){}}try{o.apply(t=a.call(N.childNodes),N.childNodes)}catch(e){o={apply:function(e,r){D.apply(e,a.call(r))},call:function(e){D.apply(e,a.call(arguments,1))}}}function ee(e,r,t,i){var a,s,n,f,l,u,v,m=r&&r.ownerDocument,A=r?r.nodeType:9;t=t||[];if(typeof e!=="string"||!e||A!==1&&A!==9&&A!==11){return t}if(!i){oe(r);r=r||c;if(h){if(A!==11&&(l=G.exec(e))){if(a=l[1]){if(A===9){if(n=r.getElementById(a)){if(n.id===a){o.call(t,n);return t}}else{return t}}else{if(m&&(n=m.getElementById(a))&&ee.contains(r,n)&&n.id===a){o.call(t,n);return t}}}else if(l[2]){o.apply(t,r.getElementsByTagName(e));return t}else if((a=l[3])&&r.getElementsByClassName){o.apply(t,r.getElementsByClassName(a));return t}}if(!F[e+" "]&&(!p||!p.test(e))){v=e;m=r;if(A===1&&(V.test(e)||L.test(e))){m=X.test(e)&&le(r.parentNode)||r;if(m!=r||!d.scope){if(f=r.getAttribute("id")){f=g.escapeSelector(f)}else{r.setAttribute("id",f=T)}}u=ce(e);s=u.length;while(s--){u[s]=(f?"#"+f:":scope")+" "+ve(u[s])}v=u.join(",")}try{o.apply(t,m.querySelectorAll(v));return t}catch(r){F(e,true)}finally{if(f===T){r.removeAttribute("id")}}}}}return Oe(e.replace(q,"$1"),r,t,i)}function re(){var e=[];function r(t,a){if(e.push(t+" ")>i.cacheLength){delete r[e.shift()]}return r[t+" "]=a}return r}function te(e){e[T]=true;return e}function ie(e){var r=c.createElement("fieldset");try{return!!e(r)}catch(e){return false}finally{if(r.parentNode){r.parentNode.removeChild(r)}r=null}}function ae(e){return function(r){return b(r,"input")&&r.type===e}}function se(e){return function(r){return(b(r,"input")||b(r,"button"))&&r.type===e}}function ne(e){return function(r){if("form"in r){if(r.parentNode&&r.disabled===false){if("label"in r){if("label"in r.parentNode){return r.parentNode.disabled===e}else{return r.disabled===e}}return r.isDisabled===e||r.isDisabled!==!e&&W(r)===e}return r.disabled===e}else if("label"in r){return r.disabled===e}return false}}function fe(e){return te((function(r){r=+r;return te((function(t,i){var a,s=e([],t.length,r),n=s.length;while(n--){if(t[a=s[n]]){t[a]=!(i[a]=t[a])}}}))}))}function le(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}function oe(e){var r,t=e?e.ownerDocument||e:N;if(t==c||t.nodeType!==9||!t.documentElement){return c}c=t;v=c.documentElement;h=!g.isXMLDoc(c);m=v.matches||v.webkitMatchesSelector||v.msMatchesSelector;if(v.msMatchesSelector&&N!=c&&(r=c.defaultView)&&r.top!==r){r.addEventListener("unload",Y)}d.getById=ie((function(e){v.appendChild(e).id=g.expando;return!c.getElementsByName||!c.getElementsByName(g.expando).length}));d.disconnectedMatch=ie((function(e){return m.call(e,"*")}));d.scope=ie((function(){return c.querySelectorAll(":scope")}));d.cssHas=ie((function(){try{c.querySelector(":has(*,:jqfake)");return false}catch(e){return true}}));if(d.getById){i.filter.ID=function(e){var r=e.replace($,Q);return function(e){return e.getAttribute("id")===r}};i.find.ID=function(e,r){if(typeof r.getElementById!=="undefined"&&h){var t=r.getElementById(e);return t?[t]:[]}}}else{i.filter.ID=function(e){var r=e.replace($,Q);return function(e){var t=typeof e.getAttributeNode!=="undefined"&&e.getAttributeNode("id");return t&&t.value===r}};i.find.ID=function(e,r){if(typeof r.getElementById!=="undefined"&&h){var t,i,a,s=r.getElementById(e);if(s){t=s.getAttributeNode("id");if(t&&t.value===e){return[s]}a=r.getElementsByName(e);i=0;while(s=a[i++]){t=s.getAttributeNode("id");if(t&&t.value===e){return[s]}}}return[]}}}i.find.TAG=function(e,r){if(typeof r.getElementsByTagName!=="undefined"){return r.getElementsByTagName(e)}else{return r.querySelectorAll(e)}};i.find.CLASS=function(e,r){if(typeof r.getElementsByClassName!=="undefined"&&h){return r.getElementsByClassName(e)}};p=[];ie((function(e){var r;v.appendChild(e).innerHTML="<a id='"+T+"' href='' disabled='disabled'></a>"+"<select id='"+T+"-\r\\' disabled='disabled'>"+"<option selected=''></option></select>";if(!e.querySelectorAll("[selected]").length){p.push("\\["+k+"*(?:value|"+E+")")}if(!e.querySelectorAll("[id~="+T+"-]").length){p.push("~=")}if(!e.querySelectorAll("a#"+T+"+*").length){p.push(".#.+[+~]")}if(!e.querySelectorAll(":checked").length){p.push(":checked")}r=c.createElement("input");r.setAttribute("type","hidden");e.appendChild(r).setAttribute("name","D");v.appendChild(e).disabled=true;if(e.querySelectorAll(":disabled").length!==2){p.push(":enabled",":disabled")}r=c.createElement("input");r.setAttribute("name","");e.appendChild(r);if(!e.querySelectorAll("[name='']").length){p.push("\\["+k+"*name"+k+"*="+k+"*(?:''|\"\")")}}));if(!d.cssHas){p.push(":has")}p=p.length&&new RegExp(p.join("|"));P=function(e,r){if(e===r){l=true;return 0}var t=!e.compareDocumentPosition-!r.compareDocumentPosition;if(t){return t}t=(e.ownerDocument||e)==(r.ownerDocument||r)?e.compareDocumentPosition(r):1;if(t&1||!d.sortDetached&&r.compareDocumentPosition(e)===t){if(e===c||e.ownerDocument==N&&ee.contains(N,e)){return-1}if(r===c||r.ownerDocument==N&&ee.contains(N,r)){return 1}return n?f.call(n,e)-f.call(n,r):0}return t&4?-1:1};return c}ee.matches=function(e,r){return ee(e,null,null,r)};ee.matchesSelector=function(e,r){oe(e);if(h&&!F[r+" "]&&(!p||!p.test(r))){try{var t=m.call(e,r);if(t||d.disconnectedMatch||e.document&&e.document.nodeType!==11){return t}}catch(e){F(r,true)}}return ee(r,c,null,[e]).length>0};ee.contains=function(e,r){if((e.ownerDocument||e)!=c){oe(e)}return g.contains(e,r)};ee.attr=function(e,r){if((e.ownerDocument||e)!=c){oe(e)}var t=i.attrHandle[r.toLowerCase()],a=t&&u.call(i.attrHandle,r.toLowerCase())?t(e,r,!h):undefined;if(a!==undefined){return a}return e.getAttribute(r)};ee.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};g.uniqueSort=function(e){var r,t=[],i=0,s=0;l=!d.sortStable;n=!d.sortStable&&a.call(e,0);S.call(e,P);if(l){while(r=e[s++]){if(r===e[s]){i=t.push(s)}}while(i--){I.call(e,t[i],1)}}n=null;return e};g.fn.uniqueSort=function(){return this.pushStack(g.uniqueSort(a.apply(this)))};i=g.expr={cacheLength:50,createPseudo:te,match:z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace($,Q);e[3]=(e[3]||e[4]||e[5]||"").replace($,Q);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){ee.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){ee.error(e[0])}return e},PSEUDO:function(e){var r,t=!e[6]&&e[2];if(z.CHILD.test(e[0])){return null}if(e[3]){e[2]=e[4]||e[5]||""}else if(t&&B.test(t)&&(r=ce(t,true))&&(r=t.indexOf(")",t.length-r)-t.length)){e[0]=e[0].slice(0,r);e[2]=t.slice(0,r)}return e.slice(0,3)}},filter:{TAG:function(e){var r=e.replace($,Q).toLowerCase();return e==="*"?function(){return true}:function(e){return b(e,r)}},CLASS:function(e){var r=w[e+" "];return r||(r=new RegExp("(^|"+k+")"+e+"("+k+"|$)"))&&w(e,(function(e){return r.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!=="undefined"&&e.getAttribute("class")||"")}))},ATTR:function(e,r,t){return function(i){var a=ee.attr(i,e);if(a==null){return r==="!="}if(!r){return true}a+="";if(r==="="){return a===t}if(r==="!="){return a!==t}if(r==="^="){return t&&a.indexOf(t)===0}if(r==="*="){return t&&a.indexOf(t)>-1}if(r==="$="){return t&&a.slice(-t.length)===t}if(r==="~="){return(" "+a.replace(M," ")+" ").indexOf(t)>-1}if(r==="|="){return a===t||a.slice(0,t.length+1)===t+"-"}return false}},CHILD:function(e,r,t,i,a){var s=e.slice(0,3)!=="nth",n=e.slice(-4)!=="last",f=r==="of-type";return i===1&&a===0?function(e){return!!e.parentNode}:function(r,t,l){var o,u,c,v,d,h=s!==n?"nextSibling":"previousSibling",p=r.parentNode,m=f&&r.nodeName.toLowerCase(),y=!l&&!f,w=false;if(p){if(s){while(h){c=r;while(c=c[h]){if(f?b(c,m):c.nodeType===1){return false}}d=h=e==="only"&&!d&&"nextSibling"}return true}d=[n?p.firstChild:p.lastChild];if(n&&y){u=p[T]||(p[T]={});o=u[e]||[];v=o[0]===A&&o[1];w=v&&o[2];c=v&&p.childNodes[v];while(c=++v&&c&&c[h]||(w=v=0)||d.pop()){if(c.nodeType===1&&++w&&c===r){u[e]=[A,v,w];break}}}else{if(y){u=r[T]||(r[T]={});o=u[e]||[];v=o[0]===A&&o[1];w=v}if(w===false){while(c=++v&&c&&c[h]||(w=v=0)||d.pop()){if((f?b(c,m):c.nodeType===1)&&++w){if(y){u=c[T]||(c[T]={});u[e]=[A,w]}if(c===r){break}}}}}w-=a;return w===i||w%i===0&&w/i>=0}}},PSEUDO:function(e,r){var t,a=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ee.error("unsupported pseudo: "+e);if(a[T]){return a(r)}if(a.length>1){t=[e,e,"",r];return i.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){var i,s=a(e,r),n=s.length;while(n--){i=f.call(e,s[n]);e[i]=!(t[i]=s[n])}})):function(e){return a(e,0,t)}}return a}},pseudos:{not:te((function(e){var r=[],t=[],i=we(e.replace(q,"$1"));return i[T]?te((function(e,r,t,a){var s,n=i(e,null,a,[]),f=e.length;while(f--){if(s=n[f]){e[f]=!(r[f]=s)}}})):function(e,a,s){r[0]=e;i(r,null,s,t);r[0]=null;return!t.pop()}})),has:te((function(e){return function(r){return ee(e,r).length>0}})),contains:te((function(e){e=e.replace($,Q);return function(r){return(r.textContent||g.text(r)).indexOf(e)>-1}})),lang:te((function(e){if(!U.test(e||"")){ee.error("unsupported lang: "+e)}e=e.replace($,Q).toLowerCase();return function(r){var t;do{if(t=h?r.lang:r.getAttribute("xml:lang")||r.getAttribute("lang")){t=t.toLowerCase();return t===e||t.indexOf(e+"-")===0}}while((r=r.parentNode)&&r.nodeType===1);return false}})),target:function(r){var t=e.location&&e.location.hash;return t&&t.slice(1)===r.id},root:function(e){return e===v},focus:function(e){return e===K()&&c.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:ne(false),disabled:ne(true),checked:function(e){return b(e,"input")&&!!e.checked||b(e,"option")&&!!e.selected},selected:function(e){return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeType<6){return false}}return true},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return H.test(e.nodeName)},button:function(e){return b(e,"input")&&e.type==="button"||b(e,"button")},text:function(e){var r;return b(e,"input")&&e.type==="text"&&((r=e.getAttribute("type"))==null||r.toLowerCase()==="text")},first:fe((function(){return[0]})),last:fe((function(e,r){return[r-1]})),eq:fe((function(e,r,t){return[t<0?t+r:t]})),even:fe((function(e,r){var t=0;for(;t<r;t+=2){e.push(t)}return e})),odd:fe((function(e,r){var t=1;for(;t<r;t+=2){e.push(t)}return e})),lt:fe((function(e,r,t){var i;if(t<0){i=t+r}else if(t>r){i=r}else{i=t}for(;--i>=0;){e.push(i)}return e})),gt:fe((function(e,r,t){var i=t<0?t+r:t;for(;++i<r;){e.push(i)}return e}))}};i.pseudos.nth=i.pseudos.eq;for(r in{radio:true,checkbox:true,file:true,password:true,image:true}){i.pseudos[r]=ae(r)}for(r in{submit:true,reset:true}){i.pseudos[r]=se(r)}function ue(){}ue.prototype=i.filters=i.pseudos;i.setFilters=new ue;function ce(e,r){var t,a,s,n,f,l,o,u=O[e+" "];if(u){return r?0:u.slice(0)}f=e;l=[];o=i.preFilter;while(f){if(!t||(a=J.exec(f))){if(a){f=f.slice(a[0].length)||f}l.push(s=[])}t=false;if(a=L.exec(f)){t=a.shift();s.push({value:t,type:a[0].replace(q," ")});f=f.slice(t.length)}for(n in i.filter){if((a=z[n].exec(f))&&(!o[n]||(a=o[n](a)))){t=a.shift();s.push({value:t,type:n,matches:a});f=f.slice(t.length)}}if(!t){break}}if(r){return f.length}return f?ee.error(e):O(e,l).slice(0)}function ve(e){var r=0,t=e.length,i="";for(;r<t;r++){i+=e[r].value}return i}function de(e,r,t){var i=r.dir,a=r.next,s=a||i,n=t&&s==="parentNode",f=y++;return r.first?function(r,t,a){while(r=r[i]){if(r.nodeType===1||n){return e(r,t,a)}}return false}:function(r,t,l){var o,u,c=[A,f];if(l){while(r=r[i]){if(r.nodeType===1||n){if(e(r,t,l)){return true}}}}else{while(r=r[i]){if(r.nodeType===1||n){u=r[T]||(r[T]={});if(a&&b(r,a)){r=r[i]||r}else if((o=u[s])&&o[0]===A&&o[1]===f){return c[2]=o[2]}else{u[s]=c;if(c[2]=e(r,t,l)){return true}}}}}return false}}function he(e){return e.length>1?function(r,t,i){var a=e.length;while(a--){if(!e[a](r,t,i)){return false}}return true}:e[0]}function pe(e,r,t){var i=0,a=r.length;for(;i<a;i++){ee(e,r[i],t)}return t}function me(e,r,t,i,a){var s,n=[],f=0,l=e.length,o=r!=null;for(;f<l;f++){if(s=e[f]){if(!t||t(s,i,a)){n.push(s);if(o){r.push(f)}}}}return n}function Te(e,r,t,i,a,s){if(i&&!i[T]){i=Te(i)}if(a&&!a[T]){a=Te(a,s)}return te((function(s,n,l,u){var c,v,d,h,p=[],m=[],T=n.length,A=s||pe(r||"*",l.nodeType?[l]:l,[]),y=e&&(s||!r)?me(A,p,e,l,u):A;if(t){h=a||(s?e:T||i)?[]:n;t(y,h,l,u)}else{h=y}if(i){c=me(h,m);i(c,[],l,u);v=c.length;while(v--){if(d=c[v]){h[m[v]]=!(y[m[v]]=d)}}}if(s){if(a||e){if(a){c=[];v=h.length;while(v--){if(d=h[v]){c.push(y[v]=d)}}a(null,h=[],c,u)}v=h.length;while(v--){if((d=h[v])&&(c=a?f.call(s,d):p[v])>-1){s[c]=!(n[c]=d)}}}}else{h=me(h===n?h.splice(T,h.length):h);if(a){a(null,n,h,u)}else{o.apply(n,h)}}}))}function Ae(e){var r,t,a,n=e.length,l=i.relative[e[0].type],o=l||i.relative[" "],u=l?1:0,c=de((function(e){return e===r}),o,true),v=de((function(e){return f.call(r,e)>-1}),o,true),d=[function(e,t,i){var a=!l&&(i||t!=s)||((r=t).nodeType?c(e,t,i):v(e,t,i));r=null;return a}];for(;u<n;u++){if(t=i.relative[e[u].type]){d=[de(he(d),t)]}else{t=i.filter[e[u].type].apply(null,e[u].matches);if(t[T]){a=++u;for(;a<n;a++){if(i.relative[e[a].type]){break}}return Te(u>1&&he(d),u>1&&ve(e.slice(0,u-1).concat({value:e[u-2].type===" "?"*":""})).replace(q,"$1"),t,u<a&&Ae(e.slice(u,a)),a<n&&Ae(e=e.slice(a)),a<n&&ve(e))}d.push(t)}}return he(d)}function ye(e,r){var t=r.length>0,a=e.length>0,n=function(n,f,l,u,v){var d,p,m,T=0,y="0",w=n&&[],O=[],_=s,b=n||a&&i.find.TAG("*",v),S=A+=_==null?1:Math.random()||.1,I=b.length;if(v){s=f==c||f||v}for(;y!==I&&(d=b[y])!=null;y++){if(a&&d){p=0;if(!f&&d.ownerDocument!=c){oe(d);l=!h}while(m=e[p++]){if(m(d,f||c,l)){o.call(u,d);break}}if(v){A=S}}if(t){if(d=!m&&d){T--}if(n){w.push(d)}}}T+=y;if(t&&y!==T){p=0;while(m=r[p++]){m(w,O,f,l)}if(n){if(T>0){while(y--){if(!(w[y]||O[y])){O[y]=x.call(u)}}}O=me(O)}o.apply(u,O);if(v&&!n&&O.length>0&&T+r.length>1){g.uniqueSort(u)}}if(v){A=S;s=_}return w};return t?te(n):n}function we(e,r){var t,i=[],a=[],s=_[e+" "];if(!s){if(!r){r=ce(e)}t=r.length;while(t--){s=Ae(r[t]);if(s[T]){i.push(s)}else{a.push(s)}}s=_(e,ye(a,i));s.selector=e}return s}function Oe(e,r,t,a){var s,n,f,l,u,c=typeof e==="function"&&e,v=!a&&ce(e=c.selector||e);t=t||[];if(v.length===1){n=v[0]=v[0].slice(0);if(n.length>2&&(f=n[0]).type==="ID"&&r.nodeType===9&&h&&i.relative[n[1].type]){r=(i.find.ID(f.matches[0].replace($,Q),r)||[])[0];if(!r){return t}else if(c){r=r.parentNode}e=e.slice(n.shift().value.length)}s=z.needsContext.test(e)?0:n.length;while(s--){f=n[s];if(i.relative[l=f.type]){break}if(u=i.find[l]){if(a=u(f.matches[0].replace($,Q),X.test(n[0].type)&&le(r.parentNode)||r)){n.splice(s,1);e=a.length&&ve(n);if(!e){o.apply(t,a);return t}break}}}}(c||we(e,v))(a,r,!h,t,!r||X.test(e)&&le(r.parentNode)||r);return t}d.sortStable=T.split("").sort(P).join("")===T;oe();d.sortDetached=ie((function(e){return e.compareDocumentPosition(c.createElement("fieldset"))&1}));g.find=ee;g.expr[":"]=g.expr.pseudos;g.unique=g.uniqueSort;ee.compile=we;ee.select=Oe;ee.setDocument=oe;ee.tokenize=ce;ee.escape=g.escapeSelector;ee.getText=g.text;ee.isXML=g.isXMLDoc;ee.selectors=g.expr;ee.support=g.support;ee.uniqueSort=g.uniqueSort})();var E=function(e,r,t){var i=[],a=t!==undefined;while((e=e[r])&&e.nodeType!==9){if(e.nodeType===1){if(a&&g(e).is(t)){break}i.push(e)}}return i};var C=function(e,r){var t=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==r){t.push(e)}}return t};var j=g.expr.match.needsContext;var R=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function M(e,r,t){if(h(r)){return g.grep(e,(function(e,i){return!!r.call(e,i,e)!==t}))}if(r.nodeType){return g.grep(e,(function(e){return e===r!==t}))}if(typeof r!=="string"){return g.grep(e,(function(e){return f.call(r,e)>-1!==t}))}return g.filter(r,e,t)}g.filter=function(e,r,t){var i=r[0];if(t){e=":not("+e+")"}if(r.length===1&&i.nodeType===1){return g.find.matchesSelector(i,e)?[i]:[]}return g.find.matches(e,g.grep(r,(function(e){return e.nodeType===1})))};g.fn.extend({find:function(e){var r,t,i=this.length,a=this;if(typeof e!=="string"){return this.pushStack(g(e).filter((function(){for(r=0;r<i;r++){if(g.contains(a[r],this)){return true}}})))}t=this.pushStack([]);for(r=0;r<i;r++){g.find(e,a[r],t)}return i>1?g.uniqueSort(t):t},filter:function(e){return this.pushStack(M(this,e||[],false))},not:function(e){return this.pushStack(M(this,e||[],true))},is:function(e){return!!M(this,typeof e==="string"&&j.test(e)?g(e):e||[],false).length}});var J,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,V=g.fn.init=function(e,r,t){var i,a;if(!e){return this}t=t||J;if(typeof e==="string"){if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3){i=[null,e,null]}else{i=L.exec(e)}if(i&&(i[1]||!r)){if(i[1]){r=r instanceof g?r[0]:r;g.merge(this,g.parseHTML(i[1],r&&r.nodeType?r.ownerDocument||r:m,true));if(R.test(i[1])&&g.isPlainObject(r)){for(i in r){if(h(this[i])){this[i](r[i])}else{this.attr(i,r[i])}}}return this}else{a=m.getElementById(i[2]);if(a){this[0]=a;this.length=1}return this}}else if(!r||r.jquery){return(r||t).find(e)}else{return this.constructor(r).find(e)}}else if(e.nodeType){this[0]=e;this.length=1;return this}else if(h(e)){return t.ready!==undefined?t.ready(e):e(g)}return g.makeArray(e,this)};V.prototype=g.fn;J=g(m);var B=/^(?:parents|prev(?:Until|All))/,U={children:true,contents:true,next:true,prev:true};g.fn.extend({has:function(e){var r=g(e,this),t=r.length;return this.filter((function(){var e=0;for(;e<t;e++){if(g.contains(this,r[e])){return true}}}))},closest:function(e,r){var t,i=0,a=this.length,s=[],n=typeof e!=="string"&&g(e);if(!j.test(e)){for(;i<a;i++){for(t=this[i];t&&t!==r;t=t.parentNode){if(t.nodeType<11&&(n?n.index(t)>-1:t.nodeType===1&&g.find.matchesSelector(t,e))){s.push(t);break}}}}return this.pushStack(s.length>1?g.uniqueSort(s):s)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return f.call(g(e),this[0])}return f.call(this,e.jquery?e[0]:e)},add:function(e,r){return this.pushStack(g.uniqueSort(g.merge(this.get(),g(e,r))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function z(e,r){while((e=e[r])&&e.nodeType!==1){}return e}g.each({parent:function(e){var r=e.parentNode;return r&&r.nodeType!==11?r:null},parents:function(e){return E(e,"parentNode")},parentsUntil:function(e,r,t){return E(e,"parentNode",t)},next:function(e){return z(e,"nextSibling")},prev:function(e){return z(e,"previousSibling")},nextAll:function(e){return E(e,"nextSibling")},prevAll:function(e){return E(e,"previousSibling")},nextUntil:function(e,r,t){return E(e,"nextSibling",t)},prevUntil:function(e,r,t){return E(e,"previousSibling",t)},siblings:function(e){return C((e.parentNode||{}).firstChild,e)},children:function(e){return C(e.firstChild)},contents:function(e){if(e.contentDocument!=null&&i(e.contentDocument)){return e.contentDocument}if(b(e,"template")){e=e.content||e}return g.merge([],e.childNodes)}},(function(e,r){g.fn[e]=function(t,i){var a=g.map(this,r,t);if(e.slice(-5)!=="Until"){i=t}if(i&&typeof i==="string"){a=g.filter(i,a)}if(this.length>1){if(!U[e]){g.uniqueSort(a)}if(B.test(e)){a.reverse()}}return this.pushStack(a)}}));var H=/[^\x20\t\r\n\f]+/g;function Z(e){var r={};g.each(e.match(H)||[],(function(e,t){r[t]=true}));return r}g.Callbacks=function(e){e=typeof e==="string"?Z(e):g.extend({},e);var r,t,i,a,s=[],n=[],f=-1,l=function(){a=a||e.once;i=r=true;for(;n.length;f=-1){t=n.shift();while(++f<s.length){if(s[f].apply(t[0],t[1])===false&&e.stopOnFalse){f=s.length;t=false}}}if(!e.memory){t=false}r=false;if(a){if(t){s=[]}else{s=""}}},o={add:function(){if(s){if(t&&!r){f=s.length-1;n.push(t)}(function r(t){g.each(t,(function(t,i){if(h(i)){if(!e.unique||!o.has(i)){s.push(i)}}else if(i&&i.length&&y(i)!=="string"){r(i)}}))})(arguments);if(t&&!r){l()}}return this},remove:function(){g.each(arguments,(function(e,r){var t;while((t=g.inArray(r,s,t))>-1){s.splice(t,1);if(t<=f){f--}}}));return this},has:function(e){return e?g.inArray(e,s)>-1:s.length>0},empty:function(){if(s){s=[]}return this},disable:function(){a=n=[];s=t="";return this},disabled:function(){return!s},lock:function(){a=n=[];if(!t&&!r){s=t=""}return this},locked:function(){return!!a},fireWith:function(e,t){if(!a){t=t||[];t=[e,t.slice?t.slice():t];n.push(t);if(!r){l()}}return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!i}};return o};function G(e){return e}function X(e){throw e}function $(e,r,t,i){var a;try{if(e&&h(a=e.promise)){a.call(e).done(r).fail(t)}else if(e&&h(a=e.then)){a.call(e,r,t)}else{r.apply(undefined,[e].slice(i))}}catch(e){t.apply(undefined,[e])}}g.extend({Deferred:function(r){var t=[["notify","progress",g.Callbacks("memory"),g.Callbacks("memory"),2],["resolve","done",g.Callbacks("once memory"),g.Callbacks("once memory"),0,"resolved"],["reject","fail",g.Callbacks("once memory"),g.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){s.done(arguments).fail(arguments);return this},catch:function(e){return a.then(null,e)},pipe:function(){var e=arguments;return g.Deferred((function(r){g.each(t,(function(t,i){var a=h(e[i[4]])&&e[i[4]];s[i[1]]((function(){var e=a&&a.apply(this,arguments);if(e&&h(e.promise)){e.promise().progress(r.notify).done(r.resolve).fail(r.reject)}else{r[i[0]+"With"](this,a?[e]:arguments)}}))}));e=null})).promise()},then:function(r,i,a){var s=0;function n(r,t,i,a){return function(){var f=this,l=arguments,o=function(){var e,o;if(r<s){return}e=i.apply(f,l);if(e===t.promise()){throw new TypeError("Thenable self-resolution")}o=e&&(typeof e==="object"||typeof e==="function")&&e.then;if(h(o)){if(a){o.call(e,n(s,t,G,a),n(s,t,X,a))}else{s++;o.call(e,n(s,t,G,a),n(s,t,X,a),n(s,t,G,t.notifyWith))}}else{if(i!==G){f=undefined;l=[e]}(a||t.resolveWith)(f,l)}},u=a?o:function(){try{o()}catch(e){if(g.Deferred.exceptionHook){g.Deferred.exceptionHook(e,u.error)}if(r+1>=s){if(i!==X){f=undefined;l=[e]}t.rejectWith(f,l)}}};if(r){u()}else{if(g.Deferred.getErrorHook){u.error=g.Deferred.getErrorHook()}else if(g.Deferred.getStackHook){u.error=g.Deferred.getStackHook()}e.setTimeout(u)}}}return g.Deferred((function(e){t[0][3].add(n(0,e,h(a)?a:G,e.notifyWith));t[1][3].add(n(0,e,h(r)?r:G));t[2][3].add(n(0,e,h(i)?i:X))})).promise()},promise:function(e){return e!=null?g.extend(e,a):a}},s={};g.each(t,(function(e,r){var n=r[2],f=r[5];a[r[1]]=n.add;if(f){n.add((function(){i=f}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock)}n.add(r[3].fire);s[r[0]]=function(){s[r[0]+"With"](this===s?undefined:this,arguments);return this};s[r[0]+"With"]=n.fireWith}));a.promise(s);if(r){r.call(s,s)}return s},when:function(e){var r=arguments.length,t=r,i=Array(t),s=a.call(arguments),n=g.Deferred(),f=function(e){return function(t){i[e]=this;s[e]=arguments.length>1?a.call(arguments):t;if(! --r){n.resolveWith(i,s)}}};if(r<=1){$(e,n.done(f(t)).resolve,n.reject,!r);if(n.state()==="pending"||h(s[t]&&s[t].then)){return n.then()}}while(t--){$(s[t],f(t),n.reject)}return n.promise()}});var Q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;g.Deferred.exceptionHook=function(r,t){if(e.console&&e.console.warn&&r&&Q.test(r.name)){e.console.warn("jQuery.Deferred exception: "+r.message,r.stack,t)}};g.readyException=function(r){e.setTimeout((function(){throw r}))};var Y=g.Deferred();g.fn.ready=function(e){Y.then(e).catch((function(e){g.readyException(e)}));return this};g.extend({isReady:false,readyWait:1,ready:function(e){if(e===true?--g.readyWait:g.isReady){return}g.isReady=true;if(e!==true&&--g.readyWait>0){return}Y.resolveWith(m,[g])}});g.ready.then=Y.then;function W(){m.removeEventListener("DOMContentLoaded",W);e.removeEventListener("load",W);g.ready()}if(m.readyState==="complete"||m.readyState!=="loading"&&!m.documentElement.doScroll){e.setTimeout(g.ready)}else{m.addEventListener("DOMContentLoaded",W);e.addEventListener("load",W)}var K=function(e,r,t,i,a,s,n){var f=0,l=e.length,o=t==null;if(y(t)==="object"){a=true;for(f in t){K(e,r,f,t[f],true,s,n)}}else if(i!==undefined){a=true;if(!h(i)){n=true}if(o){if(n){r.call(e,i);r=null}else{o=r;r=function(e,r,t){return o.call(g(e),t)}}}if(r){for(;f<l;f++){r(e[f],t,n?i:i.call(e[f],f,r(e[f],t)))}}}if(a){return e}if(o){return r.call(e)}return l?r(e[0],t):s};var ee=/^-ms-/,re=/-([a-z])/g;function te(e,r){return r.toUpperCase()}function ie(e){return e.replace(ee,"ms-").replace(re,te)}var ae=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function se(){this.expando=g.expando+se.uid++}se.uid=1;se.prototype={cache:function(e){var r=e[this.expando];if(!r){r={};if(ae(e)){if(e.nodeType){e[this.expando]=r}else{Object.defineProperty(e,this.expando,{value:r,configurable:true})}}}return r},set:function(e,r,t){var i,a=this.cache(e);if(typeof r==="string"){a[ie(r)]=t}else{for(i in r){a[ie(i)]=r[i]}}return a},get:function(e,r){return r===undefined?this.cache(e):e[this.expando]&&e[this.expando][ie(r)]},access:function(e,r,t){if(r===undefined||r&&typeof r==="string"&&t===undefined){return this.get(e,r)}this.set(e,r,t);return t!==undefined?t:r},remove:function(e,r){var t,i=e[this.expando];if(i===undefined){return}if(r!==undefined){if(Array.isArray(r)){r=r.map(ie)}else{r=ie(r);r=r in i?[r]:r.match(H)||[]}t=r.length;while(t--){delete i[r[t]]}}if(r===undefined||g.isEmptyObject(i)){if(e.nodeType){e[this.expando]=undefined}else{delete e[this.expando]}}},hasData:function(e){var r=e[this.expando];return r!==undefined&&!g.isEmptyObject(r)}};var ne=new se;var fe=new se;var le=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,oe=/[A-Z]/g;function ue(e){if(e==="true"){return true}if(e==="false"){return false}if(e==="null"){return null}if(e===+e+""){return+e}if(le.test(e)){return JSON.parse(e)}return e}function ce(e,r,t){var i;if(t===undefined&&e.nodeType===1){i="data-"+r.replace(oe,"-$&").toLowerCase();t=e.getAttribute(i);if(typeof t==="string"){try{t=ue(t)}catch(e){}fe.set(e,r,t)}else{t=undefined}}return t}g.extend({hasData:function(e){return fe.hasData(e)||ne.hasData(e)},data:function(e,r,t){return fe.access(e,r,t)},removeData:function(e,r){fe.remove(e,r)},_data:function(e,r,t){return ne.access(e,r,t)},_removeData:function(e,r){ne.remove(e,r)}});g.fn.extend({data:function(e,r){var t,i,a,s=this[0],n=s&&s.attributes;if(e===undefined){if(this.length){a=fe.get(s);if(s.nodeType===1&&!ne.get(s,"hasDataAttrs")){t=n.length;while(t--){if(n[t]){i=n[t].name;if(i.indexOf("data-")===0){i=ie(i.slice(5));ce(s,i,a[i])}}}ne.set(s,"hasDataAttrs",true)}}return a}if(typeof e==="object"){return this.each((function(){fe.set(this,e)}))}return K(this,(function(r){var t;if(s&&r===undefined){t=fe.get(s,e);if(t!==undefined){return t}t=ce(s,e);if(t!==undefined){return t}return}this.each((function(){fe.set(this,e,r)}))}),null,r,arguments.length>1,null,true)},removeData:function(e){return this.each((function(){fe.remove(this,e)}))}});g.extend({queue:function(e,r,t){var i;if(e){r=(r||"fx")+"queue";i=ne.get(e,r);if(t){if(!i||Array.isArray(t)){i=ne.access(e,r,g.makeArray(t))}else{i.push(t)}}return i||[]}},dequeue:function(e,r){r=r||"fx";var t=g.queue(e,r),i=t.length,a=t.shift(),s=g._queueHooks(e,r),n=function(){g.dequeue(e,r)};if(a==="inprogress"){a=t.shift();i--}if(a){if(r==="fx"){t.unshift("inprogress")}delete s.stop;a.call(e,n,s)}if(!i&&s){s.empty.fire()}},_queueHooks:function(e,r){var t=r+"queueHooks";return ne.get(e,t)||ne.access(e,t,{empty:g.Callbacks("once memory").add((function(){ne.remove(e,[r+"queue",t])}))})}});g.fn.extend({queue:function(e,r){var t=2;if(typeof e!=="string"){r=e;e="fx";t--}if(arguments.length<t){return g.queue(this[0],e)}return r===undefined?this:this.each((function(){var t=g.queue(this,e,r);g._queueHooks(this,e);if(e==="fx"&&t[0]!=="inprogress"){g.dequeue(this,e)}}))},dequeue:function(e){return this.each((function(){g.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,r){var t,i=1,a=g.Deferred(),s=this,n=this.length,f=function(){if(! --i){a.resolveWith(s,[s])}};if(typeof e!=="string"){r=e;e=undefined}e=e||"fx";while(n--){t=ne.get(s[n],e+"queueHooks");if(t&&t.empty){i++;t.empty.add(f)}}f();return a.promise(r)}});var ve=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var de=new RegExp("^(?:([+-])=|)("+ve+")([a-z%]*)$","i");var he=["Top","Right","Bottom","Left"];var pe=m.documentElement;var me=function(e){return g.contains(e.ownerDocument,e)},Te={composed:true};if(pe.getRootNode){me=function(e){return g.contains(e.ownerDocument,e)||e.getRootNode(Te)===e.ownerDocument}}var Ae=function(e,r){e=r||e;return e.style.display==="none"||e.style.display===""&&me(e)&&g.css(e,"display")==="none"};function ye(e,r,t,i){var a,s,n=20,f=i?function(){return i.cur()}:function(){return g.css(e,r,"")},l=f(),o=t&&t[3]||(g.cssNumber[r]?"":"px"),u=e.nodeType&&(g.cssNumber[r]||o!=="px"&&+l)&&de.exec(g.css(e,r));if(u&&u[3]!==o){l=l/2;o=o||u[3];u=+l||1;while(n--){g.style(e,r,u+o);if((1-s)*(1-(s=f()/l||.5))<=0){n=0}u=u/s}u=u*2;g.style(e,r,u+o);t=t||[]}if(t){u=+u||+l||0;a=t[1]?u+(t[1]+1)*t[2]:+t[2];if(i){i.unit=o;i.start=u;i.end=a}}return a}var we={};function Oe(e){var r,t=e.ownerDocument,i=e.nodeName,a=we[i];if(a){return a}r=t.body.appendChild(t.createElement(i));a=g.css(r,"display");r.parentNode.removeChild(r);if(a==="none"){a="block"}we[i]=a;return a}function ge(e,r){var t,i,a=[],s=0,n=e.length;for(;s<n;s++){i=e[s];if(!i.style){continue}t=i.style.display;if(r){if(t==="none"){a[s]=ne.get(i,"display")||null;if(!a[s]){i.style.display=""}}if(i.style.display===""&&Ae(i)){a[s]=Oe(i)}}else{if(t!=="none"){a[s]="none";ne.set(i,"display",t)}}}for(s=0;s<n;s++){if(a[s]!=null){e[s].style.display=a[s]}}return e}g.fn.extend({show:function(){return ge(this,true)},hide:function(){return ge(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each((function(){if(Ae(this)){g(this).show()}else{g(this).hide()}}))}});var _e=/^(?:checkbox|radio)$/i;var be=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i;var xe=/^$|^module$|\/(?:java|ecma)script/i;(function(){var e=m.createDocumentFragment(),r=e.appendChild(m.createElement("div")),t=m.createElement("input");t.setAttribute("type","radio");t.setAttribute("checked","checked");t.setAttribute("name","t");r.appendChild(t);d.checkClone=r.cloneNode(true).cloneNode(true).lastChild.checked;r.innerHTML="<textarea>x</textarea>";d.noCloneChecked=!!r.cloneNode(true).lastChild.defaultValue;r.innerHTML="<option></option>";d.option=!!r.lastChild})();var Se={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Se.tbody=Se.tfoot=Se.colgroup=Se.caption=Se.thead;Se.th=Se.td;if(!d.option){Se.optgroup=Se.option=[1,"<select multiple='multiple'>","</select>"]}function Ie(e,r){var t;if(typeof e.getElementsByTagName!=="undefined"){t=e.getElementsByTagName(r||"*")}else if(typeof e.querySelectorAll!=="undefined"){t=e.querySelectorAll(r||"*")}else{t=[]}if(r===undefined||r&&b(e,r)){return g.merge([e],t)}return t}function ke(e,r){var t=0,i=e.length;for(;t<i;t++){ne.set(e[t],"globalEval",!r||ne.get(r[t],"globalEval"))}}var qe=/<|&#?\w+;/;function Fe(e,r,t,i,a){var s,n,f,l,o,u,c=r.createDocumentFragment(),v=[],d=0,h=e.length;for(;d<h;d++){s=e[d];if(s||s===0){if(y(s)==="object"){g.merge(v,s.nodeType?[s]:s)}else if(!qe.test(s)){v.push(r.createTextNode(s))}else{n=n||c.appendChild(r.createElement("div"));f=(be.exec(s)||["",""])[1].toLowerCase();l=Se[f]||Se._default;n.innerHTML=l[1]+g.htmlPrefilter(s)+l[2];u=l[0];while(u--){n=n.lastChild}g.merge(v,n.childNodes);n=c.firstChild;n.textContent=""}}}c.textContent="";d=0;while(s=v[d++]){if(i&&g.inArray(s,i)>-1){if(a){a.push(s)}continue}o=me(s);n=Ie(c.appendChild(s),"script");if(o){ke(n)}if(t){u=0;while(s=n[u++]){if(xe.test(s.type||"")){t.push(s)}}}}return c}var Pe=/^([^.]*)(?:\.(.+)|)/;function Ne(){return true}function De(){return false}function Ee(e,r,t,i,a,s){var n,f;if(typeof r==="object"){if(typeof t!=="string"){i=i||t;t=undefined}for(f in r){Ee(e,f,t,i,r[f],s)}return e}if(i==null&&a==null){a=t;i=t=undefined}else if(a==null){if(typeof t==="string"){a=i;i=undefined}else{a=i;i=t;t=undefined}}if(a===false){a=De}else if(!a){return e}if(s===1){n=a;a=function(e){g().off(e);return n.apply(this,arguments)};a.guid=n.guid||(n.guid=g.guid++)}return e.each((function(){g.event.add(this,r,a,i,t)}))}g.event={global:{},add:function(e,r,t,i,a){var s,n,f,l,o,u,c,v,d,h,p,m=ne.get(e);if(!ae(e)){return}if(t.handler){s=t;t=s.handler;a=s.selector}if(a){g.find.matchesSelector(pe,a)}if(!t.guid){t.guid=g.guid++}if(!(l=m.events)){l=m.events=Object.create(null)}if(!(n=m.handle)){n=m.handle=function(r){return typeof g!=="undefined"&&g.event.triggered!==r.type?g.event.dispatch.apply(e,arguments):undefined}}r=(r||"").match(H)||[""];o=r.length;while(o--){f=Pe.exec(r[o])||[];d=p=f[1];h=(f[2]||"").split(".").sort();if(!d){continue}c=g.event.special[d]||{};d=(a?c.delegateType:c.bindType)||d;c=g.event.special[d]||{};u=g.extend({type:d,origType:p,data:i,handler:t,guid:t.guid,selector:a,needsContext:a&&g.expr.match.needsContext.test(a),namespace:h.join(".")},s);if(!(v=l[d])){v=l[d]=[];v.delegateCount=0;if(!c.setup||c.setup.call(e,i,h,n)===false){if(e.addEventListener){e.addEventListener(d,n)}}}if(c.add){c.add.call(e,u);if(!u.handler.guid){u.handler.guid=t.guid}}if(a){v.splice(v.delegateCount++,0,u)}else{v.push(u)}g.event.global[d]=true}},remove:function(e,r,t,i,a){var s,n,f,l,o,u,c,v,d,h,p,m=ne.hasData(e)&&ne.get(e);if(!m||!(l=m.events)){return}r=(r||"").match(H)||[""];o=r.length;while(o--){f=Pe.exec(r[o])||[];d=p=f[1];h=(f[2]||"").split(".").sort();if(!d){for(d in l){g.event.remove(e,d+r[o],t,i,true)}continue}c=g.event.special[d]||{};d=(i?c.delegateType:c.bindType)||d;v=l[d]||[];f=f[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)");n=s=v.length;while(s--){u=v[s];if((a||p===u.origType)&&(!t||t.guid===u.guid)&&(!f||f.test(u.namespace))&&(!i||i===u.selector||i==="**"&&u.selector)){v.splice(s,1);if(u.selector){v.delegateCount--}if(c.remove){c.remove.call(e,u)}}}if(n&&!v.length){if(!c.teardown||c.teardown.call(e,h,m.handle)===false){g.removeEvent(e,d,m.handle)}delete l[d]}}if(g.isEmptyObject(l)){ne.remove(e,"handle events")}},dispatch:function(e){var r,t,i,a,s,n,f=new Array(arguments.length),l=g.event.fix(e),o=(ne.get(this,"events")||Object.create(null))[l.type]||[],u=g.event.special[l.type]||{};f[0]=l;for(r=1;r<arguments.length;r++){f[r]=arguments[r]}l.delegateTarget=this;if(u.preDispatch&&u.preDispatch.call(this,l)===false){return}n=g.event.handlers.call(this,l,o);r=0;while((a=n[r++])&&!l.isPropagationStopped()){l.currentTarget=a.elem;t=0;while((s=a.handlers[t++])&&!l.isImmediatePropagationStopped()){if(!l.rnamespace||s.namespace===false||l.rnamespace.test(s.namespace)){l.handleObj=s;l.data=s.data;i=((g.event.special[s.origType]||{}).handle||s.handler).apply(a.elem,f);if(i!==undefined){if((l.result=i)===false){l.preventDefault();l.stopPropagation()}}}}}if(u.postDispatch){u.postDispatch.call(this,l)}return l.result},handlers:function(e,r){var t,i,a,s,n,f=[],l=r.delegateCount,o=e.target;if(l&&o.nodeType&&!(e.type==="click"&&e.button>=1)){for(;o!==this;o=o.parentNode||this){if(o.nodeType===1&&!(e.type==="click"&&o.disabled===true)){s=[];n={};for(t=0;t<l;t++){i=r[t];a=i.selector+" ";if(n[a]===undefined){n[a]=i.needsContext?g(a,this).index(o)>-1:g.find(a,this,null,[o]).length}if(n[a]){s.push(i)}}if(s.length){f.push({elem:o,handlers:s})}}}}o=this;if(l<r.length){f.push({elem:o,handlers:r.slice(l)})}return f},addProp:function(e,r){Object.defineProperty(g.Event.prototype,e,{enumerable:true,configurable:true,get:h(r)?function(){if(this.originalEvent){return r(this.originalEvent)}}:function(){if(this.originalEvent){return this.originalEvent[e]}},set:function(r){Object.defineProperty(this,e,{enumerable:true,configurable:true,writable:true,value:r})}})},fix:function(e){return e[g.expando]?e:new g.Event(e)},special:{load:{noBubble:true},click:{setup:function(e){var r=this||e;if(_e.test(r.type)&&r.click&&b(r,"input")){Ce(r,"click",true)}return false},trigger:function(e){var r=this||e;if(_e.test(r.type)&&r.click&&b(r,"input")){Ce(r,"click")}return true},_default:function(e){var r=e.target;return _e.test(r.type)&&r.click&&b(r,"input")&&ne.get(r,"click")||b(r,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==undefined&&e.originalEvent){e.originalEvent.returnValue=e.result}}}}};function Ce(e,r,t){if(!t){if(ne.get(e,r)===undefined){g.event.add(e,r,Ne)}return}ne.set(e,r,false);g.event.add(e,r,{namespace:false,handler:function(e){var t,i=ne.get(this,r);if(e.isTrigger&1&&this[r]){if(!i){i=a.call(arguments);ne.set(this,r,i);this[r]();t=ne.get(this,r);ne.set(this,r,false);if(i!==t){e.stopImmediatePropagation();e.preventDefault();return t}}else if((g.event.special[r]||{}).delegateType){e.stopPropagation()}}else if(i){ne.set(this,r,g.event.trigger(i[0],i.slice(1),this));e.stopPropagation();e.isImmediatePropagationStopped=Ne}}})}g.removeEvent=function(e,r,t){if(e.removeEventListener){e.removeEventListener(r,t)}};g.Event=function(e,r){if(!(this instanceof g.Event)){return new g.Event(e,r)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===false?Ne:De;this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target;this.currentTarget=e.currentTarget;this.relatedTarget=e.relatedTarget}else{this.type=e}if(r){g.extend(this,r)}this.timeStamp=e&&e.timeStamp||Date.now();this[g.expando]=true};g.Event.prototype={constructor:g.Event,isDefaultPrevented:De,isPropagationStopped:De,isImmediatePropagationStopped:De,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ne;if(e&&!this.isSimulated){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ne;if(e&&!this.isSimulated){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ne;if(e&&!this.isSimulated){e.stopImmediatePropagation()}this.stopPropagation()}};g.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,char:true,code:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:true},g.event.addProp);g.each({focus:"focusin",blur:"focusout"},(function(e,r){function t(e){if(m.documentMode){var t=ne.get(this,"handle"),i=g.event.fix(e);i.type=e.type==="focusin"?"focus":"blur";i.isSimulated=true;t(e);if(i.target===i.currentTarget){t(i)}}else{g.event.simulate(r,e.target,g.event.fix(e))}}g.event.special[e]={setup:function(){var i;Ce(this,e,true);if(m.documentMode){i=ne.get(this,r);if(!i){this.addEventListener(r,t)}ne.set(this,r,(i||0)+1)}else{return false}},trigger:function(){Ce(this,e);return true},teardown:function(){var e;if(m.documentMode){e=ne.get(this,r)-1;if(!e){this.removeEventListener(r,t);ne.remove(this,r)}else{ne.set(this,r,e)}}else{return false}},_default:function(r){return ne.get(r.target,e)},delegateType:r};g.event.special[r]={setup:function(){var i=this.ownerDocument||this.document||this,a=m.documentMode?this:i,s=ne.get(a,r);if(!s){if(m.documentMode){this.addEventListener(r,t)}else{i.addEventListener(e,t,true)}}ne.set(a,r,(s||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,a=m.documentMode?this:i,s=ne.get(a,r)-1;if(!s){if(m.documentMode){this.removeEventListener(r,t)}else{i.removeEventListener(e,t,true)}ne.remove(a,r)}else{ne.set(a,r,s)}}}}));g.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,r){g.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,i=this,a=e.relatedTarget,s=e.handleObj;if(!a||a!==i&&!g.contains(i,a)){e.type=s.origType;t=s.handler.apply(this,arguments);e.type=r}return t}}}));g.fn.extend({on:function(e,r,t,i){return Ee(this,e,r,t,i)},one:function(e,r,t,i){return Ee(this,e,r,t,i,1)},off:function(e,r,t){var i,a;if(e&&e.preventDefault&&e.handleObj){i=e.handleObj;g(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler);return this}if(typeof e==="object"){for(a in e){this.off(a,r,e[a])}return this}if(r===false||typeof r==="function"){t=r;r=undefined}if(t===false){t=De}return this.each((function(){g.event.remove(this,e,t,r)}))}});var je=/<script|<style|<link/i,Re=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Je(e,r){if(b(e,"table")&&b(r.nodeType!==11?r:r.firstChild,"tr")){return g(e).children("tbody")[0]||e}return e}function Le(e){e.type=(e.getAttribute("type")!==null)+"/"+e.type;return e}function Ve(e){if((e.type||"").slice(0,5)==="true/"){e.type=e.type.slice(5)}else{e.removeAttribute("type")}return e}function Be(e,r){var t,i,a,s,n,f,l;if(r.nodeType!==1){return}if(ne.hasData(e)){s=ne.get(e);l=s.events;if(l){ne.remove(r,"handle events");for(a in l){for(t=0,i=l[a].length;t<i;t++){g.event.add(r,a,l[a][t])}}}}if(fe.hasData(e)){n=fe.access(e);f=g.extend({},n);fe.set(r,f)}}function Ue(e,r){var t=r.nodeName.toLowerCase();if(t==="input"&&_e.test(e.type)){r.checked=e.checked}else if(t==="input"||t==="textarea"){r.defaultValue=e.defaultValue}}function ze(e,r,t,i){r=s(r);var a,n,f,l,o,u,c=0,v=e.length,p=v-1,m=r[0],T=h(m);if(T||v>1&&typeof m==="string"&&!d.checkClone&&Re.test(m)){return e.each((function(a){var s=e.eq(a);if(T){r[0]=m.call(this,a,s.html())}ze(s,r,t,i)}))}if(v){a=Fe(r,e[0].ownerDocument,false,e,i);n=a.firstChild;if(a.childNodes.length===1){a=n}if(n||i){f=g.map(Ie(a,"script"),Le);l=f.length;for(;c<v;c++){o=a;if(c!==p){o=g.clone(o,true,true);if(l){g.merge(f,Ie(o,"script"))}}t.call(e[c],o,c)}if(l){u=f[f.length-1].ownerDocument;g.map(f,Ve);for(c=0;c<l;c++){o=f[c];if(xe.test(o.type||"")&&!ne.access(o,"globalEval")&&g.contains(u,o)){if(o.src&&(o.type||"").toLowerCase()!=="module"){if(g._evalUrl&&!o.noModule){g._evalUrl(o.src,{nonce:o.nonce||o.getAttribute("nonce")},u)}}else{A(o.textContent.replace(Me,""),o,u)}}}}}}return e}function He(e,r,t){var i,a=r?g.filter(r,e):e,s=0;for(;(i=a[s])!=null;s++){if(!t&&i.nodeType===1){g.cleanData(Ie(i))}if(i.parentNode){if(t&&me(i)){ke(Ie(i,"script"))}i.parentNode.removeChild(i)}}return e}g.extend({htmlPrefilter:function(e){return e},clone:function(e,r,t){var i,a,s,n,f=e.cloneNode(true),l=me(e);if(!d.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!g.isXMLDoc(e)){n=Ie(f);s=Ie(e);for(i=0,a=s.length;i<a;i++){Ue(s[i],n[i])}}if(r){if(t){s=s||Ie(e);n=n||Ie(f);for(i=0,a=s.length;i<a;i++){Be(s[i],n[i])}}else{Be(e,f)}}n=Ie(f,"script");if(n.length>0){ke(n,!l&&Ie(e,"script"))}return f},cleanData:function(e){var r,t,i,a=g.event.special,s=0;for(;(t=e[s])!==undefined;s++){if(ae(t)){if(r=t[ne.expando]){if(r.events){for(i in r.events){if(a[i]){g.event.remove(t,i)}else{g.removeEvent(t,i,r.handle)}}}t[ne.expando]=undefined}if(t[fe.expando]){t[fe.expando]=undefined}}}}});g.fn.extend({detach:function(e){return He(this,e,true)},remove:function(e){return He(this,e)},text:function(e){return K(this,(function(e){return e===undefined?g.text(this):this.empty().each((function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=e}}))}),null,e,arguments.length)},append:function(){return ze(this,arguments,(function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var r=Je(this,e);r.appendChild(e)}}))},prepend:function(){return ze(this,arguments,(function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var r=Je(this,e);r.insertBefore(e,r.firstChild)}}))},before:function(){return ze(this,arguments,(function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}}))},after:function(){return ze(this,arguments,(function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}}))},empty:function(){var e,r=0;for(;(e=this[r])!=null;r++){if(e.nodeType===1){g.cleanData(Ie(e,false));e.textContent=""}}return this},clone:function(e,r){e=e==null?false:e;r=r==null?e:r;return this.map((function(){return g.clone(this,e,r)}))},html:function(e){return K(this,(function(e){var r=this[0]||{},t=0,i=this.length;if(e===undefined&&r.nodeType===1){return r.innerHTML}if(typeof e==="string"&&!je.test(e)&&!Se[(be.exec(e)||["",""])[1].toLowerCase()]){e=g.htmlPrefilter(e);try{for(;t<i;t++){r=this[t]||{};if(r.nodeType===1){g.cleanData(Ie(r,false));r.innerHTML=e}}r=0}catch(e){}}if(r){this.empty().append(e)}}),null,e,arguments.length)},replaceWith:function(){var e=[];return ze(this,arguments,(function(r){var t=this.parentNode;if(g.inArray(this,e)<0){g.cleanData(Ie(this));if(t){t.replaceChild(r,this)}}}),e)}});g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,r){g.fn[e]=function(e){var t,i=[],a=g(e),s=a.length-1,f=0;for(;f<=s;f++){t=f===s?this:this.clone(true);g(a[f])[r](t);n.apply(i,t.get())}return this.pushStack(i)}}));var Ze=new RegExp("^("+ve+")(?!px)[a-z%]+$","i");var Ge=/^--/;var Xe=function(r){var t=r.ownerDocument.defaultView;if(!t||!t.opener){t=e}return t.getComputedStyle(r)};var $e=function(e,r,t){var i,a,s={};for(a in r){s[a]=e.style[a];e.style[a]=r[a]}i=t.call(e);for(a in r){e.style[a]=s[a]}return i};var Qe=new RegExp(he.join("|"),"i");(function(){function r(){if(!u){return}o.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";pe.appendChild(o).appendChild(u);var r=e.getComputedStyle(u);i=r.top!=="1%";l=t(r.marginLeft)===12;u.style.right="60%";n=t(r.right)===36;a=t(r.width)===36;u.style.position="absolute";s=t(u.offsetWidth/3)===12;pe.removeChild(o);u=null}function t(e){return Math.round(parseFloat(e))}var i,a,s,n,f,l,o=m.createElement("div"),u=m.createElement("div");if(!u.style){return}u.style.backgroundClip="content-box";u.cloneNode(true).style.backgroundClip="";d.clearCloneStyle=u.style.backgroundClip==="content-box";g.extend(d,{boxSizingReliable:function(){r();return a},pixelBoxStyles:function(){r();return n},pixelPosition:function(){r();return i},reliableMarginLeft:function(){r();return l},scrollboxSize:function(){r();return s},reliableTrDimensions:function(){var r,t,i,a;if(f==null){r=m.createElement("table");t=m.createElement("tr");i=m.createElement("div");r.style.cssText="position:absolute;left:-11111px;border-collapse:separate";t.style.cssText="box-sizing:content-box;border:1px solid";t.style.height="1px";i.style.height="9px";i.style.display="block";pe.appendChild(r).appendChild(t).appendChild(i);a=e.getComputedStyle(t);f=parseInt(a.height,10)+parseInt(a.borderTopWidth,10)+parseInt(a.borderBottomWidth,10)===t.offsetHeight;pe.removeChild(r)}return f}})})();function Ye(e,r,t){var i,a,s,n,f=Ge.test(r),l=e.style;t=t||Xe(e);if(t){n=t.getPropertyValue(r)||t[r];if(f&&n){n=n.replace(q,"$1")||undefined}if(n===""&&!me(e)){n=g.style(e,r)}if(!d.pixelBoxStyles()&&Ze.test(n)&&Qe.test(r)){i=l.width;a=l.minWidth;s=l.maxWidth;l.minWidth=l.maxWidth=l.width=n;n=t.width;l.width=i;l.minWidth=a;l.maxWidth=s}}return n!==undefined?n+"":n}function We(e,r){return{get:function(){if(e()){delete this.get;return}return(this.get=r).apply(this,arguments)}}}var Ke=["Webkit","Moz","ms"],er=m.createElement("div").style,rr={};function tr(e){var r=e[0].toUpperCase()+e.slice(1),t=Ke.length;while(t--){e=Ke[t]+r;if(e in er){return e}}}function ir(e){var r=g.cssProps[e]||rr[e];if(r){return r}if(e in er){return e}return rr[e]=tr(e)||e}var ar=/^(none|table(?!-c[ea]).+)/,sr={position:"absolute",visibility:"hidden",display:"block"},nr={letterSpacing:"0",fontWeight:"400"};function fr(e,r,t){var i=de.exec(r);return i?Math.max(0,i[2]-(t||0))+(i[3]||"px"):r}function lr(e,r,t,i,a,s){var n=r==="width"?1:0,f=0,l=0,o=0;if(t===(i?"border":"content")){return 0}for(;n<4;n+=2){if(t==="margin"){o+=g.css(e,t+he[n],true,a)}if(!i){l+=g.css(e,"padding"+he[n],true,a);if(t!=="padding"){l+=g.css(e,"border"+he[n]+"Width",true,a)}else{f+=g.css(e,"border"+he[n]+"Width",true,a)}}else{if(t==="content"){l-=g.css(e,"padding"+he[n],true,a)}if(t!=="margin"){l-=g.css(e,"border"+he[n]+"Width",true,a)}}}if(!i&&s>=0){l+=Math.max(0,Math.ceil(e["offset"+r[0].toUpperCase()+r.slice(1)]-s-l-f-.5))||0}return l+o}function or(e,r,t){var i=Xe(e),a=!d.boxSizingReliable()||t,s=a&&g.css(e,"boxSizing",false,i)==="border-box",n=s,f=Ye(e,r,i),l="offset"+r[0].toUpperCase()+r.slice(1);if(Ze.test(f)){if(!t){return f}f="auto"}if((!d.boxSizingReliable()&&s||!d.reliableTrDimensions()&&b(e,"tr")||f==="auto"||!parseFloat(f)&&g.css(e,"display",false,i)==="inline")&&e.getClientRects().length){s=g.css(e,"boxSizing",false,i)==="border-box";n=l in e;if(n){f=e[l]}}f=parseFloat(f)||0;return f+lr(e,r,t||(s?"border":"content"),n,i,f)+"px"}g.extend({cssHooks:{opacity:{get:function(e,r){if(r){var t=Ye(e,"opacity");return t===""?"1":t}}}},cssNumber:{animationIterationCount:true,aspectRatio:true,borderImageSlice:true,columnCount:true,flexGrow:true,flexShrink:true,fontWeight:true,gridArea:true,gridColumn:true,gridColumnEnd:true,gridColumnStart:true,gridRow:true,gridRowEnd:true,gridRowStart:true,lineHeight:true,opacity:true,order:true,orphans:true,scale:true,widows:true,zIndex:true,zoom:true,fillOpacity:true,floodOpacity:true,stopOpacity:true,strokeMiterlimit:true,strokeOpacity:true},cssProps:{},style:function(e,r,t,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var a,s,n,f=ie(r),l=Ge.test(r),o=e.style;if(!l){r=ir(f)}n=g.cssHooks[r]||g.cssHooks[f];if(t!==undefined){s=typeof t;if(s==="string"&&(a=de.exec(t))&&a[1]){t=ye(e,r,a);s="number"}if(t==null||t!==t){return}if(s==="number"&&!l){t+=a&&a[3]||(g.cssNumber[f]?"":"px")}if(!d.clearCloneStyle&&t===""&&r.indexOf("background")===0){o[r]="inherit"}if(!n||!("set"in n)||(t=n.set(e,t,i))!==undefined){if(l){o.setProperty(r,t)}else{o[r]=t}}}else{if(n&&"get"in n&&(a=n.get(e,false,i))!==undefined){return a}return o[r]}},css:function(e,r,t,i){var a,s,n,f=ie(r),l=Ge.test(r);if(!l){r=ir(f)}n=g.cssHooks[r]||g.cssHooks[f];if(n&&"get"in n){a=n.get(e,true,t)}if(a===undefined){a=Ye(e,r,i)}if(a==="normal"&&r in nr){a=nr[r]}if(t===""||t){s=parseFloat(a);return t===true||isFinite(s)?s||0:a}return a}});g.each(["height","width"],(function(e,r){g.cssHooks[r]={get:function(e,t,i){if(t){return ar.test(g.css(e,"display"))&&(!e.getClientRects().length||!e.getBoundingClientRect().width)?$e(e,sr,(function(){return or(e,r,i)})):or(e,r,i)}},set:function(e,t,i){var a,s=Xe(e),n=!d.scrollboxSize()&&s.position==="absolute",f=n||i,l=f&&g.css(e,"boxSizing",false,s)==="border-box",o=i?lr(e,r,i,l,s):0;if(l&&n){o-=Math.ceil(e["offset"+r[0].toUpperCase()+r.slice(1)]-parseFloat(s[r])-lr(e,r,"border",false,s)-.5)}if(o&&(a=de.exec(t))&&(a[3]||"px")!=="px"){e.style[r]=t;t=g.css(e,r)}return fr(e,t,o)}}}));g.cssHooks.marginLeft=We(d.reliableMarginLeft,(function(e,r){if(r){return(parseFloat(Ye(e,"marginLeft"))||e.getBoundingClientRect().left-$e(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"}}));g.each({margin:"",padding:"",border:"Width"},(function(e,r){g.cssHooks[e+r]={expand:function(t){var i=0,a={},s=typeof t==="string"?t.split(" "):[t];for(;i<4;i++){a[e+he[i]+r]=s[i]||s[i-2]||s[0]}return a}};if(e!=="margin"){g.cssHooks[e+r].set=fr}}));g.fn.extend({css:function(e,r){return K(this,(function(e,r,t){var i,a,s={},n=0;if(Array.isArray(r)){i=Xe(e);a=r.length;for(;n<a;n++){s[r[n]]=g.css(e,r[n],false,i)}return s}return t!==undefined?g.style(e,r,t):g.css(e,r)}),e,r,arguments.length>1)}});function ur(e,r,t,i,a){return new ur.prototype.init(e,r,t,i,a)}g.Tween=ur;ur.prototype={constructor:ur,init:function(e,r,t,i,a,s){this.elem=e;this.prop=t;this.easing=a||g.easing._default;this.options=r;this.start=this.now=this.cur();this.end=i;this.unit=s||(g.cssNumber[t]?"":"px")},cur:function(){var e=ur.propHooks[this.prop];return e&&e.get?e.get(this):ur.propHooks._default.get(this)},run:function(e){var r,t=ur.propHooks[this.prop];if(this.options.duration){this.pos=r=g.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=r=e}this.now=(this.end-this.start)*r+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(t&&t.set){t.set(this)}else{ur.propHooks._default.set(this)}return this}};ur.prototype.init.prototype=ur.prototype;ur.propHooks={_default:{get:function(e){var r;if(e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null){return e.elem[e.prop]}r=g.css(e.elem,e.prop,"");return!r||r==="auto"?0:r},set:function(e){if(g.fx.step[e.prop]){g.fx.step[e.prop](e)}else if(e.elem.nodeType===1&&(g.cssHooks[e.prop]||e.elem.style[ir(e.prop)]!=null)){g.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};ur.propHooks.scrollTop=ur.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};g.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"};g.fx=ur.prototype.init;g.fx.step={};var cr,vr,dr=/^(?:toggle|show|hide)$/,hr=/queueHooks$/;function pr(){if(vr){if(m.hidden===false&&e.requestAnimationFrame){e.requestAnimationFrame(pr)}else{e.setTimeout(pr,g.fx.interval)}g.fx.tick()}}function mr(){e.setTimeout((function(){cr=undefined}));return cr=Date.now()}function Tr(e,r){var t,i=0,a={height:e};r=r?1:0;for(;i<4;i+=2-r){t=he[i];a["margin"+t]=a["padding"+t]=e}if(r){a.opacity=a.width=e}return a}function Ar(e,r,t){var i,a=(Or.tweeners[r]||[]).concat(Or.tweeners["*"]),s=0,n=a.length;for(;s<n;s++){if(i=a[s].call(t,r,e)){return i}}}function yr(e,r,t){var i,a,s,n,f,l,o,u,c="width"in r||"height"in r,v=this,d={},h=e.style,p=e.nodeType&&Ae(e),m=ne.get(e,"fxshow");if(!t.queue){n=g._queueHooks(e,"fx");if(n.unqueued==null){n.unqueued=0;f=n.empty.fire;n.empty.fire=function(){if(!n.unqueued){f()}}}n.unqueued++;v.always((function(){v.always((function(){n.unqueued--;if(!g.queue(e,"fx").length){n.empty.fire()}}))}))}for(i in r){a=r[i];if(dr.test(a)){delete r[i];s=s||a==="toggle";if(a===(p?"hide":"show")){if(a==="show"&&m&&m[i]!==undefined){p=true}else{continue}}d[i]=m&&m[i]||g.style(e,i)}}l=!g.isEmptyObject(r);if(!l&&g.isEmptyObject(d)){return}if(c&&e.nodeType===1){t.overflow=[h.overflow,h.overflowX,h.overflowY];o=m&&m.display;if(o==null){o=ne.get(e,"display")}u=g.css(e,"display");if(u==="none"){if(o){u=o}else{ge([e],true);o=e.style.display||o;u=g.css(e,"display");ge([e])}}if(u==="inline"||u==="inline-block"&&o!=null){if(g.css(e,"float")==="none"){if(!l){v.done((function(){h.display=o}));if(o==null){u=h.display;o=u==="none"?"":u}}h.display="inline-block"}}}if(t.overflow){h.overflow="hidden";v.always((function(){h.overflow=t.overflow[0];h.overflowX=t.overflow[1];h.overflowY=t.overflow[2]}))}l=false;for(i in d){if(!l){if(m){if("hidden"in m){p=m.hidden}}else{m=ne.access(e,"fxshow",{display:o})}if(s){m.hidden=!p}if(p){ge([e],true)}v.done((function(){if(!p){ge([e])}ne.remove(e,"fxshow");for(i in d){g.style(e,i,d[i])}}))}l=Ar(p?m[i]:0,i,v);if(!(i in m)){m[i]=l.start;if(p){l.end=l.start;l.start=0}}}}function wr(e,r){var t,i,a,s,n;for(t in e){i=ie(t);a=r[i];s=e[t];if(Array.isArray(s)){a=s[1];s=e[t]=s[0]}if(t!==i){e[i]=s;delete e[t]}n=g.cssHooks[i];if(n&&"expand"in n){s=n.expand(s);delete e[i];for(t in s){if(!(t in e)){e[t]=s[t];r[t]=a}}}else{r[i]=a}}}function Or(e,r,t){var i,a,s=0,n=Or.prefilters.length,f=g.Deferred().always((function(){delete l.elem})),l=function(){if(a){return false}var r=cr||mr(),t=Math.max(0,o.startTime+o.duration-r),i=t/o.duration||0,s=1-i,n=0,l=o.tweens.length;for(;n<l;n++){o.tweens[n].run(s)}f.notifyWith(e,[o,s,t]);if(s<1&&l){return t}if(!l){f.notifyWith(e,[o,1,0])}f.resolveWith(e,[o]);return false},o=f.promise({elem:e,props:g.extend({},r),opts:g.extend(true,{specialEasing:{},easing:g.easing._default},t),originalProperties:r,originalOptions:t,startTime:cr||mr(),duration:t.duration,tweens:[],createTween:function(r,t){var i=g.Tween(e,o.opts,r,t,o.opts.specialEasing[r]||o.opts.easing);o.tweens.push(i);return i},stop:function(r){var t=0,i=r?o.tweens.length:0;if(a){return this}a=true;for(;t<i;t++){o.tweens[t].run(1)}if(r){f.notifyWith(e,[o,1,0]);f.resolveWith(e,[o,r])}else{f.rejectWith(e,[o,r])}return this}}),u=o.props;wr(u,o.opts.specialEasing);for(;s<n;s++){i=Or.prefilters[s].call(o,e,u,o.opts);if(i){if(h(i.stop)){g._queueHooks(o.elem,o.opts.queue).stop=i.stop.bind(i)}return i}}g.map(u,Ar,o);if(h(o.opts.start)){o.opts.start.call(e,o)}o.progress(o.opts.progress).done(o.opts.done,o.opts.complete).fail(o.opts.fail).always(o.opts.always);g.fx.timer(g.extend(l,{elem:e,anim:o,queue:o.opts.queue}));return o}g.Animation=g.extend(Or,{tweeners:{"*":[function(e,r){var t=this.createTween(e,r);ye(t.elem,e,de.exec(r),t);return t}]},tweener:function(e,r){if(h(e)){r=e;e=["*"]}else{e=e.match(H)}var t,i=0,a=e.length;for(;i<a;i++){t=e[i];Or.tweeners[t]=Or.tweeners[t]||[];Or.tweeners[t].unshift(r)}},prefilters:[yr],prefilter:function(e,r){if(r){Or.prefilters.unshift(e)}else{Or.prefilters.push(e)}}});g.speed=function(e,r,t){var i=e&&typeof e==="object"?g.extend({},e):{complete:t||!t&&r||h(e)&&e,duration:e,easing:t&&r||r&&!h(r)&&r};if(g.fx.off){i.duration=0}else{if(typeof i.duration!=="number"){if(i.duration in g.fx.speeds){i.duration=g.fx.speeds[i.duration]}else{i.duration=g.fx.speeds._default}}}if(i.queue==null||i.queue===true){i.queue="fx"}i.old=i.complete;i.complete=function(){if(h(i.old)){i.old.call(this)}if(i.queue){g.dequeue(this,i.queue)}};return i};g.fn.extend({fadeTo:function(e,r,t,i){return this.filter(Ae).css("opacity",0).show().end().animate({opacity:r},e,t,i)},animate:function(e,r,t,i){var a=g.isEmptyObject(e),s=g.speed(r,t,i),n=function(){var r=Or(this,g.extend({},e),s);if(a||ne.get(this,"finish")){r.stop(true)}};n.finish=n;return a||s.queue===false?this.each(n):this.queue(s.queue,n)},stop:function(e,r,t){var i=function(e){var r=e.stop;delete e.stop;r(t)};if(typeof e!=="string"){t=r;r=e;e=undefined}if(r){this.queue(e||"fx",[])}return this.each((function(){var r=true,a=e!=null&&e+"queueHooks",s=g.timers,n=ne.get(this);if(a){if(n[a]&&n[a].stop){i(n[a])}}else{for(a in n){if(n[a]&&n[a].stop&&hr.test(a)){i(n[a])}}}for(a=s.length;a--;){if(s[a].elem===this&&(e==null||s[a].queue===e)){s[a].anim.stop(t);r=false;s.splice(a,1)}}if(r||!t){g.dequeue(this,e)}}))},finish:function(e){if(e!==false){e=e||"fx"}return this.each((function(){var r,t=ne.get(this),i=t[e+"queue"],a=t[e+"queueHooks"],s=g.timers,n=i?i.length:0;t.finish=true;g.queue(this,e,[]);if(a&&a.stop){a.stop.call(this,true)}for(r=s.length;r--;){if(s[r].elem===this&&s[r].queue===e){s[r].anim.stop(true);s.splice(r,1)}}for(r=0;r<n;r++){if(i[r]&&i[r].finish){i[r].finish.call(this)}}delete t.finish}))}});g.each(["toggle","show","hide"],(function(e,r){var t=g.fn[r];g.fn[r]=function(e,i,a){return e==null||typeof e==="boolean"?t.apply(this,arguments):this.animate(Tr(r,true),e,i,a)}}));g.each({slideDown:Tr("show"),slideUp:Tr("hide"),slideToggle:Tr("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,r){g.fn[e]=function(e,t,i){return this.animate(r,e,t,i)}}));g.timers=[];g.fx.tick=function(){var e,r=0,t=g.timers;cr=Date.now();for(;r<t.length;r++){e=t[r];if(!e()&&t[r]===e){t.splice(r--,1)}}if(!t.length){g.fx.stop()}cr=undefined};g.fx.timer=function(e){g.timers.push(e);g.fx.start()};g.fx.interval=13;g.fx.start=function(){if(vr){return}vr=true;pr()};g.fx.stop=function(){vr=null};g.fx.speeds={slow:600,fast:200,_default:400};g.fn.delay=function(r,t){r=g.fx?g.fx.speeds[r]||r:r;t=t||"fx";return this.queue(t,(function(t,i){var a=e.setTimeout(t,r);i.stop=function(){e.clearTimeout(a)}}))};(function(){var e=m.createElement("input"),r=m.createElement("select"),t=r.appendChild(m.createElement("option"));e.type="checkbox";d.checkOn=e.value!=="";d.optSelected=t.selected;e=m.createElement("input");e.value="t";e.type="radio";d.radioValue=e.value==="t"})();var gr,_r=g.expr.attrHandle;g.fn.extend({attr:function(e,r){return K(this,g.attr,e,r,arguments.length>1)},removeAttr:function(e){return this.each((function(){g.removeAttr(this,e)}))}});g.extend({attr:function(e,r,t){var i,a,s=e.nodeType;if(s===3||s===8||s===2){return}if(typeof e.getAttribute==="undefined"){return g.prop(e,r,t)}if(s!==1||!g.isXMLDoc(e)){a=g.attrHooks[r.toLowerCase()]||(g.expr.match.bool.test(r)?gr:undefined)}if(t!==undefined){if(t===null){g.removeAttr(e,r);return}if(a&&"set"in a&&(i=a.set(e,t,r))!==undefined){return i}e.setAttribute(r,t+"");return t}if(a&&"get"in a&&(i=a.get(e,r))!==null){return i}i=g.find.attr(e,r);return i==null?undefined:i},attrHooks:{type:{set:function(e,r){if(!d.radioValue&&r==="radio"&&b(e,"input")){var t=e.value;e.setAttribute("type",r);if(t){e.value=t}return r}}}},removeAttr:function(e,r){var t,i=0,a=r&&r.match(H);if(a&&e.nodeType===1){while(t=a[i++]){e.removeAttribute(t)}}}});gr={set:function(e,r,t){if(r===false){g.removeAttr(e,t)}else{e.setAttribute(t,t)}return t}};g.each(g.expr.match.bool.source.match(/\w+/g),(function(e,r){var t=_r[r]||g.find.attr;_r[r]=function(e,r,i){var a,s,n=r.toLowerCase();if(!i){s=_r[n];_r[n]=a;a=t(e,r,i)!=null?n:null;_r[n]=s}return a}}));var br=/^(?:input|select|textarea|button)$/i,xr=/^(?:a|area)$/i;g.fn.extend({prop:function(e,r){return K(this,g.prop,e,r,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[g.propFix[e]||e]}))}});g.extend({prop:function(e,r,t){var i,a,s=e.nodeType;if(s===3||s===8||s===2){return}if(s!==1||!g.isXMLDoc(e)){r=g.propFix[r]||r;a=g.propHooks[r]}if(t!==undefined){if(a&&"set"in a&&(i=a.set(e,t,r))!==undefined){return i}return e[r]=t}if(a&&"get"in a&&(i=a.get(e,r))!==null){return i}return e[r]},propHooks:{tabIndex:{get:function(e){var r=g.find.attr(e,"tabindex");if(r){return parseInt(r,10)}if(br.test(e.nodeName)||xr.test(e.nodeName)&&e.href){return 0}return-1}}},propFix:{for:"htmlFor",class:"className"}});if(!d.optSelected){g.propHooks.selected={get:function(e){return null},set:function(e){}}}g.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){g.propFix[this.toLowerCase()]=this}));function Sr(e){var r=e.match(H)||[];return r.join(" ")}function Ir(e){return e.getAttribute&&e.getAttribute("class")||""}function kr(e){if(Array.isArray(e)){return e}if(typeof e==="string"){return e.match(H)||[]}return[]}g.fn.extend({addClass:function(e){var r,t,i,a,s,n;if(h(e)){return this.each((function(r){g(this).addClass(e.call(this,r,Ir(this)))}))}r=kr(e);if(r.length){return this.each((function(){i=Ir(this);t=this.nodeType===1&&" "+Sr(i)+" ";if(t){for(s=0;s<r.length;s++){a=r[s];if(t.indexOf(" "+a+" ")<0){t+=a+" "}}n=Sr(t);if(i!==n){this.setAttribute("class",n)}}}))}return this},removeClass:function(e){var r,t,i,a,s,n;if(h(e)){return this.each((function(r){g(this).removeClass(e.call(this,r,Ir(this)))}))}if(!arguments.length){return this.attr("class","")}r=kr(e);if(r.length){return this.each((function(){i=Ir(this);t=this.nodeType===1&&" "+Sr(i)+" ";if(t){for(s=0;s<r.length;s++){a=r[s];while(t.indexOf(" "+a+" ")>-1){t=t.replace(" "+a+" "," ")}}n=Sr(t);if(i!==n){this.setAttribute("class",n)}}}))}return this},toggleClass:function(e,r){var t,i,a,s,n=typeof e,f=n==="string"||Array.isArray(e);if(h(e)){return this.each((function(t){g(this).toggleClass(e.call(this,t,Ir(this),r),r)}))}if(typeof r==="boolean"&&f){return r?this.addClass(e):this.removeClass(e)}t=kr(e);return this.each((function(){if(f){s=g(this);for(a=0;a<t.length;a++){i=t[a];if(s.hasClass(i)){s.removeClass(i)}else{s.addClass(i)}}}else if(e===undefined||n==="boolean"){i=Ir(this);if(i){ne.set(this,"__className__",i)}if(this.setAttribute){this.setAttribute("class",i||e===false?"":ne.get(this,"__className__")||"")}}}))},hasClass:function(e){var r,t,i=0;r=" "+e+" ";while(t=this[i++]){if(t.nodeType===1&&(" "+Sr(Ir(t))+" ").indexOf(r)>-1){return true}}return false}});var qr=/\r/g;g.fn.extend({val:function(e){var r,t,i,a=this[0];if(!arguments.length){if(a){r=g.valHooks[a.type]||g.valHooks[a.nodeName.toLowerCase()];if(r&&"get"in r&&(t=r.get(a,"value"))!==undefined){return t}t=a.value;if(typeof t==="string"){return t.replace(qr,"")}return t==null?"":t}return}i=h(e);return this.each((function(t){var a;if(this.nodeType!==1){return}if(i){a=e.call(this,t,g(this).val())}else{a=e}if(a==null){a=""}else if(typeof a==="number"){a+=""}else if(Array.isArray(a)){a=g.map(a,(function(e){return e==null?"":e+""}))}r=g.valHooks[this.type]||g.valHooks[this.nodeName.toLowerCase()];if(!r||!("set"in r)||r.set(this,a,"value")===undefined){this.value=a}}))}});g.extend({valHooks:{option:{get:function(e){var r=g.find.attr(e,"value");return r!=null?r:Sr(g.text(e))}},select:{get:function(e){var r,t,i,a=e.options,s=e.selectedIndex,n=e.type==="select-one",f=n?null:[],l=n?s+1:a.length;if(s<0){i=l}else{i=n?s:0}for(;i<l;i++){t=a[i];if((t.selected||i===s)&&!t.disabled&&(!t.parentNode.disabled||!b(t.parentNode,"optgroup"))){r=g(t).val();if(n){return r}f.push(r)}}return f},set:function(e,r){var t,i,a=e.options,s=g.makeArray(r),n=a.length;while(n--){i=a[n];if(i.selected=g.inArray(g.valHooks.option.get(i),s)>-1){t=true}}if(!t){e.selectedIndex=-1}return s}}}});g.each(["radio","checkbox"],(function(){g.valHooks[this]={set:function(e,r){if(Array.isArray(r)){return e.checked=g.inArray(g(e).val(),r)>-1}}};if(!d.checkOn){g.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}}));var Fr=e.location;var Pr={guid:Date.now()};var Nr=/\?/;g.parseXML=function(r){var t,i;if(!r||typeof r!=="string"){return null}try{t=(new e.DOMParser).parseFromString(r,"text/xml")}catch(e){}i=t&&t.getElementsByTagName("parsererror")[0];if(!t||i){g.error("Invalid XML: "+(i?g.map(i.childNodes,(function(e){return e.textContent})).join("\n"):r))}return t};var Dr=/^(?:focusinfocus|focusoutblur)$/,Er=function(e){e.stopPropagation()};g.extend(g.event,{trigger:function(r,t,i,a){var s,n,f,l,o,c,v,d,T=[i||m],A=u.call(r,"type")?r.type:r,y=u.call(r,"namespace")?r.namespace.split("."):[];n=d=f=i=i||m;if(i.nodeType===3||i.nodeType===8){return}if(Dr.test(A+g.event.triggered)){return}if(A.indexOf(".")>-1){y=A.split(".");A=y.shift();y.sort()}o=A.indexOf(":")<0&&"on"+A;r=r[g.expando]?r:new g.Event(A,typeof r==="object"&&r);r.isTrigger=a?2:3;r.namespace=y.join(".");r.rnamespace=r.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;r.result=undefined;if(!r.target){r.target=i}t=t==null?[r]:g.makeArray(t,[r]);v=g.event.special[A]||{};if(!a&&v.trigger&&v.trigger.apply(i,t)===false){return}if(!a&&!v.noBubble&&!p(i)){l=v.delegateType||A;if(!Dr.test(l+A)){n=n.parentNode}for(;n;n=n.parentNode){T.push(n);f=n}if(f===(i.ownerDocument||m)){T.push(f.defaultView||f.parentWindow||e)}}s=0;while((n=T[s++])&&!r.isPropagationStopped()){d=n;r.type=s>1?l:v.bindType||A;c=(ne.get(n,"events")||Object.create(null))[r.type]&&ne.get(n,"handle");if(c){c.apply(n,t)}c=o&&n[o];if(c&&c.apply&&ae(n)){r.result=c.apply(n,t);if(r.result===false){r.preventDefault()}}}r.type=A;if(!a&&!r.isDefaultPrevented()){if((!v._default||v._default.apply(T.pop(),t)===false)&&ae(i)){if(o&&h(i[A])&&!p(i)){f=i[o];if(f){i[o]=null}g.event.triggered=A;if(r.isPropagationStopped()){d.addEventListener(A,Er)}i[A]();if(r.isPropagationStopped()){d.removeEventListener(A,Er)}g.event.triggered=undefined;if(f){i[o]=f}}}}return r.result},simulate:function(e,r,t){var i=g.extend(new g.Event,t,{type:e,isSimulated:true});g.event.trigger(i,null,r)}});g.fn.extend({trigger:function(e,r){return this.each((function(){g.event.trigger(e,r,this)}))},triggerHandler:function(e,r){var t=this[0];if(t){return g.event.trigger(e,r,t,true)}}});var Cr=/\[\]$/,jr=/\r?\n/g,Rr=/^(?:submit|button|image|reset|file)$/i,Mr=/^(?:input|select|textarea|keygen)/i;function Jr(e,r,t,i){var a;if(Array.isArray(r)){g.each(r,(function(r,a){if(t||Cr.test(e)){i(e,a)}else{Jr(e+"["+(typeof a==="object"&&a!=null?r:"")+"]",a,t,i)}}))}else if(!t&&y(r)==="object"){for(a in r){Jr(e+"["+a+"]",r[a],t,i)}}else{i(e,r)}}g.param=function(e,r){var t,i=[],a=function(e,r){var t=h(r)?r():r;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t==null?"":t)};if(e==null){return""}if(Array.isArray(e)||e.jquery&&!g.isPlainObject(e)){g.each(e,(function(){a(this.name,this.value)}))}else{for(t in e){Jr(t,e[t],r,a)}}return i.join("&")};g.fn.extend({serialize:function(){return g.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=g.prop(this,"elements");return e?g.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!g(this).is(":disabled")&&Mr.test(this.nodeName)&&!Rr.test(e)&&(this.checked||!_e.test(e))})).map((function(e,r){var t=g(this).val();if(t==null){return null}if(Array.isArray(t)){return g.map(t,(function(e){return{name:r.name,value:e.replace(jr,"\r\n")}}))}return{name:r.name,value:t.replace(jr,"\r\n")}})).get()}});var Lr=/%20/g,Vr=/#.*$/,Br=/([?&])_=[^&]*/,Ur=/^(.*?):[ \t]*([^\r\n]*)$/gm,zr=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Hr=/^(?:GET|HEAD)$/,Zr=/^\/\//,Gr={},Xr={},$r="*/".concat("*"),Qr=m.createElement("a");Qr.href=Fr.href;function Yr(e){return function(r,t){if(typeof r!=="string"){t=r;r="*"}var i,a=0,s=r.toLowerCase().match(H)||[];if(h(t)){while(i=s[a++]){if(i[0]==="+"){i=i.slice(1)||"*";(e[i]=e[i]||[]).unshift(t)}else{(e[i]=e[i]||[]).push(t)}}}}}function Wr(e,r,t,i){var a={},s=e===Xr;function n(f){var l;a[f]=true;g.each(e[f]||[],(function(e,f){var o=f(r,t,i);if(typeof o==="string"&&!s&&!a[o]){r.dataTypes.unshift(o);n(o);return false}else if(s){return!(l=o)}}));return l}return n(r.dataTypes[0])||!a["*"]&&n("*")}function Kr(e,r){var t,i,a=g.ajaxSettings.flatOptions||{};for(t in r){if(r[t]!==undefined){(a[t]?e:i||(i={}))[t]=r[t]}}if(i){g.extend(true,e,i)}return e}function et(e,r,t){var i,a,s,n,f=e.contents,l=e.dataTypes;while(l[0]==="*"){l.shift();if(i===undefined){i=e.mimeType||r.getResponseHeader("Content-Type")}}if(i){for(a in f){if(f[a]&&f[a].test(i)){l.unshift(a);break}}}if(l[0]in t){s=l[0]}else{for(a in t){if(!l[0]||e.converters[a+" "+l[0]]){s=a;break}if(!n){n=a}}s=s||n}if(s){if(s!==l[0]){l.unshift(s)}return t[s]}}function rt(e,r,t,i){var a,s,n,f,l,o={},u=e.dataTypes.slice();if(u[1]){for(n in e.converters){o[n.toLowerCase()]=e.converters[n]}}s=u.shift();while(s){if(e.responseFields[s]){t[e.responseFields[s]]=r}if(!l&&i&&e.dataFilter){r=e.dataFilter(r,e.dataType)}l=s;s=u.shift();if(s){if(s==="*"){s=l}else if(l!=="*"&&l!==s){n=o[l+" "+s]||o["* "+s];if(!n){for(a in o){f=a.split(" ");if(f[1]===s){n=o[l+" "+f[0]]||o["* "+f[0]];if(n){if(n===true){n=o[a]}else if(o[a]!==true){s=f[0];u.unshift(f[1])}break}}}}if(n!==true){if(n&&e.throws){r=n(r)}else{try{r=n(r)}catch(e){return{state:"parsererror",error:n?e:"No conversion from "+l+" to "+s}}}}}}}return{state:"success",data:r}}g.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Fr.href,type:"GET",isLocal:zr.test(Fr.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$r,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":g.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,r){return r?Kr(Kr(e,g.ajaxSettings),r):Kr(g.ajaxSettings,e)},ajaxPrefilter:Yr(Gr),ajaxTransport:Yr(Xr),ajax:function(r,t){if(typeof r==="object"){t=r;r=undefined}t=t||{};var i,a,s,n,f,l,o,u,c,v,d=g.ajaxSetup({},t),h=d.context||d,p=d.context&&(h.nodeType||h.jquery)?g(h):g.event,T=g.Deferred(),A=g.Callbacks("once memory"),y=d.statusCode||{},w={},O={},_="canceled",b={readyState:0,getResponseHeader:function(e){var r;if(o){if(!n){n={};while(r=Ur.exec(s)){n[r[1].toLowerCase()+" "]=(n[r[1].toLowerCase()+" "]||[]).concat(r[2])}}r=n[e.toLowerCase()+" "]}return r==null?null:r.join(", ")},getAllResponseHeaders:function(){return o?s:null},setRequestHeader:function(e,r){if(o==null){e=O[e.toLowerCase()]=O[e.toLowerCase()]||e;w[e]=r}return this},overrideMimeType:function(e){if(o==null){d.mimeType=e}return this},statusCode:function(e){var r;if(e){if(o){b.always(e[b.status])}else{for(r in e){y[r]=[y[r],e[r]]}}}return this},abort:function(e){var r=e||_;if(i){i.abort(r)}x(0,r);return this}};T.promise(b);d.url=((r||d.url||Fr.href)+"").replace(Zr,Fr.protocol+"//");d.type=t.method||t.type||d.method||d.type;d.dataTypes=(d.dataType||"*").toLowerCase().match(H)||[""];if(d.crossDomain==null){l=m.createElement("a");try{l.href=d.url;l.href=l.href;d.crossDomain=Qr.protocol+"//"+Qr.host!==l.protocol+"//"+l.host}catch(e){d.crossDomain=true}}if(d.data&&d.processData&&typeof d.data!=="string"){d.data=g.param(d.data,d.traditional)}Wr(Gr,d,t,b);if(o){return b}u=g.event&&d.global;if(u&&g.active++===0){g.event.trigger("ajaxStart")}d.type=d.type.toUpperCase();d.hasContent=!Hr.test(d.type);a=d.url.replace(Vr,"");if(!d.hasContent){v=d.url.slice(a.length);if(d.data&&(d.processData||typeof d.data==="string")){a+=(Nr.test(a)?"&":"?")+d.data;delete d.data}if(d.cache===false){a=a.replace(Br,"$1");v=(Nr.test(a)?"&":"?")+"_="+Pr.guid+++v}d.url=a+v}else if(d.data&&d.processData&&(d.contentType||"").indexOf("application/x-www-form-urlencoded")===0){d.data=d.data.replace(Lr,"+")}if(d.ifModified){if(g.lastModified[a]){b.setRequestHeader("If-Modified-Since",g.lastModified[a])}if(g.etag[a]){b.setRequestHeader("If-None-Match",g.etag[a])}}if(d.data&&d.hasContent&&d.contentType!==false||t.contentType){b.setRequestHeader("Content-Type",d.contentType)}b.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+$r+"; q=0.01":""):d.accepts["*"]);for(c in d.headers){b.setRequestHeader(c,d.headers[c])}if(d.beforeSend&&(d.beforeSend.call(h,b,d)===false||o)){return b.abort()}_="abort";A.add(d.complete);b.done(d.success);b.fail(d.error);i=Wr(Xr,d,t,b);if(!i){x(-1,"No Transport")}else{b.readyState=1;if(u){p.trigger("ajaxSend",[b,d])}if(o){return b}if(d.async&&d.timeout>0){f=e.setTimeout((function(){b.abort("timeout")}),d.timeout)}try{o=false;i.send(w,x)}catch(e){if(o){throw e}x(-1,e)}}function x(r,t,n,l){var c,v,m,w,O,_=t;if(o){return}o=true;if(f){e.clearTimeout(f)}i=undefined;s=l||"";b.readyState=r>0?4:0;c=r>=200&&r<300||r===304;if(n){w=et(d,b,n)}if(!c&&g.inArray("script",d.dataTypes)>-1&&g.inArray("json",d.dataTypes)<0){d.converters["text script"]=function(){}}w=rt(d,w,b,c);if(c){if(d.ifModified){O=b.getResponseHeader("Last-Modified");if(O){g.lastModified[a]=O}O=b.getResponseHeader("etag");if(O){g.etag[a]=O}}if(r===204||d.type==="HEAD"){_="nocontent"}else if(r===304){_="notmodified"}else{_=w.state;v=w.data;m=w.error;c=!m}}else{m=_;if(r||!_){_="error";if(r<0){r=0}}}b.status=r;b.statusText=(t||_)+"";if(c){T.resolveWith(h,[v,_,b])}else{T.rejectWith(h,[b,_,m])}b.statusCode(y);y=undefined;if(u){p.trigger(c?"ajaxSuccess":"ajaxError",[b,d,c?v:m])}A.fireWith(h,[b,_]);if(u){p.trigger("ajaxComplete",[b,d]);if(! --g.active){g.event.trigger("ajaxStop")}}}return b},getJSON:function(e,r,t){return g.get(e,r,t,"json")},getScript:function(e,r){return g.get(e,undefined,r,"script")}});g.each(["get","post"],(function(e,r){g[r]=function(e,t,i,a){if(h(t)){a=a||i;i=t;t=undefined}return g.ajax(g.extend({url:e,type:r,dataType:a,data:t,success:i},g.isPlainObject(e)&&e))}}));g.ajaxPrefilter((function(e){var r;for(r in e.headers){if(r.toLowerCase()==="content-type"){e.contentType=e.headers[r]||""}}}));g._evalUrl=function(e,r,t){return g.ajax({url:e,type:"GET",dataType:"script",cache:true,async:false,global:false,converters:{"text script":function(){}},dataFilter:function(e){g.globalEval(e,r,t)}})};g.fn.extend({wrapAll:function(e){var r;if(this[0]){if(h(e)){e=e.call(this[0])}r=g(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){r.insertBefore(this[0])}r.map((function(){var e=this;while(e.firstElementChild){e=e.firstElementChild}return e})).append(this)}return this},wrapInner:function(e){if(h(e)){return this.each((function(r){g(this).wrapInner(e.call(this,r))}))}return this.each((function(){var r=g(this),t=r.contents();if(t.length){t.wrapAll(e)}else{r.append(e)}}))},wrap:function(e){var r=h(e);return this.each((function(t){g(this).wrapAll(r?e.call(this,t):e)}))},unwrap:function(e){this.parent(e).not("body").each((function(){g(this).replaceWith(this.childNodes)}));return this}});g.expr.pseudos.hidden=function(e){return!g.expr.pseudos.visible(e)};g.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};g.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var tt={0:200,1223:204},it=g.ajaxSettings.xhr();d.cors=!!it&&"withCredentials"in it;d.ajax=it=!!it;g.ajaxTransport((function(r){var t,i;if(d.cors||it&&!r.crossDomain){return{send:function(a,s){var n,f=r.xhr();f.open(r.type,r.url,r.async,r.username,r.password);if(r.xhrFields){for(n in r.xhrFields){f[n]=r.xhrFields[n]}}if(r.mimeType&&f.overrideMimeType){f.overrideMimeType(r.mimeType)}if(!r.crossDomain&&!a["X-Requested-With"]){a["X-Requested-With"]="XMLHttpRequest"}for(n in a){f.setRequestHeader(n,a[n])}t=function(e){return function(){if(t){t=i=f.onload=f.onerror=f.onabort=f.ontimeout=f.onreadystatechange=null;if(e==="abort"){f.abort()}else if(e==="error"){if(typeof f.status!=="number"){s(0,"error")}else{s(f.status,f.statusText)}}else{s(tt[f.status]||f.status,f.statusText,(f.responseType||"text")!=="text"||typeof f.responseText!=="string"?{binary:f.response}:{text:f.responseText},f.getAllResponseHeaders())}}}};f.onload=t();i=f.onerror=f.ontimeout=t("error");if(f.onabort!==undefined){f.onabort=i}else{f.onreadystatechange=function(){if(f.readyState===4){e.setTimeout((function(){if(t){i()}}))}}}t=t("abort");try{f.send(r.hasContent&&r.data||null)}catch(e){if(t){throw e}}},abort:function(){if(t){t()}}}}}));g.ajaxPrefilter((function(e){if(e.crossDomain){e.contents.script=false}}));g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){g.globalEval(e);return e}}});g.ajaxPrefilter("script",(function(e){if(e.cache===undefined){e.cache=false}if(e.crossDomain){e.type="GET"}}));g.ajaxTransport("script",(function(e){if(e.crossDomain||e.scriptAttrs){var r,t;return{send:function(i,a){r=g("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",t=function(e){r.remove();t=null;if(e){a(e.type==="error"?404:200,e.type)}});m.head.appendChild(r[0])},abort:function(){if(t){t()}}}}}));var at=[],st=/(=)\?(?=&|$)|\?\?/;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=at.pop()||g.expando+"_"+Pr.guid++;this[e]=true;return e}});g.ajaxPrefilter("json jsonp",(function(r,t,i){var a,s,n,f=r.jsonp!==false&&(st.test(r.url)?"url":typeof r.data==="string"&&(r.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&st.test(r.data)&&"data");if(f||r.dataTypes[0]==="jsonp"){a=r.jsonpCallback=h(r.jsonpCallback)?r.jsonpCallback():r.jsonpCallback;if(f){r[f]=r[f].replace(st,"$1"+a)}else if(r.jsonp!==false){r.url+=(Nr.test(r.url)?"&":"?")+r.jsonp+"="+a}r.converters["script json"]=function(){if(!n){g.error(a+" was not called")}return n[0]};r.dataTypes[0]="json";s=e[a];e[a]=function(){n=arguments};i.always((function(){if(s===undefined){g(e).removeProp(a)}else{e[a]=s}if(r[a]){r.jsonpCallback=t.jsonpCallback;at.push(a)}if(n&&h(s)){s(n[0])}n=s=undefined}));return"script"}}));d.createHTMLDocument=function(){var e=m.implementation.createHTMLDocument("").body;e.innerHTML="<form></form><form></form>";return e.childNodes.length===2}();g.parseHTML=function(e,r,t){if(typeof e!=="string"){return[]}if(typeof r==="boolean"){t=r;r=false}var i,a,s;if(!r){if(d.createHTMLDocument){r=m.implementation.createHTMLDocument("");i=r.createElement("base");i.href=m.location.href;r.head.appendChild(i)}else{r=m}}a=R.exec(e);s=!t&&[];if(a){return[r.createElement(a[1])]}a=Fe([e],r,s);if(s&&s.length){g(s).remove()}return g.merge([],a.childNodes)};g.fn.load=function(e,r,t){var i,a,s,n=this,f=e.indexOf(" ");if(f>-1){i=Sr(e.slice(f));e=e.slice(0,f)}if(h(r)){t=r;r=undefined}else if(r&&typeof r==="object"){a="POST"}if(n.length>0){g.ajax({url:e,type:a||"GET",dataType:"html",data:r}).done((function(e){s=arguments;n.html(i?g("<div>").append(g.parseHTML(e)).find(i):e)})).always(t&&function(e,r){n.each((function(){t.apply(this,s||[e.responseText,r,e])}))})}return this};g.expr.pseudos.animated=function(e){return g.grep(g.timers,(function(r){return e===r.elem})).length};g.offset={setOffset:function(e,r,t){var i,a,s,n,f,l,o,u=g.css(e,"position"),c=g(e),v={};if(u==="static"){e.style.position="relative"}f=c.offset();s=g.css(e,"top");l=g.css(e,"left");o=(u==="absolute"||u==="fixed")&&(s+l).indexOf("auto")>-1;if(o){i=c.position();n=i.top;a=i.left}else{n=parseFloat(s)||0;a=parseFloat(l)||0}if(h(r)){r=r.call(e,t,g.extend({},f))}if(r.top!=null){v.top=r.top-f.top+n}if(r.left!=null){v.left=r.left-f.left+a}if("using"in r){r.using.call(e,v)}else{c.css(v)}}};g.fn.extend({offset:function(e){if(arguments.length){return e===undefined?this:this.each((function(r){g.offset.setOffset(this,e,r)}))}var r,t,i=this[0];if(!i){return}if(!i.getClientRects().length){return{top:0,left:0}}r=i.getBoundingClientRect();t=i.ownerDocument.defaultView;return{top:r.top+t.pageYOffset,left:r.left+t.pageXOffset}},position:function(){if(!this[0]){return}var e,r,t,i=this[0],a={top:0,left:0};if(g.css(i,"position")==="fixed"){r=i.getBoundingClientRect()}else{r=this.offset();t=i.ownerDocument;e=i.offsetParent||t.documentElement;while(e&&(e===t.body||e===t.documentElement)&&g.css(e,"position")==="static"){e=e.parentNode}if(e&&e!==i&&e.nodeType===1){a=g(e).offset();a.top+=g.css(e,"borderTopWidth",true);a.left+=g.css(e,"borderLeftWidth",true)}}return{top:r.top-a.top-g.css(i,"marginTop",true),left:r.left-a.left-g.css(i,"marginLeft",true)}},offsetParent:function(){return this.map((function(){var e=this.offsetParent;while(e&&g.css(e,"position")==="static"){e=e.offsetParent}return e||pe}))}});g.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,r){var t="pageYOffset"===r;g.fn[e]=function(i){return K(this,(function(e,i,a){var s;if(p(e)){s=e}else if(e.nodeType===9){s=e.defaultView}if(a===undefined){return s?s[r]:e[i]}if(s){s.scrollTo(!t?a:s.pageXOffset,t?a:s.pageYOffset)}else{e[i]=a}}),e,i,arguments.length)}}));g.each(["top","left"],(function(e,r){g.cssHooks[r]=We(d.pixelPosition,(function(e,t){if(t){t=Ye(e,r);return Ze.test(t)?g(e).position()[r]+"px":t}}))}));g.each({Height:"height",Width:"width"},(function(e,r){g.each({padding:"inner"+e,content:r,"":"outer"+e},(function(t,i){g.fn[i]=function(a,s){var n=arguments.length&&(t||typeof a!=="boolean"),f=t||(a===true||s===true?"margin":"border");return K(this,(function(r,t,a){var s;if(p(r)){return i.indexOf("outer")===0?r["inner"+e]:r.document.documentElement["client"+e]}if(r.nodeType===9){s=r.documentElement;return Math.max(r.body["scroll"+e],s["scroll"+e],r.body["offset"+e],s["offset"+e],s["client"+e])}return a===undefined?g.css(r,t,f):g.style(r,t,a,f)}),r,n?a:undefined,n)}}))}));g.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,r){g.fn[r]=function(e){return this.on(r,e)}}));g.fn.extend({bind:function(e,r,t){return this.on(e,null,r,t)},unbind:function(e,r){return this.off(e,null,r)},delegate:function(e,r,t,i){return this.on(r,e,t,i)},undelegate:function(e,r,t){return arguments.length===1?this.off(e,"**"):this.off(r,e||"**",t)},hover:function(e,r){return this.on("mouseenter",e).on("mouseleave",r||e)}});g.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),(function(e,r){g.fn[r]=function(e,t){return arguments.length>0?this.on(r,null,e,t):this.trigger(r)}}));var nt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;g.proxy=function(e,r){var t,i,s;if(typeof r==="string"){t=e[r];r=e;e=t}if(!h(e)){return undefined}i=a.call(arguments,2);s=function(){return e.apply(r||this,i.concat(a.call(arguments)))};s.guid=e.guid=e.guid||g.guid++;return s};g.holdReady=function(e){if(e){g.readyWait++}else{g.ready(true)}};g.isArray=Array.isArray;g.parseJSON=JSON.parse;g.nodeName=b;g.isFunction=h;g.isWindow=p;g.camelCase=ie;g.type=y;g.now=Date.now;g.isNumeric=function(e){var r=g.type(e);return(r==="number"||r==="string")&&!isNaN(e-parseFloat(e))};g.trim=function(e){return e==null?"":(e+"").replace(nt,"$1")};var ft=e.jQuery,lt=e.$;g.noConflict=function(r){if(e.$===g){e.$=lt}if(r&&e.jQuery===g){e.jQuery=ft}return g};if(typeof r==="undefined"){e.jQuery=e.$=g}return g}))}));var oat_pivotTable=createCommonjsModule((function(module,exports){const contains2=function(e,r){for(var t=0;t<e.length;t++){if(e[t]===r){return t}}return-1};var OAT={};OAT.Preferences={showAjax:1,useCursors:1,windowTypeOverride:0,version:"10.08.2023",httpError:1,allowDefaultResize:1,allowDefaultDrag:1};OAT.$=function(e){if(typeof e=="string"){var r=document.getElementById(e)}else{var r=e}if(e instanceof Array){var r=[];for(var t=0;t<e.length;t++){r.push(OAT.$(e[t]))}}if(!r)return false;return r};OAT.$$=function(e,r){var t=r||document;var i=t.getElementsByTagName("*");var a=[];if(OAT.Dom.isClass(t,e)){a.push(t)}for(var s=0;s<i.length;s++){if(OAT.Dom.isClass(i[s],e)){a.push(i[s])}}return a};OAT.$v=function(e){var r=OAT.$(e);if(!r)return false;if(!("value"in r))return false;return r.value};Array.prototype.findIndex=function(e){for(var r=0;r<this.length;r++)if(this[r]==e){return r}return-1};String.prototype.trimpivot=function(){var e=this.match(/^ *(.*?) *$/);return e?e[1]:this};OAT.addTextNode=function(e,r){var t=document.createTextNode(r);var i=jquery('<span id="span_txt_pivot"></span>')[0];i.appendChild(t);e.appendChild(i)};OAT.addImageNode=function(e,r,t,i){var a=document.createElement("i");if(i!=undefined){a.setAttribute("id",i)}a.setAttribute("class","material-icons");a.setAttribute("style",t);a.textContent=r;e.appendChild(a)};OAT.replaceTextNode=function(e,r){while(e.firstChild){e.removeChild(e.firstChild)}var t=document.createTextNode(r);e.appendChild(t)};OAT.AddItemToList=function(e,r){if(e.indexOf(r)==-1){e.push(r)}return e.sort((function(e,r){return e-r}))};OAT.removeIconFont=function(e){return e.replace(/arrow_drop_up/g,"").replace(/arrow_drop_down/g,"").replace(/remove/g,"").replace(/add/g,"").replace(/settings/g,"")};OAT.ApplyPictureValue=function(e,r,t,i){if(e=="#NuN#"){var a=t.getAttribute("textForNullValues");if(a==""){return"Â "}if(a!=undefined){return a}return"Â "}var s=t.getAttribute("decimalSeparator")!=undefined&&t.getAttribute("decimalSeparator")!=null?t.getAttribute("decimalSeparator"):".";var n=t.getAttribute("decimalPlaces")!=undefined&&t.getAttribute("decimalPlaces")!=null?t.getAttribute("decimalPlaces"):2;t.getAttribute("thousandsSeparator");var f=t.getAttribute("dateFormat");var l=e;var o=false;var u="";if(r=="integer"||r=="real"){if(i!=undefined||i!=null){if(i[0]!="Z"||i[0]!="9"||i[0]!=","||i[0]!="."){o=true;var c=0;while(i.length>c&&i[c]!="Z"&&i[c]!="9"&&i[c]!=","&&i[c]!="."){c++}u=i.substring(0,c);i=i.substring(c)}}}var v=false;var d="";if(r=="integer"||r=="real"){if(i!=undefined||i!=null){if(i[i.length-1]!="Z"||i[i.length-1]!="9"||i[i.length-1]!=","||i[i.length-1]!="."){v=true;var c=i.length-1;while(c>-1&&i[c]!="Z"&&i[c]!="9"&&i[c]!=","&&i[c]!="."){c--}d=i.substring(c+1);i=i.substring(0,c+1)}}}switch(r){case"integer":n=0;case"real":if(i!=undefined&&i!=""){if(typeof qv=="undefined")var l=parseFloat(e);else qv.util.formatNumber(parseFloat(e),n,i,false)}else{var h=e.split(".");var p=true;if(i==""&&r=="integer"){p=false}if(r=="real"){l=parseFloat(e).toFixed(2);h=l.split(".")}l=h[0];var m=-1;if(i!=undefined&&i!=""){var T=i.split(".");if(T.length>1)m=T[1].indexOf("Z")}if(h[1]==null){if(p){var A=n;if(m!=-1){A=m}if(A>0){l=l+s;for(var y=0;y<A;y++){l=l+"0"}}}}else{if(p){if(m===-1){if(h[1].length<n){l=l+s+h[1];for(var y=0;y<n-h[1].length;y++){l=l+"0"}}else{if(h[1].length>n){var w="";for(var y=0;y<n;y++){w=w+h[1].charAt(y)}l=l+s+w}else{l=l+s+h[1]}}}else{var O=m;if(h[1].length<n){if(h[1].length>0||O>0){l=l+s+h[1];for(var y=0;y<O-h[1].length;y++){l=l+"0"}}}else{if(h[1].length>n){var w="";for(var y=0;y<n;y++){w=w+h[1].charAt(y)}l=l+s+w}else{l=l+s+h[1]}}}}}}break;case"date":if(e=="")return"";if(i===""){var g=e.split("-");var l=e;if(f!=undefined&&f!=null){pict=f.split("");l="";for(var y=0;y<=2;y++){if(pict[y]==="M")l=l+g[1];if(pict[y]==="D")l=l+g[2];if(pict[y]==="Y")l=l+g[0];if(y!=2)l=l+"/"}}else{l=g[1]+"/"+g[2]+"/"+g[0]}}else{var h=e.split("-");l="";if(i=="99/99/9999"){if(h[0].length==4){if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}}else{l=e;while(l.indexOf("-")!=-1){l.replace("-","/")}}}else if(i=="99/99/99"){if(h[0].length==4){h[0]=h[0].substr(h[0].length-2,2)}if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}}else if(i=="9999/99/99"){if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}}else{if(h[0].length==4){h[0]=h[0].substr(h[0].length-2,2)}if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}}}break;case"datetime":if(e=="")return"";var _=e.split("T");if(e.indexOf("T")===-1){_=e.split(" ")}if(i===""){var g=_[0].split("-");var l=e;if(f!=undefined&&f!=null){pict=f.split("");l="";for(var y=0;y<=2;y++){if(pict[y]==="M")l=l+g[1];if(pict[y]==="D")l=l+g[2];if(pict[y]==="Y")l=l+g[0];if(y!=2)l=l+"/"}}else{l=g[1]+"/"+g[2]+"/"+g[0]}}else{var b=i.split(" ");var h=_[0].split("-");l="";if(b[0]=="99/99/9999"){if(h[0].length==4){if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}}else{l=e;while(l.indexOf("-")!=-1){l.replace("-","/")}}}else if(b[0]=="99/99/99"){if(h[0].length==4){h[0]=h[0].substr(h[0].length-2,2)}if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}}else if(b[0]=="9999/99/99")if(f==undefined||f==null||f=="MDY"){l=h[1]+"/"+h[2]+"/"+h[0]}else if(f!=undefined&&f=="YMD"){l=h[0]+"/"+h[1]+"/"+h[2]}else{l=h[2]+"/"+h[1]+"/"+h[0]}else{l=""}}if(i===""){if(_.length>1){var x=_[1].split(".");l=l+" "+x[0]}}else{var b=i.split(" ");if(i.split(" ").length<2&&b[0]!="99/99/9999"&&b[0]!="9999/99/99"&&b[0]!="99/99/99"){b.push(i)}if(b.length>1){var S;if(_.length>1){var x=_[1].split(".");S=x[0].split(":");if(S.length<2){S[1]="00";S[2]="00"}if(S.length<3){S[2]="00"}if(x.length<2){S[3]="000"}else{S[3]=x[1]}}else{S=new Array(3);S[0]="00";S[1]="00";S[2]="00";S[3]="000"}switch(b[1]){case"99":l=l+" "+S[0];break;case"99:99":l=l+" "+S[0]+":"+S[1];break;case"99:99:99":l=l+" "+S[0]+":"+S[1]+":"+S[2];break;case"99:99:99.999":l=l+" "+S[0]+":"+S[1]+":"+S[2]+"."+S[3];break;default:l=l+" "+S[0]+":"+S[1]+":"+S[2]}}}break;case"character":l=OAT.Dom.fromSafeXML(e);if(i=="@!"){l=e.toUpperCase()}break}if(o){l=u+l}if(v){l=l+d}return l};OAT.SetSelectedNodeBackgroundColor=function(e,r,t){OAT.ClearSelectedNodes(t);OAT.SetNodeBackgroundColor(e,r)};OAT.ClearSelectedNodes=function(e){e.find(".gx-qv-selected-element").removeClass("gx-qv-selected-element")};OAT.SetNodeBackgroundColor=function(e,r){if(!jquery(e).hasClass("gx-qv-selected-element")){jquery(e).addClass("gx-qv-selected-element")}};OAT.IsNodeSelected=function(e){return jquery(e).hasClass("gx-qv-selected-element")};OAT.SelectAllRow=function(e,r,t){for(var i=0;i<e.children.length;i++){if(t==undefined||t!=i)OAT.SetNodeBackgroundColor(e.children[i],r)}};OAT.isSD=function(){var e=navigator.userAgent.toLowerCase();var r=e.indexOf("android")>-1;var t=e.indexOf("iPhone")!=-1||e.indexOf("iPad")!=-1||e.indexOf("iPod")!=-1;if(r||t){return true}else{return false}};OAT.isAndroid=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("android")>-1};OAT.isSafari=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("Safari")!=-1&&e.indexOf("Chrome")===-1};OAT.isIE=function(){if(window.document.documentMode)return true;else return false};OAT.isWebkit=function(){var e=navigator.userAgent.toLowerCase();return e.search(/webkit/gi)!=-1};OAT.resourceURL=function(e){return e};OAT.charReplace=function(e,r,t){var i="";var a=e.length;for(var s=0;s<a;s++){var n=false;var f=r.length;for(var l=0;l<f;l++){if(e.charAt(s)==r[l]){if(l<t.length){i+=t[l];n=true;break}}}if(n===false)i+=e.charAt(s)}return i};OAT.Dom={create:function(e,r,t){var i=document.createElement(e);if(t){i.className=t}return i},createNS:function(e,r){if(document.createElementNS){var t=document.createElementNS(e,r)}else{var t=document.createElement(r);t.setAttribute("xmlns",e)}return t},text:function(e){var r=document.createTextNode(e);return r},button:function(e){var r=OAT.Dom.create("input");r.type="button";r.value=e;return r},radio:function(e){if(OAT.isIE()){var r=document.createElement('<input type="radio" name="'+e+'" />');return r}else{var r=OAT.Dom.create("input");r.name=e;r.type="radio";return r}},image:function(e,r,t,i){t=t?t+"px":"auto";i=i?i+"px":"auto";var a=OAT.Dom.create("img",{width:t,height:i});OAT.Dom.imageSrc(a,e,r);return a},imageSrc:function(e,r,t){var i=OAT.$(e);!!r.toLowerCase().match(/png$/);i.src=r},option:function(e,r,t){var i=OAT.Dom.create("option");OAT.addTextNode(i,e);i.value=r;if(t){OAT.$(t).appendChild(i)}return i},append:function(){for(var e=0;e<arguments.length;e++){var r=arguments[e];if(!(r instanceof Array)){continue}if(r.length<2){continue}var t=OAT.$(r[0]);for(var i=1;i<r.length;i++){var a=r[i];if(!(a instanceof Array)){a=[a]}for(var s=0;s<a.length;s++){var n=a[s];t.appendChild(OAT.$(n))}}}},hide:function(e){if(arguments.length>1){for(var r=0;r<arguments.length;r++){OAT.Dom.hide(arguments[r])}return}if(e instanceof Array){for(var r=0;r<e.length;r++){OAT.Dom.hide(e[r])}return}var t=OAT.$(e);if(!t){return}var i=t.getElementsByTagName("input");var a=[];for(var r=0;r<i.length;r++){a.push(i[r])}if(t.tagName.toLowerCase()=="input"){a.push(t)}for(var r=0;r<a.length;r++){var s=a[r];if(s.type=="radio"||s.type=="checkbox"){if(!s.__checked){s.__checked=s.checked?"1":"0"}}}t.style.display="none"},show:function(e){if(arguments.length>1){for(var r=0;r<arguments.length;r++){OAT.Dom.show(arguments[r])}return}if(e instanceof Array){for(var r=0;r<e.length;r++){OAT.Dom.show(e[r])}return}var t=OAT.$(e);if(!t){return}t.style.display="";var i=t.getElementsByTagName("input");var a=[];for(var r=0;r<i.length;r++){a.push(i[r])}if(t.tagName.toLowerCase()=="input"){a.push(t)}for(var r=0;r<a.length;r++){var s=a[r];if(s.type=="radio"||s.type=="checkbox"){if(s["__checked"]&&s.__checked==="1"){s.checked=true}if(s["__checked"]&&s.__checked==="0"){s.checked=false}s.__checked=false}}},clear:function(e){var r=OAT.$(e);while(r.firstChild){r.removeChild(r.firstChild)}},unlink:function(e){var r=OAT.$(e);if(!r){return}if(!r.parentNode){return}r.parentNode.removeChild(r)},center:function(e,r,t,i){var a=OAT.$(e);var s=a.offsetParent;if(i){s=i}if(!s){return}var n=s==document.body||s.tagName.toLowerCase()=="html"?OAT.Dom.getViewport():OAT.Dom.getWH(s);var f=OAT.Dom.getWH(a);var l=Math.round(n[0]/2-f[0]/2);var o=Math.round(n[1]/2-f[1]/2);if(o<0){o=30}var u=OAT.Dom.getScroll();if(s==document.body||s.tagName.toLowerCase()=="html"){l+=u[0];o+=u[1]}if(r){a.style.left=l+"px"}if(t){a.style.top=o+"px"}},isChild:function(e,r){var t=OAT.$(e);var i=OAT.$(r);var a=t.parentNode;do{if(!a){return false}if(a==i){return true}a=a.parentNode}while(a!=document.body&&a!=document);return false},isKonqueror:function(){return navigator.userAgent.match(/konqueror/i)?true:false},isKHTML:function(){return navigator.userAgent.match(/khtml/i)?true:false},isIE:function(){return document.attachEvent&&!document.addEventListener?true:false},isIE7:function(){return navigator.userAgent.match(/msie 7/i)?true:false},isIE6:function(){return OAT.Dom.isIE()&&!OAT.Dom.isIE7()},isGecko:function(){return!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i)?true:false},isOpera:function(){return navigator.userAgent.match(/Opera/)?true:false},isWebKit:function(){return navigator.userAgent.match(/AppleWebKit/)?true:false},isMac:function(){return navigator.platform.toString().match(/mac/i)?true:false},isLinux:function(){return navigator.platform.toString().match(/linux/i)?true:false},isWindows:function(){return navigator.userAgent.toString().match(/windows/i)?true:false},color:function(e){var r=function(e){return parseInt(e,16)};if(e.match(/#/)){if(e.length==4){var t="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3)}else{var t=e}var i=t.match(/#(..)(..)(..)/);return[r(i[1]),r(i[2]),r(i[3])]}else{var i=e.match(/\(([^,]*),([^,]*),([^\)]*)/);return[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]}},isClass:function(e,r){var t=OAT.$(e);if(!t){return false}if(r=="*"){return true}if(r==""){return false}if(!t.className){return false}var i=t.className.split(" ");var a=i.indexOf(r);return a!=-1},addClass:function(e,r){var t=OAT.$(e);if(!t){return}if(OAT.Dom.isClass(t,r)){return}var i=t.className.split(" ");i.push(r);if(i[0]==""){i.splice(0,1)}t.className=i.join(" ")},setIdPropertyValue:function(e,r){var t=OAT.$(e);if(!t){return}t.id=r},removeClass:function(e,r){var t=OAT.$(e);if(!t){return}if(!OAT.Dom.isClass(t,r)){return}if(r=="*"){t.className=""}var i=t.className.split(" ");var a=i.indexOf(r);if(a==-1){return}i.splice(a,1);t.className=i.join(" ")},getViewport:function(){if(OAT.isWebkit()){return[window.innerWidth,window.innerHeight]}if(navigator.userAgent.match(/Opera/)||document.compatMode=="BackCompat"){return[document.body.clientWidth,document.body.clientHeight]}else{return[document.documentElement.clientWidth,document.documentElement.clientHeight]}},position:function(e){var r=OAT.$(e);var t=r.offsetParent;if(r==document.body||r==document||!t){return OAT.Dom.getLT(r)}var i=OAT.Dom.position(t);var a=OAT.Dom.getLT(r);var s=a[0];var n=a[1];if(!navigator.userAgent.match(/Opera/)||r.scrollTop!=r.offsetTop||r.scrollLeft!=r.offsetLeft){s-=r.scrollLeft;n-=r.scrollTop}if(OAT.isWebkit()&&t==document.body&&OAT.Dom.style(r,"position")=="absolute"){return[s,n]}s+=i[0];n+=i[1];return[s,n]},getLT:function(e){var r=OAT.$(e);var t,i;if(r.style.left&&r.style.position!="relative"){t=parseInt(r.style.left)}else{t=r.offsetLeft}if(r.style.top&&r.style.position!="relative"){i=parseInt(r.style.top)}else{i=r.offsetTop}return[t,i]},getWH:function(e){var r,t;var i=OAT.$(e);if(i.style.width&&!i.style.width.match(/%/)&&i.style.width!="auto"){r=parseInt(i.style.width)}else if(OAT.Style.get(i,"width")&&!OAT.isIE()){r=Math.round(parseFloat(OAT.Style.get(i,"width")))}else{r=i.offsetWidth;if(i.tagName.toLowerCase()=="input"){r+=5}}if(i.style.height&&!i.style.height.match(/%/)&&i.style.height!="auto"){t=parseInt(i.style.height)}else if(OAT.Style.get(i,"height")&&!OAT.isIE()){t=Math.round(parseFloat(OAT.Style.get(i,"height")))}else{t=i.offsetHeight;if(i.tagName.toLowerCase()=="input"){t+=5}}if(i==document.body){t=OAT.isIE()?document.body.clientHeight:window.innerHeight}return[r,t]},moveBy:function(e,r,t){var i,a;var s=OAT.$(e);if(OAT.Dom.style(s,"position")=="absolute"){if(!s.style.left){s.style.left=s.offsetLeft+"px";s.style.right=""}if(!s.style.top){s.style.top=s.offsetTop+"px";s.style.bottom=""}}var n=OAT.Dom.getLT(s);i=n[0];a=n[1];var f=i+r;var l=a+t;s.style.left=f+"px";s.style.top=l+"px"},resizeBy:function(e,r,t){var i,a;var s=OAT.$(e);if(OAT.Dom.style(s,"position")=="absolute"&&r){if(!s.style.left){s.style.left=s.offsetLeft+"px";s.style.right=""}if(!s.style.top&&t){s.style.top=s.offsetTop+"px";s.style.bottom=""}}var n=OAT.Dom.getWH(s);i=n[0];a=n[1];var f=i+r;var l=a+t;if(r){s.style.width=f+"px"}if(t){s.style.height=l+"px"}},decodeImage:function(e){var r=OAT.Crypto.base64d(e);var t="image/";switch(r.charAt(1)){case"I":t+="gif";break;case"P":t+="png";break;case"M":t+="bmp";break;default:t+="jpeg";break}var i="data:"+t+";base64,"+e;return i},removeSelection:function(){var e=false;if(document.getSelection&&!(!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i))){e=document.getSelection()}if(window.getSelection){e=window.getSelection()}if(document.selection){e=document.selection}if(e){if(e.empty){e.empty()}if(e.removeAllRanges){e.removeAllRanges()}}},getScroll:function(){var e=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var r=Math.max(document.documentElement.scrollTop,document.body.scrollTop);return[e,r]},getFreeSpace:function(e,r){var t=OAT.Dom.getScroll();var i=OAT.Dom.getViewport();var a=e-t[0];var s=i[0]-e+t[0];var n=r-t[1];var f=i[1]-r+t[1];var l=a>s;var o=n>f;return[l,o]},toSafeXML:function(e){if(typeof e!="string"){return e}return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},fromSafeXML:function(e){return e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<")},uriParams:function(){var e={};var r=location.search;if(r.length>1){r=r.substring(1)}if(!r){return e}var t=r.split("&");for(var i=0;i<t.length;i++){var a=t[i];if(!a){continue}var s=a.indexOf("=");if(s==-1){e[decodeURIComponent(a)]="";continue}var n=a.substring(0,s);var f=a.substring(s+1);n=decodeURIComponent(n);f=decodeURIComponent(f);var l=false;if(l=n.match(/(.*)\[\]$/)){n=l[1];if(n in e){e[n].push(f)}else{e[n]=[f]}}else{e[n]=f}}return e},changeHref:function(e,r){var t=false;var i=OAT.$(e);var a=i;while(a.parentNode){a=a.parentNode;if(a==document.body){t=true}}if(t){i.href=r}else if(i.parentNode){var s=i.parentNode;var n=i.nextSibling;document.body.appendChild(i);i.href=r;OAT.Dom.unlink(i);s.insertBefore(i,n)}else{document.body.appendChild(i);i.href=r;OAT.Dom.unlink(i)}},makePosition:function(e){var r=OAT.$(e);if(OAT.Dom.style(r,"position")!="absolute"){r.style.position="relative"}}};OAT.Style={include:function(e,r,t){if(!e)return;e=r+"QueryViewer/oatPivot/css/"+e;if(!t){var i=document.getElementsByTagName("link");var a=location.protocol+"//"+location.host;for(var s=0;s<i.length;s++)if(e==i[s].getAttribute("href")||a+e==i[s].getAttribute("href"))return}var n=OAT.Dom.create("link");n.rel="stylesheet";n.type="text/css";n.href=e;jquery("head").prepend(n)},get:function(e,r){var t=OAT.$(e);if(document.defaultView&&document.defaultView.getComputedStyle){var i=document.defaultView.getComputedStyle(t,"");if(!i){return true}return i[r]}else{try{var a=t.currentStyle[r]}catch(e){var a=t.getExpression(r)}return a}},background:function(e,r){var t=OAT.$(e);var i=!!r.toLowerCase().match(/png$/);if(i&&OAT.isIE()){t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"', sizingMethod='crop')"}else{t.style.backgroundImage="url("+r+")"}},apply:function(e,r){var t=OAT.$(e);if(!t){return}for(var i in r){t.style[i]=r[i]}},opacity:function(e,r){var t=Math.max(r,0);var i=OAT.$(e);if(OAT.isIE()){i.style.filter="alpha(opacity="+Math.round(t*100)+")"}else{i.style.opacity=t}}};OAT.Dom.style=OAT.Style.get;OAT.Dom.applyStyle=OAT.Style.apply;OAT.Event={attach:function(e,r,t){var i=OAT.$(e);if(i.addEventListener){i.addEventListener(r,t,false)}else if(i.attachEvent){i.attachEvent("on"+r,t)}else{i["on"+r]=t}},detach:function(e,r,t){var i=OAT.$(e);if(i.removeEventListener){i.removeEventListener(r,t,false)}else if(i.detachEvent){i.detachEvent("on"+r,t)}else{i["on"+r]=false}},source:function(e){return e.target?e.target:e.srcElement},cancel:function(e){e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation()}},position:function(e){var r=OAT.Dom.getScroll();return[e.clientX+r[0],e.clientY+r[1]]},prevent:function(e){if(e.preventDefault){e.preventDefault()}if(window.document.documentMode){e.returnValue=false}}};OAT.Dom.attach=OAT.Event.attach;OAT.Dom.detach=OAT.Event.detach;OAT.Dom.source=OAT.Event.source;OAT.Dom.eventPos=OAT.Event.position;OAT.Dom.prevent=OAT.Event.prevent;OAT.Loader={toolkitPath:false,loadOccurred:0,openAjax:false};OAT.MSG={DEBUG:0,OAT_DEBUG:0,OAT_LOAD:1,ANIMATION_STOP:2,TREE_EXPAND:3,TREE_COLLAPSE:4,DS_RECORD_PREADVANCE:5,DS_RECORD_ADVANCE:6,DS_PAGE_PREADVANCE:7,DS_PAGE_ADVANCE:8,AJAX_START:9,AJAX_ERROR:10,GD_START:11,GD_ABORT:12,GD_END:13,DOCK_DRAG:14,DOCK_REMOVE:15,SLB_OPENED:16,SLB_CLOSED:17,registry:[],attach:function(e,r,t){if(!e){return}OAT.MSG.registry.push([e,r,t])},detach:function(e,r,t){if(!e){return}var i=-1;for(var a=0;a<OAT.MSG.registry.length;a++){var s=OAT.MSG.registry[a];if(s[0]==e&&s[1]==r&&s[2]==t){i=a}}if(i!=-1){OAT.MSG.registry.splice(i,1)}},send:function(e,r,t){for(var i=0;i<OAT.MSG.registry.length;i++){var a=OAT.MSG.registry[i];var s=e==a[0]||a[0]=="*";if(!s){continue}var n=r==a[1]||a[1]=="*";if(!n&&a[1].toString().match(/\*/)){var f=new RegExp(a[1]);var l="";for(var o in OAT.MSG){var u=OAT.MSG[o];if(u==r){l=o}}if(l.match(f)){n=true}}if(n){a[2](e,r,t)}}}};if(typeof window!="undefined"){OAT.Event.attach(window,"load",(function(){OAT.Loader.loadOccurred=1;OAT.Loader.callListeners()}))}OAT.Loader.listeners=new Array;OAT.Loader.addListener=function(e){if(OAT.Loader.loadOccurred==1)e();else{OAT.Loader.listeners.push(e)}};OAT.Loader.callListeners=function(){for(var e=0,r=this.listeners.length;e<r;e++)OAT.Loader.listeners[e]()};OAT.LoadJapanesseCharacters=function(){var e="";for(var r=0;r<jquery("script").length;r++){var t=jquery("script")[r].src;if(t.indexOf("gxpivotjs")>0){e=t;break}}OAT.rP=e.substring(0,e.indexOf("QueryViewer/oatPivot"));if(gx.languageCode=="jap"||gx.languageCode=="jpn"||gx.languageCode=="jp"||gx.languageCode=="ja"||gx.languageCode=="jpx"||gx.languageCode=="ain"||gx.languageCode=="jpns"||gx.languageCode=="ams"||gx.languageCode=="japanese"||gx.languageCode=="JAP"||gx.languageCode=="JP"||gx.languageCode=="JA"||gx.languageCode=="JPN"||gx.languageCode=="ja-JP"||gx.languageCode=="ja_JP"||gx.languageCode=="jp"){var i=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/downloadify/"+"jsPDF_japanese.js",true);var a=document.getElementsByTagName("head")[0]||document.documentElement;var s=a.getElementsByTagName("script");var n=false;for(var r=0;s.length>r;r++){if(s[r].src==i){n=true}}if(!n){var f=document.createElement("script");f.type="text/javascript";f.src=i;f.onerror=function(){var e=document.createElement("script");e.type="text/javascript";e.src=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/downloadify/"+"jsPDF_japanese.src.js",true);var r=document.getElementsByTagName("head")[0]||document.documentElement;r.insertBefore(e,r.lastChild)};f.onreadystatechange=function(){var e=this.readyState;if(e==="loaded"||e==="complete"){f.onreadystatechange=null}};a.insertBefore(f,a.lastChild)}}};var jsPDF=function(){if(typeof btoa==="undefined"){window.btoa=function(e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=r.split(""),i,a,s,n,f,l,o,u,c=0,v=0,d="",h=[],p;do{i=e.charCodeAt(c++);a=e.charCodeAt(c++);s=e.charCodeAt(c++);u=i<<16|a<<8|s;n=u>>18&63;f=u>>12&63;l=u>>6&63;o=u&63;h[v++]=t[n]+t[f]+t[l]+t[o]}while(c<e.length);d=h.join("");p=e.length%3;return(p?d.slice(0,p-3):d)+"===".slice(p||3)}}if(typeof atob==="undefined"){window.atob=function(e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t,i,a,s,n,f,l,o,u=0,c=0,v="",d=[];if(!e){return e}e+="";do{s=r.indexOf(e.charAt(u++));n=r.indexOf(e.charAt(u++));f=r.indexOf(e.charAt(u++));l=r.indexOf(e.charAt(u++));o=s<<18|n<<12|f<<6|l;t=o>>16&255;i=o>>8&255;a=o&255;if(f===64){d[c++]=String.fromCharCode(t)}else if(l===64){d[c++]=String.fromCharCode(t,i)}else{d[c++]=String.fromCharCode(t,i,a)}}while(u<e.length);v=d.join("");return v}}var e=typeof Object.keys==="function"?function(e){return Object.keys(e).length}:function(e){var r=0,t;for(t in e){if(e.hasOwnProperty(t)){r++}}return r},r=function(e){this.topics={};this.context=e;this.publish=function(e,r){if(this.topics[e]){var t=this.topics[e],i=[],a,s,n,f,l=function(){};r=Array.prototype.slice.call(arguments,1);for(s=0,n=t.length;s<n;s++){f=t[s];a=f[0];if(f[1]){f[0]=l;i.push(s)}a.apply(this.context,r)}for(s=0,n=i.length;s<n;s++){t.splice(i[s],1)}}};this.subscribe=function(e,r,t){if(!this.topics[e]){this.topics[e]=[[r,t]]}else{this.topics[e].push([r,t])}return{topic:e,callback:r}};this.unsubscribe=function(e){if(this.topics[e.topic]){var r=this.topics[e.topic],t,i;for(t=0,i=r.length;t<i;t++){if(r[t][0]===e.callback){r.splice(t,1)}}}}};function t(i,a,s,n,f,l){if(typeof i==="undefined"){i="p"}else{i=i.toString().toLowerCase()}if(typeof a==="undefined"){a="mm"}if(typeof s==="undefined"){s="a4"}if(typeof n==="undefined"&&typeof zpipe==="undefined"){n=false}var o=s.toString().toLowerCase(),u="0.9.0rc2",c=[],v=0,d=n,h="1.3",p={a3:[841.89,1190.55],a4:[f,l],a5:[420.94,595.28],letter:[612,792],legal:[612,1008]},m="0 g",T="0 G",A=0,y=[],w=2,O=false,g=[],_={},b={},x=16,S,I=.200025,k,q,F,P={title:"",subject:"",author:"",keywords:"",creator:""},N=0,D=0,E={},C=new r(E),j,R,M=function(e){return e.toFixed(2)},J=function(e){return e.toFixed(3)},L=function(e){var r=e.toFixed(0);if(e<10){return"0"+r}else{return r}},V=function(e){var r=e.toFixed(0);if(r.length<10){return new Array(11-r.length).join("0")+r}else{return r}},B=function(e){if(O){y[A].push(e)}else{c.push(e);v+=e.length+1}},U=function(){w++;g[w]=v;B(w+" 0 obj");return w},z=function(e){B("stream");B(e);B("endstream")},H,Z,G,X=function(){H=q*F;Z=k*F;var e,r,t,i,a,s;for(e=1;e<=A;e++){U();B("<</Type /Page");B("/Parent 1 0 R");B("/Resources 2 0 R");B("/Contents "+(w+1)+" 0 R>>");B("endobj");r=y[e].join("\n");U();if(d){t=[];for(i=0;i<r.length;++i){t[i]=r.charCodeAt(i)}s=adler32cs.from(r);a=new Deflater(6);a.append(new Uint8Array(t));r=a.flush();t=[new Uint8Array([120,156]),new Uint8Array(r),new Uint8Array([s&255,s>>8&255,s>>16&255,s>>24&255])];r="";for(i in t){if(t.hasOwnProperty(i)){r+=String.fromCharCode.apply(null,t[i])}}B("<</Length "+r.length+" /Filter [/FlateDecode]>>")}else{B("<</Length "+r.length+">>")}z(r);B("endobj")}g[1]=v;B("1 0 obj");B("<</Type /Pages");G="/Kids [";for(i=0;i<A;i++){G+=3+2*i+" 0 R "}B(G+"]");B("/Count "+A);B("/MediaBox [0 0 "+M(H)+" "+M(Z)+"]");B(">>");B("endobj")},$=function(e){e.objectNumber=U();B("<</BaseFont/"+e.PostScriptName+"/Type/Font");if(typeof e.encoding==="string"){B("/Encoding/"+e.encoding)}B("/Subtype/Type1>>");B("endobj")},Q=function(){var e;for(e in _){if(_.hasOwnProperty(e)){$(_[e])}}},Y=function(){C.publish("putXobjectDict")},W=function(){B("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]");B("/Font <<");var e;for(e in _){if(_.hasOwnProperty(e)){B("/"+e+" "+_[e].objectNumber+" 0 R")}}B(">>");B("/XObject <<");Y();B(">>")},K=function(){Q();C.publish("putResources");g[2]=v;B("2 0 obj");B("<<");W();B(">>");B("endobj");C.publish("postPutResources")},ee=function(e,r,t){var i;if(b[r]===i){b[r]={}}b[r][t]=e},re=function(r,t,i,a){var s="F"+(e(_)+1).toString(10),n=_[s]={id:s,PostScriptName:r,fontName:t,fontStyle:i,encoding:a,metadata:{}};ee(s,t,i);C.publish("addFont",n);return s},te=function(){var e="helvetica",r="times",t="courier",i="normal",a="bold",s="italic",n="bolditalic",f="StandardEncoding",l=[["Helvetica",e,i],["Helvetica-Bold",e,a],["Helvetica-Oblique",e,s],["Helvetica-BoldOblique",e,n],["Courier",t,i],["Courier-Bold",t,a],["Courier-Oblique",t,s],["Courier-BoldOblique",t,n],["Times-Roman",r,i],["Times-Bold",r,a],["Times-Italic",r,s],["Times-BoldItalic",r,n]],o,u,c,v;for(o=0,u=l.length;o<u;o++){c=re(l[o][0],l[o][1],l[o][2],f);v=l[o][0].split("-");ee(c,v[0],v[1]||"")}C.publish("addFonts",{fonts:_,dictionary:b})},ie=function(e,r){var t,i,a,s,n,f,l,o,u,c;if(r===a){r={}}s=r.sourceEncoding?s:"Unicode";f=r.outputEncoding;if((r.autoencode||f)&&_[S].metadata&&_[S].metadata[s]&&_[S].metadata[s].encoding){n=_[S].metadata[s].encoding;if(!f&&_[S].encoding){f=_[S].encoding}if(!f&&n.codePages){f=n.codePages[0]}if(typeof f==="string"){f=n[f]}if(f){o=false;l=[];for(t=0,i=e.length;t<i;t++){u=f[e.charCodeAt(t)];if(u){l.push(String.fromCharCode(u))}else{l.push(e[t])}if(l[t].charCodeAt(0)>>8){o=true}}e=l.join("")}}t=e.length;while(o===a&&t!==0){if(e.charCodeAt(t-1)>>8){o=true}t--}if(!o){return e}else{l=r.noBOM?[]:[254,255];for(t=0,i=e.length;t<i;t++){u=e.charCodeAt(t);c=u>>8;if(c>>8){throw new Error("Character at position "+t.toString(10)+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE")}l.push(c);l.push(u-(c<<8))}return String.fromCharCode.apply(a,l)}},ae=function(e,r){return ie(e,r).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},se=function(){B("/Producer (jsPDF "+u+")");if(P.title){B("/Title ("+ae(P.title)+")")}if(P.subject){B("/Subject ("+ae(P.subject)+")")}if(P.author){B("/Author ("+ae(P.author)+")")}if(P.keywords){B("/Keywords ("+ae(P.keywords)+")")}if(P.creator){B("/Creator ("+ae(P.creator)+")")}var e=new Date;B("/CreationDate (D:"+[e.getFullYear(),L(e.getMonth()+1),L(e.getDate()),L(e.getHours()),L(e.getMinutes()),L(e.getSeconds())].join("")+")")},ne=function(){B("/Type /Catalog");B("/Pages 1 0 R");B("/OpenAction [3 0 R /FitH null]");B("/PageLayout /OneColumn");C.publish("putCatalog")},fe=function(){B("/Size "+(w+1));B("/Root "+w+" 0 R");B("/Info "+(w-1)+" 0 R")},le=function(){A++;O=true;y[A]=[]},oe=function(){le();B(M(I*F)+" w");B(T);if(N!==0){B(N.toString(10)+" J")}if(D!==0){B(D.toString(10)+" j")}C.publish("addPage",{pageNumber:A})},ue=function(e,r){var t,i;if(e===i){e=_[S].fontName}if(r===i){r=_[S].fontStyle}try{t=b[e][r]}catch(e){t=i}if(!t){throw new Error("Unable to look up font label for font '"+e+"', '"+r+"'. Refer to getFontList() for available fonts.")}return t},ce=function(){O=false;c=[];g=[];B("%PDF-"+h);X();K();U();B("<<");se();B(">>");B("endobj");U();B("<<");ne();B(">>");B("endobj");var e=v,r;B("xref");B("0 "+(w+1));B("0000000000 65535 f ");for(r=1;r<=w;r++){B(V(g[r])+" 00000 n ")}B("trailer");B("<<");fe();B(">>");B("startxref");B(e);B("%%EOF");O=true;return c.join("\n")},ve=function(e){var r="S";if(e==="F"){r="f"}else if(e==="FD"||e==="DF"){r="B"}return r},de=function(e,r){var t,i,a,s,n,f;switch(e){case t:return ce();case"save":if(navigator.getUserMedia){if(window.URL===undefined){return E.output("dataurlnewwindow")}else if(window.URL.createObjectURL===undefined){return E.output("dataurlnewwindow")}}i=ce();a=i.length;s=new Uint8Array(new ArrayBuffer(a));for(n=0;n<a;n++){s[n]=i.charCodeAt(n)}f=new Blob([s],{type:"application/pdf"});saveAs(f,r);break;case"datauristring":case"dataurlstring":return"data:application/pdf;base64,"+btoa(ce());case"datauri":case"dataurl":document.location.href="data:application/pdf;base64,"+btoa(ce());break;case"dataurlnewwindow":window.open("data:application/pdf;base64,"+btoa(ce()));break;default:throw new Error('Output type "'+e+'" is not supported.')}};if(a==="pt"){F=1}else if(a==="mm"){F=72/25.4}else if(a==="cm"){F=72/2.54}else if(a==="in"){F=72}else{throw"Invalid unit: "+a}if(p.hasOwnProperty(o)){k=p[o][1]/F;q=p[o][0]/F}else{try{k=s[1];q=s[0]}catch(e){throw"Invalid format: "+s}}if(i==="p"||i==="portrait"){i="p";if(q>k){j=q;q=k;k=j}}else if(i==="l"||i==="landscape"){i="l";if(k>q){j=q;q=k;k=j}}else{throw"Invalid orientation: "+i}E.internal={pdfEscape:ae,getStyle:ve,getFont:function(){return _[ue.apply(E,arguments)]},getFontSize:function(){return x},btoa,write:function(e,r,t,i){B(arguments.length===1?e:Array.prototype.join.call(arguments," "))},getCoordinateString:function(e){return M(e*F)},getVerticalCoordinateString:function(e){return M((k-e)*F)},collections:{},newObject:U,putStream:z,events:C,scaleFactor:F,pageSize:{width:q,height:k},output:function(e,r){return de(e,r)}};E.addPage=function(){oe();return this};E.text=function(e,r,t,i){var a,s,n,f,l,o,u;if(typeof e==="number"){s=t;n=e;f=r;e=s;r=n;t=f}if(typeof e==="string"&&e.match(/[\n\r]/)){e=e.split(/\r\n|\r|\n/g)}if(typeof i==="undefined"){i={noBOM:true,autoencode:true}}else{if(i.noBOM===a){i.noBOM=true}if(i.autoencode===a){i.autoencode=true}}if(typeof e==="string"){o=ae(e,i)}else if(e instanceof Array){l=e.concat();for(u=l.length-1;u!==-1;u--){l[u]=ae(l[u],i)}o=l.join(") Tj\nT* (")}else{throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.')}B("BT\n/"+S+" "+x+" Tf\n"+x+" TL\n"+m+"\n"+M(r*F)+" "+M((k-t)*F)+" Td\n("+o+") Tj\nET");return this};E.line=function(e,r,t,i){B(M(e*F)+" "+M((k-r)*F)+" m "+M(t*F)+" "+M((k-i)*F)+" l S");return this};E.lines=function(e,r,t,i,a){var s,n,f,l,o,u,c,v,d,h,p,m,T,A,y;if(typeof e==="number"){n=t;f=e;l=r;e=n;r=f;t=l}a=ve(a);i=i===s?[1,1]:i;B(J(r*F)+" "+J((k-t)*F)+" m ");o=i[0];u=i[1];v=e.length;A=r;y=t;for(c=0;c<v;c++){d=e[c];if(d.length===2){A=d[0]*o+A;y=d[1]*u+y;B(J(A*F)+" "+J((k-y)*F)+" l")}else{h=d[0]*o+A;p=d[1]*u+y;m=d[2]*o+A;T=d[3]*u+y;A=d[4]*o+A;y=d[5]*u+y;B(J(h*F)+" "+J((k-p)*F)+" "+J(m*F)+" "+J((k-T)*F)+" "+J(A*F)+" "+J((k-y)*F)+" c")}}B(a);return this};E.rect=function(e,r,t,i,a){var s=ve(a);B([M(e*F),M((k-r)*F),M(t*F),M(-i*F),"re",s].join(" "));return this};E.setProperties=function(e){var r;for(r in P){if(P.hasOwnProperty(r)&&e[r]){P[r]=e[r]}}return this};E.setFontSize=function(e){x=e;return this};E.setFont=function(e,r){S=ue(e,r);return this};E.setFontStyle=E.setFontType=function(e){var r;S=ue(r,e);return this};E.getFontList=function(){var e={},r,t,i;for(r in b){if(b.hasOwnProperty(r)){e[r]=i=[];for(t in b[r]){if(b[r].hasOwnProperty(t)){i.push(t)}}}}return e};E.setLineWidth=function(e){B((e*F).toFixed(2)+" w");return this};E.setDrawColor=function(e,r,t,i){var a;if(r===undefined||i===undefined&&e===r===t){if(typeof e==="string"){a=e+" G"}else{a=M(e/255)+" G"}}else if(i===undefined){if(typeof e==="string"){a=[e,r,t,"RG"].join(" ")}else{a=[M(e/255),M(r/255),M(t/255),"RG"].join(" ")}}else{if(typeof e==="string"){a=[e,r,t,i,"K"].join(" ")}else{a=[M(e),M(r),M(t),M(i),"K"].join(" ")}}B(a);return this};E.setFillColor=function(e,r,t,i){var a;if(r===undefined||i===undefined&&e===r===t){if(typeof e==="string"){a=e+" g"}else{a=M(e/255)+" g"}}else if(i===undefined){if(typeof e==="string"){a=[e,r,t,"rg"].join(" ")}else{a=[M(e/255),M(r/255),M(t/255),"rg"].join(" ")}}else{if(typeof e==="string"){a=[e,r,t,i,"k"].join(" ")}else{a=[M(e),M(r),M(t),M(i),"k"].join(" ")}}B(a);return this};E.setTextColor=function(e,r,t){if(e===0&&r===0&&t===0||typeof r==="undefined"){m=J(e/255)+" g"}else{m=[J(e/255),J(r/255),J(t/255),"rg"].join(" ")}return this};E.CapJoinStyles={0:0,butt:0,but:0,bevel:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,milter:2};E.setLineCap=function(e){var r=this.CapJoinStyles[e];if(r===undefined){throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles")}N=r;B(r.toString(10)+" J");return this};E.setLineJoin=function(e){var r=this.CapJoinStyles[e];if(r===undefined){throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles")}D=r;B(r.toString(10)+" j");return this};E.output=de;E.save=function(e){E.output("save",e)};for(R in t.API){if(t.API.hasOwnProperty(R)){if(R==="events"&&t.API.events.length){(function(e,r){var t,i,a;for(a=r.length-1;a!==-1;a--){t=r[a][0];i=r[a][1];e.subscribe.apply(e,[t].concat(typeof i==="function"?[i]:i))}})(C,t.API.events)}else{E[R]=t.API[R]}}}te();S="F1";oe();C.publish("initialized");return E}t.API={events:[]};return t}();(function(e){var r="addImage_";var t=function(e){var r,t;if(!e.charCodeAt(0)===255||!e.charCodeAt(1)===216||!e.charCodeAt(2)===255||!e.charCodeAt(3)===224||!e.charCodeAt(6)==="J".charCodeAt(0)||!e.charCodeAt(7)==="F".charCodeAt(0)||!e.charCodeAt(8)==="I".charCodeAt(0)||!e.charCodeAt(9)==="F".charCodeAt(0)||!e.charCodeAt(10)===0){throw new Error("getJpegSize requires a binary jpeg file")}var i=e.charCodeAt(4)*256+e.charCodeAt(5);var a=4,s=e.length;while(a<s){a+=i;if(e.charCodeAt(a)!==255){throw new Error("getJpegSize could not find the size of the image")}if(e.charCodeAt(a+1)===192){t=e.charCodeAt(a+5)*256+e.charCodeAt(a+6);r=e.charCodeAt(a+7)*256+e.charCodeAt(a+8);return[r,t]}else{a+=2;i=e.charCodeAt(a)*256+e.charCodeAt(a+1)}}},i=function(e){var r=this.internal.newObject(),t=this.internal.write,i=this.internal.putStream;e["n"]=r;t("<</Type /XObject");t("/Subtype /Image");t("/Width "+e["w"]);t("/Height "+e["h"]);if(e["cs"]==="Indexed"){t("/ColorSpace [/Indexed /DeviceRGB "+(e["pal"].length/3-1)+" "+(r+1)+" 0 R]")}else{t("/ColorSpace /"+e["cs"]);if(e["cs"]==="DeviceCMYK"){t("/Decode [1 0 1 0 1 0 1 0]")}}t("/BitsPerComponent "+e["bpc"]);if("f"in e){t("/Filter /"+e["f"])}if("dp"in e){t("/DecodeParms <<"+e["dp"]+">>")}if("trns"in e&&e["trns"].constructor==Array){var a="";for(var s=0;s<e["trns"].length;s++){a+=e[a][s]+" "+e["trns"][s]+" ";t("/Mask ["+a+"]")}}if("smask"in e){t("/SMask "+(r+1)+" 0 R")}t("/Length "+e["data"].length+">>");i(e["data"]);t("endobj")},a=function(){var e=this.internal.collections[r+"images"];for(var t in e){i.call(this,e[t])}},s=function(){var e=this.internal.collections[r+"images"],t=this.internal.write,i;for(var a in e){i=e[a];t("/I"+i["i"],i["n"],"0","R")}};e.addImage=function(e,i,n,f,l,o){if(typeof e==="object"&&e.nodeType===1){var u=document.createElement("canvas");u.width=e.clientWidth;u.height=e.clientHeight;var c=u.getContext("2d");if(!c){throw"addImage requires canvas to be supported by browser."}c.drawImage(e,0,0,u.width,u.height);e=u.toDataURL("image/jpeg");i="JPEG"}if(i.toUpperCase()!=="JPEG"){throw new Error("addImage currently only supports format 'JPEG', not '"+i+"'")}var v,d=this.internal.collections[r+"images"],h=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString;if(e.substring(0,23)==="data:image/jpeg;base64,"){e=atob(e.replace("data:image/jpeg;base64,",""))}if(d){v=Object.keys?Object.keys(d).length:function(e){var r=0;for(var t in e){if(e.hasOwnProperty(t)){r++}}return r}(d)}else{v=0;this.internal.collections[r+"images"]=d={};this.internal.events.subscribe("putResources",a);this.internal.events.subscribe("putXobjectDict",s)}var m=t(e);var T={w:m[0],h:m[1],cs:"DeviceRGB",bpc:8,f:"DCTDecode",i:v,data:e};d[v]=T;if(!l&&!o){l=-96;o=-96}if(l<0){l=-1*T["w"]*72/l/this.internal.scaleFactor}if(o<0){o=-1*T["h"]*72/o/this.internal.scaleFactor}if(l===0){l=o*T["w"]/T["h"]}if(o===0){o=l*T["h"]/T["w"]}this.internal.write("q",h(l),"0 0",h(o),h(n),p(f+o),"cm /I"+T["i"],"Do Q");return this}})(jsPDF.API);(function(e){var r=function(e){var r="0123456789abcdef",t="klmnopqrstuvwxyz",i={};for(var a=0;a<t.length;a++){i[t[a]]=r[a]}var s,n={},f=1,l,o=n,u=[],c,v="",d="",h,p=e.length-1,m;a=1;while(a!=p){m=e[a];a+=1;if(m=="'"){if(l){h=l.join("");l=s}else{l=[]}}else if(l){l.push(m)}else if(m=="{"){u.push([o,h]);o={};h=s}else if(m=="}"){c=u.pop();c[0][c[1]]=o;h=s;o=c[0]}else if(m=="-"){f=-1}else{if(h===s){if(i.hasOwnProperty(m)){v+=i[m];h=parseInt(v,16)*f;f=+1;v=""}else{v+=m}}else{if(i.hasOwnProperty(m)){d+=i[m];o[h]=parseInt(d,16)*f;f=+1;h=s;d=""}else{d+=m}}}}return n};var t={codePages:["WinAnsiEncoding"],WinAnsiEncoding:r("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},i={Unicode:{Courier:t,"Courier-Bold":t,"Courier-BoldOblique":t,"Courier-Oblique":t,Helvetica:t,"Helvetica-Bold":t,"Helvetica-BoldOblique":t,"Helvetica-Oblique":t,"Times-Roman":t,"Times-Bold":t,"Times-BoldItalic":t,"Times-Italic":t}},a={Unicode:{"Courier-Oblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":r("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":r("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Helvetica:r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":r("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),"Courier-Bold":r("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":r("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":r("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":r("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFonts",function(e){var r,t,s,n,f="Unicode",l;for(t in e.fonts){if(e.fonts.hasOwnProperty(t)){r=e.fonts[t];s=a[f][r.PostScriptName];if(s){if(r.metadata[f]){n=r.metadata[f]}else{n=r.metadata[f]={}}n.widths=s.widths;n.kerning=s.kerning}l=i[f][r.PostScriptName];if(l){if(r.metadata[f]){n=r.metadata[f]}else{n=r.metadata[f]={}}n.encoding=l;if(l.codePages&&l.codePages.length){r.encoding=l.codePages[0]}}}}}])})(jsPDF.API);(function(e){var r=e.getCharWidthsArray=function(e,r){if(!r){r={}}var t=r.widths?r.widths:this.internal.getFont().metadata.Unicode.widths,i=t.fof?t.fof:1,a=r.kerning?r.kerning:this.internal.getFont().metadata.Unicode.kerning,s=a.fof?a.fof:1;var n,f,l,o=0,u=t[0]||i,c=[];for(n=0,f=e.length;n<f;n++){l=e.charCodeAt(n);c.push((t[l]||u)/i+(a[l]&&a[l][o]||0)/s);o=l}return c};var t=function(e){var r=e.length,t=0;while(r){r--;t+=e[r]}return t};e.getStringUnitWidth=function(e,i){return t(r.call(this,e,i))};var i=function(e,r,t,i){var a=[];var s=0,n=e.length,f=0;while(s!==n&&f+r[s]<t){f+=r[s];s++}a.push(e.slice(0,s));var l=s;f=0;while(s!==n){if(f+r[s]>i){a.push(e.slice(l,s));f=0;l=s}f+=r[s];s++}if(l!==s){a.push(e.slice(l,s))}return a};var a=function(e,a,s){if(!s){s={}}var n=r(" ",s)[0];var f=e.split(" ");var l=[],o=[l],u=s.textIndent||0,c=0,v=0,d,h;var p,m,T;for(p=0,m=f.length;p<m;p++){d=f[p];h=r(d,s);v=t(h);if(u+c+v>a){if(v>a){T=i(d,h,a-(u+c),a);l.push(T.shift());l=[T.pop()];while(T.length){o.push([T.shift()])}v=t(h.slice(d.length-l[0].length))}else{l=[d]}o.push(l);u=v;c=n}else{l.push(d);u+=c+v;c=n}}var A=[];for(p=0,m=o.length;p<m;p++){A.push(o[p].join(" "))}return A};e.splitTextToSize=function(e,r,t){if(!t){t={}}var i=t.fontSize||this.internal.getFontSize(),s=function(e){var r={0:1},t={};if(!e.widths||!e.kerning){var i=this.internal.getFont(e.fontName,e.fontStyle),a="Unicode";if(i.metadata[a]){return{widths:i.metadata[a].widths||r,kerning:i.metadata[a].kerning||t}}}else{return{widths:e.widths,kerning:e.kerning}}return{widths:r,kerning:t}}.call(this,t);var n;if(e.match(/[\n\r]/)){n=e.split(/\r\n|\r|\n/g)}else{n=[e]}var f=1*this.internal.scaleFactor*r/i;s.textIndent=t.textIndent?t.textIndent*1*this.internal.scaleFactor/i:0;var l,o,u=[];for(l=0,o=n.length;l<o;l++){u=u.concat(a(n[l],f,s))}return u}})(jsPDF.API);(function(e){e.addSVG=function(e,r,t,i,a){var s;if(r===s||r===s){throw new Error("addSVG needs values for 'x' and 'y'")}function n(e,r){var t=r.createElement("style");t.type="text/css";if(t.styleSheet){t.styleSheet.cssText=e}else{t.appendChild(r.createTextNode(e))}r.getElementsByTagName("head")[0].appendChild(t)}function f(e){var r="childframe",t=e.createElement("iframe");n(".jsPDF_sillysvg_iframe {display:none;position:absolute;}",e);t.name=r;t.setAttribute("width",0);t.setAttribute("height",0);t.setAttribute("frameborder","0");t.setAttribute("scrolling","no");t.setAttribute("seamless","seamless");t.setAttribute("class","jsPDF_sillysvg_iframe");e.body.appendChild(t);return t}function l(e,r){var t=(r.contentWindow||r.contentDocument).document;t.write(e);t.close();return t.getElementsByTagName("svg")[0]}function o(e){var r=parseFloat(e[1]),t=parseFloat(e[2]),i=[],a=3,s=e.length;while(a<s){if(e[a]==="c"){i.push([parseFloat(e[a+1]),parseFloat(e[a+2]),parseFloat(e[a+3]),parseFloat(e[a+4]),parseFloat(e[a+5]),parseFloat(e[a+6])]);a+=7}else if(e[a]==="l"){i.push([parseFloat(e[a+1]),parseFloat(e[a+2])]);a+=3}else{a+=1}}return[r,t,i]}var u=f(document),c=l(e,u),v=[1,1],d=parseFloat(c.getAttribute("width")),h=parseFloat(c.getAttribute("height"));if(d&&h){if(i&&a){v=[i/d,a/h]}else if(i){v=[i/d,i/d]}else if(a){v=[a/h,a/h]}}var p,m,T,A,y=c.childNodes;for(p=0,m=y.length;p<m;p++){T=y[p];if(T.tagName&&T.tagName.toUpperCase()==="PATH"){A=o(T.getAttribute("d").split(" "));A[0]=A[0]*v[0]+r;A[1]=A[1]*v[1]+t;this.lines.call(this,A[2],A[0],A[1],v)}}return this}})(jsPDF.API);(function(e){e.output=function(e,r){return this.internal.output(e,r)}})(jsPDF.API);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */if(typeof window!="undefined"){var saveAs=saveAs||function(e){var r=e.document,t=function(){return e.URL||e.webkitURL||e},i=e.URL||e.webkitURL||e,a=r.createElementNS("http://www.w3.org/1999/xhtml","a"),s="download"in a,n=function(t){var i=r.createEvent("MouseEvents");i.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);return t.dispatchEvent(i)},f=e.webkitRequestFileSystem,l=e.requestFileSystem||f||e.mozRequestFileSystem,o=function(r){(e.setImmediate||e.setTimeout)((function(){throw r}),0)},u="application/octet-stream",c=0,v=[],d=function(){var e=v.length;while(e--){var r=v[e];if(typeof r==="string"){i.revokeObjectURL(r)}else{r.remove()}}v.length=0},h=function(e,r,t){r=[].concat(r);var i=r.length;while(i--){var a=e["on"+r[i]];if(typeof a==="function"){try{a.call(e,t||e)}catch(e){o(e)}}}},p=function(r,i){var o=this,d=r.type,p=false,m,T,A=function(){var e=t().createObjectURL(r);v.push(e);return e},y=function(){h(o,"writestart progress write writeend".split(" "))},w=function(){if(p||!m){m=A()}if(T){T.location.href=m}o.readyState=o.DONE;y()},O=function(e){return function(){if(o.readyState!==o.DONE){return e.apply(this,arguments)}}},g={create:true,exclusive:false},_;o.readyState=o.INIT;if(!i){i="download"}if(s){m=A();a.href=m;a.download=i;if(n(a)){o.readyState=o.DONE;y();return}}if(e.chrome&&d&&d!==u){_=r.slice||r.webkitSlice;r=_.call(r,0,r.size,u);p=true}if(f&&i!=="download"){i+=".download"}if(d===u||f){T=e}if(!l){w();return}c+=r.size;l(e.TEMPORARY,c,O((function(e){e.root.getDirectory("saved",g,O((function(e){var t=function(){e.getFile(i,g,O((function(e){e.createWriter(O((function(t){t.onwriteend=function(r){T.location.href=e.toURL();v.push(e);o.readyState=o.DONE;h(o,"writeend",r)};t.onerror=function(){var e=t.error;if(e.code!==e.ABORT_ERR){w()}};"writestart progress write abort".split(" ").forEach((function(e){t["on"+e]=o["on"+e]}));t.write(r);o.abort=function(){t.abort();o.readyState=o.DONE};o.readyState=o.WRITING})),w)})),w)};e.getFile(i,{create:false},O((function(e){e.remove();t()})),O((function(e){if(e.code===e.NOT_FOUND_ERR){t()}else{w()}})))})),w)})),w)},m=p.prototype,T=function(e,r){return new p(e,r)};m.abort=function(){var e=this;e.readyState=e.DONE;h(e,"abort")};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;e.addEventListener("unload",d,false);return T}(commonjsGlobal)}var MAX_BITS=15;var D_CODES=30;var BL_CODES=19;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var HEAP_SIZE=2*L_CODES+1;var END_BLOCK=256;var MAX_BL_BITS=7;var REP_3_6=16;var REPZ_3_10=17;var REPZ_11_138=18;var Buf_size=8*2;var Z_DEFAULT_COMPRESSION=-1;var Z_FILTERED=1;var Z_HUFFMAN_ONLY=2;var Z_DEFAULT_STRATEGY=0;var Z_NO_FLUSH=0;var Z_PARTIAL_FLUSH=1;var Z_FULL_FLUSH=3;var Z_FINISH=4;var Z_OK=0;var Z_STREAM_END=1;var Z_NEED_DICT=2;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_BUF_ERROR=-5;var _dist_code=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29];function Tree(){var e=this;function r(r){var t=e.dyn_tree;var i=e.stat_desc.static_tree;var a=e.stat_desc.extra_bits;var s=e.stat_desc.extra_base;var n=e.stat_desc.max_length;var f;var l,o;var u;var c;var v;var d=0;for(u=0;u<=MAX_BITS;u++)r.bl_count[u]=0;t[r.heap[r.heap_max]*2+1]=0;for(f=r.heap_max+1;f<HEAP_SIZE;f++){l=r.heap[f];u=t[t[l*2+1]*2+1]+1;if(u>n){u=n;d++}t[l*2+1]=u;if(l>e.max_code)continue;r.bl_count[u]++;c=0;if(l>=s)c=a[l-s];v=t[l*2];r.opt_len+=v*(u+c);if(i)r.static_len+=v*(i[l*2+1]+c)}if(d===0)return;do{u=n-1;while(r.bl_count[u]===0)u--;r.bl_count[u]--;r.bl_count[u+1]+=2;r.bl_count[n]--;d-=2}while(d>0);for(u=n;u!==0;u--){l=r.bl_count[u];while(l!==0){o=r.heap[--f];if(o>e.max_code)continue;if(t[o*2+1]!=u){r.opt_len+=(u-t[o*2+1])*t[o*2];t[o*2+1]=u}l--}}}function t(e,r){var t=0;do{t|=e&1;e>>>=1;t<<=1}while(--r>0);return t>>>1}function i(e,r,i){var a=[];var s=0;var n;var f;var l;for(n=1;n<=MAX_BITS;n++){a[n]=s=s+i[n-1]<<1}for(f=0;f<=r;f++){l=e[f*2+1];if(l===0)continue;e[f*2]=t(a[l]++,l)}}e.build_tree=function(t){var a=e.dyn_tree;var s=e.stat_desc.static_tree;var n=e.stat_desc.elems;var f,l;var o=-1;var u;t.heap_len=0;t.heap_max=HEAP_SIZE;for(f=0;f<n;f++){if(a[f*2]!==0){t.heap[++t.heap_len]=o=f;t.depth[f]=0}else{a[f*2+1]=0}}while(t.heap_len<2){u=t.heap[++t.heap_len]=o<2?++o:0;a[u*2]=1;t.depth[u]=0;t.opt_len--;if(s)t.static_len-=s[u*2+1]}e.max_code=o;for(f=Math.floor(t.heap_len/2);f>=1;f--)t.pqdownheap(a,f);u=n;do{f=t.heap[1];t.heap[1]=t.heap[t.heap_len--];t.pqdownheap(a,1);l=t.heap[1];t.heap[--t.heap_max]=f;t.heap[--t.heap_max]=l;a[u*2]=a[f*2]+a[l*2];t.depth[u]=Math.max(t.depth[f],t.depth[l])+1;a[f*2+1]=a[l*2+1]=u;t.heap[1]=u++;t.pqdownheap(a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1];r(t);i(a,e.max_code,t.bl_count)}}Tree._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28];Tree.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];Tree.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];Tree.d_code=function(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]};Tree.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];Tree.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];Tree.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];Tree.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function StaticTree(e,r,t,i,a){var s=this;s.static_tree=e;s.extra_bits=r;s.extra_base=t;s.elems=i;s.max_length=a}StaticTree.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8];StaticTree.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5];StaticTree.static_l_desc=new StaticTree(StaticTree.static_ltree,Tree.extra_lbits,LITERALS+1,L_CODES,MAX_BITS);StaticTree.static_d_desc=new StaticTree(StaticTree.static_dtree,Tree.extra_dbits,0,D_CODES,MAX_BITS);StaticTree.static_bl_desc=new StaticTree(null,Tree.extra_blbits,0,BL_CODES,MAX_BL_BITS);var MAX_MEM_LEVEL=9;var DEF_MEM_LEVEL=8;function Config(e,r,t,i,a){var s=this;s.good_length=e;s.max_lazy=r;s.nice_length=t;s.max_chain=i;s.func=a}var STORED=0;var FAST=1;var SLOW=2;var config_table=[new Config(0,0,0,0,STORED),new Config(4,4,8,4,FAST),new Config(4,5,16,8,FAST),new Config(4,6,32,32,FAST),new Config(4,4,16,16,SLOW),new Config(8,16,32,32,SLOW),new Config(8,16,128,128,SLOW),new Config(8,32,128,256,SLOW),new Config(32,128,258,1024,SLOW),new Config(32,258,258,4096,SLOW)];var z_errmsg=["need dictionary","stream end","","","stream error","data error","","buffer error","",""];var NeedMore=0;var BlockDone=1;var FinishStarted=2;var FinishDone=3;var PRESET_DICT=32;var INIT_STATE=42;var BUSY_STATE=113;var FINISH_STATE=666;var Z_DEFLATED=8;var STORED_BLOCK=0;var STATIC_TREES=1;var DYN_TREES=2;var MIN_MATCH=3;var MAX_MATCH=258;var MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1;function smaller(e,r,t,i){var a=e[r*2];var s=e[t*2];return a<s||a==s&&i[r]<=i[t]}function Deflate(){var e=this;var r;var t;var i;var a;var s;var n;var f;var l;var o;var u;var c;var v;var d;var h;var p;var m;var T;var A;var y;var w;var O;var g;var _;var b;var x;var S;var I;var k;var q;var F;var P;var N;var D;var E=new Tree;var C=new Tree;var j=new Tree;e.depth=[];var R;var M;var J;var L;var V;var B;var U;var z;e.bl_count=[];e.heap=[];P=[];N=[];D=[];function H(){var e;o=2*s;c[d-1]=0;for(e=0;e<d-1;e++){c[e]=0}S=config_table[I].max_lazy;q=config_table[I].good_length;F=config_table[I].nice_length;x=config_table[I].max_chain;O=0;T=0;_=0;A=b=MIN_MATCH-1;w=0;v=0}function Z(){var r;for(r=0;r<L_CODES;r++)P[r*2]=0;for(r=0;r<D_CODES;r++)N[r*2]=0;for(r=0;r<BL_CODES;r++)D[r*2]=0;P[END_BLOCK*2]=1;e.opt_len=e.static_len=0;J=V=0}function G(){E.dyn_tree=P;E.stat_desc=StaticTree.static_l_desc;C.dyn_tree=N;C.stat_desc=StaticTree.static_d_desc;j.dyn_tree=D;j.stat_desc=StaticTree.static_bl_desc;U=0;z=0;B=8;Z()}e.pqdownheap=function(r,t){var i=e.heap;var a=i[t];var s=t<<1;while(s<=e.heap_len){if(s<e.heap_len&&smaller(r,i[s+1],i[s],e.depth)){s++}if(smaller(r,a,i[s],e.depth))break;i[t]=i[s];t=s;s<<=1}i[t]=a};function X(e,r){var t;var i=-1;var a;var s=e[0*2+1];var n=0;var f=7;var l=4;if(s===0){f=138;l=3}e[(r+1)*2+1]=65535;for(t=0;t<=r;t++){a=s;s=e[(t+1)*2+1];if(++n<f&&a==s){continue}else if(n<l){D[a*2]+=n}else if(a!==0){if(a!=i)D[a*2]++;D[REP_3_6*2]++}else if(n<=10){D[REPZ_3_10*2]++}else{D[REPZ_11_138*2]++}n=0;i=a;if(s===0){f=138;l=3}else if(a==s){f=6;l=3}else{f=7;l=4}}}function $(){var r;X(P,E.max_code);X(N,C.max_code);j.build_tree(e);for(r=BL_CODES-1;r>=3;r--){if(D[Tree.bl_order[r]*2+1]!==0)break}e.opt_len+=3*(r+1)+5+5+4;return r}function Q(r){e.pending_buf[e.pending++]=r}function Y(e){Q(e&255);Q(e>>>8&255)}function W(e){Q(e>>8&255);Q(e&255&255)}function K(e,r){var t,i=r;if(z>Buf_size-i){t=e;U|=t<<z&65535;Y(U);U=t>>>Buf_size-z;z+=i-Buf_size}else{U|=e<<z&65535;z+=i}}function ee(e,r){var t=e*2;K(r[t]&65535,r[t+1]&65535)}function re(e,r){var t;var i=-1;var a;var s=e[0*2+1];var n=0;var f=7;var l=4;if(s===0){f=138;l=3}for(t=0;t<=r;t++){a=s;s=e[(t+1)*2+1];if(++n<f&&a==s){continue}else if(n<l){do{ee(a,D)}while(--n!==0)}else if(a!==0){if(a!=i){ee(a,D);n--}ee(REP_3_6,D);K(n-3,2)}else if(n<=10){ee(REPZ_3_10,D);K(n-3,3)}else{ee(REPZ_11_138,D);K(n-11,7)}n=0;i=a;if(s===0){f=138;l=3}else if(a==s){f=6;l=3}else{f=7;l=4}}}function te(e,r,t){var i;K(e-257,5);K(r-1,5);K(t-4,4);for(i=0;i<t;i++){K(D[Tree.bl_order[i]*2+1],3)}re(P,e-1);re(N,r-1)}function ie(){if(z==16){Y(U);U=0;z=0}else if(z>=8){Q(U&255);U>>>=8;z-=8}}function ae(){K(STATIC_TREES<<1,3);ee(END_BLOCK,StaticTree.static_ltree);ie();if(1+B+10-z<9){K(STATIC_TREES<<1,3);ee(END_BLOCK,StaticTree.static_ltree);ie()}B=7}function se(r,t){var i,a,s;e.pending_buf[L+J*2]=r>>>8&255;e.pending_buf[L+J*2+1]=r&255;e.pending_buf[R+J]=t&255;J++;if(r===0){P[t*2]++}else{V++;r--;P[(Tree._length_code[t]+LITERALS+1)*2]++;N[Tree.d_code(r)*2]++}if((J&8191)===0&&I>2){i=J*8;a=O-T;for(s=0;s<D_CODES;s++){i+=N[s*2]*(5+Tree.extra_dbits[s])}i>>>=3;if(V<Math.floor(J/2)&&i<Math.floor(a/2))return true}return J==M-1}function ne(r,t){var i;var a;var s=0;var n;var f;if(J!==0){do{i=e.pending_buf[L+s*2]<<8&65280|e.pending_buf[L+s*2+1]&255;a=e.pending_buf[R+s]&255;s++;if(i===0){ee(a,r)}else{n=Tree._length_code[a];ee(n+LITERALS+1,r);f=Tree.extra_lbits[n];if(f!==0){a-=Tree.base_length[n];K(a,f)}i--;n=Tree.d_code(i);ee(n,t);f=Tree.extra_dbits[n];if(f!==0){i-=Tree.base_dist[n];K(i,f)}}}while(s<J)}ee(END_BLOCK,r);B=r[END_BLOCK*2+1]}function fe(){if(z>8){Y(U)}else if(z>0){Q(U&255)}U=0;z=0}function le(r,t,i){fe();B=8;if(i){Y(t);Y(~t)}e.pending_buf.set(l.subarray(r,r+t),e.pending);e.pending+=t}function oe(e,r,t){K((STORED_BLOCK<<1)+(t?1:0),3);le(e,r,true)}function ue(r,t,i){var a,s;var n=0;if(I>0){E.build_tree(e);C.build_tree(e);n=$();a=e.opt_len+3+7>>>3;s=e.static_len+3+7>>>3;if(s<=a)a=s}else{a=s=t+5}if(t+4<=a&&r!=-1){oe(r,t,i)}else if(s==a){K((STATIC_TREES<<1)+(i?1:0),3);ne(StaticTree.static_ltree,StaticTree.static_dtree)}else{K((DYN_TREES<<1)+(i?1:0),3);te(E.max_code+1,C.max_code+1,n+1);ne(P,N)}Z();if(i){fe()}}function ce(e){ue(T>=0?T:-1,O-T,e);T=O;r.flush_pending()}function ve(){var e,t;var i;var a;do{a=o-_-O;if(a===0&&O===0&&_===0){a=s}else if(a==-1){a--}else if(O>=s+s-MIN_LOOKAHEAD){l.set(l.subarray(s,s+s),0);g-=s;O-=s;T-=s;e=d;i=e;do{t=c[--i]&65535;c[i]=t>=s?t-s:0}while(--e!==0);e=s;i=e;do{t=u[--i]&65535;u[i]=t>=s?t-s:0}while(--e!==0);a+=s}if(r.avail_in===0)return;e=r.read_buf(l,O+_,a);_+=e;if(_>=MIN_MATCH){v=l[O]&255;v=(v<<m^l[O+1]&255)&p}}while(_<MIN_LOOKAHEAD&&r.avail_in!==0)}function de(e){var t=65535;var a;if(t>i-5){t=i-5}while(true){if(_<=1){ve();if(_===0&&e==Z_NO_FLUSH)return NeedMore;if(_===0)break}O+=_;_=0;a=T+t;if(O===0||O>=a){_=O-a;O=a;ce(false);if(r.avail_out===0)return NeedMore}if(O-T>=s-MIN_LOOKAHEAD){ce(false);if(r.avail_out===0)return NeedMore}}ce(e==Z_FINISH);if(r.avail_out===0)return e==Z_FINISH?FinishStarted:NeedMore;return e==Z_FINISH?FinishDone:BlockDone}function he(e){var r=x;var t=O;var i;var a;var n=b;var o=O>s-MIN_LOOKAHEAD?O-(s-MIN_LOOKAHEAD):0;var c=F;var v=f;var d=O+MAX_MATCH;var h=l[t+n-1];var p=l[t+n];if(b>=q){r>>=2}if(c>_)c=_;do{i=e;if(l[i+n]!=p||l[i+n-1]!=h||l[i]!=l[t]||l[++i]!=l[t+1])continue;t+=2;i++;do{}while(l[++t]==l[++i]&&l[++t]==l[++i]&&l[++t]==l[++i]&&l[++t]==l[++i]&&l[++t]==l[++i]&&l[++t]==l[++i]&&l[++t]==l[++i]&&l[++t]==l[++i]&&t<d);a=MAX_MATCH-(d-t);t=d-MAX_MATCH;if(a>n){g=e;n=a;if(a>=c)break;h=l[t+n-1];p=l[t+n]}}while((e=u[e&v]&65535)>o&&--r!==0);if(n<=_)return n;return _}function pe(e){var t=0;var i;while(true){if(_<MIN_LOOKAHEAD){ve();if(_<MIN_LOOKAHEAD&&e==Z_NO_FLUSH){return NeedMore}if(_===0)break}if(_>=MIN_MATCH){v=(v<<m^l[O+(MIN_MATCH-1)]&255)&p;t=c[v]&65535;u[O&f]=c[v];c[v]=O}if(t!==0&&(O-t&65535)<=s-MIN_LOOKAHEAD){if(k!=Z_HUFFMAN_ONLY){A=he(t)}}if(A>=MIN_MATCH){i=se(O-g,A-MIN_MATCH);_-=A;if(A<=S&&_>=MIN_MATCH){A--;do{O++;v=(v<<m^l[O+(MIN_MATCH-1)]&255)&p;t=c[v]&65535;u[O&f]=c[v];c[v]=O}while(--A!==0);O++}else{O+=A;A=0;v=l[O]&255;v=(v<<m^l[O+1]&255)&p}}else{i=se(0,l[O]&255);_--;O++}if(i){ce(false);if(r.avail_out===0)return NeedMore}}ce(e==Z_FINISH);if(r.avail_out===0){if(e==Z_FINISH)return FinishStarted;else return NeedMore}return e==Z_FINISH?FinishDone:BlockDone}function me(e){var t=0;var i;var a;while(true){if(_<MIN_LOOKAHEAD){ve();if(_<MIN_LOOKAHEAD&&e==Z_NO_FLUSH){return NeedMore}if(_===0)break}if(_>=MIN_MATCH){v=(v<<m^l[O+(MIN_MATCH-1)]&255)&p;t=c[v]&65535;u[O&f]=c[v];c[v]=O}b=A;y=g;A=MIN_MATCH-1;if(t!==0&&b<S&&(O-t&65535)<=s-MIN_LOOKAHEAD){if(k!=Z_HUFFMAN_ONLY){A=he(t)}if(A<=5&&(k==Z_FILTERED||A==MIN_MATCH&&O-g>4096)){A=MIN_MATCH-1}}if(b>=MIN_MATCH&&A<=b){a=O+_-MIN_MATCH;i=se(O-1-y,b-MIN_MATCH);_-=b-1;b-=2;do{if(++O<=a){v=(v<<m^l[O+(MIN_MATCH-1)]&255)&p;t=c[v]&65535;u[O&f]=c[v];c[v]=O}}while(--b!==0);w=0;A=MIN_MATCH-1;O++;if(i){ce(false);if(r.avail_out===0)return NeedMore}}else if(w!==0){i=se(0,l[O-1]&255);if(i){ce(false)}O++;_--;if(r.avail_out===0)return NeedMore}else{w=1;O++;_--}}if(w!==0){i=se(0,l[O-1]&255);w=0}ce(e==Z_FINISH);if(r.avail_out===0){if(e==Z_FINISH)return FinishStarted;else return NeedMore}return e==Z_FINISH?FinishDone:BlockDone}function Te(r){r.total_in=r.total_out=0;r.msg=null;e.pending=0;e.pending_out=0;t=BUSY_STATE;a=Z_NO_FLUSH;G();H();return Z_OK}e.deflateInit=function(r,t,a,o,v,T){if(!o)o=Z_DEFLATED;if(!v)v=DEF_MEM_LEVEL;if(!T)T=Z_DEFAULT_STRATEGY;r.msg=null;if(t==Z_DEFAULT_COMPRESSION)t=6;if(v<1||v>MAX_MEM_LEVEL||o!=Z_DEFLATED||a<9||a>15||t<0||t>9||T<0||T>Z_HUFFMAN_ONLY){return Z_STREAM_ERROR}r.dstate=e;n=a;s=1<<n;f=s-1;h=v+7;d=1<<h;p=d-1;m=Math.floor((h+MIN_MATCH-1)/MIN_MATCH);l=new Uint8Array(s*2);u=[];c=[];M=1<<v+6;e.pending_buf=new Uint8Array(M*4);i=M*4;L=Math.floor(M/2);R=(1+2)*M;I=t;k=T;return Te(r)};e.deflateEnd=function(){if(t!=INIT_STATE&&t!=BUSY_STATE&&t!=FINISH_STATE){return Z_STREAM_ERROR}e.pending_buf=null;c=null;u=null;l=null;e.dstate=null;return t==BUSY_STATE?Z_DATA_ERROR:Z_OK};e.deflateParams=function(e,r,t){var i=Z_OK;if(r==Z_DEFAULT_COMPRESSION){r=6}if(r<0||r>9||t<0||t>Z_HUFFMAN_ONLY){return Z_STREAM_ERROR}if(config_table[I].func!=config_table[r].func&&e.total_in!==0){i=e.deflate(Z_PARTIAL_FLUSH)}if(I!=r){I=r;S=config_table[I].max_lazy;q=config_table[I].good_length;F=config_table[I].nice_length;x=config_table[I].max_chain}k=t;return i};e.deflateSetDictionary=function(e,r,i){var a=i;var n,o=0;if(!r||t!=INIT_STATE)return Z_STREAM_ERROR;if(a<MIN_MATCH)return Z_OK;if(a>s-MIN_LOOKAHEAD){a=s-MIN_LOOKAHEAD;o=i-a}l.set(r.subarray(o,o+a),0);O=a;T=a;v=l[0]&255;v=(v<<m^l[1]&255)&p;for(n=0;n<=a-MIN_MATCH;n++){v=(v<<m^l[n+(MIN_MATCH-1)]&255)&p;u[n&f]=c[v];c[v]=n}return Z_OK};e.deflate=function(i,s){var f,l,o,u,v;if(s>Z_FINISH||s<0){return Z_STREAM_ERROR}if(!i.next_out||!i.next_in&&i.avail_in!==0||t==FINISH_STATE&&s!=Z_FINISH){i.msg=z_errmsg[Z_NEED_DICT-Z_STREAM_ERROR];return Z_STREAM_ERROR}if(i.avail_out===0){i.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR];return Z_BUF_ERROR}r=i;u=a;a=s;if(t==INIT_STATE){l=Z_DEFLATED+(n-8<<4)<<8;o=(I-1&255)>>1;if(o>3)o=3;l|=o<<6;if(O!==0)l|=PRESET_DICT;l+=31-l%31;t=BUSY_STATE;W(l)}if(e.pending!==0){r.flush_pending();if(r.avail_out===0){a=-1;return Z_OK}}else if(r.avail_in===0&&s<=u&&s!=Z_FINISH){r.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR];return Z_BUF_ERROR}if(t==FINISH_STATE&&r.avail_in!==0){i.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR];return Z_BUF_ERROR}if(r.avail_in!==0||_!==0||s!=Z_NO_FLUSH&&t!=FINISH_STATE){v=-1;switch(config_table[I].func){case STORED:v=de(s);break;case FAST:v=pe(s);break;case SLOW:v=me(s);break}if(v==FinishStarted||v==FinishDone){t=FINISH_STATE}if(v==NeedMore||v==FinishStarted){if(r.avail_out===0){a=-1}return Z_OK}if(v==BlockDone){if(s==Z_PARTIAL_FLUSH){ae()}else{oe(0,0,false);if(s==Z_FULL_FLUSH){for(f=0;f<d;f++)c[f]=0}}r.flush_pending();if(r.avail_out===0){a=-1;return Z_OK}}}if(s!=Z_FINISH)return Z_OK;return Z_STREAM_END}}function ZStream(){var e=this;e.next_in_index=0;e.next_out_index=0;e.avail_in=0;e.total_in=0;e.avail_out=0;e.total_out=0}ZStream.prototype={deflateInit:function(e,r){var t=this;t.dstate=new Deflate;if(!r)r=MAX_BITS;return t.dstate.deflateInit(t,e,r)},deflate:function(e){var r=this;if(!r.dstate){return Z_STREAM_ERROR}return r.dstate.deflate(r,e)},deflateEnd:function(){var e=this;if(!e.dstate)return Z_STREAM_ERROR;var r=e.dstate.deflateEnd();e.dstate=null;return r},deflateParams:function(e,r){var t=this;if(!t.dstate)return Z_STREAM_ERROR;return t.dstate.deflateParams(t,e,r)},deflateSetDictionary:function(e,r){var t=this;if(!t.dstate)return Z_STREAM_ERROR;return t.dstate.deflateSetDictionary(t,e,r)},read_buf:function(e,r,t){var i=this;var a=i.avail_in;if(a>t)a=t;if(a===0)return 0;i.avail_in-=a;e.set(i.next_in.subarray(i.next_in_index,i.next_in_index+a),r);i.next_in_index+=a;i.total_in+=a;return a},flush_pending:function(){var e=this;var r=e.dstate.pending;if(r>e.avail_out)r=e.avail_out;if(r===0)return;e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+r),e.next_out_index);e.next_out_index+=r;e.dstate.pending_out+=r;e.total_out+=r;e.avail_out-=r;e.dstate.pending-=r;if(e.dstate.pending===0){e.dstate.pending_out=0}}};function Deflater(e){var r=this;var t=new ZStream;var i=512;var a=Z_NO_FLUSH;var s=new Uint8Array(i);if(typeof e=="undefined")e=Z_DEFAULT_COMPRESSION;t.deflateInit(e);t.next_out=s;r.append=function(e,r){var n,f=[],l=0,o=0,u=0,c;if(!e.length)return;t.next_in_index=0;t.next_in=e;t.avail_in=e.length;do{t.next_out_index=0;t.avail_out=i;n=t.deflate(a);if(n!=Z_OK)throw"deflating: "+t.msg;if(t.next_out_index)if(t.next_out_index==i)f.push(new Uint8Array(s));else f.push(new Uint8Array(s.subarray(0,t.next_out_index)));u+=t.next_out_index;if(r&&t.next_in_index>0&&t.next_in_index!=l){r(t.next_in_index);l=t.next_in_index}}while(t.avail_in>0||t.avail_out===0);c=new Uint8Array(u);f.forEach((function(e){c.set(e,o);o+=e.length}));return c};r.flush=function(){var e,r=[],a=0,n=0,f;do{t.next_out_index=0;t.avail_out=i;e=t.deflate(Z_FINISH);if(e!=Z_STREAM_END&&e!=Z_OK)throw"deflating: "+t.msg;if(i-t.avail_out>0)r.push(new Uint8Array(s.subarray(0,t.next_out_index)));n+=t.next_out_index}while(t.avail_in>0||t.avail_out===0);t.deflateEnd();f=new Uint8Array(n);r.forEach((function(e){f.set(e,a);a+=e.length}));return f}}var JSZip=function(e,r){this.files={};this.root="";if(e)this.load(e,r)};JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"};JSZip.defaults={base64:false,binary:false,dir:false,date:null};JSZip.prototype=function(){var e=function(e,r,t){this.name=e;this.data=r;this.options=t};e.prototype={asText:function(){return this.options.binary?JSZip.prototype.utf8decode(this.data):this.data},asBinary:function(){return this.options.binary?this.data:JSZip.prototype.utf8encode(this.data)}};var r=function(e,r){var t="",i;for(i=0;i<r;i++){t+=String.fromCharCode(e&255);e=e>>>8}return t};var t=function(){var e={},r,t;for(r=0;r<arguments.length;r++){for(t in arguments[r]){if(typeof e[t]==="undefined"){e[t]=arguments[r][t]}}}return e};var i=function(e){e=e||{};if(e.base64===true&&e.binary==null)e.binary=true;e=t(e,JSZip.defaults);e.date=e.date||new Date;return e};var a=function(e,r,t){var a=s(e);if(a)n.call(this,a);t=i(t);return this.files[e]={name:e,data:r,options:t}};var s=function(e){if(e.slice(-1)=="/"){e=e.substring(0,e.length-1)}var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""};var n=function(e){if(e.slice(-1)!="/")e+="/";if(!this.files[e]){var r=s(e);if(r)n.call(this,r);a.call(this,e,"",{dir:true})}return this.files[e]};var f=function(e,t,i){var a=t!==e.name,s=e.data,n=e.options,f,l;f=n.date.getHours();f=f<<6;f=f|n.date.getMinutes();f=f<<5;f=f|n.date.getSeconds()/2;l=n.date.getFullYear()-1980;l=l<<4;l=l|n.date.getMonth()+1;l=l<<5;l=l|n.date.getDate();if(n.base64===true)s=JSZipBase64.decode(s);if(n.binary===false)s=this.utf8encode(s);var o=JSZip.compressions[i];var u=o.compress(s);var c="";c+="\n\0";c+=a?"\0\b":"\0\0";c+=o.magic;c+=r(f,2);c+=r(l,2);c+=r(this.crc32(s),4);c+=r(u.length,4);c+=r(s.length,4);c+=r(t.length,2);c+="\0\0";return{header:c,compressedData:u}};return{load:function(e,r){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(r){var i=[],a,s,n,f;for(a in this.files){n=this.files[a];f=new e(n.name,n.data,t(n.options));s=a.slice(this.root.length,a.length);if(a.slice(0,this.root.length)===this.root&&r(s,f)){i.push(f)}}return i},file:function(e,r,t){if(arguments.length===1){if(e instanceof RegExp){var i=e;return this.filter((function(e,r){return!r.options.dir&&i.test(e)}))}else{return this.filter((function(r,t){return!t.options.dir&&r===e}))[0]||null}}else{e=this.root+e;a.call(this,e,r,t)}return this},folder:function(e){if(!e){throw new Error("folder : wrong argument")}if(e instanceof RegExp){return this.filter((function(r,t){return t.options.dir&&e.test(r)}))}var r=this.root+e;var t=n.call(this,r);var i=this.clone();i.root=t.name;return i},remove:function(e){e=this.root+e;var r=this.files[e];if(!r){if(e.slice(-1)!="/")e+="/";r=this.files[e]}if(r){if(!r.options.dir){delete this.files[e]}else{var t=this.filter((function(r,t){return t.name.slice(0,e.length)===e}));for(var i=0;i<t.length;i++){delete this.files[t[i].name]}}}return this},generate:function(e){e=t(e||{},{base64:true,compression:"STORE"});var i=e.compression.toUpperCase();var a=[],s=[],n=0;if(!JSZip.compressions[i]){throw i+" is not a valid compression method !"}for(var l in this.files){if(!this.files.hasOwnProperty(l)){continue}var o=this.files[l];var u=this.utf8encode(o.name);var c="",v="",d=f.call(this,o,u,i);c=JSZip.signature.LOCAL_FILE_HEADER+d.header+u+d.compressedData;v=JSZip.signature.CENTRAL_FILE_HEADER+"\0"+d.header+"\0\0"+"\0\0"+"\0\0"+(this.files[l].dir===true?"\0\0\0":"\0\0\0\0")+r(n,4)+u;n+=c.length;s.push(c);a.push(v)}var h=s.join("");var p=a.join("");var m="";m=JSZip.signature.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+r(s.length,2)+r(s.length,2)+r(p.length,4)+r(h.length,4)+"\0\0";var T=h+p+m;return e.base64?JSZipBase64.encode(T):T},crc32:function(e,r){if(e===""||typeof e==="undefined")return 0;var t="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";if(typeof r=="undefined"){r=0}var i=0;var a=0;r=r^-1;for(var s=0,n=e.length;s<n;s++){a=(r^e.charCodeAt(s))&255;i="0x"+t.substr(a*9,8);r=r>>>8^i}return r^-1},clone:function(){var e=new JSZip;for(var r in this){if(typeof this[r]!=="function"){e[r]=this[r]}}return e},utf8encode:function(e){e=e.replace(/\r\n/g,"\n");var r="";for(var t=0;t<e.length;t++){var i=e.charCodeAt(t);if(i<128){r+=String.fromCharCode(i)}else if(i>127&&i<2048){r+=String.fromCharCode(i>>6|192);r+=String.fromCharCode(i&63|128)}else{r+=String.fromCharCode(i>>12|224);r+=String.fromCharCode(i>>6&63|128);r+=String.fromCharCode(i&63|128)}}return r},utf8decode:function(e){var r="";var t=0;var i=0,a=0,s=0;while(t<e.length){i=e.charCodeAt(t);if(i<128){r+=String.fromCharCode(i);t++}else if(i>191&&i<224){a=e.charCodeAt(t+1);r+=String.fromCharCode((i&31)<<6|a&63);t+=2}else{a=e.charCodeAt(t+1);s=e.charCodeAt(t+2);r+=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63);t+=3}}return r}}}();JSZip.compressions={STORE:{magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e}}};var JSZipBase64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(r,t){var i="";var a,s,n,f,l,o,u;var c=0;while(c<r.length){a=r.charCodeAt(c++);s=r.charCodeAt(c++);n=r.charCodeAt(c++);f=a>>2;l=(a&3)<<4|s>>4;o=(s&15)<<2|n>>6;u=n&63;if(isNaN(s)){o=u=64}else if(isNaN(n)){u=64}i=i+e.charAt(f)+e.charAt(l)+e.charAt(o)+e.charAt(u)}return i},decode:function(r,t){var i="";var a,s,n;var f,l,o,u;var c=0;r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<r.length){f=e.indexOf(r.charAt(c++));l=e.indexOf(r.charAt(c++));o=e.indexOf(r.charAt(c++));u=e.indexOf(r.charAt(c++));a=f<<2|l>>4;s=(l&15)<<4|o>>2;n=(o&3)<<6|u;i=i+String.fromCharCode(a);if(o!=64){i=i+String.fromCharCode(s)}if(u!=64){i=i+String.fromCharCode(n)}}return i}}}();if(!JSZip){throw"JSZip not defined"}(function(){var e=32768;var r=0;var t=1;var i=2;var a=6;var s=32768;var n=64;var f=1024*8;var l=2*e;var o=3;var u=258;var c=16;var v=8192;var d=13;var h=v;var p=1<<d;var m=p-1;var T=e-1;var A=0;var y=4096;var w=u+o+1;var O=e-w;var g=1;var _=15;var b=7;var x=29;var S=256;var I=256;var k=S+1+x;var q=30;var F=19;var P=16;var N=17;var D=18;var E=2*k+1;var C=parseInt((d+o-1)/o);var j;var R,M;var J;var L=null;var V,B;var U;var z;var H;var Z;var G;var X;var $;var Q;var Y;var W;var K;var ee;var re;var te;var ie;var ae;var se;var ne;var fe;var le;var oe;var ue;var ce;var ve;var de;var he;var pe;var me;var Te;var Ae;var ye;var we;var Oe;var ge;var _e;var be;var xe;var Se;var Ie;var ke;var qe;var Fe;var Pe;var Ne;var De;var Ee;var Ce;var je;var Re;var Me=function(){this.fc=0;this.dl=0};var Je=function(){this.dyn_tree=null;this.static_tree=null;this.extra_bits=null;this.extra_base=0;this.elems=0;this.max_length=0;this.max_code=0};var Le=function(e,r,t,i){this.good_length=e;this.max_lazy=r;this.nice_length=t;this.max_chain=i};var Ve=function(){this.next=null;this.len=0;this.ptr=new Array(f);this.off=0};var Be=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0);var Ue=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);var ze=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7);var He=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);var Ze=new Array(new Le(0,0,0,0),new Le(4,4,8,4),new Le(4,5,16,8),new Le(4,6,32,32),new Le(4,4,16,16),new Le(8,16,32,32),new Le(8,16,128,128),new Le(8,32,128,256),new Le(32,128,258,1024),new Le(32,258,258,4096));var Ge=function(e){var r;if(!e)e=a;else if(e<1)e=1;else if(e>9)e=9;oe=e;J=false;se=false;if(L!=null)return;j=R=M=null;L=new Array(f);z=new Array(l);H=new Array(h);Z=new Array(s+n);G=new Array(1<<c);ce=new Array(E);for(r=0;r<E;r++)ce[r]=new Me;ve=new Array(2*q+1);for(r=0;r<2*q+1;r++)ve[r]=new Me;de=new Array(k+2);for(r=0;r<k+2;r++)de[r]=new Me;he=new Array(q);for(r=0;r<q;r++)he[r]=new Me;pe=new Array(2*F+1);for(r=0;r<2*F+1;r++)pe[r]=new Me;me=new Je;Te=new Je;Ae=new Je;ye=new Array(_+1);we=new Array(2*k+1);_e=new Array(2*k+1);be=new Array(u-o+1);xe=new Array(512);Se=new Array(x);Ie=new Array(q);ke=new Array(parseInt(v/8))};var Xe=function(e){e.next=j;j=e};var $e=function(){var e;if(j!=null){e=j;j=j.next}else e=new Ve;e.next=null;e.len=e.off=0;return e};var Qe=function(r){return G[e+r]};var Ye=function(r,t){return G[e+r]=t};var We=function(e){L[B+V++]=e;if(B+V==f)Fr()};var Ke=function(e){e&=65535;if(B+V<f-2){L[B+V++]=e&255;L[B+V++]=e>>>8}else{We(e&255);We(e>>>8)}};var er=function(){Y=(Y<<C^z[ie+o-1]&255)&m;W=Qe(Y);G[ie&T]=W;Ye(Y,ie)};var rr=function(e,r){Ir(r[e].fc,r[e].dl)};var tr=function(e){return(e<256?xe[e]:xe[256+(e>>7)])&255};var ir=function(e,r,t){return e[r].fc<e[t].fc||e[r].fc==e[t].fc&&_e[r]<=_e[t]};var ar=function(e,r,t){var i;for(i=0;i<t&&Re<je.length;i++)e[r+i]=je.charCodeAt(Re++)&255;return i};var sr=function(){var r;for(r=0;r<p;r++)G[e+r]=0;le=Ze[oe].max_lazy;ue=Ze[oe].good_length;fe=Ze[oe].max_chain;ie=0;Q=0;ne=ar(z,0,2*e);if(ne<=0){se=true;ne=0;return}se=false;while(ne<w&&!se)fr();Y=0;for(r=0;r<o-1;r++){Y=(Y<<C^z[r]&255)&m}};var nr=function(e){var r=fe;var t=ie;var i;var a;var s=te;var n=ie>O?ie-O:A;var f=ie+u;var l=z[t+s-1];var o=z[t+s];if(te>=ue)r>>=2;do{i=e;if(z[i+s]!=o||z[i+s-1]!=l||z[i]!=z[t]||z[++i]!=z[t+1]){continue}t+=2;i++;do{}while(z[++t]==z[++i]&&z[++t]==z[++i]&&z[++t]==z[++i]&&z[++t]==z[++i]&&z[++t]==z[++i]&&z[++t]==z[++i]&&z[++t]==z[++i]&&z[++t]==z[++i]&&t<f);a=u-(f-t);t=f-u;if(a>s){ae=e;s=a;{if(a>=u)break}l=z[t+s-1];o=z[t+s]}}while((e=G[e&T])>n&&--r!=0);return s};var fr=function(){var r,t;var i=l-ne-ie;if(i==-1){i--}else if(ie>=e+O){for(r=0;r<e;r++)z[r]=z[r+e];ae-=e;ie-=e;Q-=e;for(r=0;r<p;r++){t=Qe(r);Ye(r,t>=e?t-e:A)}for(r=0;r<e;r++){t=G[r];G[r]=t>=e?t-e:A}i+=e}if(!se){r=ar(z,ie+ne,i);if(r<=0)se=true;else ne+=r}};var lr=function(){while(ne!=0&&R==null){var e;er();if(W!=A&&ie-W<=O){re=nr(W);if(re>ne)re=ne}if(re>=o){e=br(ie-ae,re-o);ne-=re;if(re<=le){re--;do{ie++;er()}while(--re!=0);ie++}else{ie+=re;re=0;Y=z[ie]&255;Y=(Y<<C^z[ie+1]&255)&m}}else{e=br(0,z[ie]&255);ne--;ie++}if(e){_r(0);Q=ie}while(ne<w&&!se)fr()}};var or=function(){while(ne!=0&&R==null){er();te=re;K=ae;re=o-1;if(W!=A&&te<le&&ie-W<=O){re=nr(W);if(re>ne)re=ne;if(re==o&&ie-ae>y){re--}}if(te>=o&&re<=te){var e;e=br(ie-1-K,te-o);ne-=te-1;te-=2;do{ie++;er()}while(--te!=0);ee=0;re=o-1;ie++;if(e){_r(0);Q=ie}}else if(ee!=0){if(br(0,z[ie-1]&255)){_r(0);Q=ie}ie++;ne--}else{ee=1;ie++;ne--}while(ne<w&&!se)fr()}};var ur=function(){if(se)return;X=0;$=0;dr();sr();R=null;V=0;B=0;if(oe<=3){te=o-1;re=0}else{re=o-1;ee=0}U=false};var cr=function(e,r,t){var i;if(!J){ur();J=true;if(ne==0){U=true;return 0}}if((i=vr(e,r,t))==t)return t;if(U)return i;if(oe<=3)lr();else or();if(ne==0){if(ee!=0)br(0,z[ie-1]&255);_r(1);U=true}return i+vr(e,i+r,t-i)};var vr=function(e,r,t){var i,a,s;i=0;while(R!=null&&i<t){a=t-i;if(a>R.len)a=R.len;for(s=0;s<a;s++)e[r+i+s]=R.ptr[R.off+s];R.off+=a;R.len-=a;i+=a;if(R.len==0){var n;n=R;R=R.next;Xe(n)}}if(i==t)return i;if(B<V){a=t-i;if(a>V-B)a=V-B;for(s=0;s<a;s++)e[r+i+s]=L[B+s];B+=a;i+=a;if(V==B)V=B=0}return i};var dr=function(){var e;var r;var t;var i;var a;if(he[0].dl!=0)return;me.dyn_tree=ce;me.static_tree=de;me.extra_bits=Be;me.extra_base=S+1;me.elems=k;me.max_length=_;me.max_code=0;Te.dyn_tree=ve;Te.static_tree=he;Te.extra_bits=Ue;Te.extra_base=0;Te.elems=q;Te.max_length=_;Te.max_code=0;Ae.dyn_tree=pe;Ae.static_tree=null;Ae.extra_bits=ze;Ae.extra_base=0;Ae.elems=F;Ae.max_length=b;Ae.max_code=0;t=0;for(i=0;i<x-1;i++){Se[i]=t;for(e=0;e<1<<Be[i];e++)be[t++]=i}be[t-1]=i;a=0;for(i=0;i<16;i++){Ie[i]=a;for(e=0;e<1<<Ue[i];e++){xe[a++]=i}}a>>=7;for(;i<q;i++){Ie[i]=a<<7;for(e=0;e<1<<Ue[i]-7;e++)xe[256+a++]=i}for(r=0;r<=_;r++)ye[r]=0;e=0;while(e<=143){de[e++].dl=8;ye[8]++}while(e<=255){de[e++].dl=9;ye[9]++}while(e<=279){de[e++].dl=7;ye[7]++}while(e<=287){de[e++].dl=8;ye[8]++}Tr(de,k+1);for(e=0;e<q;e++){he[e].dl=5;he[e].fc=kr(e,5)}hr()};var hr=function(){var e;for(e=0;e<k;e++)ce[e].fc=0;for(e=0;e<q;e++)ve[e].fc=0;for(e=0;e<F;e++)pe[e].fc=0;ce[I].fc=1;Ee=Ce=0;qe=Fe=Pe=0;Ne=0;De=1};var pr=function(e,r){var t=we[r];var i=r<<1;while(i<=Oe){if(i<Oe&&ir(e,we[i+1],we[i]))i++;if(ir(e,t,we[i]))break;we[r]=we[i];r=i;i<<=1}we[r]=t};var mr=function(e){var r=e.dyn_tree;var t=e.extra_bits;var i=e.extra_base;var a=e.max_code;var s=e.max_length;var n=e.static_tree;var f;var l,o;var u;var c;var v;var d=0;for(u=0;u<=_;u++)ye[u]=0;r[we[ge]].dl=0;for(f=ge+1;f<E;f++){l=we[f];u=r[r[l].dl].dl+1;if(u>s){u=s;d++}r[l].dl=u;if(l>a)continue;ye[u]++;c=0;if(l>=i)c=t[l-i];v=r[l].fc;Ee+=v*(u+c);if(n!=null)Ce+=v*(n[l].dl+c)}if(d==0)return;do{u=s-1;while(ye[u]==0)u--;ye[u]--;ye[u+1]+=2;ye[s]--;d-=2}while(d>0);for(u=s;u!=0;u--){l=ye[u];while(l!=0){o=we[--f];if(o>a)continue;if(r[o].dl!=u){Ee+=(u-r[o].dl)*r[o].fc;r[o].fc=u}l--}}};var Tr=function(e,r){var t=new Array(_+1);var i=0;var a;var s;for(a=1;a<=_;a++){i=i+ye[a-1]<<1;t[a]=i}for(s=0;s<=r;s++){var n=e[s].dl;if(n==0)continue;e[s].fc=kr(t[n]++,n)}};var Ar=function(e){var r=e.dyn_tree;var t=e.static_tree;var i=e.elems;var a,s;var n=-1;var f=i;Oe=0;ge=E;for(a=0;a<i;a++){if(r[a].fc!=0){we[++Oe]=n=a;_e[a]=0}else r[a].dl=0}while(Oe<2){var l=we[++Oe]=n<2?++n:0;r[l].fc=1;_e[l]=0;Ee--;if(t!=null)Ce-=t[l].dl}e.max_code=n;for(a=Oe>>1;a>=1;a--)pr(r,a);do{a=we[g];we[g]=we[Oe--];pr(r,g);s=we[g];we[--ge]=a;we[--ge]=s;r[f].fc=r[a].fc+r[s].fc;if(_e[a]>_e[s]+1)_e[f]=_e[a];else _e[f]=_e[s]+1;r[a].dl=r[s].dl=f;we[g]=f++;pr(r,g)}while(Oe>=2);we[--ge]=we[g];mr(e);Tr(r,n)};var yr=function(e,r){var t;var i=-1;var a;var s=e[0].dl;var n=0;var f=7;var l=4;if(s==0){f=138;l=3}e[r+1].dl=65535;for(t=0;t<=r;t++){a=s;s=e[t+1].dl;if(++n<f&&a==s)continue;else if(n<l)pe[a].fc+=n;else if(a!=0){if(a!=i)pe[a].fc++;pe[P].fc++}else if(n<=10)pe[N].fc++;else pe[D].fc++;n=0;i=a;if(s==0){f=138;l=3}else if(a==s){f=6;l=3}else{f=7;l=4}}};var wr=function(e,r){var t;var i=-1;var a;var s=e[0].dl;var n=0;var f=7;var l=4;if(s==0){f=138;l=3}for(t=0;t<=r;t++){a=s;s=e[t+1].dl;if(++n<f&&a==s){continue}else if(n<l){do{rr(a,pe)}while(--n!=0)}else if(a!=0){if(a!=i){rr(a,pe);n--}rr(P,pe);Ir(n-3,2)}else if(n<=10){rr(N,pe);Ir(n-3,3)}else{rr(D,pe);Ir(n-11,7)}n=0;i=a;if(s==0){f=138;l=3}else if(a==s){f=6;l=3}else{f=7;l=4}}};var Or=function(){var e;yr(ce,me.max_code);yr(ve,Te.max_code);Ar(Ae);for(e=F-1;e>=3;e--){if(pe[He[e]].dl!=0)break}Ee+=3*(e+1)+5+5+4;return e};var gr=function(e,r,t){var i;Ir(e-257,5);Ir(r-1,5);Ir(t-4,4);for(i=0;i<t;i++){Ir(pe[He[i]].dl,3)}wr(ce,e-1);wr(ve,r-1)};var _r=function(e){var a,s;var n;var f;f=ie-Q;ke[Pe]=Ne;Ar(me);Ar(Te);n=Or();a=Ee+3+7>>3;s=Ce+3+7>>3;if(s<=a)a=s;if(f+4<=a&&Q>=0){var l;Ir((r<<1)+e,3);qr();Ke(f);Ke(~f);for(l=0;l<f;l++)We(z[Q+l])}else if(s==a){Ir((t<<1)+e,3);xr(de,he)}else{Ir((i<<1)+e,3);gr(me.max_code+1,Te.max_code+1,n+1);xr(ce,ve)}hr();if(e!=0)qr()};var br=function(e,r){Z[qe++]=r;if(e==0){ce[r].fc++}else{e--;ce[be[r]+S+1].fc++;ve[tr(e)].fc++;H[Fe++]=e;Ne|=De}De<<=1;if((qe&7)==0){ke[Pe++]=Ne;Ne=0;De=1}if(oe>2&&(qe&4095)==0){var t=qe*8;var i=ie-Q;var a;for(a=0;a<q;a++){t+=ve[a].fc*(5+Ue[a])}t>>=3;if(Fe<parseInt(qe/2)&&t<parseInt(i/2))return true}return qe==v-1||Fe==h};var xr=function(e,r){var t;var i;var a=0;var s=0;var n=0;var f=0;var l;var o;if(qe!=0)do{if((a&7)==0)f=ke[n++];i=Z[a++]&255;if((f&1)==0){rr(i,e)}else{l=be[i];rr(l+S+1,e);o=Be[l];if(o!=0){i-=Se[l];Ir(i,o)}t=H[s++];l=tr(t);rr(l,r);o=Ue[l];if(o!=0){t-=Ie[l];Ir(t,o)}}f>>=1}while(a<qe);rr(I,e)};var Sr=16;var Ir=function(e,r){if($>Sr-r){X|=e<<$;Ke(X);X=e>>Sr-$;$+=r-Sr}else{X|=e<<$;$+=r}};var kr=function(e,r){var t=0;do{t|=e&1;e>>=1;t<<=1}while(--r>0);return t>>1};var qr=function(){if($>8){Ke(X)}else if($>0){We(X)}X=0;$=0};var Fr=function(){if(V!=0){var e,r;e=$e();if(R==null)R=M=e;else M=M.next=e;e.len=V-B;for(r=0;r<e.len;r++)e.ptr[r]=L[B+r];V=B=0}};var Pr=function(e,r){var t,i;je=e;Re=0;if(typeof r=="undefined")r=a;Ge(r);var s=new Array(1024);var n=[];while((t=cr(s,0,s.length))>0){var f=new Array(t);for(i=0;i<t;i++){f[i]=String.fromCharCode(s[i])}n[n.length]=f.join("")}je=null;return n.join("")};if(!JSZip.compressions["DEFLATE"]){JSZip.compressions["DEFLATE"]={magic:"\b\0",compress:Pr}}else{JSZip.compressions["DEFLATE"].compress=Pr}})();if(!JSZip){throw"JSZip not defined"}(function(){var e;var r=32768;var t=0;var i=9;var a=6;var s;var n;var f=null;var l;var o;var u;var c;var v;var d;var h;var p;var m,T;var A,y;var w;var O;var g=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);var _=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0);var b=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99);var x=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577);var S=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);var I=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);function k(){this.next=null;this.list=null}function q(){this.e=0;this.b=0;this.n=0;this.t=null}function F(e,r,t,i,a,s){this.BMAX=16;this.N_MAX=288;this.status=0;this.root=null;this.m=0;{var n;var f=new Array(this.BMAX+1);var l;var o;var u;var c;var v;var d;var h;var p=new Array(this.BMAX+1);var m;var T;var A;var y=new q;var w=new Array(this.BMAX);var O=new Array(this.N_MAX);var g;var _=new Array(this.BMAX+1);var b;var x;var S;var I;var F;F=this.root=null;for(v=0;v<f.length;v++)f[v]=0;for(v=0;v<p.length;v++)p[v]=0;for(v=0;v<w.length;v++)w[v]=null;for(v=0;v<O.length;v++)O[v]=0;for(v=0;v<_.length;v++)_[v]=0;l=r>256?e[256]:this.BMAX;m=e;T=0;v=r;do{f[m[T]]++;T++}while(--v>0);if(f[0]==r){this.root=null;this.m=0;this.status=0;return}for(d=1;d<=this.BMAX;d++)if(f[d]!=0)break;h=d;if(s<d)s=d;for(v=this.BMAX;v!=0;v--)if(f[v]!=0)break;u=v;if(s>v)s=v;for(x=1<<d;d<v;d++,x<<=1)if((x-=f[d])<0){this.status=2;this.m=s;return}if((x-=f[v])<0){this.status=2;this.m=s;return}f[v]+=x;_[1]=d=0;m=f;T=1;b=2;while(--v>0)_[b++]=d+=m[T++];m=e;T=0;v=0;do{if((d=m[T++])!=0)O[_[d]++]=v}while(++v<r);r=_[u];_[0]=v=0;m=O;T=0;c=-1;g=p[0]=0;A=null;S=0;for(;h<=u;h++){n=f[h];while(n-- >0){while(h>g+p[1+c]){g+=p[1+c];c++;S=(S=u-g)>s?s:S;if((o=1<<(d=h-g))>n+1){o-=n+1;b=h;while(++d<S){if((o<<=1)<=f[++b])break;o-=f[b]}}if(g+d>l&&g<l)d=l-g;S=1<<d;p[1+c]=d;A=new Array(S);for(I=0;I<S;I++){A[I]=new q}if(F==null)F=this.root=new k;else F=F.next=new k;F.next=null;F.list=A;w[c]=A;if(c>0){_[c]=v;y.b=p[c];y.e=16+d;y.t=A;d=(v&(1<<g)-1)>>g-p[c];w[c-1][d].e=y.e;w[c-1][d].b=y.b;w[c-1][d].n=y.n;w[c-1][d].t=y.t}}y.b=h-g;if(T>=r)y.e=99;else if(m[T]<t){y.e=m[T]<256?16:15;y.n=m[T++]}else{y.e=a[m[T]-t];y.n=i[m[T++]-t]}o=1<<h-g;for(d=v>>g;d<S;d+=o){A[d].e=y.e;A[d].b=y.b;A[d].n=y.n;A[d].t=y.t}for(d=1<<h-1;(v&d)!=0;d>>=1)v^=d;v^=d;while((v&(1<<g)-1)!=_[c]){g-=p[c];c--}}}this.m=p[1];this.status=x!=0&&u!=1?1:0}}function P(){if(w.length==O)return-1;return w.charCodeAt(O++)&255}function N(e){while(c<e){u|=P()<<c;c+=8}}function D(e){return u&g[e]}function E(e){u>>=e;c-=e}function C(e,t,i){var a;var f;var l;if(i==0)return 0;l=0;for(;;){N(A);f=m.list[D(A)];a=f.e;while(a>16){if(a==99)return-1;E(f.b);a-=16;N(a);f=f.t[D(a)];a=f.e}E(f.b);if(a==16){n&=r-1;e[t+l++]=s[n++]=f.n;if(l==i)return i;continue}if(a==15)break;N(a);h=f.n+D(a);E(a);N(y);f=T.list[D(y)];a=f.e;while(a>16){if(a==99)return-1;E(f.b);a-=16;N(a);f=f.t[D(a)];a=f.e}E(f.b);N(a);p=n-f.n-D(a);E(a);while(h>0&&l<i){h--;p&=r-1;n&=r-1;e[t+l++]=s[n++]=s[p++]}if(l==i)return i}v=-1;return l}function j(e,t,i){var a;a=c&7;E(a);N(16);a=D(16);E(16);N(16);if(a!=(~u&65535))return-1;E(16);h=a;a=0;while(h>0&&a<i){h--;n&=r-1;N(8);e[t+a++]=s[n++]=D(8);E(8)}if(h==0)v=-1;return a}function R(r,t,i){if(f==null){var a;var s=new Array(288);var n;for(a=0;a<144;a++)s[a]=8;for(;a<256;a++)s[a]=9;for(;a<280;a++)s[a]=7;for(;a<288;a++)s[a]=8;o=7;n=new F(s,288,257,_,b,o);if(n.status!=0){alert("HufBuild error: "+n.status);return-1}f=n.root;o=n.m;for(a=0;a<30;a++)s[a]=5;e=5;n=new F(s,30,0,x,S,e);if(n.status>1){f=null;alert("HufBuild error: "+n.status);return-1}l=n.root;e=n.m}m=f;T=l;A=o;y=e;return C(r,t,i)}function M(e,r,t){var s;var n;var f;var l;var o;var u;var c;var v;var d=new Array(286+30);var h;for(s=0;s<d.length;s++)d[s]=0;N(5);c=257+D(5);E(5);N(5);v=1+D(5);E(5);N(4);u=4+D(4);E(4);if(c>286||v>30)return-1;for(n=0;n<u;n++){N(3);d[I[n]]=D(3);E(3)}for(;n<19;n++)d[I[n]]=0;A=7;h=new F(d,19,19,null,null,A);if(h.status!=0)return-1;m=h.root;A=h.m;l=c+v;s=f=0;while(s<l){N(A);o=m.list[D(A)];n=o.b;E(n);n=o.n;if(n<16)d[s++]=f=n;else if(n==16){N(2);n=3+D(2);E(2);if(s+n>l)return-1;while(n-- >0)d[s++]=f}else if(n==17){N(3);n=3+D(3);E(3);if(s+n>l)return-1;while(n-- >0)d[s++]=0;f=0}else{N(7);n=11+D(7);E(7);if(s+n>l)return-1;while(n-- >0)d[s++]=0;f=0}}A=i;h=new F(d,c,257,_,b,A);if(A==0)h.status=1;if(h.status!=0){return-1}m=h.root;A=h.m;for(s=0;s<v;s++)d[s]=d[s+c];y=a;h=new F(d,v,0,x,S,y);T=h.root;y=h.m;if(y==0&&c>257){return-1}if(h.status!=0)return-1;return C(e,r,t)}function J(){if(s==null)s=new Array(2*r);n=0;u=0;c=0;v=-1;d=false;h=p=0;m=null}function L(e,i,a){var f,l;f=0;while(f<a){if(d&&v==-1)return f;if(h>0){if(v!=t){while(h>0&&f<a){h--;p&=r-1;n&=r-1;e[i+f++]=s[n++]=s[p++]}}else{while(h>0&&f<a){h--;n&=r-1;N(8);e[i+f++]=s[n++]=D(8);E(8)}if(h==0)v=-1}if(f==a)return f}if(v==-1){if(d)break;N(1);if(D(1)!=0)d=true;E(1);N(2);v=D(2);E(2);m=null;h=0}switch(v){case 0:l=j(e,i+f,a-f);break;case 1:if(m!=null)l=C(e,i+f,a-f);else l=R(e,i+f,a-f);break;case 2:if(m!=null)l=C(e,i+f,a-f);else l=M(e,i+f,a-f);break;default:l=-1;break}if(l==-1){if(d)return 0;return-1}f+=l}return f}function V(e){var r,t;var i,a;J();w=e;O=0;t=new Array(1024);r="";while((i=L(t,0,t.length))>0){for(a=0;a<i;a++)r+=String.fromCharCode(t[a])}w=null;return r}if(!JSZip.compressions["DEFLATE"]){JSZip.compressions["DEFLATE"]={magic:"\b\0",uncompress:V}}else{JSZip.compressions["DEFLATE"].uncompress=V}})();(function(){var e=function(e){var r="",t,i;for(i=0;i<e.length;i++){t=e.charCodeAt(i);r+="\\x"+(t<10?"0":"")+t.toString(16)}return r};var r=function(e){for(var r in JSZip.compressions){if(JSZip.compressions[r].magic===e){return JSZip.compressions[r]}}return null};function t(e){this.stream=e;this.index=0}t.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.stream.length<e||e<0){throw new Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+e+"). Corrupted zip ?")}},setIndex:function(e){this.checkIndex(e);this.index=e},eof:function(){return this.index>=this.stream.length},byteAt:function(e){return this.stream.charCodeAt(e)&255},readByte:function(){this.checkOffset(1);return this.byteAt(1+this.index++)},readInt:function(e){var r=0,t;this.checkOffset(e);for(t=e-1;t>=0;t--){r=(r<<8)+this.byteAt(this.index+t)}this.index+=e;return r},readString:function(e){var r="",t,i;this.checkOffset(e);for(t=0;t<e;t++){i=this.byteAt(this.index+t);r+=String.fromCharCode(i)}this.index+=e;return r},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};function i(e,r){this.options=e;this.loadOptions=r}i.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},hasDataDescriptor:function(){return(this.bitFlag&8)===8},useUTF8:function(){return(this.bitFlag&2048)===2048},isZIP64:function(){return this.options.zip64},readLocalPartHeader:function(e){this.versionNeeded=e.readInt(2);this.bitFlag=e.readInt(2);this.compressionMethod=e.readString(2);this.date=e.readDate();this.crc32=e.readInt(4);this.compressedSize=e.readInt(4);this.uncompressedSize=e.readInt(4);this.fileNameLength=e.readInt(2);this.extraFieldsLength=e.readInt(2);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}},readLocalPart:function(t){var i;this.readLocalPartHeader(t);this.fileName=t.readString(this.fileNameLength);this.readExtraFields(t);if(!this.hasDataDescriptor()){this.compressedFileData=t.readString(this.compressedSize)}else{this.compressedFileData=this.findDataUntilDataDescriptor(t);this.crc32=t.readInt(4);this.compressedSize=t.readInt(this.isZIP64()?8:4);this.uncompressedSize=t.readInt(this.isZIP64()?8:4);if(this.compressedFileData.length!==this.compressedSize){throw new Error("Bug : data descriptor incorrectly read (size mismatch)")}}this.uncompressedFileData=null;i=r(this.compressionMethod);if(i===null){throw new Error("Corrupted zip : compression "+e(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")}this.uncompressedFileData=i.uncompress(this.compressedFileData);if(this.loadOptions.checkCRC32&&JSZip.prototype.crc32(this.uncompressedFileData)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName)}},findDataUntilDataDescriptor:function(e){var r="",t=e.readString(4),i;while(t!==JSZip.signature.DATA_DESCRIPTOR){i=e.readString(1);r+=t.slice(0,1);t=(t+i).slice(-4)}return r},readCentralPart:function(e){this.versionMadeBy=e.readString(2);this.readLocalPartHeader(e);this.fileCommentLength=e.readInt(2);this.diskNumberStart=e.readInt(2);this.internalFileAttributes=e.readInt(2);this.externalFileAttributes=e.readInt(4);this.localHeaderOffset=e.readInt(4);this.fileName=e.readString(this.fileNameLength);this.readExtraFields(e);this.fileComment=e.readString(this.fileCommentLength);if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName);this.fileComment=JSZip.prototype.utf8decode(this.fileComment)}this.dir=this.externalFileAttributes&16?true:false},parseZIP64ExtraField:function(e){var r=new t(this.extraFields[1].value);if(this.uncompressedSize===-1){this.uncompressedSize=r.readInt(8)}if(this.compressedSize===-1){this.compressedSize=r.readInt(8)}if(this.localHeaderOffset===-1){this.localHeaderOffset=r.readInt(8)}if(this.diskNumberStart===-1){this.diskNumberStart=r.readInt(4)}},readExtraFields:function(e){var r=e.index,t,i,a;this.extraFields=this.extraFields||{};while(e.index<r+this.extraFieldsLength){t=e.readInt(2);i=e.readInt(2);a=e.readString(i);this.extraFields[t]={id:t,length:i,value:a}}if(this.isZIP64()&&this.extraFields[1]){this.parseZIP64ExtraField(e)}}};function a(e,r){this.files=[];this.loadOptions=r;if(e)this.load(e)}a.prototype={checkSignature:function(r){var t=this.reader.readString(4);if(t!==r){throw new Error("Corrupted zip or bug : unexpected signature "+"("+e(t)+", expected "+e(r)+")")}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var e=this.zip64EndOfCentralSize-44,r=0,t,i,a;while(r<e){t=this.reader.readInt(2);i=this.reader.readInt(4);a=this.reader.readString(i);this.zip64ExtensibleData[t]={id:t,length:i,value:a}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++){r=this.files[e];this.reader.setIndex(r.localHeaderOffset);this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER);r.readLocalPart(this.reader)}},readCentralDir:function(){var e;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER){e=new i({zip64:this.zip64},this.loadOptions);e.readCentralPart(this.reader);this.files.push(e)}},readEndOfCentral:function(){var e=this.reader.stream.lastIndexOf(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(e===-1){this.zip64=false;e=this.reader.stream.lastIndexOf(JSZip.signature.CENTRAL_DIRECTORY_END);if(e===-1){throw new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(e);this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral()}else{this.zip64=true;this.reader.setIndex(e);this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},load:function(e){this.reader=new t(e);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};JSZip.prototype.load=function(e,r){var t,i,s,n;r=r||{};if(r.base64){e=JSZipBase64.decode(e)}i=new a(e,r);t=i.files;for(s in t){n=t[s];this.file(n.fileName,n.uncompressedFileData,{binary:true,date:n.date,dir:n.dir})}return this}})();function xlsx(e){var r="Calibri";var t=11;var i="000000";var a,s=new JSZip,n,f,l,o,u,c,v,d,h,p,m,T,A,y,w,O,g,_,b,x,S,I,k,q,F,P=[[],[]],N=[],D=[],E=[],C,j,R,M,J,L,V,B=["General","0","0.00","#,##0","#,##0.00",,,,,"0%","0.00%","0.00E+00","# ?/?","# ??/??","mm-dd-yy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm",,,,,,,,,,,,,,,"#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)",,,,,"mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@"],U="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function z(e){var r=Math.floor(e/26)-1;return(r>-1?z(r):"")+U.charAt(e%26)}function H(e){return typeof e==="object"?(e-new Date(1900,0,0))/864e5+1:new Date(+new Date(1900,0,0)+(e-1)*864e5)}function Z(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function G(e){return(e||"").replace(/&amp;/g,"&").replace(/&(?!(lt|gt))/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace("settings","")}function X(e,r,t){if(e==undefined||e.trim()==""){e=""}else{if(r.genexusType=="date"){var i=t?["DMY","YMD","YDM"]:r.genexusPicture=="99/99/99"?["dd/mm/yy","yy/mm/dd","yyyy/dd/mm"]:["dd/mm/yyyy","yyyy/mm/dd","yyyy/dd/mm"];var a=e.split("-");if(!r.genexusPicture||r.genexusPicture=="99/99/99"){e=a[1]+"/"+a[2]+"/"+a[0].substring(2);if(r.formatCode==i[0])e=a[2]+"/"+a[1]+"/"+a[0].substring(2);if(r.formatCode==i[1])e=a[0].substring(2)+"/"+a[1]+"/"+a[2]}if(r.genexusPicture=="99/99/9999"){e=a[1]+"/"+a[2]+"/"+a[0];if(r.formatCode==i[0])e=a[2]+"/"+a[1]+"/"+a[0];if(r.formatCode==i[1])e=a[0]+"/"+a[1]+"/"+a[2]}if(r.genexusPicture=="9999/99/99"){e=a[0]+"/"+a[1]+"/"+a[2];if(r.formatCode==i[2])e=a[0]+"/"+a[2]+"/"+a[1];if(r.formatCode==i[1])e=a[0]+"/"+a[1]+"/"+a[2]}}else{var s=e.split(" ");var a=s[0].split("-");se=s[1].split(":");if(!r.genexusPicture){e=a[1]+"/"+a[2]+"/"+a[0].substring(2)+" "+se[0]+":"+se[1]}else{var n=r.genexusPicture.split(" ");var i=t?["DMY","YMD","YDM"]:n[0]=="99/99/99"?["dd/mm/yy","yy/mm/dd","yyyy/dd/mm"]:["dd/mm/yyyy","yyyy/mm/dd","yyyy/dd/mm"];if(n[0]=="99/99/99"){e=a[1]+"/"+a[2]+"/"+a[0].substring(2);if(r.formatCode==i[0])e=a[2]+"/"+a[1]+"/"+a[0].substring(2);if(r.formatCode==i[1])e=a[0].substring(2)+"/"+a[1]+"/"+a[2]}if(n[0]=="99/99/9999"){e=a[1]+"/"+a[2]+"/"+a[0];if(r.formatCode==i[0])e=a[2]+"/"+a[1]+"/"+a[0];if(r.formatCode==i[1])e=a[0]+"/"+a[1]+"/"+a[2]}if(n[0]=="9999/99/99"){e=a[0]+"/"+a[1]+"/"+a[2];if(r.formatCode==i[2])e=a[0]+"/"+a[2]+"/"+a[1];if(r.formatCode==i[1])e=a[0]+"/"+a[1]+"/"+a[2]}if(n[1]=="99"){e=e+" "+se[0]}if(n[1]=="99:99"){e=e+" "+se[0]+":"+se[1]}if(n[1]=="99:99:99"){e=e+" "+se[0]+":"+se[1]+":"+se[2].split(".")[0]}if(n[1]=="99:99:99.999"){e=e+" "+se[0]+":"+se[1]+":"+se[2]}}}}return e}if(e.pivot){f=Date.now();s.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>'+'<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/>'+'<Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/>'+"</Relationships>");I=s.folder("docProps");I.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">'+"<dc:creator>gonzalo</dc:creator>"+'<dcterms:created xsi:type="dcterms:W3CDTF">2010-12-23T01:32:21Z</dcterms:created>'+"<cp:lastModifiedBy>xperTools</cp:lastModifiedBy>"+'<dcterms:modified xsi:type="dcterms:W3CDTF">2010-02-23T01:32:21Z</dcterms:modified>'+"</cp:coreProperties>");I.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">'+"<DocSecurity>0</DocSecurity>"+"<ScaleCrop>false</ScaleCrop>"+"<HeadingPairs>"+'<vt:vector size="2" baseType="variant">'+"<vt:variant>"+"<vt:lpstr>Hojas de cÃ¡lculo</vt:lpstr>"+"</vt:variant>"+"<vt:variant>"+"<vt:i4>2</vt:i4>"+"</vt:variant>"+"</vt:vector>"+"</HeadingPairs>"+"<TitlesOfParts>"+'<vt:vector size="2" baseType="lpstr">'+"<vt:lpstr>PivotTable</vt:lpstr>"+"<vt:lpstr>SourceData</vt:lpstr>"+"</vt:vector>"+"</TitlesOfParts>"+"<LinksUpToDate>false</LinksUpToDate>"+"<SharedDoc>false</SharedDoc>"+"<HyperlinksChanged>false</HyperlinksChanged>"+"<AppVersion>12.0000</AppVersion>"+"</Properties>");s.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">'+'<Default Extension="xml" ContentType="application/xml"/>'+'<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>'+'<Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>'+'<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>'+'<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+'<Override PartName="/xl/worksheets/sheet2.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>'+'<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>'+'<Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>'+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>'+'<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>'+'<Override PartName="/xl/pivotTables/pivotTable1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml"/>'+'<Override PartName="/xl/pivotCache/pivotCacheDefinition1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml"/>'+'<Override PartName="/xl/pivotCache/pivotCacheRecords1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml"/>'+"</Types>");k=s.folder("xl");k.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>'+'<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet2.xml"/>'+'<Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="pivotCache/pivotCacheDefinition1.xml"/>'+'<Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>'+'<Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>'+'<Relationship Id="rId6" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/>'+"</Relationships>");var $=k.folder("pivotCache").file("pivotCacheRecords1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<pivotCacheRecords xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+"</pivotCacheRecords>");$.file("pivotCacheDefinition1.xml",e.pivotCacheDefinition);$.folder("_rels").file("pivotCacheDefinition1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords" Target="pivotCacheRecords1.xml"/>'+"</Relationships>");var Q=k.folder("pivotTables").file("pivotTable1.xml",e.pivotTable1);Q.folder("_rels").file("pivotTable1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="../pivotCache/pivotCacheDefinition1.xml"/>'+"</Relationships>");k.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<a:theme name="Tema de Office" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"/>');q=k.folder("worksheets");q.file("sheet1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+"<sheetData/>"+"</worksheet>");m=new Array(1);O=new Array(1);b=new Array(1);var Y="";var W=1;h=e.worksheets.length;while(h--){C=h+1;F=e.worksheets[h];A=F.data;l="";j=[];L=[];o=-1;v=A.length;while(++o<v){u=-1;c=A[o].length;l+='<row r="'+(o+1)+'" x14ac:dyDescent="0.25">';while(++u<c){var K=false;J=A[o][u];y=J.hasOwnProperty("value")?J.value:J;d="";w={borders:J.borders,hAlign:J.hAlign,vAlign:J.vAlign,bold:J.bold,italic:J.italic,fontColor:J.fontColor,fontName:J.fontName,fontSize:J.fontSize,fill:J.fill,formatCode:J.formatCode||"General"};M=0;if((J.isString||y&&typeof y==="string"&&!isFinite(y))&&!(J.genexusType=="date")&&!(J.genexusType=="datetime")||J.genexusType=="character"){y=G(y);d="inlineStr";K=true}else if(typeof y==="boolean"){y=y?1:0;d="b";M=1}else if(Z(y)==="date"||J.genexusType=="date"||J.genexusType=="datetime"){y=X(y,J,true);d="inlineStr";K=true;w.hAlign="right"}else if(typeof y==="object"){y=null}else{M=(""+y).length}w=JSON.stringify(w);T=m.indexOf(w);if(T<0){w=m.push(w)-1}else{w=T}if(j[u]==null){j[u]={autoWidth:false,max:0}}if(J.autoWidth){j[u].autoWidth=true}if(M>j[u].max){j[u].max=M}if(J.colSpan>1){L.push([z(u)+(o+1),z(u+J.colSpan-1)+(o+1)]);V=[u,0];for(var ee=0;ee<J.colSpan-1;ee++){V.push(J)}A[o].splice.apply(A[o],V);c+=J.colSpan-1}else if(J.rowSpan>1){for(var ee=1;ee<J.rowSpan;ee++){if(A[o+ee]){A[o+ee].splice(u,0,J)}else{J.rowSpan=ee;break}}L.push([z(u)+(o+1),z(u)+(o+J.rowSpan)])}if(J.rowSpan>1||J.colSpan>1){delete J.value;delete J.rowSpan;delete J.colSpan}l+='<c r="'+z(u)+(o+1)+'"'+(w?' s="'+w+'"':"")+(d?' t="'+d+'"':"");if(y!=null){if(K){l+=">"+(J.formula?"<f>"+J.formula+"</f>":"")+"<is><t>"+y+"</t></is></c>"}else{l+=">"+(J.formula?"<f>"+J.formula+"</f>":"")+"<v>"+y+"</v></c>"}}else{l+="/>"}}l+="</row>"}R=[];for(o=0;o<j.length;o++){if(j[o].autoWidth){R.push('<col min="',o+1,'" max="',o+1,'" width="',j[o].max,'" bestFit="1"/>')}}if(R.length>0){R=["<cols>"].concat(R,["</cols>"]).join("")}l='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+'<dimension ref="A1:'+z(A[0].length-1)+A.length+'"/><sheetViews><sheetView '+(h===e.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+R+"<sheetData>"+l+"</sheetData>";if(L.length>0){l+='<mergeCells count="'+L.length+'">';for(o=0;o<L.length;o++){l+='<mergeCell ref="'+L[o].join(":")+'"/>'}l+="</mergeCells>"}l+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';if(F.table){l+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>'}q.file("sheet2.xml",l+"</worksheet>")}o=m.length;d=[];var re=0;while(--o){w=JSON.parse(m[o]);if(w.formatCode!=="General"){T=B.indexOf(w.formatCode);if(T<0){T=164+d.length;d.push('<numFmt formatCode="'+w.formatCode+'" numFmtId="'+T+'"/>')}w.formatCode=T}else{w.formatCode=0}_=0;if(w.borders){g=["<border>"];for(var te in{left:0,right:0,top:0,bottom:0,diagonal:0}){if(w.borders[te]){g.push("<",te,' style="thin">','<color rgb="',w.borders[te],'"/></',te,">")}else{g.push("<",te,"/>")}}g.push("</border>");g=g.join("");_=O.indexOf(g);if(_<0){_=O.push(g)-1}}S=0;if(w.bold||w.italic||w.fontSize||w.fontName||w.fontColor){x=["<font>"];if(w.bold){x.push("<b/>")}if(w.italic){x.push("<i/>")}x.push('<sz val="',w.fontSize||t,'"/>');x.push('<color rgb="FF',w.fontColor||i,'"/>');x.push('<name val="',w.fontName||r,'"/>');x.push('<family val="2"/>',"</font>");x=x.join("");S=b.indexOf(x);if(S<0){S=b.push(x)-1}}re=0;if(w.fill){Y=Y+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+w.fill+'"/>'+'<bgColor indexed="64"/></patternFill></fill>';W++;re=W}m[o]=['<xf xfId="0" borderId="',_,'" fontId="',S,'" numFmtId="',w.formatCode,'" fillId="',re,'" ',w.hAlign||w.vAlign?'applyAlignment="1" ':" ",w.formatCode>0?'applyNumberFormat="1" ':" ",_>0?'applyBorder="1" ':" ",S>0?'applyFont="1" ':" ",re>0?'applyFill="1" ':" ",">"];if(w.hAlign||w.vAlign){m[o].push("<alignment");if(w.hAlign){m[o].push(' horizontal="',w.hAlign,'"')}if(w.vAlign){m[o].push(' vertical="',w.vAlign,'"')}m[o].push("/>")}m[o].push("</xf>");m[o]=m[o].join("")}d=d.length?'<numFmts count="'+d.length+'">'+d.join("")+"</numFmts>":"";if(e.style!=""){d=e.style}var ie='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+d+'<fonts count="'+b.length+'" x14ac:knownFonts="1"><font><sz val="'+t+'"/><color theme="1"/><name val="'+r+'"/><family val="2"/>'+'<scheme val="minor"/></font>'+b.join("")+"</fonts>"+'<fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+Y+"</fills>"+'<borders count="'+O.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+O.join("")+'</borders><cellStyleXfs count="1">'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+m.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+m.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>';if(e.dfx!=undefined){ie=ie+"<dxfs>"+e.dfx+"</dxfs>"}else{ie=ie+'<dxfs count="0"/>'}ie=ie+'<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/>'+'<extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main">'+'<x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>';k.file("styles.xml",ie);q.folder("_rels").file("sheet1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable" Target="../pivotTables/pivotTable1.xml"/></Relationships>');k.file("sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">'+"</sst>");k.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<fileVersion appName="xl" lastEdited="4" lowestEdited="4" rupBuild="4506"/>'+'<workbookPr defaultThemeVersion="124226"/>'+"<bookViews>"+'<workbookView xWindow="360" yWindow="555" windowWidth="21015" windowHeight="9405"/>'+"</bookViews>"+"<sheets>"+'<sheet name="PivotTable" sheetId="1" r:id="rId1"/>'+'<sheet name="SourceData" sheetId="2" r:id="rId2"/>'+"</sheets>"+'<calcPr calcId="125725"/>'+"<pivotCaches>"+'<pivotCache cacheId="5" r:id="rId3"/>'+"</pivotCaches>"+'<fileRecoveryPr repairLoad="1"/>'+"</workbook>");f=Date.now()-f;n=Date.now();a={base64:s.generate({compression:"STORE"}),zipTime:Date.now()-n,processTime:f,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}}else{f=Date.now();p=[[],0];s.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>');I=s.folder("docProps");k=s.folder("xl");k.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>');q=k.folder("worksheets");I.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>'+(e.creator||"XLSX.js")+"</dc:creator><cp:lastModifiedBy>"+(e.lastModifiedBy||"XLSX.js")+'</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">'+(e.created||new Date).toISOString()+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+(e.modified||new Date).toISOString()+"</dcterms:modified></cp:coreProperties>");m=new Array(1);O=new Array(1);b=new Array(1);var Y="";var W=1;h=e.worksheets.length;while(h--){C=h+1;F=e.worksheets[h];A=F.data;l="";j=[];L=[];o=-1;v=A.length;while(++o<v){u=-1;c=A[o].length;l+='<row r="'+(o+1)+'" x14ac:dyDescent="0.25">';while(++u<c){J=A[o][u];y=J.hasOwnProperty("value")?J.value:J;d="";w={borders:J.borders,hAlign:J.hAlign,vAlign:J.vAlign,bold:J.bold,italic:J.italic,fontColor:J.fontColor,fontName:J.fontName,fontSize:J.fontSize,fill:J.fill,formatCode:J.formatCode||"General"};M=0;if(y&&typeof y==="string"&&!isFinite(y)&&!(J.genexusType=="date")&&!(J.genexusType=="datetime")||J.genexusType=="character"){y=G(y);p[1]++;T=p[0].indexOf(y);M=y.length;if(T<0){T=p[0].push(y)-1}y=T;d="s"}else if(typeof y==="boolean"){y=y?1:0;d="b";M=1}else if(Z(y)==="date"){var ae=y.split("-");var se;if(J.genexusType=="datetime"){var ne=y.split(" ");ae=ne[0].split("-");se=ne[1].split(":")}var fe=null;if(J.genexusType=="datetime"){fe=new Date(ae[0],parseInt(ae[1])-1,parseInt(ae[2]),parseInt(se[0])+1,parseInt(se[1])-15,parseInt(se[2])-9)}else{fe=new Date(ae[0],parseInt(ae[1])-1,parseInt(ae[2])+1)}y=H(fe);if(J.genexusType=="date"){y=parseInt(y);w.formatCode=J.formatCode||"mm/dd/yy"}else{w.formatCode=J.formatCode||"mm/dd/yy hh:mm"}M=J.formatCode.length+1}else if(J.genexusType=="date"||J.genexusType=="datetime"){y=X(y,J,false);y=G(y);p[1]++;T=p[0].indexOf(y);M=y.length;if(T<0){T=p[0].push(y)-1}y=T;d="s";w.formatCode="General";w.hAlign="right"}else if(typeof y==="object"){y=null}else{M=(""+y).length;if(y==undefined||y.trim()==""){y=G(y);p[1]++;T=p[0].indexOf(y);M=y.length;if(T<0){T=p[0].push(y)-1}y=T;d="s"}}w=JSON.stringify(w);T=m.indexOf(w);if(T<0){w=m.push(w)-1}else{w=T}if(j[u]==null){j[u]={autoWidth:false,max:0}}if(J.autoWidth||J.genexusType=="date"||J.genexusType=="datetime"){j[u].autoWidth=true}if(M>j[u].max){j[u].max=M}if(J.colSpan>1){L.push([z(u)+(o+1),z(u+J.colSpan-1)+(o+1)]);V=[u,0];for(var ee=0;ee<J.colSpan-1;ee++){V.push(J)}A[o].splice.apply(A[o],V);c+=J.colSpan-1}else if(J.rowSpan>1){for(var ee=1;ee<J.rowSpan;ee++){if(A[o+ee]){A[o+ee].splice(u,0,J)}else{J.rowSpan=ee;break}}L.push([z(u)+(o+1),z(u)+(o+J.rowSpan)])}if(J.rowSpan>1||J.colSpan>1){delete J.value;delete J.rowSpan;delete J.colSpan}l+='<c r="'+z(u)+(o+1)+'"'+(w?' s="'+w+'"':"")+(d?' t="'+d+'"':"");if(y!=null){l+=">"+(J.formula?"<f>"+J.formula+"</f>":"")+"<v>"+y+"</v></c>"}else{l+="/>"}}l+="</row>"}R=[];for(o=0;o<j.length;o++){if(j[o].autoWidth){R.push('<col min="',o+1,'" max="',o+1,'" width="',j[o].max,'" bestFit="1"/>')}}if(R.length>0){R=["<cols>"].concat(R,["</cols>"]).join("")}l='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+'<dimension ref="A1:'+z(A[0].length-1)+A.length+'"/><sheetViews><sheetView '+(h===e.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+R+"<sheetData>"+l+"</sheetData>";if(L.length>0){l+='<mergeCells count="'+L.length+'">';for(o=0;o<L.length;o++){l+='<mergeCell ref="'+L[o].join(":")+'"/>'}l+="</mergeCells>"}l+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';if(F.table){l+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>'}q.file("sheet"+C+".xml",l+"</worksheet>");if(F.table){o=-1;v=A[0].length;d=z(A[0].length-1)+A.length;l='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" id="'+C+'" name="Table'+C+'" displayName="Table'+C+'" ref="A1:'+d+'" totalsRowShown="0"><autoFilter ref="A1:'+d+'"/><tableColumns count="'+A[0].length+'">';while(++o<v){l+='<tableColumn id="'+(o+1)+'" name="'+(A[0][o].hasOwnProperty("value")?A[0][o].value:A[0][o])+'"/>'}l+='</tableColumns><tableStyleInfo name="TableStyleMedium2" showFirstColumn="0" showLastColumn="0" showRowStripes="1" showColumnStripes="0"/></table>';k.folder("tables").file("table"+C+".xml",l);q.folder("_rels").file("sheet"+C+".xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table'+C+'.xml"/></Relationships>');P[1].unshift('<Override PartName="/xl/tables/table'+C+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"/>')}P[0].unshift('<Override PartName="/xl/worksheets/sheet'+C+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>');N.unshift(G(F.name)||"Sheet"+C);D.unshift('<Relationship Id="rId'+C+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+C+'.xml"/>');E.unshift('<sheet name="'+(G(F.name)||"Sheet"+C)+'" sheetId="'+C+'" r:id="rId'+C+'"/>')}o=m.length;d=[];var re=0;while(--o){w=JSON.parse(m[o]);if(w.formatCode!=="General"){T=B.indexOf(w.formatCode);if(T<0){T=164+d.length;d.push('<numFmt formatCode="'+w.formatCode+'" numFmtId="'+T+'"/>')}w.formatCode=T}else{w.formatCode=0}_=0;if(w.borders){g=["<border>"];for(var te in{left:0,right:0,top:0,bottom:0,diagonal:0}){if(w.borders[te]){g.push("<",te,' style="thin">','<color rgb="',w.borders[te],'"/></',te,">")}else{g.push("<",te,"/>")}}g.push("</border>");g=g.join("");_=O.indexOf(g);if(_<0){_=O.push(g)-1}}S=0;if(w.bold||w.italic||w.fontSize||w.fontName||w.fontColor){x=["<font>"];if(w.bold){x.push("<b/>")}if(w.italic){x.push("<i/>")}x.push('<sz val="',w.fontSize||t,'"/>');x.push('<color rgb="FF',w.fontColor||i,'"/>');x.push('<name val="',w.fontName||r,'"/>');x.push('<family val="2"/>',"</font>");x=x.join("");S=b.indexOf(x);if(S<0){S=b.push(x)-1}}re=0;if(w.fill){Y=Y+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+w.fill+'"/>'+'<bgColor indexed="64"/></patternFill></fill>';W++;re=W}m[o]=['<xf xfId="0" borderId="',_,'" fontId="',S,'" numFmtId="',w.formatCode,'" fillId="',re,'" ',w.hAlign||w.vAlign?'applyAlignment="1" ':" ",w.formatCode>0?'applyNumberFormat="1" ':" ",_>0?'applyBorder="1" ':" ",S>0?'applyFont="1" ':" ",re>0?'applyFill="1" ':" ",">"];if(w.hAlign||w.vAlign){m[o].push("<alignment");if(w.hAlign){m[o].push(' horizontal="',w.hAlign,'"')}if(w.vAlign){m[o].push(' vertical="',w.vAlign,'"')}m[o].push("/>")}m[o].push("</xf>");m[o]=m[o].join("")}d=d.length?'<numFmts count="'+d.length+'">'+d.join("")+"</numFmts>":"";k.file("styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+d+'<fonts count="'+b.length+'" x14ac:knownFonts="1"><font><sz val="'+t+'"/><color theme="1"/><name val="'+r+'"/><family val="2"/>'+'<scheme val="minor"/></font>'+b.join("")+"</fonts>"+'<fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+Y+"</fills>"+'<borders count="'+O.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+O.join("")+'</borders><cellStyleXfs count="1">'+'<xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+m.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+m.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0"/>'+'<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/>'+'<extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main">'+'<x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>');s.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+P[0].join("")+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>'+P[1].join("")+'<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>');I.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>XLSX.js</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+e.worksheets.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="'+N.length+'" baseType="lpstr"><vt:lpstr>'+N.join("</vt:lpstr><vt:lpstr>")+"</vt:lpstr></vt:vector></TitlesOfParts><Manager></Manager><Company>Microsoft Corporation</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>");k.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+D.join("")+'<Relationship Id="rId'+(D.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/>'+'<Relationship Id="rId'+(D.length+2)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>'+'<Relationship Id="rId'+(D.length+3)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/></Relationships>');k.file("sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+p[1]+'" uniqueCount="'+p[0].length+'"><si><t>'+p[0].join("</t></si><si><t>")+"</t></si></sst>");k.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView '+(e.activeWorksheet?'activeTab="'+e.activeWorksheet+'" ':"")+'xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"/></bookViews><sheets>'+E.join("")+'</sheets><calcPr calcId="145621"/></workbook>');f=Date.now()-f;n=Date.now();a={base64:s.generate({compression:"DEFLATE"}),zipTime:Date.now()-n,processTime:f,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}}return a}OAT.GeneratePDFOutput=function(e,r){var t=-1;var i=10;var a=13;var s=25;var n=-1;a+jquery("#"+e.controlName+"_"+e.query+" tr").length*30+5;var f=0;var l=true;var o=0;while(l&&o<jquery("#"+e.controlName+"_"+e.query+" tr").length){if(jquery("#"+e.controlName+"_"+e.query+" tr")[o].getAttribute("title_row")!="true")l=false;else o++}var u=jquery("#"+e.controlName+"_"+e.query+" tr")[o];if(u==undefined){u=jquery("#"+e.controlName+"_"+e.query+" tr")[0]}for(var c=0;c<u.children.length;c++){if(u.children[c].getAttribute("colspan")!=null){f=f+parseInt(u.children[c].getAttribute("colspan"))}else{f=f+1}}f=i+f*(s+48)+5;if(f<595){f=595}var v=[];var d=[];for(var h=0;h<u.childNodes.length;h++){d[h]=0}for(var p=0;p<jquery("#"+e.controlName+"_"+e.query+" tr").length;p++){var m=-1;t=-1;var T=0;if(e.colConditions.length==0){for(var A=0;A<d.length;A++){if(d[A]>0){T=1+T;d[A]=d[A]-1}}}else{for(var y=0;y<p;y++){var w=jquery("#"+e.controlName+"_"+e.query+" tr")[y];for(var O=0;O<w.children.length;O++){var g=w.children[O].getAttribute("rowspan");if(g!=null&&parseInt(g)>p-y){var _=w.children[O].getAttribute("colspan");if(_===null){T=1+T}else{T=parseInt(_)+T}}}}}m=T-1;var u=jquery("#"+e.controlName+"_"+e.query+" tr")[p];if(e.colConditions.length==0){for(var c=0;c<u.children.length;c++){var b=u.children[c].getAttribute("rowspan");if(b==null)b=0;d[T+c]=parseInt(b)-1}}for(var c=0;c<u.children.length;c++){m++;var x=OAT.removeIconFont(u.children[c].textContent.replace(/^\s+|\s+$/g,""));var S=u.children[c].getAttribute("hidden");if(S===null){var I=u.children[c].getAttribute("rowspan");var k=u.children[c].getAttribute("colspan");var q=m;if(v[q]==undefined){v[q]=s}if(I===null&&k===null||c===u.children.length-1&&k==="3"){if(k!=null&&x===""){m=parseInt(k)+m-1}}else if(k===null);else if(I===null){m=parseInt(k)+m-1}else{m=parseInt(k)+m-1}var F=0;var P=0;var N=0;while(N<x.length&&x.charCodeAt(N)<1e3){P++;N++}F=x.length-P;if(F==0){if(x.length>14&&(k==null||p==0||parseInt(k)<2)){if(x.length*1.98>v[q]){v[q]=x.length*1.98}}}else{var D=F*3.1+(x.length-F)*2;if(D>v[q]&&(k==null||p==0||parseInt(k)<2)){v[q]=D}}}t=m}}var E=0;for(var C=0;C<v.length;C++){E=E+v[C]*2.5+48}E=i+E+5;if(E>f){f=E}var j=function(e,r){if(e>r.length){e=r.length}var t=0;for(var i=0;i<e;i++){t=t+r[i]}return t};var R;if(f<=595){R=new jsPDF("portrait","mm","a4",false,f,792)}else if(f>595&&f<792){R=new jsPDF("landscape","mm","a4",false,793,792)}else{R=new jsPDF("landscape","mm","a4",false,f,792)}R.setFontSize(8);var M=[];if(jquery("#"+e.controlName+"_"+e.query+" tr")[1+e.colConditions.length]!=undefined){for(var J=0;J<jquery("#"+e.controlName+"_"+e.query+" tr")[1+e.colConditions.length].children.length;J++){M[J]=0}}else{for(var J=0;J<jquery("#"+e.controlName+"_"+e.query+" tr")[e.colConditions.length].children.length;J++){M[J]=0}}d=[];for(var h=0;h<v.length;h++){d[h]=0}for(var p=0;p<jquery("#"+e.controlName+"_"+e.query+" tr").length;p++){var m=-1;t=-1;n++;var T=0;if(e.colConditions.length==0){for(var A=0;A<d.length;A++){if(d[A]>0){T=1+T;d[A]=d[A]-1}}}else{for(var y=0;y<p;y++){var w=jquery("#"+e.controlName+"_"+e.query+" tr")[y];for(var O=0;O<w.children.length;O++){var g=w.children[O].getAttribute("rowspan");if(g!=null&&parseInt(g)>p-y){var _=w.children[O].getAttribute("colspan");if(_===null){T=1+T}else{T=parseInt(_)+T}}}}}m=T-1;var u=jquery("#"+e.controlName+"_"+e.query+" tr")[p];if(e.colConditions.length==0){for(var c=0;c<u.children.length;c++){var b=u.children[c].getAttribute("rowspan");if(b==null)b=0;d[T+c]=parseInt(b)-1}}var L=-1;for(var c=0;c<u.children.length;c++){var x=OAT.removeIconFont(u.children[c].textContent.replace(/^\s+|\s+$/g,""));var S=u.children[c].getAttribute("hidden");var V=u.children[c].getAttribute("pivotcorrect");var B=false;R.setDrawColor(0,0,0);R.setTextColor(0,0,0);R.setFontStyle("normal");var U=!isNaN(parseFloat(x))||x=="-"&&(u.children[c].getAttribute("style")==undefined||u.children[c].getAttribute("style").indexOf("text-align: left")==-1);var z=0;z=R.getStringUnitWidth(x);if(u.children[c].getAttribute("style")!=undefined&&u.children[c].getAttribute("style")!=null){var H=u.children[c].getAttribute("style").split(";");for(var Z=0;Z<H.length;Z++){var G=H[Z].split(":");if(G[0].replace(/^\s+|\s+$/g,"")==="color"){var X=G[1].replace(/^\s+|\s+$/g,"");X=X.substring(4,X.length);X=X.substring(0,X.length-1);R.setTextColor(parseInt(X.split(",")[0]),parseInt(X.split(",")[1]),parseInt(X.split(",")[2]))}else if(G[0].replace(/^\s+|\s+$/g,"")==="text-align"){U=G[1].replace(/^\s+|\s+$/g,"")=="right"}else if(G[0].replace(/^\s+|\s+$/g,"")==="font-style"){R.setFontStyle("italic")}else if(G[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(G[1].replace(/^\s+|\s+$/g,"")==="bold"){R.setFontStyle("bold")}}else if(G[0].replace(/^\s+|\s+$/g,"")==="background-color"){var X=G[1].replace(/^\s+|\s+$/g,"");X=X.substring(4,X.length);X=X.substring(0,X.length-1);R.setFillColor(parseInt(X.split(",")[0]),parseInt(X.split(",")[1]),parseInt(X.split(",")[2]));B=true}else if(G[0].replace(/^\s+|\s+$/g,"")==="border-color"){var X=G[1].replace(/^\s+|\s+$/g,"");X=X.substring(4,X.length);X=X.substring(0,X.length-1);R.setDrawColor(parseInt(X.split(",")[0]),parseInt(X.split(",")[1]),parseInt(X.split(",")[2]))}}}var $=[];var Q="",Y=-1;var W=0;if(x.charCodeAt(0)>1e3){for(var K=0;K<x.length;K++){if((W==58||W==65306)&&x.charCodeAt(K)==32){$[K]="ToDelete"}else{$[K]=OAT.getCharacterImg(x.charCodeAt(K));W=x.charCodeAt(K)}if(x.charCodeAt(K)<1e3){Q=Q+x[K];if(Y==-1)Y=K}else{Q="";Y=-1}}}else{var ee=-1;for(var h=1;h<x.length;h++){if(x.charCodeAt(h)>1e3){ee=h;break}}if(ee>0){var re=x.substring(0,ee);var te=0;for(var K=ee;K<x.length;K++){if(x.charCodeAt(K)<1e3){Q=Q+x[K];if(Y==-1)Y=K-ee}else{Q="";Y=-1}if((W==58||W==65306)&&x.charCodeAt(K)==32){$[te]="ToDelete"}else{$[te]=OAT.getCharacterImg(x.charCodeAt(K));W=x.charCodeAt(K)}te++}x=re}}try{if(Y!=-1&&!U){$=$.slice(0,Y)}}catch(e){}while($.length>0&&$.indexOf("ToDelete")!=-1){var ie=$.indexOf("ToDelete");$.splice(ie,1)}if(S===null&&!V){m++;var I=u.children[c].getAttribute("rowspan");var k=u.children[c].getAttribute("colspan");L=L+1;if(I&&n+parseInt(I)>26){var ae=n+parseInt(I)-26;I=parseInt(I)-ae;M[L+T]=ae}var q=m;if(I===null&&k===null||c===u.children.length-1&&k==="3"&&e.colConditions.length==0){if(B){var se=m;if(k!=null&&x===""){se=parseInt(k)+m-1}R.rect(i-2+j(q,v),a+n*10-7,j(se+1,v)-j(q,v),10,"F")}var ne=0;if(x.charCodeAt(0)<1e3){ne=x.length*1.4+2;if(U){R.text(i+j(m+1,v)-z*3-4,a+n*10,x)}else{R.text(i+j(m,v),a+n*10,x)}}if($.length>0){for(var K=0;K<$.length;K++){R.addImage($[K],"JPEG",i+j(m,v)+ne+K*2.5,a+n*10-2.3,2.5,2.5)}}if(Y!=-1&&!U){R.text(i+j(m,v)+ne+$.length*2.5,a+n*10,Q)}if(k!=null&&x===""){m=parseInt(k)+m-1}R.line(i-2+j(q,v),a+n*10-7,i-2+j(m+1,v),a+n*10-7);R.line(i-2+j(q,v),a+n*10-7,i-2+j(q,v),a+n*10+3)}else if(k===null){if(B){if(I===null){R.rect(i-2+j(m,v),a+n*10-7,s,10,"F")}else{R.rect(i-2+j(m,v),a+n*10-7,s,10+(parseInt(I)-1)*10,"F")}}var ne=0;if(x.charCodeAt(0)<1e3){ne=x.length*1.4+2;R.text(i+j(m,v),a+n*10,x)}if($.length>0){for(var K=0;K<$.length;K++){R.addImage($[K],"JPEG",i+j(m,v)+ne+K*2.5,a+n*10-2.3,2.5,2.5)}}if(Y!=-1&&!U){R.text(i+j(m,v)+ne+$.length*2.5,a+n*10,Q)}R.line(i-2+j(m,v),a+n*10-7,i-2+j(m+1,v),a+n*10-7);if(I===null){R.line(i-2+j(m,v),a+n*10-7,i-2+j(m,v),a+n*10+3)}else{R.line(i-2+j(q,v),a+n*10-7,i-2+j(q,v),a+(n+parseInt(I)-1)*10+3)}}else if(I===null){if(B){var fe=parseInt(k)+m-1;R.rect(i-2+j(q,v),a+n*10-7,j(fe+1,v)-j(q,v),10,"F")}var ne=0;if(x.charCodeAt(0)<1e3){ne=x.length*1.4+2;R.text(i+j(m,v),a+n*10,x)}if($.length>0){for(var K=0;K<$.length;K++){R.addImage($[K],"JPEG",i+j(m,v)+ne+K*2.5,a+n*10-2.3,2.5,2.5)}}if(Y!=-1&&!U){R.text(i+j(m,v)+ne+$.length*2.5,a+n*10,Q)}m=parseInt(k)+m-1;R.line(i-2+j(q,v),a+n*10-7,i-2+j(m+1,v),a+n*10-7);R.line(i-2+j(q,v),a+n*10-7,i-2+j(q,v),a+n*10+3)}else{if(B){var fe=parseInt(k)+m-1;if(I===null){R.rect(i-2+j(q,v),a+n*10-7,j(fe+1,v)-j(q,v),10,"F")}else{R.rect(i-2+j(q,v),a+n*10-7,j(fe+1,v)-j(q,v),(parseInt(I)-1)*10,"F")}}var ne=0;if(x.charCodeAt(0)<1e3){ne=x.length*1.4+2;R.text(i+j(m,v),a+n*10,x)}if($.length>0){for(var K=0;K<$.length;K++){R.addImage($[K],"JPEG",i+j(m,v)+ne+K*2.5,a+n*10-2.3,2.5,2.5)}}if(Y!=-1&&!U){R.text(i+j(m,v)+ne+$.length*2.5,a+n*10,Q)}m=parseInt(k)+m-1;R.line(i-2+j(q,v),a+n*10-7,i-2+j(m+1,v),a+n*10-7);if(I===null){R.line(i-2+j(q,v),a+n*10-7,i-2+j(q,v),a+n*10+3)}else{R.line(i-2+j(q,v),a+n*10-7,i-2+j(q,v),a+(n+parseInt(I)-1)*10+3)}}}R.setFontSize(8);t=m;if(c===u.children.length-1){R.line(i-2+j(m+1,v),a+n*10-7,i-2+j(m+1,v),a+n*10+3)}}if(n>=25){R.setDrawColor(0,0,0);R.line(i-2,a+(n+1)*10-7,i-2+j(t+1,v),a+(n+1)*10-7);n=0;R.addPage();for(var le=0;le<M.length;le++){if(!isNaN(M[le])){if(M[le]>=25){M[le]=M[le]-25;R.line(i-2+j(le,v),a+1*10-7,i-2+j(le+1,v),a+1*10-7);R.line(i-2+j(le,v),a+1*10-7,i-2+j(le,v),a+(1+25-1)*10+3)}else{R.line(i-2+j(le,v),a+1*10-7,i-2+j(le+1,v),a+1*10-7);R.line(i-2+j(le,v),a+1*10-7,i-2+j(le,v),a+(1+M[le]-1)*10+3);M[le]=0}}}}}R.setDrawColor(0,0,0);R.line(i-2,a+(n+1)*10-7,i-2+j(t+1,v),a+(n+1)*10-7);if(OAT.isSafari()||e.isSD){R.output("dataurlnewwindow")}else{R.save(r+".pdf")}};var removeComas=function(e,r){var t="";actPos=0;var i=r.defaultPicture.getAttribute("decimalSeparator");for(var a=0;a<e.length;a++){if(e[a]=="0"||e[a]=="1"||e[a]=="2"||e[a]=="3"||e[a]=="4"||e[a]=="5"||e[a]=="6"||e[a]=="7"||e[a]=="8"||e[a]=="9"||e[a]==i||e[a]=="-"){t=t+e[a]}}if(i!="."){var s="";for(var a=0;a<t.length;a++){if(t[a]==i){s=s+"."}else{s=s+t[a]}}t=s}return t};var cleanDistinctValue=function(e,r,t){if(e=="#NuN#"){return" "}else{var i=true;if(e.indexOf(">")>-1){e=e.replace(/\>/g,"&lt;");i=false}if(e.indexOf("<")>-1){e=e.replace(/\</g,"&gt;");i=false}if(e.indexOf("settings")>-1){e=e.replace("settings","");i=false}if(e.indexOf("%")>-1&&t!=undefined){return e.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\%/g,"%"+t).trimpivot()}else{e=e.replace(/"/g,"&quot;");if(i){e=e.replace(/\&/g,"&amp;")}if(e.indexOf("&amp;lt;")>-1){e=e.replace(/\&amp\;lt\;/g,"&lt;")}return e.trimpivot()}}};var headers=[];var getMeasureTitle=function(e,r){if(headers[r]!=undefined){return headers[r]}else{return e}};var createExcelROWITEMS=function(e,r,t,i,a){if(r===0){var s=t[i].indexOf(e.value);var n="";if(a===0){n="<i>"}else{n='<i r="'+a+'">'}if(s>0){return n+'<x v="'+s+'"/></i>'}else{return n+"<x/></i>"}}else{r--;var f="";for(var l=0;l<e.items.length;l++){f=f+createExcelROWITEMS(e.items[l],r,t,i,a)}return f}};var createExcelCOLITEMS=function(e,r,t,i,a){if(r===0){var s=t[i].indexOf(e.value.trimpivot());var n="";for(var f=0;f<measures.length;f++){if(a===0){n="<i>"}else{n='<i r="'+a+'">'}n=n+'<x v="'+s+'"/>';if(measures.length>1){n=n+"<x/>"}n=n+"</i>"}return n}else{r--;var l="";for(var o=0;o<e.items.length;o++){l=l+createExcelROWITEMS(e.items[o],r,t,i,a)}return l}};OAT.GenerateExcelOutput=function(e,r,t){function i(e){var r=e.toString(16);return r.length==1?"0"+r:r}function a(e,r,t){return i(e)+i(r)+i(t)}function s(e){var r={};for(var t=0;t<e.length;t++){var i=e[t].split(":");if(i[0].replace(/^\s+|\s+$/g,"")==="color"){var s=i[1].replace(/^\s+|\s+$/g,"");s=s.substring(4,s.length);s=s.substring(0,s.length-1);var n=a(parseInt(s.split(",")[0]),parseInt(s.split(",")[1]),parseInt(s.split(",")[2]));r.fontColor=n}else if(i[0].replace(/^\s+|\s+$/g,"")==="text-align"){var f=i[1].replace(/^\s+|\s+$/g,"");r.vAlign=f}else if(i[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(i[1].replace(/^\s+|\s+$/g,"")==="italic"){r.italic=1}}else if(i[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(i[1].replace(/^\s+|\s+$/g,"")==="bold"){r.bold=1}}else if(i[0].replace(/^\s+|\s+$/g,"")==="background-color"){var s=i[1].replace(/^\s+|\s+$/g,"");s=s.substring(4,s.length);s=s.substring(0,s.length-1);var n=a(parseInt(s.split(",")[0]),parseInt(s.split(",")[1]),parseInt(s.split(",")[2]));r.fill=n}}return r}var n=function(e,r){for(var t in e.formulaInfo.itemPosition){if(e.formulaInfo.itemPosition[t]==r){return t}}};headers=[];var f=[];for(var l=0;l<t.length;l++){for(var o=0;o<f.length;o++){if(f[o]==cleanDistinctValue(t[l].getAttribute("displayName"),r,t[l].getAttribute("name"))){headers[l]=cleanDistinctValue(t[l].getAttribute("displayName"),r,t[l].getAttribute("name"))+" ("+t[l].getAttribute("dataField")+")"}}f.push(cleanDistinctValue(t[l].getAttribute("displayName"),r,t[l].getAttribute("name")))}dataTable=[];dataRow=[];for(var u=0;u<r.columns.length;u++){var c={value:cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))};c.isString=1;dataRow.push(c)}for(var l=0;l<t.length;l++){if(!r.formulaInfo.measureFormula[l].hasFormula){var c={value:cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))};dataRow.push(c)}}var v=[];if(r.formulaInfo.cantFormulaMeasures>0){for(var d=0;d<r.formulaInfo.measureFormula.length;d++){if(r.formulaInfo.measureFormula[d].hasFormula){for(var h=0;h<r.formulaInfo.measureFormula[d].relatedMeasures.length;h++){var p=r.formulaInfo.measureFormula[d].relatedMeasures[h];if(v.indexOf(p)==-1){v.push(p)}}}}v.sort();for(var l=0;l<v.length;l++){var c={value:n(r,v[l])};dataRow.push(c)}}dataTable.push(dataRow);var m=r.GeneralDataRows;if(r.autoPaging){m=r.RowsWhenMoveToFilter}if(r.formulaInfo.cantFormulaMeasures>0){m=r.recordForFormula}var T=function(e,r){if(e.getAttribute("style")!=undefined){var t=e.getAttribute("style").split(";");for(var i=0;i<t.length;i++){var s=t[i].split(":");if(s[0].replace(/^\s+|\s+$/g,"")==="color"){var n=s[1].replace(/^\s+|\s+$/g,"");n=n.substring(4,n.length);n=n.substring(0,n.length-1);var f=a(parseInt(n.split(",")[0]),parseInt(n.split(",")[1]),parseInt(n.split(",")[2]));r.fontColor=f}else if(s[0].replace(/^\s+|\s+$/g,"")==="text-align"){var l=s[1].replace(/^\s+|\s+$/g,"");r.vAlign=l}else if(s[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(s[1].replace(/^\s+|\s+$/g,"")==="italic"){r.italic=1}}else if(s[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(s[1].replace(/^\s+|\s+$/g,"")==="bold"){r.bold=1}}else if(s[0].replace(/^\s+|\s+$/g,"")==="background-color"){var n=s[1].replace(/^\s+|\s+$/g,"");n=n.substring(4,n.length);n=n.substring(0,n.length-1);var f=a(parseInt(n.split(",")[0]),parseInt(n.split(",")[1]),parseInt(n.split(",")[2]));r.fill=f}}}return r};for(var A=0;A<m.length;A++){dataRow=[];for(var u=0;u<r.columns.length;u++){var o=r.conditions[u].dataRowPosition;var y=m[A][o];if(y=="#NuN#"){y=" "}var c={value:y};c.isString=1;var w=OAT.Dom.create("th",{},"");w=r.applyFormatValues(w,m[A][o],o);c=T(w,c);c.formatCode=r.defaultPicture.getAttribute("dateFormat");c.genexusType=r.columns[u].getAttribute("dataType");c.genexusPicture=r.columns[u].getAttribute("picture");dataRow.push(c)}for(var l=0;l<t.length;l++){if(!r.formulaInfo.measureFormula[l].hasFormula){var o=r.columns.length+l;var y=m[A][o];y=r.defaultPictureValue(y,l==t.length-1,l);y=removeComas(y,r);var c={value:y};var O=OAT.Dom.create("td",{},"");O=r.applyConditionalFormats(O,m[A][o],l===t.length-1?true:false,l);c=T(O,c);c.formatCode=r.defaultPicture.getAttribute("dateFormat");c.genexusType=t[l].getAttribute("dataType");c.genexusPicture=t[l].getAttribute("picture");dataRow.push(c)}}for(var g=0;g<v.length;g++){dataRow.push({value:m[A][v[g]]})}dataTable.push(dataRow)}var _=[];var b=[];var x=1;for(var u=0;u<r.columns.length;u++){b[u]=0;var w=OAT.Dom.create("th",{},"");var o=r.conditions[u].dataRowPosition;w=r.applyFormatValues(w,m[0][o],o);if(w.getAttribute("style")!=undefined){var S=w.getAttribute("style").split(";");var I=s(S);if(I.fontColor!=undefined||I.italic!=undefined||I.bold!=undefined){b[u]=x;x++;_.push(I)}}}var k=[];for(var q=0;q<t.length;q++){k[q]=0;var O=OAT.Dom.create("td",{},"");var o=r.columns.length+q;O=r.applyConditionalFormats(O,m[0][o],q===t.length-1?true:false,q);if(O.getAttribute("style")!=undefined){var S=O.getAttribute("style").split(";");var I=s(S);if(I.fontColor!=undefined||I.italic!=undefined||I.bold!=undefined){k[q]=x;x++;_.push(I)}}}var F='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+'<pivotCacheDefinition r:id="rId1" refreshOnLoad="1" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n'+'<cacheSource type="worksheet">\n';var P=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD"];var N=_.length>0;var D=P[t.length+r.columns.length-1]+(m.length+1+2);var E=r.colConditions.length+2;var C=r.colConditions.length>0?r.colConditions.length:1;var j=" ";var m=r.GeneralDataRows;if(r.autoPaging){m=r.RowsWhenMoveToFilter}var R;if(r.columns.length<0){var M='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+"Value"+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" rowHeaderCaption="Make" '+j+'xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">'+'<location ref="A1:'+D+'" firstHeaderRow="1" firstDataRow="'+E+'" firstDataCol="'+C+'"/>'+"<pivotFields>";var J=[];var L=[];var V=[];var B=-1;var U=0;var z=-1;var H=0;for(var l=0;l<r.columns.length;l++){var Z="axisRow";if(r.rowConditions.findIndex(l)!=-1){Z="axisRow";B++;U=l}else if(r.colConditions.findIndex(l)!=-1){Z="axisCol";z++;H=l}else{Z="axisRow";B++;U=l}var G="";var X='<item t="default"/>';M=M+'<pivotField axis="'+Z+'" showAll="0" '+G+">"+"<items>";var $;var Q;if(r.conditions[l].distinctValues!=undefined){$=[];Q=[];for(var Y=0;Y<r.conditions[l].distinctValues.length;Y++){$.push(cleanDistinctValue(r.conditions[l].distinctValues[Y]));var W="";if(r.conditions[l].blackList.findIndex(r.conditions[l].distinctValues[Y])!=-1){W=' h="1"';Q.push(cleanDistinctValue(r.conditions[l].distinctValues[Y]))}M=M+'<item x="'+Y+'" '+W+" />"}M=M+X+"</items>"+"</pivotField>"}L[l]=$;V[l]=Q[l];J.push(l)}for(var l=0;l<t.length;l++){M=M+'<pivotField dataField="1" showAll="0"/>';J.push(cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")))}M=M+"</pivotFields>";M=M+"<rowFields>";for(var l=0;l<r.columns.length;l++){if(r.rowConditions.findIndex(l)!=-1||r.filterIndexes.findIndex(l)!=-1){M=M+'<field x="'+0+'"/>'}}M=M+"</rowFields>";M=M+"<rowItems>";for(var K=0;K<r.rowStructure.items.length;K++){M=M+createExcelROWITEMS(r.rowStructure.items[K],B,L,U,B)}M=M+'<i t="grand"><x/></i>'+"</rowItems>";if(z>-1||t.length>1){M=M+"<colFields>";for(var l=0;l<r.columns.length;l++){if(r.colConditions.findIndex(l)!=-1){var o=J.indexOf(l);M=M+'<field x="'+o+'"/>'}}if(t.length>1){M=M+'<field x="-2"/>'}M=M+"</colFields>"}M=M+"<colItems>";if(r.colStructure.items){for(var K=0;K<r.colStructure.items.length;K++){M=M+createExcelCOLITEMS(r.colStructure.items[K],z,L,H,z)}}else{for(var l=0;l<t.length;l++){M=M+"<i/>"}}M=M+"</colItems>";M=M+"<dataFields>";for(var l=0;l<t.length;l++){M=M+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))+'" fld="'+(l+r.columns.length)+'"/>'}M=M+"</dataFields>";if(N){M=M+"<formats>";for(var l=0;l<r.columns.length;l++){if(b[l]>0){M=M+'<format dxfId="'+b[l]+'">'+'<pivotArea dataOnly="0" labelOnly="1" fieldPosition="0">'+'<references ><reference field="0">';if(r.conditions[l].distinctValues!=undefined){for(var Y=0;Y<r.conditions[l].distinctValues.length;Y++){M=M+'<x v="'+Y+'"/>'}}M=M+"</reference></references>"+"</pivotArea>"+"</format>"}}for(var K=0;K<t.length;K++){if(k[K]>0){M=M+'<format dxfId="'+k[K]+'">';M=M+'<pivotArea  fieldPosition="0">';M=M+"<references>";M=M+'<reference field="4294967294" selected="0">';M=M+'<x v="'+K+'"/></reference>';M=M+'<reference field="0">';for(var ee=0;ee<r.rowStructure.items.length;ee++){M=M+'<x v="'+ee+'"/>'}M=M+"</reference>";M=M+"</references></pivotArea>";M=M+"</format>"}}M=M+"</formats>"}M=M+'<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/>'+"</pivotTableDefinition>";var re='<dxf><font><color rgb="FFCCCCCC" /></font></dxf>';if(N){for(var te=0;te<_.length;te++){re=re+"<dxf><font>";if(_[te].bold!=undefined){re=re+"<b/>"}if(_[te].italic!=undefined){re=re+"<i/>"}if(_[te].fontColor!=undefined){re=re+'<color rgb="FF'+_[te].fontColor+'"/>'}re=re+"</font></dxf>"}}var ie=re;for(var A=0;A<m.length;A++){for(var u=0;u<r.columns.length;u++){L[u].indexOf(m[A][u])}for(var l=0;l<t.length;l++){var o=r.columns.length+l;var y=r.defaultPictureValue(m[A][o],l==t.length-1,l);y=removeComas(y,r);y=cleanDistinctValue(y)}}F=F+'<worksheetSource ref="A1:'+P[r.columns.length+t.length-1]+(m.length+1)+'" sheet="SourceData"/>';F=F+"</cacheSource>";F=F+'<cacheFields count="'+(r.columns.length+t.length)+'">';for(var u=0;u<r.columns.length;u++){F=F+'<cacheField name="'+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+'" numFmtId="0">';F=F+'<sharedItems count="'+r.conditions[u].distinctValues.length+'">';for(var Y=0;Y<r.conditions[u].distinctValues.length;Y++){F=F+'<s v="'+cleanDistinctValue(r.conditions[u].distinctValues[Y])+'"/>'}F=F+"</sharedItems>";F=F+"</cacheField>"}for(var l=0;l<t.length;l++){F=F+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))+'" numFmtId="0">';F=F+"<sharedItems/>";F=F+"</cacheField>"}F=F+"</cacheFields>";F=F+"</pivotCacheDefinition>";var ae='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">'+'<dimension ref="A1:'+P[r.columns.length+t.length-1]+(m.length+1)+'"/>'+"<sheetViews>"+'<sheetView workbookViewId="0"/>'+"</sheetViews>"+"<sheetData>";var se=1;var ne=0;ae=ae+'<row r="'+se+'" span="1:3">';for(var u=0;u<r.columns.length;u++){ae=ae+'<c t="inlineStr" r="'+P[ne]+se+'">';ae=ae+"<is><t>"+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))+"</t></is>";ae=ae+"</c>";ne++}for(var l=0;l<t.length;l++){ae=ae+'<c t="inlineStr" r="'+P[ne]+se+'">';ae=ae+"<is><t>"+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))+"</t></is>";ae=ae+"</c>";ne++}ae=ae+"</row>";for(var A=0;A<m.length;A++){ne=0;se++;ae=ae+'<row r="'+se+'" span="1:3">';for(var u=0;u<r.columns.length;u++){var o=r.conditions[u].dataRowPosition;var y=cleanDistinctValue(m[A][o]);ae=ae+'<c t="inlineStr" r="'+P[ne]+se+'">';ae=ae+"<is><t>"+y+"</t></is>";ae=ae+"</c>";ne++}for(var l=0;l<t.length;l++){o=r.columns.length+l;var y=r.defaultPictureValue(m[A][o],l==t.length-1,l);y=removeComas(y,r);y=cleanDistinctValue(y);if(t[l].getAttribute("dataType")==="real"||t[l].getAttribute("dataType")==="integer"){ae=ae+'<c r="'+P[ne]+se+'">';ae=ae+"<v>"+y+"</v>";ae=ae+"</c>"}else{ae=ae+'<c t="inlineStr" r="'+P[ne]+se+'">';ae=ae+"<is><t>"+y+"</t></is>";ae=ae+"</c>"}ne++}ae=ae+"</row>"}ae=ae+"</sheetData>";ae=ae+"</worksheet>";R=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:F,pivotTable1:M,Sheet2:ae,style:re,dfx:ie,worksheets:[{data:dataTable,name:"Sheet 1"}]})}else{var E=r.colConditions.length+1;var C=r.colConditions.length>0?r.colConditions.length:1;if(r.filterIndexes.length>0&&r.rowConditions.length+1==t.length){C=0}if(r.rowConditions.length+r.filterIndexes.length==0){E=1;C=1}var fe="1";var le="";if(r.filterIndexes.length>0){E=E+r.filterIndexes.length;le=' rowPageCount="'+r.filterIndexes.length+'\'" colPageCount="1" ';fe=E+1}var oe="";if(r.rowConditions.length>0){var ue=r.rowConditions[0];if(r.columns.length>ue){oe=' rowHeaderCaption="'+cleanDistinctValue(r.columns[ue].getAttribute("displayName"),r,r.columns[ue].getAttribute("name"))+'" '}}if(r.colConditions.length>0){var ce=r.colConditions[0];if(r.columns.length>ce){oe=oe+' colHeaderCaption="'+cleanDistinctValue(r.columns[ce].getAttribute("displayName"),r,r.columns[ce].getAttribute("name"))+'" '}}var M='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+'<pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+"Value"+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" '+oe+" "+j+' xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">\n'+"<location "+'ref="A'+fe+'"'+' firstHeaderRow="1" firstDataRow="'+E+'" firstDataCol="'+C+'" '+le+"/>\n"+"<pivotFields>\n";var J=[];var L=[];var V=[];var ve="";if(r.formulaInfo.cantFormulaMeasures==0){for(var l=0;l<t.length;l++){var de=163;if(t[l].getAttribute("picture")!=""){de=164+l}if(r.rowConditions.length>0||r.colConditions.length==0){M=M+'<pivotField dataField="1" showAll="0"  numFmtId="'+de+'"/>\n'}else{ve=ve+'<pivotField dataField="1" showAll="0"  numFmtId="'+de+'"/>\n'}J.push(cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")))}}var B=-1;var U=0;var z=-1;var H=0;for(var he=0;he<r.filterIndexes.length;he++){var l=r.filterIndexes[he];Z="axisPage";var G='numFmtId="163"';var X='<item t="default"/>\n';M=M+'<pivotField axis="'+Z+'" showAll="0" '+G+" >\n"+"<items>\n";var $;var Q;if(r.conditions[l].distinctValues!=undefined){$=[];Q=[];var pe=r.conditions[l].distinctValues;var o=0;for(var Y=0;Y<pe.length;Y++){if(!(pe[Y]==""&&pe.findIndex("#NuN#")!=-1)){$.push(cleanDistinctValue(pe[Y]));var W="";if(r.conditions[l].blackList.findIndex(pe[Y])!=-1){W=' h="1"';Q.push(cleanDistinctValue(pe[Y]))}M=M+'<item x="'+o+'" '+W+" />\n";o=o+1}}M=M+X+"</items>\n"+"</pivotField>\n"}L[l]=$;V[l]=Q[l];J.push(l)}for(var l=0;l<r.columns.length;l++){if(r.filterIndexes.indexOf(l)==-1){var Z="axisRow";if(r.rowConditions.length>0&&r.rowConditions.indexOf(l)!=-1||r.rowConditions.length+r.filterIndexes.length+r.colConditions.length==0){Z="axisRow";B++;U=l}else if(r.colConditions.indexOf(l)!=-1){Z="axisCol";z++;H=l}else{Z="axisPage"}var G='numFmtId="163"';var X='<item t="default"/>\n';M=M+'<pivotField axis="'+Z+'" showAll="0" '+G+" >\n"+"<items>\n";var $;var Q;if(r.conditions[l].distinctValues!=undefined){$=[];Q=[];var pe=r.conditions[l].distinctValues;var o=0;for(var Y=0;Y<pe.length;Y++){if(!(pe[Y]==""&&pe.findIndex("#NuN#")!=-1)){$.push(cleanDistinctValue(pe[Y]));var W="";if(r.conditions[l].blackList.findIndex(pe[Y])!=-1){W=' h="1"';Q.push(cleanDistinctValue(pe[Y]))}M=M+'<item x="'+o+'" '+W+" />";o=o+1}}M=M+X+"</items>\n"+"</pivotField>\n"}L[l]=$;V[l]=Q[l];J.push(l)}}if(r.formulaInfo.cantFormulaMeasures>0){for(var l=0;l<t.length;l++){var de=163;if(t[l].getAttribute("picture")!=""){de=164+l}if(!r.formulaInfo.measureFormula[l].hasFormula){M=M+'<pivotField dataField="1" showAll="0"  numFmtId="'+de+'"/>\n';J.push(cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")))}}for(var l=0;l<v.length;l++){M=M+'<pivotField showAll="0" defaultSubtotal="0"/>\n'}for(var l=0;l<t.length;l++){if(r.formulaInfo.measureFormula[l].hasFormula){M=M+'<pivotField dataField="1" dragToRow="0" dragToCol="0" dragToPage="0" showAll="0" defaultSubtotal="0" numFmtId="'+de+'"/>\n'}}}if(r.rowConditions.length==0&&r.colConditions.length>0){M=M+ve}M=M+"</pivotFields>\n";if(r.rowConditions.length+1!=t.length){M=M+"<rowFields>\n";for(var l=0;l<r.columns.length;l++){if(r.rowConditions.findIndex(l)!=-1||r.rowConditions.length+r.filterIndexes.length==0){var o=J.indexOf(l);M=M+'<field x="'+o+'"/>\n'}}M=M+"</rowFields>\n"}M=M+"<rowItems>\n";for(var K=0;K<r.rowStructure.items.length;K++){M=M+createExcelROWITEMS(r.rowStructure.items[K],B,L,U,B)}if(r.rowConditions.length==0&&r.colConditions.length>0){M=M+"<i/>\n"+"</rowItems>\n"}else{M=M+'<i t="grand"><x/></i>\n'+"</rowItems>\n"}if(z>-1||t.length>1){M=M+"<colFields>\n";for(var l=0;l<r.columns.length;l++){if(r.colConditions.findIndex(l)!=-1&&r.rowConditions.length+r.filterIndexes.length!=0){var o=J.indexOf(l);M=M+'<field x="'+o+'"/>\n'}else{if(r.colConditions.findIndex(l)!=-1&&r.rowConditions.length+r.filterIndexes.length==0){var o=J.indexOf(l);if(r.rowConditions.length==0)o=J.indexOf(l)-t.length;M=M+'<field x="'+o+'"/>\n'}}}if(t.length>1){M=M+'<field x="-2"/>\n'}M=M+"</colFields>\n"}M=M+"<colItems>\n";if(r.colStructure.items){for(var K=0;K<r.colStructure.items.length;K++){M=M+createExcelCOLITEMS(r.colStructure.items[K],z,L,H,z)}if(r.rowConditions.length==0){M=M+'<i t="grand"><x/></i>'}}else{for(var l=0;l<t.length;l++){M=M+"<i/>\n"}}M=M+"</colItems>\n";if(r.filterIndexes.length>0){M=M+"<pageFields>\n";for(var me=0;me<r.filterIndexes.length;me++){M=M+'<pageField fld="'+(t.length+me)+'" hier="-1"/>\n'}M=M+"</pageFields>\n"}M=M+"<dataFields>\n";var Te=0;var Ae=0;for(var l=0;l<t.length;l++){var de=163;if(t[l].getAttribute("picture")!=""){de=164+l}if(!r.formulaInfo.measureFormula[l].hasFormula){var ye=0;if(r.formulaInfo.cantFormulaMeasures>0)ye=r.columns.length-Te;var we="";var Oe=t[l].getAttribute("aggregation")=="count"?"sum":t[l].getAttribute("aggregation");if(t[l].getAttribute("displayName").indexOf("%")>-1){for(var ge=0;ge<l;ge++){we=we+" "}M=M+'<dataField name="'+t[l].getAttribute("displayName")+we+'" fld="'+(l+ye)+'" subtotal="'+Oe+'" numFmtId="'+de+'"/>\n'}else{if(r.rowConditions.length>0){M=M+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+'" fld="'+(l+ye)+'" subtotal="'+Oe+'" numFmtId="'+de+'"/>\n'}else{M=M+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+'" fld="'+(l+ye+r.colConditions.length)+'" numFmtId="'+de+'"/>\n'}}}else{Te++;var de=163;if(t[l].getAttribute("picture")!=""){de=164+l}if(r.formulaInfo.measureFormula[l].hasFormula){if(t[l].getAttribute("displayName").indexOf("%")>-1){for(var ge=0;ge<l;ge++){we=we+" "}M=M+'<dataField name="'+t[l].getAttribute("displayName").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("settings","")+we+' " fld="'+(l+r.columns.length+v.length)+'" numFmtId="'+de+'" baseField="0" baseItem="0"/>\n'}else{var _e=0;var be=0;for(var ge=0;ge<r.formulaInfo.measureFormula.length;ge++){if(r.formulaInfo.measureFormula[ge].hasFormula){_e=_e+r.formulaInfo.measureFormula[ge].relatedMeasures.length}else{be++}}var xe=_e+be+r.columns.length+Ae;var Se=xe;M=M+'<dataField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))+' " fld="'+Se+'" numFmtId="'+de+'" baseField="0" baseItem="0"/>\n';Ae++}}}}M=M+"</dataFields>\n"+'<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/>\n'+"</pivotTableDefinition>\n";for(var A=0;A<m.length;A++){for(var u=0;u<r.columns.length;u++){L[u].indexOf(cleanDistinctValue(m[A][u]))}for(var l=0;l<t.length;l++){var o=r.columns.length+l;var y=r.defaultPictureValue(m[A][o],l==t.length-1,l);y=removeComas(y,r);y=cleanDistinctValue(y)}}F=F+'<worksheetSource ref="A1:'+P[r.columns.length+t.length-1-r.formulaInfo.cantFormulaMeasures+v.length]+(m.length+1)+'" sheet="SourceData"/>\n';F=F+"</cacheSource>\n";F=F+'<cacheFields count="'+(r.columns.length+t.length+v.length)+'">\n';if(r.formulaInfo.cantFormulaMeasures==0&&(r.rowConditions.length>0||r.colConditions.length==0)){for(var l=0;l<t.length;l++){F=F+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")).replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("settings","")+'" numFmtId="0">\n';F=F+"<sharedItems/>\n";F=F+"</cacheField>\n"}}for(var he=0;he<r.filterIndexes.length;he++){var u=r.filterIndexes[he];var Ie="";for(var Y=0;Y<r.GeneralDistinctValues[u].length;Y++){if(!isNaN(r.GeneralDistinctValues[u][Y])){Ie=' containsMixedTypes="1" containsString="1" containsNumber="1" containsInteger="1" ';break}}if(Ie!=""){var ke=true;for(var Y=0;Y<r.GeneralDistinctValues[u].length;Y++){if(isNaN(r.GeneralDistinctValues[u][Y])){ke=false;break}}if(ke){Ie=' containsSemiMixedTypes="0" containsString="0" containsNumber="1" containsInteger="1" '}}F=F+'<cacheField name="'+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))+'" numFmtId="0">\n';F=F+"<sharedItems "+Ie+' count="'+r.GeneralDistinctValues[u].length+'">\n';for(var Y=0;Y<r.GeneralDistinctValues[u].length;Y++){if(!isNaN(r.GeneralDistinctValues[u][Y])){F=F+'<n v="'+cleanDistinctValue(r.GeneralDistinctValues[u][Y])+'"/>\n'}else{F=F+'<s v="'+cleanDistinctValue(r.GeneralDistinctValues[u][Y])+'"/>\n'}}F=F+"</sharedItems>\n";F=F+"</cacheField>\n"}for(var u=0;u<r.columns.length;u++){if(r.filterIndexes.indexOf(u)==-1){F=F+'<cacheField name="'+cleanDistinctValue(r.columns[u].getAttribute("displayName"),r,r.columns[u].getAttribute("name"))+'" numFmtId="0">\n';F=F+'<sharedItems count="'+r.conditions[u].distinctValues.length+'">\n';for(var Y=0;Y<r.conditions[u].distinctValues.length;Y++){F=F+'<s v="'+cleanDistinctValue(r.conditions[u].distinctValues[Y])+'"/>\n'}F=F+"</sharedItems>\n";F=F+"</cacheField>\n"}}if(r.formulaInfo.cantFormulaMeasures>0){for(var l=0;l<t.length;l++){if(!r.formulaInfo.measureFormula[l].hasFormula){F=F+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))+'" numFmtId="165">\n';F=F+"<sharedItems/>\n";F=F+"</cacheField>\n"}}for(var l=0;l<v.length;l++){F=F+'<cacheField name="'+n(r,v[l])+'" numFmtId="0">\n'+"</cacheField>\n"}for(var l=0;l<t.length;l++){if(r.formulaInfo.measureFormula[l].hasFormula){F=F+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name"))+'" numFmtId="165" formula="'+r.formulaInfo.measureFormula[l].textFormula+'" databaseField="0"/>\n'}}}if(r.formulaInfo.cantFormulaMeasures==0&&(r.rowConditions.length==0&&r.colConditions.length>0)){for(var l=0;l<t.length;l++){F=F+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(t[l].getAttribute("displayName"),l),r,t[l].getAttribute("name")).replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("settings","")+'" numFmtId="164">\n';F=F+"<sharedItems/>\n";F=F+"</cacheField>\n"}}F=F+"</cacheFields>\n";F=F+"</pivotCacheDefinition>\n";var re="<numFmts>";var qe=false;for(var Fe=0;Fe<t.length;Fe++){if(t[Fe].getAttribute("picture")!=""){var Pe=t[Fe].getAttribute("picture");var de=164+Fe;var Ne="";for(var De=0;De<Pe.length;De++){if(Pe[De]=="Z"){Ne=Ne+"#"}else if(Pe[De]=="9"){Ne=Ne+"0"}else if(Pe[De]=="."||Pe[De]==","){Ne=Ne+Pe[De]}else{Ne=Ne+"\\"+Pe[De]}}re=re+'<numFmt formatCode="'+Ne+'" numFmtId="'+de+'"/>';qe=true}}if(qe){re=re+"</numFmts>"}else{re=""}R=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:F,pivotTable1:M,Sheet2:"",style:re,worksheets:[{data:dataTable,name:"Sheet 1"}]})}if(OAT.isSafari()||r.isSD){window.location=R.href()}else{var Ee=atob(R.base64);function Me(e){return e.charCodeAt(0)}var Ce=Array.prototype.map.call(Ee,Me);var je=new Uint8Array(Ce);var Re=new Blob([je],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(Re,e+".xlsx")}};OAT.Dialog=function(e,r,t){var i=this,a={width:0,height:0,modal:0,onshow:function(){},onhide:function(){},zIndex:1e3,buttons:1,resize:1,close:1,autoEnter:1,imagePath:OAT.Preferences.imagePath};if(t)for(var s in t)a[s]=t[s];var n=new OAT.Window({close:a.close,max:0,min:0,width:a.width,height:a.height,x:0,y:0,title:e,resize:a.resize,imagePath:a.imagePath});OAT.Dom.hide(n.div);try{OAT.$(r).style.margin="10px"}catch(e){}e=OAT.Dom.create("table",{marginTop:"1em",width:"90%",textAlign:"center"});t=OAT.Dom.create("tbody");s=OAT.Dom.create("tr");var f=OAT.Dom.create("td",{border:"none"}),l=OAT.Dom.create("input");l.setAttribute("type","button");l.value=" OK ";f.appendChild(l);var o=OAT.Dom.create("input",{marginLeft:"2em"});o.setAttribute("type","button");o.value="Cancel";f.appendChild(o);s.appendChild(f);t.appendChild(s);e.appendChild(t);a.buttons&&OAT.$(r).appendChild(e);document.body.appendChild(n.div);n.content.appendChild(OAT.$(r));n.div.style.zIndex=a.zIndex;a.modal?(this.show=function(){OAT.Dimmer.show(n.div,{});n.accomodate();OAT.Dom.center(n.div,1,1);a.onshow()},this.hide=function(){OAT.Dimmer.hide();a.onhide()}):(this.show=function(){OAT.Dom.show(n.div);n.accomodate();OAT.Dom.center(n.div,1,1);a.onshow()},this.hide=function(){OAT.Dom.hide(n.div);a.onhide()});n.onclose=this.hide;this.accomodate=n.accomodate;this.ok=function(){};this.cancel=function(){};this.okBtn=l;this.cancelBtn=o;OAT.Dom.attach(l,"click",(function(){i.ok()}));OAT.Dom.attach(o,"click",(function(){i.cancel()}));r=function(e){if(i.okBtn.getAttribute("disabled")!="disabled"){e.keyCode==13&&i.ok();e.keyCode==27&&i.cancel()}};a.autoEnter&&OAT.Dom.attach(n.div,"keypress",r)};try{OAT.Loader.featureLoaded("dialog")}catch(e){}OAT.Drag={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,elm:!1,mouse_x:0,mouse_y:0,move:function(e){function r(e,r){return Math.abs(e-r)<=u}if(OAT.Drag.elm){OAT.Dom.removeSelection();var t=OAT.Dom.getViewport(),i=OAT.Dom.position(OAT.Drag.elm);OAT.Dom.eventPos(e);OAT.Dom.getWH(OAT.Drag.elm);if(!(e.clientX>t[0]||0>e.clientX||e.clientY>t[1]||0>e.clientY)){for(var t=e.clientX-OAT.Drag.mouse_x,a=e.clientY-OAT.Drag.mouse_y,s=!0,n=OAT.Drag.elm._Drag_movers,f=0;f<n.length;f++){var i=n[f][0],l=n[f][1],i=OAT.Dom.getLT(i);l.restrictionFunction(i[0]+t,i[1]+a)&&(s=!1)}for(var o=!0,u=10,f=0;f<n.length;f++){for(var i=n[f][0],l=n[f][1],c=OAT.Dom.getWH(i),v=OAT.Dom.position(i),d=v[0]+t,v=v[1]+a,h=0;h<l.magnetsH.length;h++){var p=OAT.$(l.magnetsH[h]),m=OAT.Dom.position(p),p=OAT.Dom.getWH(p);if(r(d,m[0])){i.style.left=m[0]+"px";o=!1;break}if(r(d+c[0],m[0])){i.style.left=m[0]-c[0]+"px";o=!1;break}if(r(d,m[0]+p[0])){i.style.left=m[0]+p[0]+"px";o=!1;break}if(r(d+c[0],m[0]+p[0])){i.style.left=m[0]+p[0]-c[0]+"px";o=!1;break}}for(h=0;h<l.magnetsV.length;h++){p=OAT.$(l.magnetsV[h]);m=OAT.Dom.position(p);p=OAT.Dom.getWH(p);if(r(v,m[1])){i.style.top=m[1]+"px";o=!1;break}if(r(v+c[1],m[1])){i.style.top=m[1]-c[1]+"px";o=!1;break}if(r(v,m[1]+p[1])){i.style.top=m[1]+p[1]+"px";o=!1;break}if(r(v+c[1],m[1]+p[1])){i.style.top=m[1]+p[1]-c[1]+"px";o=!1;break}}}if(s&&o){for(f=0;f<n.length;f++)if(i=n[f][0],l=n[f][1],l.moveFunction)l.moveFunction(t,a);else switch(l.type){case OAT.Drag.TYPE_X:OAT.Dom.moveBy(i,t,0);break;case OAT.Drag.TYPE_Y:OAT.Dom.moveBy(i,0,a);break;case OAT.Drag.TYPE_XY:OAT.Dom.moveBy(i,t,a)}OAT.Drag.mouse_x=e.clientX;OAT.Drag.mouse_y=e.clientY}}}},up:function(){if(OAT.Drag.elm){for(var e=OAT.Drag.elm._Drag_movers,r=0;r<e.length;r++)e[r][1].endFunction(e[r][0]);OAT.Drag.elm=!1}},create:function(e,r,t){var i={type:OAT.Drag.TYPE_XY,restrictionFunction:function(){return!1},endFunction:function(){},moveFunction:!1,magnetsH:[],magnetsV:[],cursor:!0};if(t)for(p in t)i[p]=t[p];var a=OAT.$(e),e=OAT.$(r),r=function(e){OAT.Drag.initiate(e,a)};a._Drag_movers||(OAT.Dom.attach(a,"mousedown",r),a._Drag_movers=[],a._Drag_cursor=a.style.cursor);i.cursor&&(a.style.cursor="move");a._Drag_movers.push([e,i])},initiate:function(e,r){OAT.Drag.elm=r;OAT.Drag.mouse_x=e.clientX;OAT.Drag.mouse_y=e.clientY},remove:function(e,r){var t=OAT.$(e);OAT.$(r);if(t._Drag_movers){for(var i=-1,a=0;a<t._Drag_movers.length;a++)t._Drag_movers[a][0]==r&&(i=a);-1!=i&&t._Drag_movers.splice(i,1)}},removeAll:function(e){e=OAT.$(e);e._Drag_movers&&(e._Drag_movers=[],e.style.cursor=e._Drag_cursor)},createDefault:function(e,r){if(OAT.Preferences.allowDefaultDrag){var t=OAT.$(e),i=OAT.Dom.create("div",{position:"absolute",width:"21px",height:"21px"}),a=OAT.Dom.getLT(t);i.style.left=a[0]-21+"px";i.style.top=a[1]-21+"px";if(r){t.parentNode.appendChild(i);a=function(e,r){var i=OAT.Dom.getWH(t),a=OAT.Dom.getWH(t.parentNode),s=e+i[0],i=r+i[1];return 20>e||20>r||s>a[0]||i>a[1]};OAT.Drag.create(i,i);OAT.Drag.create(i,t,{restrictionFunction:a});OAT.Dom.hide(i);var s=function(){i._Drag_pending&&OAT.Dom.hide(i)};OAT.Dom.attach(t,"mouseover",(function(){OAT.Dom.show(i);i._Drag_pending=0}));OAT.Dom.attach(t,"mouseout",(function(){i._Drag_pending=1;setTimeout(s,3e3)}))}else a=function(e,r){var i=OAT.Dom.getWH(t),a=OAT.Dom.getWH(t.parentNode),s=e+i[0],i=r+i[1];return 0>e||0>r||s>a[0]||i>a[1]},OAT.Drag.create(t,t,{restrictionFunction:a})}}};if(typeof document!="undefined"){OAT.Dom.attach(document,"mousemove",OAT.Drag.move);OAT.Dom.attach(document,"mouseup",OAT.Drag.up)}try{OAT.Loader.featureLoaded("drag")}catch(e){}OAT.GhostDragData={lock:!1,up:function(e){if(OAT.GhostDragData.lock){var r=OAT.GhostDragData.lock,t=r.object;if(t.pending)t.pending=0,OAT.GhostDragData.lock=!1;else{OAT.GhostDragData.lock=!1;for(var i=OAT.Dom.eventPos(e),e=i[0],i=i[1],a=0,s=0;s<t.targets.length;s++){var n=t.targets[s],f=n[1]?n[1](e,i):OAT.GhostDragData.pos(n[0],e,i);!a&&f&&(a=1,t.callback(n[0],e,i))}a?(OAT.Dom.unlink(r),OAT.MSG.send(t,OAT.MSG.GD_END,r)):(OAT.MSG.send(t,OAT.MSG.GD_ABORT,r),t.onFail(),t=OAT.Dom.position(t.originalElement),e=t[0],i=t[1],t=new OAT.AnimationPosition(r,{speed:10,delay:10,left:e,top:i}),OAT.MSG.attach(t.animation,OAT.MSG.ANIMATION_STOP,(function(){OAT.Dom.unlink(r)})),t.start())}}},move:function(e){if(OAT.GhostDragData.lock){var r=OAT.GhostDragData.lock,t=r.object;t.pending&&(document.body.appendChild(r),r.style.zIndex=2e3,t.process&&t.process(r),t.pending=0,OAT.MSG.send(t,OAT.MSG.GD_START,r));OAT.Dom.removeSelection();var i=e.clientX-r.mouse_x,t=e.clientY-r.mouse_y,i=parseInt(OAT.Dom.style(r,"left"))+i,t=parseInt(OAT.Dom.style(r,"top"))+t;r.style.left=i+"px";r.style.top=t+"px";r.mouse_x=e.clientX;r.mouse_y=e.clientY}},pos:function(e,r,t){if(!e||"none"==e.style.display.toLowerCase())return 0;var i=OAT.Dom.position(e),a=i[0]-2,i=i[1]-2,s=parseInt(e.offsetWidth)+2,e=parseInt(e.offsetHeight)+2;return r>=a&&r<=a+s&&t>=i&&t<=i+e}};OAT.GhostDrag=function(){var e=this;this.onFail=function(){};this.sources=[];this.processes=[];this.callbacks=[];this.targets=[];this.pending=0;this.addSource=function(r,t,i){var a=OAT.$(r);e.sources.push(a);e.processes.push(t);e.callbacks.push(i);OAT.Dom.attach(a,"mousedown",(function(r){OAT.Dom.prevent(r);var t=e.sources.indexOf(a);-1!=t&&e.startDrag(e.sources[t],e.processes[t],e.callbacks[t],r.clientX,r.clientY)}))};this.delSource=function(r){r=$(r);r=e.sources.indexOf(r);-1!=r&&(e.sources.splice(r,1),e.processes.splice(r,1),e.callbacks.splice(r,1))};this.clearSources=function(){e.sources=[];e.processes=[];e.callbacks=[]};this.addTarget=function(r,t,i){r=[OAT.$(r),t,i];e.targets.length&&e.targets[e.targets.length-1][2]?e.targets.splice(e.targets.length-1,0,r):e.targets.push(r)};this.delTarget=function(r){for(var r=OAT.$(r),t=-1,i=0;i<e.targets.length;i++)e.targets[i][0]==r&&(t=i);-1!=t&&e.targets.splice(t,1)};this.clearTargets=function(){e.targets=[]};this.startDrag=function(r,t,i,a,s){OAT.GhostDragData.lock||(e.pending=1,e.originalElement=r,e.callback=i,i=OAT.Dom.create("div",{position:"absolute"}),e.process=t,t=OAT.Dom.position(r),i.style.left=t[0]+"px",i.style.top=t[1]+"px",OAT.Style.opacity(i,.5),i.appendChild(r.cloneNode(!0)),i.mouse_x=a,i.mouse_y=s,i.object=e,OAT.GhostDragData.lock=i)}};if(typeof document!="undefined"){OAT.Dom.attach(document,"mousemove",OAT.GhostDragData.move);OAT.Dom.attach(document,"mouseup",OAT.GhostDragData.up)}try{OAT.Loader.featureLoaded("ghostdrag")}catch(e){}OAT.Instant=function(e,r){var t=this;this.options={showCallback:!1,hideCallback:!1};for(var i in r)t.options[i]=r[i];this.state=1;this.elm=OAT.$(e);this.handles=[];this.hide=function(){t.state=0;OAT.Dom.hide(t.elm)};this.show=function(){t.options.showCallback&&t.options.showCallback();OAT.Dom.show(t.elm);t.state=1};this.check=function(e){t.state&&(e=OAT.Event.source(e),e==t.elm||OAT.Dom.isChild(e,t.elm)||(t.options.hideCallback&&t.options.hideCallback(),t.hide()))};this.createHandle=function(e){var r=OAT.$(e);t.handles.push(r);OAT.Event.attach(r,"mousedown",(function(e){-1!=t.handles.indexOf(r)&&!t.state&&(OAT.Event.cancel(e),t.show())}))};this.removeHandle=function(e){e=OAT.$(e);e=t.handles.indexOf(e);-1!=e&&t.handles.splice(e,1)};t.elm._Instant_show=t.show;t.elm._Instant_hide=t.hide;t.hide();OAT.Dom.attach(document,"mousedown",t.check)};OAT.Instant.assign=function(e,r){new OAT.Instant(e,{hideCallback:r})};try{OAT.Loader.featureLoaded("instant")}catch(e){}OAT.GridData={index:0,LIMIT:15,ALIGN_CENTER:1,ALIGN_START:2,ALIGN_END:3,ALIGN_RIGHT:4,SORT_NONE:1,SORT_ASC:2,SORT_DESC:3,TYPE_STRING:1,TYPE_NUMERIC:2,TYPE_AUTO:3};OAT.Grid=function(e,r,t,i,a,s,n,f,l,o,u,c,v,d,h,p,m,T,A){var y=this;y.controlName=r;y.columnsDataType=i;y.query=t;y.rowsPerPage="";y.columns=a;y.QueryViewerCollection=s;y.InitPageSize=n;y.disableColumnSort=f;y.UcId=l;y.IdForQueryViewerCollection=o;y.rememberLayout=u;y.serverPaging=c;y.HideDataFilds=v;y.OrderFildsHidden=d;y.TableDataFilds=h;y.relativePath=p;y.selection=m;y.translations=A;y.isSD=OAT.isSD();y.conditions=new Array(i.length);for(iC=0;iC<i.length;iC++){y.conditions[iC]={blackList:[],sort:1}}this.init=function(){var r;if(jquery("#"+y.controlName+"_grid_top_div").length==0||y.QueryViewerCollection[y.IdForQueryViewerCollection]._ControlRenderedTo==undefined){var t=OAT.$(e);y.ContainerName=t.getAttribute("id");OAT.Dom.clear(t);var i=document.createElement("div");i.setAttribute("class","divIeContainer");i.setAttribute("style","position: relative;opacity: 0");t.appendChild(i);y.div=i;r=OAT.Dom.create("div");if(y.isSD){r.setAttribute("class","oatgrid_top_div oatgrid_top_div_small")}else{r.setAttribute("class","oatgrid_top_div")}if(T){OAT.addTextNode(r," "+T)}else{OAT.addTextNode(r,"")}r.setAttribute("id",y.controlName+"_grid_top_div");var a=OAT.Dom.create("a");a.href="#";OAT.addTextNode(a,document.createTextNode("GXPL_QViewerJSVisibleColumns"));y.div.appendChild(r);OAT.Dom.makePosition(y.div);y.html=OAT.Dom.create("table");OAT.Dom.addClass(y.html,"oatgrid");OAT.Dom.setIdPropertyValue(y.html,y.controlName);y.header=new OAT.GridHeader(y);y.rows=[];y.rowBlock=OAT.Dom.create("tbody");OAT.Dom.append([y.div,y.html],[y.html,y.header.html,y.rowBlock])}else{var t=OAT.$(e);y.ContainerName=t.getAttribute("id");y.div=jquery("#"+y.ContainerName).find(".divIeContainer")[0];r=jquery("#"+y.ContainerName).find(".oatgrid_top_div")[0];OAT.Dom.clear(r);if(T){OAT.addTextNode(r," "+T)}else{OAT.addTextNode(r,"")}y.html=jquery("#"+y.ContainerName).find("table")[0];var s=jquery("#"+y.ContainerName).find("thead")[0];OAT.Dom.clear(s);y.header=new OAT.GridHeader(y,s);y.rows=[];y.rowBlock=jquery("#"+y.ContainerName).find("tbody")[0];OAT.Dom.clear(y.rowBlock)}var n=OAT.Dom.create("div");n.href="#";if(y.isSD){n.setAttribute("class","exportOptionsAnchor exportOptionsAnchor_small")}else{n.setAttribute("class","exportOptionsAnchor")}y.exportPage=OAT.Dom.create("div",{padding:"0px"});OAT.addImageNode(n,"menu","");var f=function(e){OAT.Dom.source=OAT.Event.source(e);var r=false;var t=false;for(var i=0;i<jquery(".oat_winrect_container").length;i++){var a=jquery(".oat_winrect_container")[i];if(!(OAT.Dom.source==a)&&!OAT.Dom.isChild(OAT.Dom.source,a)){r=true}else{r=false;break}}for(var i=0;i<jquery(".oat_winrect_container").length;i++){if(jquery(".oat_winrect_container")[i].style.display!="none"){t=true}}if((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,a))&&t){y.oat_component.resetAllScrollValue(y.UcId)}if(r){jquery(".oat_winrect_container").css({display:"none"})}};OAT.Dom.attach(document,"mousedown",f);OAT.Anchor.assign(n,{title:" ",content:y.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:y.QueryViewerCollection[o].ControlName+"-table"+" ExportPopup "});var l=function(e){if(OAT_JS.grid.gridData[y.UcId].rowsMetadata.columns[e].getAttribute("visible")!="Never"){var r=y.header.cells[e].html.style.display!="none";var t=OAT.Dom.create("div");var i=r?"check_item_img":"uncheck_item_img";if(y.isSD){i=r?"check_item_img_small":"uncheck_item_img_small"}OAT.addImageNode(t,r?"check_box":"check_box_outline_blank","");t.setAttribute("class",i);var a=OAT.Dom.create("span");OAT.addTextNode(a," "+y.header.cells[e].value.textContent.replace("settings",""));t.appendChild(a);OAT.Event.attach(t,"click",(function(){var r="check_item_img";var t="uncheck_item_img";if(y.isSD){r="check_item_img_small";t="uncheck_item_img_small"}var i=this.getAttribute("class")===r?t:r;this.setAttribute("class",i);jquery(this).find("i")[0].textContent=this.getAttribute("class")===r?"check_box":"check_box_outline_blank";var a=y.header.cells[e].html.style.display=="none"?"":"none";y.header.cells[e].html.style.display=a;var s=e;for(var n=0;n<y.rows.length;n++){y.rows[n].cells[s].html.style.display=a}OAT_JS.grid.setColumnVisibleValue(y.UcId,s,a=="")}));return t}else{return false}};var u=function(e){var r=OAT.Event.position(e);y.exportPage.style.left=r[0]+"px";y.exportPage.style.top=r[1]+"px";y.exportPage.id="exportOptionsContainer";if(OAT.isIE()){y.exportPage.id="exportOptionsContainerGrid";y.exportPage.className="export_option_container"}Math.max(jquery(".ExportPopup")[0].clientWidth,300);jquery(e.currentTarget).offset().left;var t=e.currentTarget;jquery(".ExportPopup").css({left:-2500+"px",top:0+"px"});jquery(".oat_winrect_title").find(".winrect_title_label").remove();var i=OAT.Dom.create("label");if(y.isSD){jquery(".oat_winrect_container").addClass("oat_winrect_container_small");i.setAttribute("class","winrect_title_label winrect_title_label_small")}else{i.setAttribute("class","winrect_title_label")}OAT.addTextNode(i,y.translations.GXPL_QViewerPopupTitle);jquery(".oat_winrect_title").append(i);OAT.Dom.clear(y.exportPage);var a=false;var s=document.createElement("div");s.setAttribute("class","upper_container");jquery("#divtoxml").remove();jquery("#divtoxls").remove();jquery("#divtoxlsx").remove();jquery("#divtoexport").remove();jquery("#divtohtml").remove();a=y.appendExportToXmlOption(s,a);a=y.appendExportToHtmlOption(s,a);a=y.appendExportToPdfOption(s,a);a=y.appendExportToExcelOption(s,a);a=y.appendExportToExcel2010Option(s,a);y.exportPage.appendChild(s);if(a){var n=OAT.Dom.create("hr",{});y.exportPage.appendChild(n)}var f=document.createElement("div");f.setAttribute("class","down_container");y.exportPage.appendChild(f);var o=document.createElement("span");o.textContent=y.translations.GXPL_QViewerJSVisibleColumns;var u=document.createElement("div");u.setAttribute("class","div_label_win");u.appendChild(o);f.appendChild(u);for(var c=0;c<y.columns.length;c++){for(var v=0;v<y.header.cells.length;v++){if(y.header.cells[v].dataField==y.columns[c].getAttribute("dataField")){var d=l(v);if(d)f.appendChild(d)}}}setTimeout((function(){var e=window.innerWidth;var r=jquery(".ExportPopup")[0].clientWidth;if(r==0){var i=jquery(".ExportPopup").length;r=jquery(".ExportPopup")[i-1].clientWidth}if(y.isSD){if(r<235){r=235}var a=(e-r)/2+jquery(window).scrollLeft();jquery(".ExportPopup").css({left:a+"px",top:jquery(t).offset().top+"px",width:r+"px"})}else{var s=jquery(t).offset().left;if(s+r+15<e){jquery(".ExportPopup").css({left:jquery(t).offset().left+"px",top:jquery(t).offset().top+"px"})}else{jquery(".ExportPopup").css({left:s-r+16+"px",top:jquery(t).offset().top+"px"})}}}),50)};OAT.Event.attach(n,"click",u);r.appendChild(n)};this.setPageDataForTable=function(e){switch(y.oat_component.lastCallToQueryViewer){case"getDataForTable":if(y.oat_component.lastCallData.PageNumber==0){y.oat_component.lastCallData.PageNumber=1,y.oat_component.lastCallData.RecalculateCantPages=false}OAT_JS.grid.redraw(y.oat_component.lastCallData.self,y.oat_component.lastCallData.UcId,e,y.oat_component.lastCallData.RecalculateCantPages,y.oat_component.lastCallData.DataFieldOrder!="",y.oat_component.lastCallData.PageNumber,y.oat_component.lastCallData.fromExternalRefresh);break;case"getAllDataRowsForExport":var r=e;var t=r.split("<Record>");var i=[];var a=y.oat_component.lastCallData.UcId;var s=y.oat_component.lastCallData.fileName;var n=y.oat_component.lastCallData._selfgrid;var f=y.oat_component.lastCallData.format;for(var l=1;l<t.length;l++){var o=[];for(var u=0;u<OAT_JS.grid.gridData[a].grid.columns.length;u++){o[u]="#NuN#";var c=t[l].split("<"+OAT_JS.grid.gridData[a].grid.columns[u].getAttribute("dataField")+">");if(c.length>1){var v=c[1].split("</"+OAT_JS.grid.gridData[a].grid.columns[u].getAttribute("dataField")+">");o[u]=v[0]}}i.push(o);if(f!="xlsx"){if(l>OAT_JS.grid.gridData[a].rowsPerPage&&!(OAT_JS.grid.gridData[a].rowsPerPage=="")){OAT.CreateGridRow(o,OAT_JS.grid.gridData[a],true)}}}switch(f){case"pdf":OAT.ExportToPdf(n,s);break;case"xml":OAT.ExportToXML(n,s);break;case"html":OAT_JS.grid.gridData[a].grid.ExportToHtml(n,s);break;case"xls":OAT.ExportToExcel(n,s);break;case"xlsx":OAT.ExportToExcel2010(n,s,true,i,a);break}OAT_JS.grid.gridData[a].grid.removeAllCollapseRows();break}};this.setAttributeForTable=function(e){var r=JSON.parse(e);switch(y.oat_component.lastCallToQueryViewer){case"getValuesForColumn":OAT_JS.grid.changeValues(y.oat_component.lastCallData.UcId,y.oat_component.lastCallData.dataField,y.oat_component.lastCallData.columnNumber,r,y.oat_component.lastCallData.filterValue);break;case"readScrollValue":OAT_JS.grid.appendNewValueData(y.oat_component.lastCallData.UcId,r);break;case"readScrollValueFilter":OAT_JS.grid.appendNewFilteredValueData(y.oat_component.lastCallData.UcId,r,y.oat_component.lastCallData.posColumnNumber,y.oat_component.lastCallData.filterText);case"initValueRead":OAT_JS.grid.initValueLoad(r,y.oat_component.lastCallData.UcId,y.oat_component.lastCallData.dataField);break;case"filterChange":OAT_JS.grid.appendNewValueData(y.oat_component.lastCallData.UcId,r,true);OAT_JS.grid.setFilterChangedWhenServerPagination(y.oat_component.lastCallData.UcId,y.oat_component.lastCallData.oatDimension);break}};this.setDataSynForTable=function(e){_self=y.oat_component.lastCallData.self;OAT.ClickHandle(_self,y.oat_component.lastCallData.elemvalue,e)};this.appendExportToXmlOption=function(e,r){var t;var i=this.query;if(i==""){try{i=y.controlName.substr(4).split("_")[0]}catch(e){}}if(y.QueryViewerCollection[y.IdForQueryViewerCollection].ExportToXML){t=OAT.Dom.create("div");var a=y.createExportButton(t);var s=OAT.Dom.create("label");OAT.addTextNode(s,y.translations.GXPL_QViewerContextMenuExportXml);s.htmlFor="pivot_checkbox_restoreview";t.appendChild(s);OAT.Dom.attach(a,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(y.UcId,{grid:y},i,"xml")}));e.appendChild(t);if(!r)r=true}return r};this.appendExportToHtmlOption=function(e,r){var t;var i=this.query;if(i==""){try{i=y.controlName.substr(4).split("_")[0]}catch(e){}}if(y.QueryViewerCollection[y.IdForQueryViewerCollection].ExportToHTML){t=OAT.Dom.create("div");var a=y.createExportButton(t);var s=OAT.Dom.create("label");OAT.addTextNode(s,y.translations.GXPL_QViewerContextMenuExportHtml);s.htmlFor="pivot_checkbox_restoreview";t.appendChild(s);OAT.Dom.attach(a,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(y.UcId,y,i,"html")}));e.appendChild(t);if(!r)r=true}return r};this.ExportToHtml=function(e,r){var t=OAT.resourceURL(e.relativePath+"QueryViewer/oatPivot/css/grid.css");var i="<!DOCTYPE><HTML><BODY>";i=i+"<HEAD>";i=i+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';i=i+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+t+'" />';for(var a=0;a<jquery("link").length;a++){if(jquery("link")[a].href.indexOf("QueryViewer.css")<0){i=i+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+jquery("link")[a].href+'" />'}}i=i+"</STYLE>";i=i+"</HEAD>";i=i+'<div class="gx_usercontrol qv-table QueryViewer-table">';i=i+'<table class="oatgrid"  style="width: 100%;">';i=i+OAT.removeIconFont(jquery("#"+e.controlName)[0].innerHTML.replace(/visibility: collapse;/g,"").replace(/visibility:collapse;/g,""));i=i+"</table>";i=i+"</div>";i=i+"</BODY></HTML>";isSD=OAT.isSD();if(OAT.isSafari()||isSD){window.open("data:text/html,"+i)}else{var s=new Blob([i],{type:"text/html"});saveAs(s,r+".html")}};this.appendExportToPdfOption=function(e,r){var t=this.query;if(t==""){try{t=y.controlName.substr(4).split("_")[0]}catch(e){}}var i;if(y.QueryViewerCollection[y.IdForQueryViewerCollection].ExportToPDF){i=OAT.Dom.create("div");var a=y.createExportButton(i);var s=OAT.Dom.create("label");OAT.addTextNode(s,y.translations.GXPL_QViewerContextMenuExportPdf);s.htmlFor="pivot_checkbox_restoreview";i.appendChild(s);OAT.Dom.attach(a,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(y.UcId,{grid:y},t,"pdf")}));e.appendChild(i);if(!r)r=true}return r};this.appendExportToExcelOption=function(e,r){var t=this.query;if(t==""){try{t=y.controlName.substr(4).split("_")[0]}catch(e){}}var i;if(y.QueryViewerCollection[y.IdForQueryViewerCollection].ExportToXLS){i=OAT.Dom.create("div");var a=y.createExportButton(i);var s=OAT.Dom.create("label");OAT.addTextNode(s,y.translations.GXPL_QViewerContextMenuExportXls2003);s.htmlFor="pivot_checkbox_restoreview";i.appendChild(s);OAT.Dom.attach(a,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(y.UcId,{grid:y},t,"xls")}));e.appendChild(i);if(!r)r=true}return r};this.appendExportToExcel2010Option=function(e,r){var t=this.query;if(t==""){try{t=y.controlName.substr(4).split("_")[0]}catch(e){}}var i;if(y.QueryViewerCollection[y.IdForQueryViewerCollection].ExportToXLSX){i=OAT.Dom.create("div");var a=y.createExportButton(i);var s=OAT.Dom.create("label");OAT.addTextNode(s,y.translations.GXPL_QViewerContextMenuExportXlsx);s.htmlFor="pivot_checkbox_restoreview";i.appendChild(s);OAT.Dom.attach(a,"click",(function(){OAT_JS.grid.getAllDataRowsForExport(y.UcId,{grid:y},t,"xlsx")}));e.appendChild(i);if(!r)r=true}return r};this.createExportButton=function(e){var r=OAT.Dom.create("div",{});r.setAttribute("id","divtoxml");e.appendChild(r);if(y.isSD){r.setAttribute("class","download_file_img_small")}else{r.setAttribute("class","download_file_img")}OAT.addImageNode(r,"download","");e.setAttribute("class","export_item_div");if(y.isSD){e.setAttribute("class","export_item_div export_item_div_small")}return e};this.clearData=function(){y.rows=[];OAT.Dom.clear(y.rowBlock)};this.appendHeader=function(e,r,t){var i=!t?y.header.cells.length:t;var a=y.header.addCell(e,"character",i,r);for(var i=0;i<y.header.cells.length;i++){y.header.cells[i].number=i}return a};this.ieFix=function(){for(var e=0;e<y.header.cells.length;e++){var r=y.header.cells[e].html;OAT.Dom.addClass(r,"hover");OAT.Dom.removeClass(r,"hover");var t=y.header.cells[e].value;OAT.Dom.getWH(t)}};this.createHeader=function(e,r){y.header.clear();for(var t=0;t<e.length;t++){y.appendHeader(e[t],r[t])}if(OAT.isIE()){y.ieFix()}};this.getHeaders=function(){var e=[];for(var r=0;r<y.header.cells.length;r++){e.push(y.header.cells[r].value.textContent)}return e};this.createRow=function(e,r,t,i,a,s,n,f,l,o){var u=!l?y.rows.length:l;var c=new OAT.GridRow(y,u);if(l==u||u==y.rows.length){y.rowBlock.appendChild(c.html)}else{y.rowBlock.insertBefore(c.html,y.rowBlock.childNodes[u])}OAT.underRecursionStyle=[];for(var v=0;v<e.length;v++){c.addCell(e[v],r[v],t,i[v],a,s,n,v,l,o[v])}y.rows.splice(u,0,c);return c.html};this.loadDifferentValues=function(e,r){y.conditions[e].differentValue=[];for(var t=0;t<r.length;t++){y.conditions[e].differentValue.push(r[t])}};this.removeAllRows=function(){var e=y.rows.length;for(var r=0;r<e;r++){y.removeRow(0)}};this.removeAllHiddenRows=function(){var e=y.rows.length-1;while(e>0&&y.rows[e].html.style.display=="none"){y.removeRow(e);e--}};this.removeAllCollapseRows=function(){var e=y.rows.length-1;while(e>0&&y.rows[e].html.style.visibility=="collapse"){y.removeRow(e);e--}};this.removeRow=function(e){jquery(y.rows[e].html).remove();y.rows.splice(e,1)};this.removeColumn=function(e){y.header.removeColumn(e);for(var r=0;r<y.rows.length;r++){y.rows[r].removeColumn(e)}};this.hideColumnHeader=function(e){var r=e;y.header.cells[r].html.style.display="none"};this.showColumnHeader=function(e){y.header.cells[e].html.style.display=""};this.sort=function(e,r,t){for(var i=0;i<y.header.cells.length;i++){y.conditions[i].sort=1;y.header.cells[i].changeSort(OAT.GridData.SORT_NONE)}y.conditions[e].sort=r;y.header.cells[t].changeSort(r)};this.applySaveState=function(e){if(y.rememberLayout&&y.rememberLayout!="false"){y=this;var r=OAT.getState(y,e);if(r){OAT.filterRows(y);for(var t=0;t<y.columnsDataType.length;t++){if(y.conditions[t].sort!=1){y.sort(t,y.conditions[t].sort,t)}}}}};this.applySortOrderType=function(e,r){y.sort(e,r,e)};this.applyCustomSort=function(e,r,t){var i=[];for(var a=0;a<r.childNodes.length;a++){if(r.childNodes[a]!=undefined&&r.childNodes[a].localName!=undefined&&r.childNodes[a].localName==="customOrder"){for(var s=0;s<r.childNodes[a].childNodes.length;s++){if(r.childNodes[a].childNodes[s].localName=="Value"){i.push(r.childNodes[a].childNodes[s].textContent.trimpivot())}}}}for(var n=0;n<t.length;n++){if(i.indexOf(t[n][e].trimpivot())==-1){i.push(t[n][e])}}var f=t;t=[];for(var l=0;l<i.length;l++){for(var o=0;o<f.length;o++){if(f[o][e].trimpivot()===i[l].trimpivot()){t.push(f[o])}}}return[t,i]};this.applyCustomFilter=function(e,r){try{var t=[];var i=false;for(var a=0;a<r.childNodes.length;a++){if(r.childNodes[a]!=undefined&&r.childNodes[a].localName!=undefined&&r.childNodes[a].localName==="include"){i=true;for(var s=0;s<r.childNodes[a].childNodes.length;s++){if(r.childNodes[a].childNodes[s].localName!=null&&r.childNodes[a].childNodes[s].localName.toLowerCase()==="value"){t.push(r.childNodes[a].childNodes[s].textContent)}}}}if(i){y.conditions[e].blackList=[];var n=OAT_JS.grid.gridData[y.UcId].columnDataField[e];OAT_JS.grid.gridData[y.UcId].blackLists[n].state="";OAT_JS.grid.gridData[y.UcId].blackLists[n].defaultAction="Exclude";OAT_JS.grid.gridData[y.UcId].blackLists[n].hiddens=[];for(var f=0;f<t.length;f++){if(t[f]!="TOTAL")OAT_JS.grid.gridData[y.UcId].blackLists[n].visibles.push(t[f])}for(var f=0;f<y.rows.length;f++){var l=e;if(t.findIndex(y.rows[f].cells[l].options.value)===-1&&t.findIndex(y.rows[f].cells[l].options.value.trimpivot())===-1&&y.conditions[l].blackList.findIndex(y.rows[f].cells[l].options.value)===-1){y.conditions[l].blackList.push(y.rows[f].cells[l].options.value);OAT.HideGridRow({grid:y},e,y.rows[f].cells[e].options.value);OAT.actualizeBlackList("push",y,e,y.rows[f].cells[e].options.value,false)}}}}catch(e){}};this.moveToNextPage=function(){y.oat_component.moveToNextPage(y.UcId)};this.moveToFirstPage=function(){y.oat_component.moveToFirstPage(y.UcId)};this.moveToLastPage=function(){y.oat_component.moveToLastPage(y.UcId)};this.moveToPreviousPage=function(){y.oat_component.moveToPreviousPage(y.UcId)};this.selectValue=function(e){OAT_JS.grid.gridData[y.UcId].selection.SelectedNode=[];OAT.ClearSelectedNodes(jquery(y.html));var r=0;var t=OAT_JS.grid.gridData[y.UcId].columnDataField.indexOf(e[r].DataField);OAT.SelectNodes({grid:y},e[r].Value,false,t,-1,r,e)};this.deselectValue=function(){OAT_JS.grid.gridData[y.UcId].selection.SelectedNode=[];OAT.ClearSelectedNodes(jquery(y.html))};this.refreshPivot=function(e,r,t){if(e!=""&&r!=""){var i=new DOMParser;var a=i.parseFromString(e,"text/xml");var s=a.getElementsByTagName("OLAPDimension");var n="";var f="";var l=[];for(var o=0;o<s.length;o++){var u=s[o].getElementsByTagName("name")[0].childNodes[0].nodeValue;var c=-1;var v=-1;for(var d=0;d<y.columns.length;d++){if(y.columns[d].attributes.getNamedItem("name").nodeValue===u){var h=y.columns[d].attributes.getNamedItem("displayName").nodeValue;for(var p=0;p<y.header.cells.length;p++){if(y.header.cells[p].options.value===h){c=y.header.cells.length-1-p;v=p}}}}if(c!=-1){var m=s[o].getElementsByTagName("condition")[0].childNodes[0].nodeValue;if(m==="none"){var T="none";y.header.cells[v].html.style.display=T;for(var A=0;A<y.rows.length;A++){y.rows[A].cells[c].html.style.display=T}OAT_JS.grid.setColumnVisibleValue(y.UcId,v,T=="")}else{var T="";y.header.cells[v].html.style.display=T;for(var A=0;A<y.rows.length;A++){y.rows[A].cells[c].html.style.display=T}OAT_JS.grid.setColumnVisibleValue(y.UcId,v,T=="")}try{var w=OAT_JS.grid.gridData[y.UcId].columnDataField[v];l[parseInt(s[o].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=w}catch(e){}var w=OAT_JS.grid.gridData[y.UcId].columnDataField[v];OAT_JS.grid.updateFilterInfo(y.UcId,w,{op:"all",values:[]});var O=s[o].getElementsByTagName("order")[0].childNodes[0].nodeValue;if(O=="ascending"&&y.conditions[c].sort==3){y.sort(c,OAT.GridData.SORT_ASC,v);f="Ascending";n=s[o].getElementsByTagName("dataField")[0].childNodes[0].nodeValue}else if(O=="descending"&&y.conditions[c].sort!=3){y.sort(c,OAT.GridData.SORT_DESC,v);f="Descending";n=s[o].getElementsByTagName("dataField")[0].childNodes[0].nodeValue}var g=s[o].getElementsByTagName("hide")[0].childNodes;for(var _=0;_<g.length;_++){if(g[_].tagName==="value"){var w=OAT_JS.grid.gridData[y.UcId].columnDataField[v];var b=OAT_JS.grid.gridData[y.UcId].differentValues[w];for(var A=0;A<b.length;A++){if(b[A].trimpivot()==g[_].textContent){OAT_JS.grid.updateFilterInfo(y.UcId,w,{op:"push",values:b[A]})}}}}}}if(l.length!=OAT_JS.grid.gridData[y.UcId].columnDataField.length){l=[]}var s=a.getElementsByTagName("OLAPDimension");OAT_JS.grid.refreshPivotWhenServerPagination(y.UcId,n,f,l)}};this.getDataXML=function(e){var r=e.split("<Recordset")[1];r="<Recordset"+r;return r};this.getFilteredDataXML=function(e){return OAT_JS.grid.getTableWhenServerPagination(y.UcId,e)};this.getMetadataXML=function(){var e='<OLAPCube format="'+"compact"+'" thousandsSeparator="'+","+'" decimalSeparator="'+"."+'" dateFormat="'+"MDY"+'">';for(var r=0;r<y.columns.length;r++){var t=y.columns[r].getAttribute("isMeasure")!=undefined;if(t)e=e+"<OLAPMeasure> ";else e=e+"<OLAPDimension> ";e=e+OAT.createXMLDimensionInfo(y,r);var i=0;for(var a=0;a<y.header.cells.length;a++){if(y.header.cells[a].dataField==y.columns[r].getAttribute("dataField")){i=a;if(y.header.cells[a].html.style.display=="none"){e=e+"<hidden>true</hidden>"}}}if(y.columns[r].getAttribute("picture")===""){e=e+"<picture/> "}else{e=e+"<picture>"+y.columns[r].getAttribute("picture")+"</picture> "}if(y.columns[r].getAttribute("format")===""){e=e+"<format/> "}else{e=e+"<format>"+y.columns[r].getAttribute("format")+"</format> "}var s=0;var n=false;var f=-1;for(var l=0;l<OAT_JS.grid.gridData[y.UcId].columnDataField.length&&!n;l++){var o=OAT_JS.grid.gridData[y.UcId].columnDataField[l];var u=false;for(var c=0;c<y.columns.length;c++){if(o==y.columns[c].getAttribute("dataField"))u=y.columns[c].getAttribute("visible").toLowerCase()=="never"}if(!u)s=s+1;if(o==y.columns[r].getAttribute("dataField")){n=true;if(!u)f=s}}if(f>0)e=e+"<position>"+f+"</position> ";else e=e+"<position/>";if(OAT_JS.grid.gridData[y.UcId].dataFieldOrder==y.columns[r].getAttribute("dataField")){if(OAT_JS.grid.gridData[y.UcId].orderType=="Descending")e=e+"<order>descending</order> ";else e=e+"<order>ascending</order> "}else{e=e+"<order>none</order> "}e=e+"<customOrder/> ";e=e+"<include> ";var v=[];for(var d=0;d<y.rows.length;d++){if(y.rows[d].cells[i]!=undefined){if(v.findIndex(y.rows[d].cells[i].options.value)===-1){if(y.conditions[r].blackList.findIndex(y.rows[d].cells[i].options.value)===-1){e=e+"<value>"+y.rows[d].cells[i].options.value+"</value> ";v.push(y.rows[d].cells[i].options.value)}}}}e=e+"<value>TOTAL</value> </include> <collapse/> ";if(t)e=e+"</OLAPMeasure>";else e=e+" </OLAPDimension>"}e=e+"</OLAPCube>";return e};y.init();setInterval((function(){if(jquery("#"+y.controlName).length>0&&jquery("#"+y.controlName)[0].getAttribute("class")==="oatgrid"){var e=0;if(jquery("#"+y.controlName+"tablePagination_rowsPerPage").length>0){if(!OAT_JS.grid.gridData[y.UcId].autoResize){var r=jquery("#"+y.ContainerName)[0].clientWidth;jquery("#"+y.controlName).css({width:r+"px"})}else{r=jquery("#"+y.controlName)[0].clientWidth}e=parseInt(jquery("#"+y.controlName+"tablePagination_rowsPerPage")[0].value);if(!isNaN(e)){if(y.rowsPerPage!=e){y.rowsPerPage=e}else{y.rowsPerPage=e}}var t=r;jquery("#"+y.controlName+"_tablePagination").css({width:t+"px"});jquery("#"+y.controlName+"_grid_top_div").css({width:t+"px"});var i=jquery("#"+y.controlName)[0].clientWidth;if(i>r+10||jquery("#"+y.controlName).closest(".gxwebcomponent").length>0){jquery("#"+y.controlName+"_tablePagination").css({width:i+1+"px"});jquery("#"+y.controlName+"_grid_top_div").css({width:i+1+"px"})}}else{if(!OAT_JS.grid.gridData[y.UcId].autoResize){var r=jquery("#"+y.ContainerName)[0].clientWidth;jquery("#"+y.controlName).css({width:r+"px"})}else{r=jquery("#"+y.controlName)[0].clientWidth}var a=r;jquery("#"+y.controlName+"_grid_top_div").css({width:a+"px"});jquery(".oatgrid").css({marginBottom:"0px"});var i=jquery("#"+y.controlName)[0].clientWidth;if(i>r+10||jquery("#"+y.controlName).closest(".gxwebcomponent").length>0){jquery("#"+y.controlName+"_grid_top_div").css({width:i+1+"px"})}}jquery(".divIeContainer").css({opacity:"1"});if(jquery("#"+y.controlName+" tr").length<500){var s=1;for(var n=1;n<jquery("#"+y.controlName+" tr").length;n++){if(jquery("#"+y.controlName+" tr")[n].style.display!="none"){if(s%2===1){jquery("#"+y.controlName+" tr")[n].className="odd"}else{jquery("#"+y.controlName+" tr")[n].className="even"}s++}}}if(jquery("#"+y.controlName+"tablePagination_rowsPerPage").length>0&&y.QueryViewerCollection.length===0){jquery(".pivot_pag_div").css({marginBottom:"0px"})}}}),150)};OAT.GridHeader=function(e,r){var t=this;this.cells=[];this.grid=e;if(r){this.html=r}else{this.html=OAT.Dom.create("thead")}this.container=OAT.Dom.create("tr");this.html.appendChild(t.container);this.clear=function(){OAT.Dom.clear(t.container);t.cells=[]};this.addCell=function(e,r,i,a){var s=new OAT.GridHeaderCell(t.grid,e,i,a);var n=t.container.childNodes;if(n.length&&i<n.length){t.container.insertBefore(s.html,n[i])}else{t.container.appendChild(s.html)}t.cells.splice(i,0,s);return s};t.removeColumn=function(e){OAT.Dom.unlink(t.cells[e].html);t.cells.splice(e,1);for(var r=0;r<t.cells.length;r++){t.cells[r].number=r}}};OAT.GridHeaderCell=function(e,r,t,i){var a=this;this.options={value:"",sortable:1,align:OAT.GridData.ALIGN_START,sort:OAT.GridData.SORT_NONE,type:OAT.GridData.TYPE_AUTO};var s=typeof r=="object"?r:{value:r};for(var n in s){a.options[n]=s[n]}this.changeSort=function(e){a.options.sort=e;a.updateSortImage()};this.updateSortImage=function(){if(!a.sorter){return}var e="none";switch(a.options.sort){case OAT.GridData.SORT_NONE:e="none";break;case OAT.GridData.SORT_ASC:e="asc";break;case OAT.GridData.SORT_DESC:e="desc";break}a.sorter.className="table-sort-image table-sort-"+e;jquery(a.sorter).find("i")[0].textContent=e=="none"?"":e=="asc"?"arrow_drop_up":"arrow_drop_down"};this.signal=0;this.number=t;this.grid=e;this.dataField=i;this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div",{position:"relative"});this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(a.value,"header_value");OAT.addTextNode(this.value,s.value.replace(/ /g,"Â "));this.value.setAttribute("title_v",s.value);this.value.setAttribute("dataField",i);this.html.setAttribute("title_v",s.value);this.html.setAttribute("dataField",i);var f=OAT.Dom.create("div");f.className="div_settings";OAT.addImageNode(f,"settings","");OAT.Dom.append([a.html,a.container],[a.container,a.value],[a.value,f]);if(a.options.sortable){a.html.style.cursor="pointer";a.sorter=OAT.Dom.create("div",{position:"absolute",right:"6px",bottom:"4px"});OAT.addImageNode(a.sorter,"arrow_drop_up","");a.container.appendChild(a.sorter);a.updateSortImage();var l;if(OAT.isIE()){if(e.isSD){l=OAT.Dom.create("div","","oatfilterwindowGrid oatfilterwindow_small")}else{l=OAT.Dom.create("div","","oatfilterwindowGrid")}}else{if(e.isSD){l=OAT.Dom.create("div","","oatfilterwindow oatfilterwindow_small")}else{l=OAT.Dom.create("div","","oatfilterwindow")}}OAT.Anchor.assign(a.container,{title:" ",content:l,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:a.grid.QueryViewerCollection[IdForQueryViewerCollection].ControlName+"-table"+" FilterPopup "});var o=function(e){var r=OAT.GridData.SORT_NONE;switch(a.options.sort){case OAT.GridData.SORT_NONE:r=OAT.GridData.SORT_ASC;break;case OAT.GridData.SORT_ASC:r=OAT.GridData.SORT_DESC;break;case OAT.GridData.SORT_DESC:r=OAT.GridData.SORT_ASC;break}if(OAT_JS.grid.gridData[a.grid.UcId].differentValuesPaginationInfo[i].previousPage==0){OAT_JS.grid.initValueRead(a.grid.UcId,0,i);jquery(".oat_winrect_container").css({left:"-10000000px",top:"-10000000px"});var t=jquery.extend(true,{},e);var s=function(){if(OAT_JS.grid.gridData[a.grid.UcId].differentValuesPaginationInfo[i].previousPage==0){setTimeout(s,100)}else{OAT.showPopup(t,a,r,l)}};s()}else{OAT.showPopup(e,a,r,l)}};OAT.Event.attach(a.container,"click",o)}switch(a.options.align){case OAT.GridData.ALIGN_START:a.html.style.textAlign="start";break;case OAT.GridData.ALIGN_CENTER:a.html.style.textAlign="center";break;case OAT.GridData.ALIGN_END:a.html.style.textAlign="end";break}var u=function(e){OAT.Dom.addClass(a.html,"hover")};var c=function(e){OAT.Dom.removeClass(a.html,"hover")};OAT.Event.attach(a.html,"mouseover",u);OAT.Event.attach(a.html,"mouseout",c)};OAT.GridRow=function(e,r){var t=this;this.clear=function(){OAT.Dom.clear(t.html);t.cells=[]};this.removeColumn=function(e){OAT.Dom.unlink(t.cells[e].html);t.cells.splice(e,1)};this.isDecimal=function(e,r){var t=/^[0-9]+(\.[0-9]+)+$/;if(e.match(t)){return true}else{return false}};this.addCell=function(e,r,i,a,s,n,f,l,o,u){var c=!o?t.cells.length:o;if(e==undefined){e=""}var v=new OAT.GridRowCell(e,c,r,i,a,s,n,f,l,u);var d=t.html.childNodes;if(d.length&&c!=d.length){t.html.insertBefore(v.html,d[c]);if(!u)d[c].style.display="none"}else{t.html.appendChild(v.html);if(!u)v.html.style.display="none"}OAT.setClickEventHandlers(t,d[d.length-1],e,"DIMENSION",l,t.grid.rows.length);t.cells.splice(c,0,v);return v.value};this.select=function(){t.selected=1};this.deselect=function(){t.selected=0;OAT.Dom.removeClass(t.html,"selected")};this.grid=e;this.cells=[];this.html=OAT.Dom.create("tr");this.selected=0;OAT.Dom.addClass(t.html,r%2?"even":"odd");var i=function(e){OAT.Dom.addClass(t.html,"hover")};var a=function(e){OAT.Dom.removeClass(t.html,"hover")};var s=function(e){if(!e.shiftKey&&!e.ctrlKey){for(var r=0;r<t.grid.rows.length;r++){var i=t.grid.rows[r];if(i!=t){i.deselect()}}}if(e.shiftKey){var a=-1;var s=-1;var n=0;for(var r=0;r<t.grid.rows.length;r++){var i=t.grid.rows[r];if(i!=t){if(!n&&i.selected){a=r}if(!n&&a!=-1){i.select()}if(n&&i.selected){s=r}}else{n=1}}if(a==-1&&s!=-1){var n=0;for(var r=0;r<t.grid.rows.length;r++){var i=t.grid.rows[r];if(i==t){n=1}if(n&&i!=t&&r<s){i.select()}}}}t.selected?t.deselect():t.select()};OAT.Event.attach(t.html,"mouseover",i);OAT.Event.attach(t.html,"mouseout",a);OAT.Event.attach(t.html,"click",s)};OAT.GridRowCell=function(e,r,t,i,a,s,n,f,l,o){var u=this;this.options={value:"",align:OAT.GridData.ALIGN_START};var c=typeof e=="object"?e:{value:e};for(p in c){u.options[p]=c[p]}this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div");this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(u.value,"row_value");OAT.addTextNode(this.value,OAT.ApplyPictureValue(u.options.value,t,i,a).trim().replace(/ /g,"Â "));var v=u.options.value;if(t=="date"){v=OAT.ApplyPictureValue(u.options.value,t,i,a)}this.html=OAT.applyFormatValues(this.html,v,t,l,n,s,f,i);this.html.setAttribute("title",OAT.ApplyPictureValue(u.options.value,t,i,a));OAT.Dom.append([u.html,u.container],[u.container,u.value]);this.html.setAttribute("sin_pictureValue",e);if(t!="character"&&t!="guid"){if(!isNaN(u.options.value)){u.options.align=4}if(u.options.value){u.options.align=4}}if(t==="date"){u.options.align=4}switch(u.options.align){case OAT.GridData.ALIGN_START:u.html.style.textAlign="start";break;case OAT.GridData.ALIGN_CENTER:u.html.style.textAlign="center";break;case OAT.GridData.ALIGN_END:u.html.style.textAlign="end";break;case OAT.GridData.ALIGN_RIGHT:u.html.style.textAlign="right";break}};OAT.underRecursionStyle=[];OAT.applyFormatValues=function(e,r,t,i,a,s,n){var f=t;var l=n[i];if(l!=null&&l!=""){e=OAT.setStyleValues(e,l)}if(OAT.underRecursionStyle.length>0){for(var o=0;o<OAT.underRecursionStyle.length;o++){e=OAT.setStyleValues(e,OAT.underRecursionStyle[o].format)}}for(var o=0;o<a.length;o++){if(a[o].columnNumber==i){if(a[o].value===r.trimpivot()){e=OAT.setStyleValues(e,a[o].format);if(self.formatValues[o].recursive!=undefined&&self.formatValues[o].recursive=="yes"){OAT.underRecursionStyle.push(a[o])}}}}var u=[];var c=[];var v=[];var d=[];var h=[];var p=[];var d=[];var m=[];for(var o=0;o<s.length;o++){if(s[o].columnNumber==i){if(s[o].operation1=="equal"){if(f==="real"||f==="integer"){u[0]=parseFloat(s[o].value1)}else{u[0]=s[o].value1}u[1]=s[o].format}if(s[o].operation1=="notequal"){if(f==="real"||f==="integer"){c[0]=parseFloat(s[o].value1)}else{c[0]=s[o].value1}c[1]=s[o].format}if(s[o].operation1=="less"){if(f==="real"||f==="integer"){h[0]=parseFloat(s[o].value1)}else{h[0]=s[o].value1}h[1]=s[o].format}if(s[o].operation1=="lessequal"){if(f==="real"||f==="integer"){p[0]=parseFloat(s[o].value1)}else{p[0]=s[o].value1}h[1]=s[o].format}if(s[o].operation1=="greater"){if(f==="real"||f==="integer"){v[0]=parseFloat(s[o].value1)}else{v[0]=s[o].value1}v[1]=s[o].format}if(s[o].operation1=="greaterequal"&&s[o].operation2==undefined){if(f==="real"||f==="integer"){d[0]=parseFloat(s[o].value1)}else{d[0]=s[o].value1}v[1]=s[o].format}if(s[o].operation2&&s[o].operation1=="greaterequal"){if(f==="real"||f==="integer"){m[0]=parseFloat(s[o].value1)}else{m[0]=s[o].value1}if(s[o].operation2&&s[o].operation2=="lessequal"){if(f==="real"||f==="integer"){m[1]=parseFloat(s[o].value2)}else{m[1]=s[o].value2}m[2]=s[o].format}}}}var T=new Array(3);if(f==="real"){r=parseFloat(r);if(v[0]!=undefined&&v[0]!=""){T[0]=parseFloat(v[0])}if(h[0]!=undefined&&h[0]!=""){T[1]=parseFloat(h[0])}if(m[0]!=undefined&&m[0]!=""){T[2]=parseFloat(m[0])}}if(f==="integer"){r=parseInt(r);if(v[0]!=undefined&&v[0]!=""){T[0]=parseInt(v[0])}if(h[0]!=undefined&&h[0]!=""){T[1]=parseInt(h[0])}if(m[0]!=undefined&&m[0]!=""){T[2]=parseInt(m[0])}}if(f==="date"){var A=r.split("-");var y=new Array(3);y[0]=parseInt(A[0]);y[1]=parseInt(A[1]);y[2]=parseInt(A[2]);try{if(u[0]!=undefined||d[0]!=undefined||p[0]!=undefined){var w;if(u[0]!=undefined){w=u[0].split("-")}else if(d[0]!=undefined){w=d[0].split("-")}else if(d[0]!=undefined){w=p[0].split("-")}var O=new Array(3);O[1]=parseInt(w[1]);O[2]=parseInt(w[2]);O[0]=parseInt(w[0]);if(O[0]==y[0]||O[0]==y[0]&&O[1]==y[1]){if(u[1]!=undefined)e=OAT.setStyleValues(e,u[1]);else if(v[1]!=undefined)e=OAT.setStyleValues(e,v[1]);else if(h[1]!=undefined)e=OAT.setStyleValues(e,h[1])}}if(c[0]!=undefined){var w=c[0].split("-");var O=new Array(3);O[1]=parseInt(w[1]);O[2]=parseInt(w[2]);O[0]=parseInt(w[0]);if(O[0]!=y[0]||O[0]!=y[0]&&O[1]!=y[1]){e=OAT.setStyleValues(e,c[1])}}if(v[0]!=undefined||d[0]!=undefined){var w;if(v[0].split("-")!=undefined){w=v[0].split("-")}else{w=d[0].split("-")}O[1]=parseInt(w[1]);O[2]=parseInt(w[2]);O[0]=parseInt(w[0]);if(O[0]<y[0]||O[0]<=y[0]&&O[1]<y[1]||O[0]<=y[0]&&O[1]<=y[1]&&O[2]<y[2]){e=OAT.setStyleValues(e,v[1])}}if(h[0]!=undefined||p[0]!=undefined){var w;if(h[0].split("-")!=undefined){w=h[0].split("-")}else{w=p[0].split("-")}O=new Array(3);O[1]=parseInt(w[1]);O[2]=parseInt(w[2]);O[0]=parseInt(w[0]);if(O[0]>y[0]||O[0]>=y[0]&&O[1]>y[1]||O[0]>=y[0]&&O[1]>=y[1]&&O[2]>y[2]){e=OAT.setStyleValues(e,h[1])}}if(m[0]!=undefined&&m[1]!=undefined){var w=m[0].split("-");var g=m[1].split("-");O=new Array(3);cmparElements2=new Array(3);O[1]=parseInt(w[1]);O[2]=parseInt(w[2]);O[0]=parseInt(w[0]);cmparElements2[1]=parseInt(g[1]);cmparElements2[2]=parseInt(g[2]);cmparElements2[0]=parseInt(g[0]);if((O[0]<=y[0]||O[0]<=y[0]&&O[1]<y[1]||O[0]<=y[0]&&O[1]<=y[1]&&O[2]<y[2])&&(cmparElements2[0]>y[0]||cmparElements2[0]>=y[0]&&cmparElements2[1]>y[1]||cmparElements2[0]>=y[0]&&cmparElements2[1]>=y[1]&&cmparElements2[2]>y[2])){e=OAT.setStyleValues(e,m[2])}}}catch(e){}}if(f!="date"){if(u[0]!=undefined&&r==u[0]){e=OAT.setStyleValues(e,u[1])}if(c[0]!=undefined&&r!=c[0]){e=OAT.setStyleValues(e,c[1])}if(v[0]!=undefined&&r>v[0]||d[0]!=undefined&&r>=d[0]){e=OAT.setStyleValues(e,v[1])}if(h[0]!=undefined&&r<h[0]||p[0]!=undefined&&r<=p[0]){e=OAT.setStyleValues(e,h[1])}if(m[0]!=undefined&&m[1]!=undefined&&(r>=m[0]&&r<=m[1])){e=OAT.setStyleValues(e,m[2])}}return e};OAT.setStyleValues=function(e,r){if(r==undefined)return e;function t(e){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(r,(function(e,r,t,i){return r+r+t+t+i+i}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var i=r.split(";");for(var a=0;a<i.length;a++){var s=i[a].split(":");var n=s[0].replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ");var f=s[1].replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ");switch(n){case"color":if(f[0]!=undefined&&f[0]==="#"){e.style.color="rgb("+t(f).r+","+t(f).g+","+t(f).b+")"}else{e.style.color=f}break;case"fontStyle":e.style.fontStyle=f;break;case"backgroundColor":e.style.backgroundColor=f;break;case"textDecoration":e.style.textDecoration=f;break;case"fontWeight":e.style.fontWeight=f;break;case"fontFamily":e.style.fontFamily=f;break;case"fontVariant":e.style.fontVariant=f;break;case"fontSize":e.style.fontSize=f.replace("px","")+"px";break;case"textAlign":e.style.textAlign=f;break;case"lineHeight":e.style.lineHeight=f;break;case"textIndent":e.style.textIndent=f;break;case"verticalAlign":e.style.verticalAlign=f;break;case"wordSpacing":e.style.wordSpacing=f;break;case"display":e.style.display=f;break;case"borderThickness":e.style.borderThickness=f;e.style.borderWidth=f+"px";break;case"borderColor":e.style.borderColor=f;break;case"borderWith":e.style.borderWith=f;break;case"borderStyle":e.style.borderStyle=f;break;case"padding":e.style.padding=f;break;case"paddingBottom":e.style.paddingBottom=f;break;case"paddingLeft":e.style.paddingLeft=f;break;case"paddingRight":e.style.paddingRight=f;break;case"paddingTop":e.style.paddingTop=f;break}}return e};OAT.GenerateFormatDateForGrid=function(e,r){r.split(" ");var t=e[0].split("-");var i="";switch(r){case"99/99/9999":i=t[1]+"/"+t[2]+"/"+t[0];break;case"99/99/99":if(t[0].length==4){t[0]=t[0].substr(t[0].length-2,2)}i=t[1]+"/"+t[2]+"/"+t[0];break;default:i=t[2]+"/"+t[1]+"/"+t[0]}return i};OAT.HideGridRow=function(e,r,t){for(var i=0;i<e.grid.rows.length;i++){if(e.grid.rows[i].cells[r].options.value.toString().trimpivot()===t.toString().trimpivot()){e.grid.rows[i].html.style.display="none";e.grid.rows[i].html.setAttribute("visibQ","tf")}}};OAT.ShowGridRow=function(e,r,t){for(var i=0;i<e.grid.rows.length;i++){if(e.grid.rows[i].cells[r].options.value.toString().trimpivot()===t.toString().trimpivot()){e.grid.rows[i].html.style.display="";e.grid.rows[i].html.setAttribute("visibQ","tt")}}};OAT.RestoreGridRow=function(e){for(var r=0;r<e.grid.rows.length;r++){e.grid.rows[r].html.style.display="";e.grid.rows[r].html.setAttribute("visibQ","tt")}for(var t=0;t<e.grid.columnsDataType.length;t++){e.grid.conditions[t].blackList=[]}};OAT.RestoreGridOrder=function(e){e.grid.sort(0,2,e.grid.columnsDataType.length-1-0);e.grid.sort(0,1,e.grid.columnsDataType.length-1-0)};OAT.RestoreGridColumns=function(e){for(var r=0;r<e.grid.columnsDataType.length;r++){e.grid.header.cells[r].html.style.display="";var t=0;var i=e.grid.columnsDataType.length-1-r;for(t=0;t<e.grid.rows.length;t++){e.grid.rows[t].cells[i].html.style.display=""}}};OAT.CreateGridRow=function(e,r,t){var i=[];var a=[];var s=[];var n=[];var f=[];for(var l=0;l<r.columnDataField.length;l++){var o=r.originalColumnDataField.indexOf(r.columnDataField[l]);i[l]=e[o];a[l]=r.rowsMetadata.columnsDataType[o];s[l]=r.rowsMetadata.forPivotCustomPicture[o];n[l]=r.rowsMetadata.forPivotCustomFormat[o];f[l]=r.columnVisible[o]}var u=r.grid.createRow(i,a,r.rowsMetadata.defaultPicture,s,r.rowsMetadata.conditionalFormatsColumns,r.rowsMetadata.formatValues,n,r.rowsMetadata.columns,null,f);if(t)u.style.visibility="collapse"};OAT.filterRows=function(e){var r={grid:e};for(var t=0;t<e.columnsDataType.length;t++){for(var i=0;i<e.conditions[t].blackList.length;i++){OAT.HideGridRow(r,t,e.conditions[t].blackList[i]);OAT.actualizeBlackList("push",e,t,e.conditions[t].blackList[i],false)}}};OAT.actualizeBlackList=function(e,r,t,i,a){if(e==="push"){if(r.conditions[t].blackList.indexOf(i)===-1)r.conditions[t].blackList.push(i)}else{var s=r.conditions[t].blackList.indexOf(i);if(s!=-1)r.conditions[t].blackList.splice(s,1)}};OAT.showPopup=function(e,r,t,i){var a=[];var s=function(){jquery(".oat_winrect_container").css({display:"none"})};var n=r.number;if(OAT_JS.grid.gridData[r.grid.UcId].redrawHeader){var f=0;for(var l=0;l<r.grid.columns.length;l++){if(OAT_JS.grid.gridData[r.grid.UcId].columnVisible[l])f=f+1;if(r.grid.columns[l].getAttribute("dataField")==r.dataField)n=f-1}}var o=e;if(r.grid.isSD){jquery(".oat_winrect_container").css({left:"-1500px",top:jquery(o.currentTarget).offset().top+"px"})}else{jquery(".oat_winrect_container").css({left:jquery(o.currentTarget).offset().left+"px",top:jquery(o.currentTarget).offset().top+"px"})}OAT.Dom.clear(i);a.push(i);jquery(".oat_winrect_title").find(".winrect_title_label").remove();var u=OAT.Dom.create("label");if(r.grid.isSD){jquery(".oat_winrect_container").addClass("oat_winrect_container_small");u.setAttribute("class","winrect_title_label winrect_title_label_small")}else{u.setAttribute("class","winrect_title_label")}var c=r.grid.columns[n].getAttribute("displayName");for(var v=0;v<r.grid.columns.length;v++){if(r.dataField==r.grid.columns[v].getAttribute("dataField")){c=r.grid.columns[v].getAttribute("displayName")}}OAT.addTextNode(u,c);jquery(".oat_winrect_title").append(u);var d=Math.floor(Math.random()*1e4);if(!r.grid.disableColumnSort){var h=document.createElement("div");h.setAttribute("class","first_popup_subdiv");var p=OAT.Dom.radio("order");var m="pivot_order_asc"+"_"+r.grid.ContainerName+"_"+r.grid.TableDataFilds[r.number]+d;p.id=m;p.className="input_radio_popup";p.checked=r.grid.conditions[n].sort===2;OAT.Dom.attach(p,"change",(function(){}));OAT.Dom.attach(p,"click",(function(){r.grid.sort(n,OAT.GridData.SORT_ASC,r.number);var e=r.container.parentNode.cellIndex;var t;if(e<0)t=r.dataField;else t=OAT_JS.grid.gridData[r.grid.UcId].columnDataField[e];self.getDataForTable(r.grid.UcId,1,r.grid.rowsPerPage,false,t,"Ascending","","");var i="i_"+this.getAttribute("id");var a=document.getElementById(i);a.textContent="radio_button_checked";var s=document.getElementById(i.replace("asc","desc"));s.textContent="radio_button_unchecked"}));h.appendChild(p);var T=OAT.Dom.create("label");T.className="first_div_label";T.htmlFor=m;var A=OAT.isIE()?"top:-10px;":"";OAT.addImageNode(T,r.grid.conditions[n].sort===2?"radio_button_checked":"radio_button_unchecked",A,"i_"+m);OAT.addTextNode(T,self.translations.GXPL_QViewerJSAscending);h.appendChild(T);h.appendChild(OAT.Dom.create("br"));var y=OAT.Dom.radio("order");var w="pivot_order_desc"+"_"+r.grid.ContainerName+"_"+r.grid.TableDataFilds[r.number]+d;y.id=w;y.className="input_radio_popup";y.checked=r.grid.conditions[n].sort===3;OAT.Dom.attach(y,"change",(function(){}));OAT.Dom.attach(y,"click",(function(){r.grid.sort(n,OAT.GridData.SORT_DESC,r.number);var e=r.container.parentNode.cellIndex;var t;if(e<0)t=r.dataField;else t=OAT_JS.grid.gridData[r.grid.UcId].columnDataField[e];self.getDataForTable(r.grid.UcId,1,r.grid.rowsPerPage,false,t,"Descending","","");var i="i_"+this.getAttribute("id");var a=document.getElementById(i);a.textContent="radio_button_checked";var s=document.getElementById(i.replace("desc","asc"));s.textContent="radio_button_unchecked"}));var O=OAT.Dom.create("label");O.className="first_div_label";O.htmlFor=w;OAT.addImageNode(O,r.grid.conditions[n].sort===3?"radio_button_checked":"radio_button_unchecked",A,"i_"+w);OAT.addTextNode(O,self.translations.GXPL_QViewerJSDescending);h.appendChild(y);h.appendChild(O);a.push(h);if(self.header.length>1){var g=OAT.Dom.create("hr",{});a.push(g)}}var _=OAT.Dom.create("hr",{});var b=OAT.Dom.create("div");if(r.grid.disableColumnSort){b.setAttribute("class","first_popup_subdiv")}if(r.container.parentNode.cellIndex>0){var x=document.createElement("div");x.setAttribute("class","move_item_img");OAT.Dom.attach(x,"click",(function(){var e=r.container.parentNode.cellIndex;var t=e-1;while(t>=0&&r.container.parentNode.parentNode.children[t].clientWidth==0){t=t-1}if(t==-1)return;var i=0;var a=0;var n=r.container.parentNode.parentNode.children[t].getAttribute("title_v");for(var f=0;f<r.grid.header.cells.length;f++){if(r.container.children[0].getAttribute("title_v")===r.grid.header.cells[f].value.firstChild.textContent.replace(/\u00A0/g," ")){i=f}if(n===r.grid.header.cells[f].value.firstChild.textContent.replace(/\u00A0/g," ")){a=f}}r.grid.header.cells[i].html.parentNode.insertBefore(r.grid.header.cells[i].html,r.grid.header.cells[a].html);OAT_JS.grid.gridData[r.grid.UcId].redrawHeader=true;for(var f=0;f<r.grid.rows.length;f++){r.grid.rows[f].cells[i].html.parentNode.insertBefore(r.grid.rows[f].cells[i].html,r.grid.rows[f].cells[a].html)}var l=[];for(var o=0;o<jquery("#"+r.grid.controlName).find("thead td").length;o++){l.push(jquery("#"+r.grid.controlName).find("thead td")[o].getAttribute("dataField"))}OAT_JS.grid.setDataFieldPosition(r.grid.UcId,l);s()}));var S=OAT.Dom.create("label");OAT.addTextNode(S,self.translations.GXPL_QViewerJSMoveColumnToLeft);S.htmlFor="move_column_to_left"+d;x.appendChild(S);OAT.Dom.append([b,x]);if(r.container.parentNode.cellIndex>=r.grid.header.cells.length-2){a.push(b)}}if(r.container.parentNode.cellIndex<r.grid.header.cells.length-1){var I=document.createElement("div");I.setAttribute("class","move_item_img");OAT.Dom.attach(I,"click",(function(){var e=r.container.parentNode.cellIndex;if(e==-1){for(var t=0;t<r.grid.html.tHead.rows[0].cells.length;t++){if(r.container.children[0].getAttribute("title_v")==r.grid.html.tHead.rows[0].cells[t].getAttribute("title_v")){e=t}}}var i=e+1;var a=r.container.parentNode.parentNode;if(r.container.parentNode.parentNode==undefined)a=r.grid.div.children[1].children[0].children[0];while(i<a.children.length-1&&a.children[i].clientWidth==0){i=i+1}if(i>=a.children.length)return;var n=0;var f=0;var l;if(r.container.parentNode.parentNode!=undefined){l=r.container.parentNode.parentNode.children[i].getAttribute("title_v")}else{l=r.grid.html.tHead.rows[0].cells[i].getAttribute("title_v")}for(var o=0;o<r.grid.header.cells.length;o++){if(r.container.children[0].getAttribute("title_v")===r.grid.header.cells[o].value.firstChild.textContent.replace(/\u00A0/g," ")){n=o}if(l===r.grid.header.cells[o].value.firstChild.textContent.replace(/\u00A0/g," ")){f=o}}r.grid.header.cells[n].html.parentNode.insertBefore(r.grid.header.cells[f].html,r.grid.header.cells[n].html);OAT_JS.grid.gridData[r.grid.UcId].redrawHeader=true;for(var o=0;o<r.grid.rows.length;o++){r.grid.rows[o].cells[n].html.parentNode.insertBefore(r.grid.rows[o].cells[f].html,r.grid.rows[o].cells[n].html)}var u=[];for(var c=0;c<jquery("#"+r.grid.controlName).find("thead td").length;c++){u.push(jquery("#"+r.grid.controlName).find("thead td")[c].getAttribute("dataField"))}OAT_JS.grid.setDataFieldPosition(r.grid.UcId,u);s()}));var k=OAT.Dom.create("label");OAT.addTextNode(k,self.translations.GXPL_QViewerJSMoveColumnToRight);k.htmlFor="move_column_to_right"+d;I.appendChild(k);OAT.Dom.append([b,I]);a.push(b)}if(OAT.gridStateChanged(r)){var q=OAT.Dom.create("div");var F=document.createElement("div");OAT.Dom.attach(F,"click",(function(){self.getDataForTable(r.grid.UcId,1,r.grid.rowsPerPage,true,"","","","",true);s()}));var P=OAT.Dom.create("label");OAT.addTextNode(P,self.translations.GXPL_QViewerJSRestoreDefaultView);P.htmlFor="pivot_checkbox_restoreview";F.appendChild(P);OAT.Dom.append([q,F]);a.push(q)}var N=OAT.Dom.create("div");N.setAttribute("class","last_div_popup");OAT.distinctDivs(r,N);a.push(_);a.push(N);OAT.Dom.append(a);if(r.grid.isSD){setTimeout((function(){var e=window.innerWidth;var r=jquery(".oat_winrect_container")[0].clientWidth;if(r==0){var t=jquery(".oat_winrect_container").length;r=jquery(".oat_winrect_container")[t-1].clientWidth}if(r<220){r=220}var i=(e-r)/2+jquery(window).scrollLeft();jquery(".oat_winrect_container").css({left:i+"px",width:r+"px"})}),50)}};OAT.distinctDivs=function(e,r){var t=e.grid.columns.length-1-e.number;var i=e.container.parentNode.cellIndex;if(i>-1){t=i}else{t=e.number}var a=function(e,r,t){var i=OAT.Dom.create("div");var a=OAT.Dom.create("input");var s=OAT.Dom.create("label");OAT.addTextNode(s,e);s.htmlFor=r;OAT.addImageNode(i,t?"check_box":"check_box_outline_blank","");i.appendChild(s);return[i,a]};var s=function(r,i){var a="pop";if(r){OAT.actualizeBlackList("pop",e.grid,t,i,e.grid.serverPaging)}else{a="push";OAT.actualizeBlackList("push",e.grid,t,i,e.grid.serverPaging)}var s=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",s,{op:a,values:i});OAT.onFilteredChangedEventHandle(e,t)};var n=function(){var i=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",i,{op:"all",values:[]});OAT.onFilteredChangedEventHandle(e,t);OAT.distinctDivs(e,r)};var f=function(){var i=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",i,{op:"none",values:[]});OAT.onFilteredChangedEventHandle(e,t);OAT.distinctDivs(e,r)};var l=function(){var i=OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t];self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",i,{op:"reverse",values:[]});OAT.distinctDivs(e,r);OAT.onFilteredChangedEventHandle(e,t)};var o=function(){self.getValuesForColumn(e.grid.UcId,t,this.value)};OAT.Dom.clear(r);var u=OAT.Dom.create("div");u.setAttribute("class","div_buttons_popup");var c=document.createElement("button");c.textContent=self.translations.GXPL_QViewerJSAll;c.setAttribute("class","btn");jquery(c).click(n);var v=document.createElement("button");v.textContent=self.translations.GXPL_QViewerJSNone;v.setAttribute("class","btn");jquery(v).click(f);var d=document.createElement("button");d.textContent=self.translations.GXPL_QViewerJSReverse;d.setAttribute("class","btn");jquery(d).click(l);OAT.Dom.append([u,c,v,d],[r,u]);var h=OAT.Dom.create("div");h.setAttribute("class","div_filter_input");OAT.addImageNode(h,"search","");var p=document.createElement("input");p.textContent="none";p.setAttribute("class","search_input");p.setAttribute("type","text");p.setAttribute("label",self.translations.GXPL_QViewerSearch);p.setAttribute("title",self.translations.GXPL_QViewerSearch);p.setAttribute("placeholder",self.translations.GXPL_QViewerSearch);p.setAttribute("id",e.grid.UcId+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t]);jquery(p).keyup(o);OAT.Dom.append([h,p],[r,h]);var m=OAT.Dom.create("div");var T=OAT_JS.grid.getCantDifferentValues(e.grid.UcId,t);for(var A=0;A<T;A++){var y=OAT_JS.grid.getDifferentValues(e.grid.UcId,t,A);if(y){var w=y.value;var O=y.pict_value;if(y.value=="#NuN#"||O.trimpivot()==""){O=O+"Â "}O=O.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(O.length>33){var g=O.substring(32,O.length).trimpivot().length>0?"...":"";O=O.substring(0,32)+g}O=O.replace(/ /g,"Â ")+"Â Â Â Â Â ";var _=y.checked;var b=a(O,"pivot_distinct_"+A,_);b[0].setAttribute("value",w);m.appendChild(b[0]);var x=_?"check_item_img":"uncheck_item_img";if(e.grid.isSD){var x=_?"check_item_img_small":"uncheck_item_img_small"}b[0].setAttribute("class",x);OAT.Dom.attach(b[0],"click",(function(){var r="check_item_img";var t="uncheck_item_img";if(e.grid.isSD){r="check_item_img_small";t="uncheck_item_img_small"}var i=!(this.getAttribute("class")===r);var a=this.getAttribute("class")===r?t:r;this.setAttribute("class",a);jquery(this).find("i")[0].textContent=i?"check_box":"check_box_outline_blank";s(i,this.getAttribute("value"))}))}}if(OAT_JS.grid.getCantDifferentValues(e.grid.UcId,t)<=9){m.setAttribute("class","pivot_popup_auto")}else{m.setAttribute("class","pivot_popup_fix")}m.setAttribute("ucid",e.grid.UcId);m.setAttribute("columnnumber",t);m.setAttribute("id","values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[t]);r.appendChild(m)};OAT.appendNewPairToPopUp=function(e,r,t,a,s,n){var f=function(e,r,t){var i=OAT.Dom.create("div");var a=OAT.Dom.create("input");var s=OAT.Dom.create("label");OAT.addTextNode(s,e);s.htmlFor=r;OAT.addImageNode(i,t?"check_box":"check_box_outline_blank","");i.appendChild(s);return[i,a]};var l=function(r,i){var a="pop";if(!r){a="push"}self.getDataForTable(e.grid.UcId,1,e.grid.rowsPerPage,true,"","",n,{op:a,values:i});OAT.onFilteredChangedEventHandle(e,t)};var s=s;if(r=="#NuN#"){s="Â "}s=s.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(s.length>33){var o=s.substring(32,s.length).trimpivot().length>0?"...":"";s=s.substring(0,32)+o}s=s.replace(/ /g,"Â ")+"Â Â Â Â Â ";var u=f(s,"pivot_distinct_"+i,a);u[0].setAttribute("value",r);var c=jquery("#values_"+e.grid.UcId+"_"+n)[0];c.appendChild(u[0]);var v=a;var d=v?"check_item_img":"uncheck_item_img";if(e.grid.isSD){var d=v?"check_item_img_small":"uncheck_item_img_small"}u[0].setAttribute("class",d);OAT.Dom.attach(u[0],"click",(function(){var r="check_item_img";var t="uncheck_item_img";if(e.grid.isSD){r="check_item_img_small";t="uncheck_item_img_small"}var i=!(this.getAttribute("class")===r);var a=this.getAttribute("class")===r?t:r;jquery(this).find("i")[0].textContent=i?"check_box":"check_box_outline_blank";this.setAttribute("class",a);l(i,this.getAttribute("value"))}))};OAT.removeAllPairsFromPopUp=function(e,r,t){var i="check_item_img";var a="uncheck_item_img";if(e.grid.isSD){i="check_item_img_small";a="uncheck_item_img_small"}jquery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).find("."+i).remove();jquery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).find("."+a).remove();jquery(".last_div_popup ."+i).remove();jquery(".last_div_popup ."+a).remove();if(t){jquery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).removeClass("pivot_popup_auto");jquery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).addClass("pivot_popup_fix")}else{jquery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).removeClass("pivot_popup_fix");jquery("#values_"+e.grid.UcId+"_"+OAT_JS.grid.gridData[e.grid.UcId].columnDataField[r]).addClass("pivot_popup_auto")}};OAT.onFilteredChangedEventHandle=function(e,r){var t=e.dataField;var i=r;for(var a=0;a<e.grid.columns.length;a++){if(t==e.grid.columns[a].getAttribute("dataField"))i=a}return OAT_JS.grid.setFilterChangedWhenServerPagination(e.grid.UcId,e.grid.columns[i])};OAT.setClickEventHandlers=function(e,r,t,i,a,s){var n=jquery(r).find("#span_txt_pivot")[0];if(n){jquery(r).data("itemValue",t);jquery(r).data("numberMorD",a);jquery(r).data("itemInfo",s);jquery(n).data("itemValue",t);jquery(n).data("typeMorD",i);jquery(n).data("numberMorD",a);jquery(n).data("itemInfo",s);var f=e.grid.QueryViewerCollection[e.grid.IdForQueryViewerCollection];var l=true;for(var o=0;o<f.Metadata.Axes.length;o++){if(e.grid.TableDataFilds[a]==f.Metadata.Axes[o].DataField){l=f.Metadata.Axes[o].RaiseItemClick}}for(var o=0;o<f.Metadata.Data.length;o++){if(e.grid.TableDataFilds[a]==f.Metadata.Data[o].DataField){l=f.Metadata.Data[o].RaiseItemClick}}if(f.ItemClick&&l){n.onclick=function(){OAT.onClickEventHandle(e,this);if(OAT_JS.grid.gridData[e.grid.UcId].selection.Allow){OAT.onClickSelectNode(r,e)}};n.classList.add("gx-qv-clickable-element")}else if(OAT_JS.grid.gridData[e.grid.UcId].selection.Allow){n.onclick=function(){OAT.onClickSelectNode(r,e)}}}};OAT.onClickEventHandle=function(e,r){OAT.PreClickHandle(e,r)};OAT.PreClickHandle=function(e,r){OAT_JS.grid.lastCallData={self:e,elemvalue:r};if(e.grid.HideDataFilds.length){OAT_JS.grid.requestDataSynForTable(e.grid.IdForQueryViewerCollection)}else{OAT.ClickHandle(e,r)}};OAT.ClickHandle=function(e,r,t){if(e.grid.HideDataFilds.length){var i=e.grid.IdForQueryViewerCollection;var a=t;e.grid.allRowsPivot=[];e.grid.allFullRowsPivot=[];var s=a.split("<Record>");for(var n=1;n<s.length;n++){var f=[];var l=[];for(var o=0;o<e.grid.TableDataFilds.length;o++){f[o]="#NuN#";var u=s[n].split("<"+e.grid.TableDataFilds[o]+">");if(u.length>1){var c=u[1].split("</"+e.grid.TableDataFilds[o]+">");f[o]=c[0];l[o]=f[o]}else{if(s[n].indexOf("<"+e.grid.TableDataFilds[o]+"/>")>=0){f[o]="";l[o]=""}else{f[o]="#NuN#";l[o]="#NuN#"}}}e.grid.allRowsPivot.push(f);for(var o=0;o<e.grid.HideDataFilds.length;o++){var u=s[n].split("<"+e.grid.HideDataFilds[o]+">");if(u.length>1){var c=u[1].split("</"+e.grid.HideDataFilds[o]+">");l[l.length+o]=c[0]}else{if(s[n].indexOf("<"+e.grid.HideDataFilds[o]+"/>")>=0){l[l.length+o]=""}else{l[l.length+o]="#NuN#"}}}e.grid.allFullRowsPivot.push(l)}}var v=[];var d=jquery(r).data("itemValue");var h=jquery(r).data("typeMorD");var p=jquery(r).data("numberMorD");var m=jquery(r).data("itemInfo");var T=OAT.IsNodeSelected(e.cells[p].html);var A='<DATA><ITEM type="'+h+'" ';A=A+'name="'+e.grid.columns[p].getAttribute("name")+'" ';A=A+'displayName="'+e.grid.columns[p].getAttribute("displayName")+'" ';A=A+'selected="'+T.toString()+'" ';A=A+'location="rows">';A=A+d;A=A+"</ITEM>";A=A+"<CONTEXT>";A=A+"<RELATED>";for(var n=0;n<e.grid.rows[m].cells.length;n++){A=A+'<ITEM name="'+e.grid.columns[n].getAttribute("name")+'">';A=A+"<VALUES";var y=false;var w="";if(e.grid.rows[m].cells[n].options.value!="#NuN#"){w=w+"<VALUE>"+e.grid.rows[m].cells[n].options.value+"</VALUE>"}else{y=true}v.push(e.grid.rows[m].cells[n].options.value);if(y){A=A+' Null="true"'}A=A+">"+w;A=A+"</VALUES>";A=A+"</ITEM>"}if(e.grid.HideDataFilds.length){var O=function(e,r){for(var t=0;t<e.length;t++){if(e[t]!=undefined&&e[t]!=r[t]){return false}}return true};for(var g=0;g<e.grid.allFullRowsPivot.length;g++){if(O(v,e.grid.allFullRowsPivot[g])){for(var _=0;_<e.grid.HideDataFilds.length;_++){A=A+'<ITEM name="'+e.grid.OrderFildsHidden[_]+'">';A=A+"<VALUES";var y=false;var w="";if(e.grid.rows[m].cells[n].options.value!="#NuN#"){w=w+"<VALUE>"+e.grid.allFullRowsPivot[g][_+e.grid.rows[m].cells.length]+"</VALUE>"}else{y=true}if(y){A=A+' Null="true"'}A=A+">"+w;A=A+"</VALUES>";A=A+"</ITEM>"}}}}A=A+"</RELATED>";A=A+"<FILTERS>";A=A+"</FILTERS>";A=A+"</CONTEXT>";A=A+"</DATA>";var i=e.grid.IdForQueryViewerCollection;OAT_JS.grid.fireOnItemClickEvent(e.grid.QueryViewerCollection[i],A,false)};OAT.onClickSelectNode=function(e,r){var t=jquery(e).data("itemValue");var i=jquery(e).data("numberMorD");var a=jquery(e).data("itemInfo");var s=OAT_JS.grid.gridData[r.grid.UcId].columnDataField.indexOf(r.grid.TableDataFilds[i]);if(OAT_JS.grid.gridData[r.grid.UcId].selection.Allow){OAT.SelectNodes(r,t,false,s,a)}};OAT.SelectNodes=function(e,r,t,i,a,s,n){if(a>=0){var f=jquery("#"+e.grid.controlName+" tbody").find("tr")[a];if(OAT.IsNodeSelected(jquery(f).find("td")[i])){OAT.ClearSelectedNodes(jquery(e.grid.html));OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode=[]}else{if(!t){OAT.SetSelectedNodeBackgroundColor(jquery(f).find("td")[i],e.grid.selection.Color,jquery(e.grid.html));OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode=[];OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode[0]={value:r,dataField:OAT_JS.grid.gridData[e.grid.UcId].columnDataField[i],rowData:[OAT_JS.grid.gridData[e.grid.UcId].rowsData[a]],clicked:true}}else{OAT.SetNodeBackgroundColor(jquery(f).find("td")[i],e.grid.selection.Color)}if(OAT_JS.grid.gridData[e.grid.UcId].selection.EntireLine){for(var l=0;l<e.grid.rows[a].cells.length;l++){if(l!=i){OAT.SetNodeBackgroundColor(jquery(f).find("td")[l],OAT_JS.grid.gridData[e.grid.UcId].selection.Color)}}}}}else{if(!t)OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode[s]={value:r,dataField:OAT_JS.grid.gridData[e.grid.UcId].columnDataField[i],rowData:[],clicked:false,conditions:n};for(var o=0;o<jquery("#"+e.grid.controlName+" tbody").find("tr").length;o++){var u=e.grid.columnsDataType[e.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[e.grid.UcId].columnDataField[i])];var c=OAT_JS.grid.gridData[e.grid.UcId].rowsData[o][e.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[e.grid.UcId].columnDataField[i])];var v=false;if(u=="real"||u=="integer"){v=parseFloat(r)==c}else{v=c.trim()==r.trim()}if(v){if(OAT.checkConditions(e,OAT_JS.grid.gridData[e.grid.UcId].rowsData[o],n)){var f=jquery("#"+e.grid.controlName+" tbody").find("tr")[o];OAT.SetNodeBackgroundColor(jquery(f).find("td")[i],e.grid.selection.Color,jquery(e.grid.html));OAT_JS.grid.gridData[e.grid.UcId].selection.SelectedNode[s].rowData.push(OAT_JS.grid.gridData[e.grid.UcId].rowsData[o]);if(OAT_JS.grid.gridData[e.grid.UcId].selection.EntireLine){for(var l=0;l<e.grid.rows[o].cells.length;l++){if(l!=i){OAT.SetNodeBackgroundColor(jquery(f).find("td")[l],OAT_JS.grid.gridData[e.grid.UcId].selection.Color)}}}}}}}};OAT.checkConditions=function(e,r,t){var i=true;for(var a=0;a<t.length;a++){var s=OAT_JS.grid.gridData[e.grid.UcId].columnDataField.indexOf(t[a].DataField);var n=e.grid.columnsDataType[e.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[e.grid.UcId].columnDataField[s])];var f=true;if(n=="real"||n=="integer"){f=parseFloat(t[a].Value)==parseFloat(r[s])}else{f=t[a].Value.trim()==r[s].trim()}if(!f){return false}}return i};OAT.RedrawSelectedNode=function(e){if(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode){OAT.ClearSelectedNodes(jquery(e.html));for(var r=0;r<OAT_JS.grid.gridData[e.UcId].selection.SelectedNode.length;r++){if(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].clicked){for(var t=0;t<OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].rowData.length;t++){var i=OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].rowData[t];for(var a=0;a<OAT_JS.grid.gridData[e.UcId].rowsData.length;a++){var s=true;for(var n=0;n<OAT_JS.grid.gridData[e.UcId].rowsData[a].length;n++){if(OAT_JS.grid.gridData[e.UcId].rowsData[a][n]!=i[n])s=false}if(s)OAT.SelectNodes({grid:e},OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].value,true,OAT_JS.grid.gridData[self.UcId].columnDataField.indexOf(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].dataField),a)}}}else{OAT.SelectNodes({grid:e},OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].value,true,OAT_JS.grid.gridData[self.UcId].columnDataField.indexOf(OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].dataField),-1,r,OAT_JS.grid.gridData[e.UcId].selection.SelectedNode[r].conditions)}}}};OAT.gridStateChanged=function(e){return OAT_JS.grid.getStateChange(e.grid.UcId)};OAT.createXMLDimensionInfo=function(e,r){return"<name>"+e.columns[r].getAttribute("name")+"</name> "+"<displayName>"+e.columns[r].getAttribute("displayName")+"</displayName> "+"<description>"+e.columns[r].getAttribute("description")+"</description> "+"<dataField>"+e.columns[r].getAttribute("dataField")+"</dataField> "+"<dataType>"+e.columns[r].getAttribute("dataType")+"</dataType> "+"<summarize>"+e.columns[r].getAttribute("summarize")+"</summarize> "+"<align>"+e.columns[r].getAttribute("align")+"</align> "+"<axis>"+e.columns[r].getAttribute("axis")+"</axis> "};OAT.createXMLMetadata=function(e,r,t){var i='<OLAPCube format="'+"compact"+'" thousandsSeparator="'+","+'" decimalSeparator="'+"."+'" dateFormat="'+"MDY"+'">';for(var a=0;a<=e.grid.columns.length-1;a++){var s=a;i=i+"<OLAPDimension> ";i=i+OAT.createXMLDimensionInfo(e.grid,s);var n=0;for(var f=0;f<e.grid.header.cells.length;f++){if(e.grid.header.cells[f].dataField==e.grid.columns[s].getAttribute("dataField")){n=f}}if(e.grid.header.cells[n].html.style.display=="none"){i=i+"<hidden>true</hidden>"}if(e.grid.columns[s].getAttribute("picture")===""){i=i+"<picture/> "}else{i=i+"<picture>"+e.grid.columns[s].getAttribute("picture")+"</picture> "}if(e.grid.columns[s].getAttribute("picture")===""){i=i+"<format/> "}else{i=i+"<format>"+e.grid.columns[s].getAttribute("format")+"</format> "}if(OAT_JS.grid.gridData[e.grid.UcId].dataFieldOrder==e.grid.columns[s].getAttribute("dataField")){if(OAT_JS.grid.gridData[e.grid.UcId].orderType=="Descending")i=i+"<order>descending</order> ";else i=i+"<order>ascending</order> "}else{i=i+"<order>none</order> "}i=i+"<customOrder/> ";i=i+"<include> ";var l=e.grid.columns[s].getAttribute("dataField");if(e.blackLists[l].state!="none"&&e.blackLists[l].state!="all"){for(var o=0;o<e.blackLists[l].visibles.length;o++){i=i+"<value>"+e.blackLists[l].visibles[o].trimpivot()+"</value> "}}else if(e.blackLists[l].state!="none"){for(var o=0;o<e.differentValues[l].length;o++){i=i+"<value>"+e.differentValues[l][o].trimpivot()+"</value> "}}i=i+"<value>TOTAL</value> </include> <collapse/> ";i=i+"<hide> ";var l=e.grid.columns[s].getAttribute("dataField");if(e.blackLists[l].state!="none"&&e.blackLists[l].state!="all"){for(var o=0;o<e.blackLists[l].hiddens.length;o++){i=i+"<value>"+e.blackLists[l].hiddens[o].trimpivot()+"</value> "}}else if(e.blackLists[l].state!="all"){for(var o=0;o<e.differentValues[l].length;o++){i=i+"<value>"+e.differentValues[l][o].trimpivot()+"</value> "}}i=i+"</hide> ";var u=e.grid.columnsDataType.length-1-s;try{if(e.grid.header.cells[u]!=undefined){if(e.grid.header.cells[u].html.style.display===""){i=i+"<condition>table</condition> ";i=i+"<filterbar>no</filterbar> "}else{i=i+"<condition>none</condition> ";i=i+"<filterbar>yes</filterbar> "}}}catch(e){}var c=0;var v=false;var d=-1;for(var h=0;e.columnDataField&&h<e.columnDataField.length&&!v;h++){var p=e.columnDataField[h];var m=false;for(var T=0;T<e.grid.columns.length;T++){if(p==e.grid.columns[T].getAttribute("dataField"))m=e.grid.columns[T].getAttribute("visible").toLowerCase()=="never"}if(!m)c=c+1;if(p==e.grid.columns[s].getAttribute("dataField")){v=true;if(!m)d=c}}if(d>0)i=i+"<position>"+d+"</position> ";else i=i+"<position/>";i=i+"<restoreview>no</restoreview> ";i=i+" </OLAPDimension>"}i=i+"</OLAPCube>";return i};OAT.ExportToPdf=function(e,r){var t=[];for(var i=0;i<1;i++){var a=jquery("#"+e.grid.controlName+" tr")[i];for(var s=0;s<a.children.length;s++){if(a.children[s].style.display=="none"){t.push(s)}}}var n=20+jquery("#"+e.grid.controlName+" tr").length*30+5;if(n<841){n=841}var f=0;var a=jquery("#"+e.grid.controlName+" tr")[0].children.length-t.length;f=20+a*(30+65)+5;if(f<595){f=595}var l=[];for(var i=0;i<jquery("#"+e.grid.controlName+" tr").length;i++){var a=jquery("#"+e.grid.controlName+" tr")[i];var o=0;for(var s=0;s<a.children.length;s++){var u=a.children[s].textContent;var c=a.children[s].getAttribute("hidden");if(a.children[s].style.display!="none"){if(c===null){if(l[o]==undefined){l[o]=30}var v=0;for(var d=0;d<u.length;d++){if(u.charCodeAt(d)>1e3){v++}}if(v===0){if(u.length>14){if(u.length*1.68>l[o]){l[o]=u.length*1.68}}}else{var h=v*2.8+(u.length-v)*1.68;if(h>l[o]){l[o]=h}}o=o+1}}}}var p=0;for(var i=0;i<l.length;i++){p=p+l[i]*2.5+65}p=20+p+5;if(p>f){f=p}var m=function(e,r){var t=0;for(var i=0;i<e;i++){t=t+r[i]}return t};var T;if(f<=n){T=new jsPDF("portrait","mm","a4",false,f,792)}else{T=new jsPDF("landscape","mm","a4",false,f,792)}T.setFontSize(8);T.line(18,13,20+m(jquery("#"+e.grid.controlName+" tr")[0].children.length-t.length,l),13);var A=-1;var y=1;var w=Math.min(jquery("#"+e.grid.controlName+" tr").length-(y-1)*26,26);for(var i=0;i<jquery("#"+e.grid.controlName+" tr").length;i++){A++;var a=jquery("#"+e.grid.controlName+" tr")[i];var o=0;for(var s=0;s<a.children.length;s++){if(a.children[s].style.display!="none"){T.line(18+m(o,l),13,18+m(o,l),23+(w-1)*10);var u=OAT.removeIconFont(a.children[s].textContent);var c=a.children[s].getAttribute("hidden");var O=[];if(u.charCodeAt(0)>1e3){for(var g=0;g<u.length;g++){O[g]=OAT.getCharacterImg(u.charCodeAt(g))}}else{var _=-1;for(var d=1;d<u.length;d++){if(u.charCodeAt(d)>1e3){_=d;break}}if(_>0){var b=u.substring(0,_);var x=0;for(var g=_;g<u.length;g++){O[x]=OAT.getCharacterImg(u.charCodeAt(g));x++}u=b}}var S=false;T.setTextColor(0,0,0);T.setFontStyle("normal");var I=!isNaN(parseFloat(u));var k=T.getStringUnitWidth(u);if(a.children[s].getAttribute("style")!=undefined&&a.children[s].getAttribute("style")!=null){var q=a.children[s].getAttribute("style").split(";");for(var F=0;F<q.length;F++){var P=q[F].split(":");if(P[0].replace(/^\s+|\s+$/g,"")==="color"){var N=P[1].replace(/^\s+|\s+$/g,"");N=N.substring(4,N.length);N=N.substring(0,N.length-1);T.setTextColor(parseInt(N.split(",")[0]),parseInt(N.split(",")[1]),parseInt(N.split(",")[2]))}else if(P[0].replace(/^\s+|\s+$/g,"")==="text-align"){I=P[1].replace(/^\s+|\s+$/g,"")=="right"}else if(P[0].replace(/^\s+|\s+$/g,"")==="font-style"){T.setFontStyle("italic")}else if(P[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(P[1].replace(/^\s+|\s+$/g,"")==="bold"){T.setFontStyle("bold")}}else if(P[0].replace(/^\s+|\s+$/g,"")==="background-color"){var N=P[1].replace(/^\s+|\s+$/g,"");N=N.substring(4,N.length);N=N.substring(0,N.length-1);T.setFillColor(parseInt(N.split(",")[0]),parseInt(N.split(",")[1]),parseInt(N.split(",")[2]));S=true}else if(P[0].replace(/^\s+|\s+$/g,"")==="border-color"){var N=P[1].replace(/^\s+|\s+$/g,"");N=N.substring(4,N.length);N=N.substring(0,N.length-1);T.setDrawColor(parseInt(N.split(",")[0]),parseInt(N.split(",")[1]),parseInt(N.split(",")[2]))}}}if(S&&s==a.children.length-1){T.rect(18+m(o,l),23+(A-1)*10,32,10,"FD")}else if(S){T.rect(18+m(o,l),23+(A-1)*10,30,10,"FD")}T.setDrawColor(0,0,0);T.setFontSize(8);if(c===null){var D=0;if(u.charCodeAt(0)<1e3){D=u.length+2;if(I){T.text(20+m(o+1,l)-k*3-4,20+A*10,u)}else{T.text(20+m(o,l),20+A*10,u)}}if(O.length>0){for(var g=0;g<O.length;g++){T.addImage(O[g],"JPEG",20+m(o,l)+D+g*2.5,20+A*10-2.5,2.5,2.5)}}}o=o+1}}T.line(20+m(a.children.length-t.length,l),13,20+m(a.children.length-t.length,l),23+(w-1)*10);T.line(18,23+A*10,20+m(a.children.length-t.length,l),23+A*10);if(A>=25){T.setDrawColor(0,0,0);y++;w=Math.min(jquery("#"+e.grid.controlName+" tr").length-1-(y-1)*26+1,26);A=-1;T.addPage();T.line(18,13,20+m(jquery("#"+e.grid.controlName+" tr")[0].children.length-t.length,l),13)}}isSD=OAT.isSD();if(OAT.isSafari()||isSD){T.output("dataurlnewwindow")}else{T.save(r+".pdf")}};OAT.ExportToExcel=function(e,r){var t="<table><tbody>";for(var i=0;i<jquery("#"+e.grid.controlName+" tr").length;i++){t=t+"<tr>";var a=jquery("#"+e.grid.controlName+" tr")[i];for(var s=0;s<a.children.length;s++){var n;if(i===0){n=a.children[s].getAttribute("title_v");if(n===undefined){n=OAT.removeIconFont(a.children[s].textContent).trim()}}else{n=a.children[s].getAttribute("title");if(n===undefined){n=a.children[s].textContent}}n=n.replace(/\u00A0/g," ");var f=a.children[s].getAttribute("hidden");if(a.children[s].style.display!="none"){if(f===null){var l=a.children[s].getAttribute("rowspan");var o=a.children[s].getAttribute("colspan");var u="";if(a.children[s].getAttribute("style")!=undefined&&a.children[s].getAttribute("style")!=null){u=' style="'+a.children[s].getAttribute("style")+'" '}if(l===null&&o===null){t=t+"<td "+u+">"+n+"</td>"}else if(o===null){t=t+"<td "+u+' rowspan="'+l+'">'+n+"</td>"}else if(l===null){t=t+"<td "+u+' colspan="'+o+'">'+n+"</td>"}else{t=t+"<td "+u+' colspan="'+o+'" rowspan="'+l+'">'+n+"</td>"}}}}t=t+"</tr>"}t=t+"</tbody></table>";var c='<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></head><body>';t=c+t+"</body>";var v=t;isSD=OAT.isSD();if(OAT.isSafari()||isSD){window.open("data:application/vnd.ms-excel,"+encodeURIComponent(v))}else{return v}};OAT.ExportToExcel2010=function(e,r,t,i,a){function s(e){var r=e.toString(16);return r.length==1?"0"+r:r}function n(e,r,t){return s(e)+s(r)+s(t)}dataTable=[];var f=jquery("#"+e.grid.controlName+" tr").length;if(t!=undefined&&t){f=1}var l=[];for(var o=0;o<f;o++){dataRow=[];var u=jquery("#"+e.grid.controlName+" tr")[o];for(var c=0;c<u.children.length;c++){var v=u.children[c].textContent;var d=u.children[c].getAttribute("hidden");if(u.children[c].style.display!="none"){if(d===null){var h=u.children[c].getAttribute("rowspan");var p=u.children[c].getAttribute("colspan");var m={value:v};if(u.children[c].getAttribute("style")!=undefined&&u.children[c].getAttribute("style")!=null){var T=u.children[c].getAttribute("style").split(";");for(var A=0;A<T.length;A++){var y=T[A].split(":");if(y[0].replace(/^\s+|\s+$/g,"")==="color"){var w=y[1].replace(/^\s+|\s+$/g,"");w=w.substring(4,w.length);w=w.substring(0,w.length-1);var O=n(parseInt(w.split(",")[0]),parseInt(w.split(",")[1]),parseInt(w.split(",")[2]));m.fontColor=O}else if(y[0].replace(/^\s+|\s+$/g,"")==="text-align"){var g=y[1].replace(/^\s+|\s+$/g,"");m.hAlign=g}else if(y[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(y[1].replace(/^\s+|\s+$/g,"")==="italic"){m.italic=1}}else if(y[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(y[1].replace(/^\s+|\s+$/g,"")==="bold"){m.bold=1}}else if(y[0].replace(/^\s+|\s+$/g,"")==="background-color"){var w=y[1].replace(/^\s+|\s+$/g,"");w=w.substring(4,w.length);w=w.substring(0,w.length-1);var O=n(parseInt(w.split(",")[0]),parseInt(w.split(",")[1]),parseInt(w.split(",")[2]));m.fill=O}}}if(h===null&&p===null){dataRow.push(m)}else if(p===null){m.rowSpan=parseInt(h);dataRow.push(m)}else if(h===null){m.colSpan=parseInt(p);dataRow.push(m)}else{m.colSpan=parseInt(p);m.rowSpan=parseInt(h);dataRow.push(m)}}}else{l.push(c)}}dataTable.push(dataRow)}if(t!=undefined&&t){for(var o=0;o<i.length;o++){dataRow=[];for(var c=0;c<i[o].length;c++){if(l.indexOf(c)==-1){var v=OAT.ApplyPictureValue(i[o][c],"",OAT_JS.grid.gridData[a].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c]);var _=OAT.Dom.create("td");_.setAttribute("title",v);var b=i[o][c];if(e.grid.columnsDataType[c]=="date"){b=OAT.ApplyPictureValue(i[o][c],e.grid.columnsDataType[c],OAT_JS.grid.gridData[a].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c])}_=OAT.applyFormatValues(_,b,e.grid.columnsDataType,c,OAT_JS.grid.gridData[a].rowsMetadata.formatValues,OAT_JS.grid.gridData[a].rowsMetadata.conditionalFormatsColumns,OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomFormat);if(e.grid.columnsDataType[c]!="character"&&e.grid.columnsDataType[c]!="guid"||e.grid.columnsDataType[c]==="date"){_.style.textAlign="right"}var m={value:v};if(!isNaN(parseFloat(v))&&e.grid.columnsDataType[c]!="character"&&e.grid.columnsDataType[c]!="date"&&e.grid.columnsDataType[c]!="datetime"&&e.grid.columnsDataType[c]!="guid"){m={value:parseFloat(v)+""}}if(_.getAttribute("style")!=undefined&&_.getAttribute("style")!=null){var T=_.getAttribute("style").split(";");for(var A=0;A<T.length;A++){var y=T[A].split(":");if(y[0].replace(/^\s+|\s+$/g,"")==="color"){var w=y[1].replace(/^\s+|\s+$/g,"");w=w.substring(4,w.length);w=w.substring(0,w.length-1);var O=n(parseInt(w.split(",")[0]),parseInt(w.split(",")[1]),parseInt(w.split(",")[2]));m.fontColor=O}else if(y[0].replace(/^\s+|\s+$/g,"")==="text-align"){var g=y[1].replace(/^\s+|\s+$/g,"");m.hAlign=g}else if(y[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(y[1].replace(/^\s+|\s+$/g,"")==="italic"){m.italic=1}}else if(y[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(y[1].replace(/^\s+|\s+$/g,"")==="bold"){m.bold=1}}else if(y[0].replace(/^\s+|\s+$/g,"")==="background-color"){var w=y[1].replace(/^\s+|\s+$/g,"");w=w.substring(4,w.length);w=w.substring(0,w.length-1);var O=n(parseInt(w.split(",")[0]),parseInt(w.split(",")[1]),parseInt(w.split(",")[2]));m.fill=O}}}if(e.grid.columnsDataType[c]=="real"||e.grid.columnsDataType[c]=="integer"){m.formatCode=OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c].replace(/Z/g,"#").replace(/9/g,"0")}if(e.grid.columnsDataType[c]=="date"){if(OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c]!=undefined){var x=OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c].trim();var S=OAT_JS.grid.gridData[a].rowsMetadata.defaultPicture.getAttribute("dateFormat");if(x=="99/99/99"){m.formatCode="mm/dd/yy";if(S=="DMY")m.formatCode="dd/mm/yy";if(S=="YMD")m.formatCode="yy/mm/dd"}if(x=="99/99/9999"){m.formatCode="mm/dd/yyyy";if(S=="DMY")m.formatCode="dd/mm/yyyy";if(S=="YMD")m.formatCode="yyyy/mm/dd"}if(x=="9999/99/99"){m.formatCode="yyyy/mm/dd";if(S=="YDM")m.formatCode="yyyy/dd/mm";if(S=="YMD")m.formatCode="yyyy/mm/dd"}}}if(e.grid.columnsDataType[c]=="datetime"){if(OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c]!=undefined){var x=OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c].trim().split(" ");var I=OAT_JS.grid.gridData[a].rowsMetadata.defaultPicture.getAttribute("dateFormat");if(x[0]=="99/99/99"){if(I=="DMY")m.formatCode="dd/mm/yy";if(I=="YMD")m.formatCode="yy/mm/dd"}if(x[0]=="99/99/9999"){if(I=="DMY")m.formatCode="dd/mm/yyyy";if(I=="YMD")m.formatCode="yyyy/mm/dd"}if(x[0]=="9999/99/99"){if(I=="YDM")m.formatCode="yyyy/dd/mm";if(I=="YMD")m.formatCode="yyyy/mm/dd"}}}m.genexusType=e.grid.columnsDataType[c];m.genexusPicture=OAT_JS.grid.gridData[a].rowsMetadata.forPivotCustomPicture[c];dataRow.push(m)}}dataTable.push(dataRow)}}var k=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:false,worksheets:[{data:dataTable,name:"Sheet 1"}]});isSD=OAT.isSD();if(OAT.isSafari()||isSD){window.location=k.href()}else{var q=atob(k.base64);function D(e){return e.charCodeAt(0)}var F=Array.prototype.map.call(q,D);var P=new Uint8Array(F);var N=new Blob([P],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(N,r+".xlsx")}};OAT.ExportToXML=function(e,r){var t=[];for(var i=0;i<1;i++){var a=jquery("#"+e.grid.controlName+" tr")[i];for(var s=0;s<a.children.length;s++){if(a.children[s].style.display=="none"){t.push(s)}}}var n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><EXPORT format="XML" type="flat">';n=n+"<METADATA>";for(var f=0;f<e.grid.columns.length;f++){if(t.indexOf(f)==-1){var l="row";n=n+"<OLAPDimension ";n=n+'name="'+e.grid.columns[f].getAttribute("dataField")+'" ';n=n+'label="'+e.grid.columns[f].getAttribute("displayName")+'" ';n=n+'picture="'+e.grid.columns[f].getAttribute("picture")+'" ';n=n+'datatype="'+e.grid.columns[f].getAttribute("dataType")+'" ';n=n+'showAll="false" ';n=n+'position="'+l+'">';var o=[];for(var i=0;i<e.grid.rows.length;i++){if(o.findIndex(e.grid.rows[i].cells[f].options.value)===-1){n=n+"<VALUE CHECKED=";if(e.grid.conditions[f].blackList.findIndex(e.grid.rows[i].cells[f].options.value)===-1){o.push(e.grid.rows[i].cells[f].options.value);n=n+'"true"'}else{n=n+'"false"'}n=n+' COLLAPSED="false">';var u=e.grid.rows[i].cells[f].options.value;if(!isNaN(parseFloat(e.grid.rows[i].cells[f].options.value))){if(data!=undefined){for(var c=0;c<data.length;c++){if(data[c]!=undefined){for(var v=0;v<data[c].length;v++){if(parseFloat(data[c][v])!=undefined&&!isNaN(data[c][v])){if(parseFloat(data[c][v])===parseFloat(e.grid.rows[i].cells[f].options.value)){u=data[c][v]}}}}}}}n=n+u+"</VALUE>"}}n=n+"</OLAPDimension>"}}for(var f=0;f<measures.length;f++){n=n+"<OLAPMeasure ";n=n+'name="'+measures[f].getAttribute("dataField")+'" ';n=n+'label="'+measures[f].getAttribute("displayName")+'" ';n=n+'picture="'+measures[f].getAttribute("picture")+'" ';n=n+'datatype="'+measures[f].getAttribute("dataType")+'" ';n=n+'showAll="true" ';n=n+'aggregator="sum"/>'}n=n+"</METADATA>";n=n+"<FLATDATA>";if(data!=undefined){for(var i=0;i<data.length;i++){n=n+"<ROW ";for(var f=0;f<data[0].length;f++){if(t.indexOf(f)==-1){var u=data[i][f];n=n+e.grid.columns[f].getAttribute("dataField")+'="'+u+'" '}}n=n+"/>"}}else{for(var i=0;i<e.grid.rows.length;i++){n=n+"<ROW ";for(var f=0;f<e.grid.rows[0].cells.length;f++){var u="";u=e.grid.rows[i].cells[f].options.value;if(!isNaN(parseFloat(e.grid.rows[i].cells[f].options.value))){if(data!=undefined){for(var c=0;c<data.length;c++){if(data[c]!=undefined){for(var v=0;v<data[c].length;v++){if(parseFloat(data[c][v])!=undefined&&!isNaN(data[c][v])){if(parseFloat(data[c][v])===parseFloat(e.grid.rows[i].cells[f].options.value)){u=data[c][v]}}}}}}}n=n+e.grid.columns[f].getAttribute("dataField")+'="'+u+'" '}n=n+"/>"}}n=n+"</FLATDATA>";n=n+"<HTML>";n=n+"<HEAD>";n=n+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';n=n+"<STYLE>";n=n+".odd {background-color: #FEFEFE; font-family: Verdana; font-size: 10pt;}\n";n=n+".event {background-color: #EBEBEB; font-family: Verdana; font-size: 10pt;}\n";n=n+".even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\n";n=n+"tr {border-left: 1px solid #BBBBBB; border-right: 1px solid #BBBBBB; line-height: 22px;}\n";n=n+"table {border-collapse: collapse;}\n";n=n+"</STYLE>";n=n+"</HEAD>";n=n+"<BODY>";for(var i=0;i<jquery("#"+e.grid.controlName+" tr").length;i++){n=n+"<TR>";var a=jquery("#"+e.grid.controlName+" tr")[i];for(var s=0;s<a.children.length;s++){var d=OAT.removeIconFont(a.children[s].textContent).trim();var h=a.children[s].getAttribute("hidden");if(a.children[s].style.display!="none"){if(h===null){var p=a.children[s].getAttribute("rowspan");var m=a.children[s].getAttribute("colspan");var T="";if(a.children[s].getAttribute("style")!=undefined&&a.children[s].getAttribute("style")!=null){T=' style="'+a.children[s].getAttribute("style")+'" '}var A="";if(a.getAttribute("class")!=undefined&&a.getAttribute("class")!=null){A=' class="'+a.getAttribute("class")+'" '}if(p===null&&m===null){n=n+"<TD "+A+" "+T+" >"+d+"</TD>"}else if(m===null){n=n+"<TD "+A+" "+T+' rowspan="'+p+'">'+d+"</TD>"}else if(p===null){n=n+"<TD "+A+" "+T+' colspan="'+m+'">'+d+"</TD>"}else{n=n+"<TD "+A+" "+T+' colspan="'+m+'" rowspan="'+p+'">'+d+"</TD>"}}}}n=n+"</TR>"}n=n+"</BODY>";n=n+"</HTML>";n=n+"</EXPORT>";var y=OAT.isSD();n=n.replace(/\&/g,"&amp;");if(OAT.isSafari()||y){window.open("data:text/xml,"+encodeURIComponent(n))}else{var w=new Blob([n],{type:"text/xml"});saveAs(w,r+".xml")}};OAT.SaveStateWhenServerPaging=function(e,r){localStorage.setItem(OAT.getURL()+e.grid.controlName+e.grid.query,JSON.stringify({pageSize:e.rowsPerPage,dataFieldOrder:e.dataFieldOrder,orderType:e.orderType,filters:e.filterInfo,blackLists:e.blackLists,columnVisible:e.columnVisible,columnDataField:e.columnDataField}))};OAT.getStateWhenServingPaging=function(e,r){return JSON.parse(localStorage.getItem(OAT.getURL()+e+r))};OAT.getState=function(grid,actualPageSize){if(typeof JSON.retrocycle!=="function"){JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function rez(value){var i,item,name,path;if(value&&typeof value==="object"){if(Object.prototype.toString.apply(value)==="[object Array]"){for(i=0;i<value.length;i+=1){item=value[i];if(item&&typeof item==="object"){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[i]=eval(path)}else{rez(item)}}}}else{for(name in value){if(typeof value[name]==="object"){item=value[name];if(item){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[name]=eval(path)}else{rez(item)}}}}}}})($);return $}}var retrievedObject=localStorage.getItem(OAT.getURL()+grid.controlName+grid.query);var oldState=JSON.retrocycle(JSON.parse(retrievedObject));if(oldState!=null&&oldState.rowsPerPage+" "==actualPageSize+" "){for(var tC=0;tC<grid.columnsDataType.length;tC++){grid.header.cells[tC].html.style.display=oldState.columnDisplay[tC];var numCol=grid.columnsDataType.length-1-tC;var j=0;for(j=0;j<grid.rows.length;j++){grid.rows[j].cells[numCol].html.style.display=oldState.columnDisplay[tC]}}grid.conditions=oldState.conditions;grid.rowsPerPage=oldState.rowsPerPage;return true}else return false};OAT.SaveMetadata=function(e,r){try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+r);localStorage.setItem(OAT.getURL()+r,e)}}catch(e){}};OAT.GetSavedMetadata=function(e){try{if(localStorage.getItem(OAT.getURL()+e)!=null){var r=localStorage.getItem(OAT.getURL()+e);if(r!=undefined&&r!=null){return r}}}catch(e){return""}return""};try{OAT.Loader.featureLoaded("grid")}catch(e){}commonjsGlobal.contains=function(e,r){for(var t=0;t<e.length;t++){if(e[t]===r){return t}}return-1};{Object.defineProperty(exports,"__esModule",{value:true});exports.renderJSPivot=void 0;exports.setPageDataForPivotTable=void 0;exports.setAttributeValuesForPivotTable=void 0;exports.setPivottableDataCalculation=void 0;exports.setDataSynForPivotTable=void 0;exports.setPageDataForTable=void 0;exports.setAttributeForTable=void 0;exports.setDataSynForTable=void 0;exports.getDataXML=void 0;exports.getFilteredDataXML=void 0}function renderJSPivot(e,r,t,i){if(e.RealType!="Table"){e.ServerPaging=false}if(e.RealType=="Table"){e.ServerPagingPivot=false;if(r.AutoRefreshGroup==""){jquery(".oat_winrect_container").remove()}}if(e.RememberLayout&&e.ServerPaging&&e.RealType!="PivotTable"){var a=OAT.getStateWhenServingPaging(e.UcId+"_"+e.ObjectName.replace(/\./g,""),e.ObjectName.replace(/\./g,""));if(!a){renderJSPivotInter(e,r,t,null,i)}else{if(a.pageSize==""){a.pageSize=undefined}e.previousDataFieldOrder=a.dataFieldOrder;e.orderType=a.orderType;renderJSPivotInter(e,r,t,a,i)}}else{if(e.RealType!="Table"){renderJSPivotInter(e,r,t,null,i)}else{e.customFilterInfo="";var s=jquery.parseXML(e.metadata);var n=s.getElementsByTagName("OLAPDimension");var f=false;for(var l=0;l<n.length;l++){n[l].getAttribute("dataField");var o=[];var u=false;for(var c=0;c<n[l].childNodes.length;c++){if(n[l].childNodes[c]!=undefined&&n[l].childNodes[c].localName!=undefined&&n[l].childNodes[c].localName==="include"){u=true;for(var v=0;v<n[l].childNodes[c].childNodes.length;v++){if(n[l].childNodes[c].childNodes[v].localName!=null&&n[l].childNodes[c].childNodes[v].localName.toLowerCase()==="value"){o.push(n[l].childNodes[c].childNodes[v].textContent)}}}}if(!f){if(n[l].getAttribute("order")!=undefined&&n[l].getAttribute("order")!=""){n[l].getAttribute("dataField");n[l].getAttribute("order")=="descending"?"Descending":"Ascending";f=true}}if(u){var d=r[e.UcId].getAttributeValuesSync([n[l].getAttribute("dataField"),1,0,""]);var d=JSON.parse(d);var h=d.NotNullValues;var p=[];for(var m=0;m<o.length;m++){for(var c=0;c<h.length;c++){if(h[c].trimpivot()==o[m].trimpivot()){p.push(h[c]);break}}}if(e.customFilterInfo==""){e.customFilterInfo=[]}var T={DataField:n[l].getAttribute("dataField"),NotNullValues:{DefaultAction:"Exclude",Excluded:"",Included:p},NullIncluded:true};e.customFilterInfo.push(T)}}renderJSPivotInter(e,r,t,null,i)}}}{exports.renderJSPivot=renderJSPivot}function setPageDataForPivotTable(e,r){e.setPageDataForPivotTable(r)}{exports.setPageDataForPivotTable=setPageDataForPivotTable}function setAttributeValuesForPivotTable(e,r){e.setAttributeValuesForPivotTable(r)}{exports.setAttributeValuesForPivotTable=setAttributeValuesForPivotTable}function setPivottableDataCalculation(e,r){e.setPivottableDataCalculation(r)}{exports.setPivottableDataCalculation=setPivottableDataCalculation}function setDataSynForPivotTable(e,r){e.setDataSynForPivotTable(r)}{exports.setDataSynForPivotTable=setDataSynForPivotTable}function setPageDataForTable(e,r){e.setPageDataForTable(r)}{exports.setPageDataForTable=setPageDataForTable}function setAttributeForTable(e,r){e.setAttributeForTable(r)}{exports.setAttributeForTable=setAttributeForTable}function setDataSynForTable(e,r){e.setDataSynForTable(r)}{exports.setDataSynForTable=setDataSynForTable}function getDataXML(e,r){result=e.getDataXML(r);return result}{exports.getDataXML=getDataXML}function getFilteredDataXML(e,r){result=e.getFilteredDataXML(r);return result}{exports.getFilteredDataXML=getFilteredDataXML}var renderJSPivotInter=function(e,r,t,i,a){var s=e.RealType;var n=e.container;var f=e.page;var l=e.content;var o=e.metadata;renderJSPivotInter.dataString=e.data;var u=e.ObjectName;var c=e.ControlName;var v=parseInt(e.PageSize);var d=e.AutoResize;var h=e.DisableColumnSort;var p=e.UcId;var m=e.RememberLayout;renderJSPivotInter.pivotParams=e;renderJSPivotInter.serverPaging=e.ServerPaging;renderJSPivotInter.previousDataFieldOrder=e.previousDataFieldOrder;renderJSPivotInter.previousOrderType=e.orderType;renderJSPivotInter.previousFilters=i?i.filters:undefined;renderJSPivotInter.previousColumnVisible=i?i.columnVisible:undefined;renderJSPivotInter.initialColumnVisible=[];renderJSPivotInter.previousState=i;renderJSPivotInter.customFilterInfo=e.customFilterInfo;renderJSPivotInter.gridCacheSize=e.ServerPagingCacheSize;renderJSPivotInter.hasShowValuesAs=e.metadata.indexOf("showValuesAs")>0;if(e.RealType=="Table"){o=o.replace(/\<OLAPMeasure/g,'<OLAPMeasure axis="" isMeasure="true" ');o=o.replace(/OLAPMeasure/g,"OLAPDimension")}if(e.RealType!="Table"){var T=o.split("<OLAPMeasure");var A=T[0];for(var y=1;y<T.length;y++){var w="";if(T[y].indexOf('isComponent="true"')>-1){w="<OLAPDimension"+T[y].replace(/OLAPMeasure/g,"OLAPDimension")}else{w="<OLAPMeasure"+T[y]}A=A+w}o=A}var O=e.ShowDataLabelsIn=="Rows";if(m==undefined||m=="false"){m=false}try{if(m){var g=OAT.GetSavedMetadata(n.id+u+p+c+s+"metadata");if(g===""){OAT.SaveMetadata(o,n.id+u+p+c+s+"metadata")}else{var _=g.split("OLAPDimension").length===o.split("OLAPDimension").length;var b=g.split("OLAPMeasure").length===o.split("OLAPMeasure").length;var x=g.split("name").length===o.split("name").length;var S=true;if(_&&b&&x){for(var I=1;I<g.split("name").length;I++){var k=g.split("name")[I].substring(2,g.split("name")[I].length).split('"')[0];var q=o.split("name")[I].substring(2,o.split("name")[I].length).split('"')[0];if(k!=q){S=false}}}if(!(_&&b&&x&&S)){if(OAT.isIE()){m=false}else{try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+n.id+u+p+c+s+"metadata");localStorage.removeItem(OAT.getURL()+u+p)}}catch(e){}}}}}}catch(e){}var F=jquery.parseXML(o);renderJSPivotInter.InitMetadata={};renderJSPivotInter.InitMetadata.Metadata=o;renderJSPivotInter.InitMetadata.DataString=renderJSPivotInter.dataString;renderJSPivotInter.InitMetadata.Dimensions=[];renderJSPivotInter.InitMetadata.Conditions=[];renderJSPivotInter.InitMetadata.DataFields=[];renderJSPivotInter.InitMetadata.RowsPerPage=v;var P=F.getElementsByTagName("OLAPDimension");for(var I=0;I<P.length;I++){var N={};N.name=P[I].getAttribute("name");N.displayName=P[I].getAttribute("displayName");N.description=P[I].getAttribute("description");N.dataField=P[I].getAttribute("dataField");var D="";var E=P[I].getAttribute("visible");if(E=="Never"){N.defaultPosition="hidden";N.Visible=false}else{if(E=="No"){N.Visible=false}else{N.Visible=true}N.defaultPosition=P[I].getAttribute("axis");var C=0;D=P[I].getAttribute("canDragToPages")=="true"?"filters;":"";D=D+"rows;columns;hidden"}N.validPosition=D;renderJSPivotInter.InitMetadata.Dimensions.push(N);renderJSPivotInter.InitMetadata.Conditions.push("");renderJSPivotInter.InitMetadata.DataFields.push(N.dataField)}renderJSPivotInter.InitMetadata.Measures=[];var j=F.getElementsByTagName("OLAPMeasure");for(var I=0;I<j.length;I++){var R={};R.name=j[I].attributes.getNamedItem("name").nodeValue;R.displayName=j[I].attributes.getNamedItem("displayName").nodeValue;R.dataField=j[I].attributes.getNamedItem("dataField").nodeValue;R.dataType=j[I].attributes.getNamedItem("dataType").nodeValue;R.Visible=j[I].attributes.getNamedItem("visible").nodeValue.toLowerCase()=="yes";if(j[I].attributes.getNamedItem("visible").nodeValue.toLowerCase()!="never"){R.defaultPosition=j[I].attributes.getNamedItem("axis")?j[I].attributes.getNamedItem("axis"):"data";R.validPosition="data;hidden"}else{R.defaultPosition="hidden";R.validPosition="hidden"}renderJSPivotInter.InitMetadata.Measures.push(R)}renderJSPivotInter.InitMetadata.DimensionPosition=[];renderJSPivotInter.HideDataFilds=[];var M;var J=OATgetState(u,p.replace(/,/g,"").replace(/\./g,""));if(m&&J!=undefined){var L=[];for(var I=0;I<J.Dimensions.length;I++){if(!J.Dimensions[I].Visible){L.push(J.Dimensions[I].dataField)}}var V=[];for(var I=0;I<J.Measures.length;I++){if(!J.Measures[I].Visible){V.push(J.Measures[I].dataField)}}renderJSPivotInter.InitMetadata.Measures=J.Measures;renderJSPivotInter.InitMetadata.Dimensions=J.Dimensions;renderJSPivotInter.InitMetadata.DataFields=J.DataFields;renderJSPivotInter.InitMetadata.DimensionPosition=J.DimensionPosition;if(e.ServerPagingPivot){renderJSPivotInter.InitMetadata.Conditions=J.Conditions}M=OATParseMetadata(o,L,V,e.ServerPagingPivot,t)}else{var L=[];for(var I=0;I<renderJSPivotInter.InitMetadata.Dimensions.length;I++){if(!renderJSPivotInter.InitMetadata.Dimensions[I].Visible){L.push(renderJSPivotInter.InitMetadata.Dimensions[I].dataField)}}var V=[];for(var I=0;I<renderJSPivotInter.InitMetadata.Measures.length;I++){if(!renderJSPivotInter.InitMetadata.Measures[I].Visible){V.push(renderJSPivotInter.InitMetadata.Measures[I].dataField)}}if(e.RealType=="Table"){M=OATParseMetadata(o,[],V,e.ServerPagingPivot,t)}else{M=OATParseMetadata(o,L,V,e.ServerPagingPivot,t)}}renderJSPivotInter.InitMetadata.GrandTotalVisibility={TotalForRows:e.TotalForRows,TotalForColumns:e.TotalForColumns};o=M[0];var B=M[1];var U=M[3];renderJSPivotInter.HideDataFilds=M[2];var z=jquery.parseXML(o);var H=z.childNodes[0];renderJSPivotInter.IdForQueryViewerCollection=p;p=p.replace(/,/g,"").replace(/\./g,"");renderJSPivotInter.UcId=p;renderJSPivotInter.pivotDiv=n.id;renderJSPivotInter.query=u;renderJSPivotInter.control=c;renderJSPivotInter.pageSize=v;renderJSPivotInter.autoResize=d;renderJSPivotInter.disableColumnSort=h;renderJSPivotInter.header=[];renderJSPivotInter.data=[];renderJSPivotInter.columnNumbers=[];renderJSPivotInter.rowNumbers=[];renderJSPivotInter.filterNumbers=[];renderJSPivotInter.cols=0;renderJSPivotInter.conditionalFormats=[];renderJSPivotInter.conditionalFormatsColumns=[];renderJSPivotInter.formatValues=[];renderJSPivotInter.formatValuesMeasures=[];renderJSPivotInter.forPivotFormatValues=[];renderJSPivotInter.forPivotFormats=[];renderJSPivotInter.forPivotCustomPicture=[];renderJSPivotInter.forPivotCustomFormat=[];var Z=z.getElementsByTagName("OLAPDimension");var G=[];var X=[];var $=[];renderJSPivotInter.measures=z.getElementsByTagName("OLAPMeasure");var Q=[];var Y=[];var C=0;var W=0;var K=[];var ee={measureFormula:[],itemPosition:[]};var re=[];var te=[];var ie=[];var ae=[];var se=[];if(e.RealType=="Table"){for(var I=0;I<Z.length;I++){renderJSPivotInter.initialColumnVisible[I]=true;if(Z[I].attributes.getNamedItem("visible").nodeValue!="Yes"){renderJSPivotInter.initialColumnVisible[I]=false}}}for(var I=0;I<Z.length;I++){if(Z[I].attributes.getNamedItem("axis").nodeValue=="Rows"||e.RealType=="Table"||renderJSPivotInter.InitMetadata.Dimensions[I].validPosition==""){G[C]=Z[I].attributes.getNamedItem("displayName").nodeValue;K[I]=G[C];C++}if(Z[I].attributes.getNamedItem("axis").nodeValue=="Columns"){X[W]=Z[I].attributes.getNamedItem("displayName").nodeValue;K[I]=X[W];W++}if(Z[I].attributes.getNamedItem("axis").nodeValue=="Pages"){$[W]=Z[I].attributes.getNamedItem("displayName").nodeValue;K[I]=$[W];W++}if(e.ServerPagingPivot&&Z[I].attributes.getNamedItem("axis").nodeValue==""){for(var y=0;y<renderJSPivotInter.InitMetadata.Dimensions.length;y++){if(renderJSPivotInter.InitMetadata.Dimensions[y].dataField==Z[I].attributes.getNamedItem("dataField").nodeValue){if(renderJSPivotInter.InitMetadata.Dimensions[y].Visible){G[C]=Z[I].attributes.getNamedItem("displayName").nodeValue;C++;K[I]=Z[I].attributes.getNamedItem("displayName").nodeValue}}}}Q[I]=Z[I].attributes.getNamedItem("dataType").nodeValue;if(Z[I].childNodes.length>0){if(Z[I].childNodes!=null){for(var ne=0;ne<Z[I].childNodes.length;ne++){if(Z[I].childNodes[ne].localName=="formatValues"){for(var fe=0;fe<Z[I].childNodes[ne].childNodes.length;fe++){if(Z[I].childNodes[ne].childNodes[fe].localName=="value"){var le={};le.format=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("format").nodeValue;le.recursive=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("recursive").nodeValue;var oe=Z[I].childNodes[ne].childNodes[fe].textContent;le.value=oe.replace(/^\s+|\s+$/g,"");le.columnNumber=I;renderJSPivotInter.formatValues.push(le)}}}}}}if(Z[I].childNodes.length>0){if(Z[I].childNodes!=null){for(var ne=0;ne<Z[I].childNodes.length;ne++){if(Z[I].childNodes[ne].localName=="conditionalFormats"){for(var fe=0;fe<Z[I].childNodes[ne].childNodes.length;fe++){if(Z[I].childNodes[ne].childNodes[fe].localName=="rule"){var ue={};ue.format=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("format").nodeValue;ue.operation1=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("op1").nodeValue;ue.value1=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("value1").nodeValue;if(Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("op2")!=null){ue.operation2=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("op2").nodeValue;ue.value2=Z[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("value2").nodeValue}ue.columnNumber=I;renderJSPivotInter.conditionalFormatsColumns.push(ue)}}}}}}if(Z[I].attributes.getNamedItem("picture").nodeValue!=""){if(Z[I].attributes.getNamedItem("dataType").nodeValue=="date"){te.push(Z[I].attributes.getNamedItem("picture").nodeValue);ae.push(Z[I].attributes.getNamedItem("dataField").nodeValue)}if(Z[I].attributes.getNamedItem("dataType").nodeValue=="integer"){ie.push(Z[I].attributes.getNamedItem("picture").nodeValue);se.push(Z[I].attributes.getNamedItem("dataField").nodeValue)}}renderJSPivotInter.forPivotCustomPicture.push(Z[I].attributes.getNamedItem("picture").nodeValue);renderJSPivotInter.forPivotCustomFormat.push(Z[I].attributes.getNamedItem("format").nodeValue);re.push(Z[I].attributes.getNamedItem("dataField").nodeValue)}for(var I=0;I<renderJSPivotInter.measures.length;I++){Y[I]=renderJSPivotInter.measures[I].attributes.getNamedItem("displayName").nodeValue;if(renderJSPivotInter.measures[I].childNodes.length>0){if(renderJSPivotInter.measures[I].childNodes!=null){for(var ne=0;ne<renderJSPivotInter.measures[I].childNodes.length;ne++){if(renderJSPivotInter.measures[I].childNodes[ne].localName=="formatValues"){for(var fe=0;fe<renderJSPivotInter.measures[I].childNodes[ne].childNodes.length;fe++){if(renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].localName=="value"){var le={};le.format=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("format").nodeValue;le.recursive=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("recursive").nodeValue;var oe=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].textContent;le.value=oe.replace(/^\s+|\s+$/g,"");le.columnNumber=I;formatValuesMeasures.push(le)}}}}}}if(renderJSPivotInter.measures[I].childNodes.length>0){if(renderJSPivotInter.measures[I].childNodes!=null){for(var ne=0;ne<renderJSPivotInter.measures[I].childNodes.length;ne++){if(renderJSPivotInter.measures[I].childNodes[ne].localName=="conditionalFormats"){for(var fe=0;fe<renderJSPivotInter.measures[I].childNodes[ne].childNodes.length;fe++){if(renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].localName=="rule"){var ue={};ue.format=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("format").nodeValue;ue.operation1=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("op1").nodeValue;ue.value1=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("value1").nodeValue;if(renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("op2")!=null){ue.operation2=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("op2").nodeValue;ue.value2=renderJSPivotInter.measures[I].childNodes[ne].childNodes[fe].attributes.getNamedItem("value2").nodeValue}ue.columnNumber=I;conditionalFormats.push(ue)}}}}}}if(renderJSPivotInter.measures[I].attributes.getNamedItem("picture").nodeValue!=""){if(renderJSPivotInter.measures[I].attributes.getNamedItem("dataType").nodeValue=="date"){te.push(renderJSPivotInter.measures[I].attributes.getNamedItem("picture").nodeValue);ae.push(renderJSPivotInter.measures[I].attributes.getNamedItem("dataField").nodeValue)}if(renderJSPivotInter.measures[I].attributes.getNamedItem("dataType").nodeValue=="integer"||renderJSPivotInter.measures[I].attributes.getNamedItem("dataType").nodeValue=="real"){ie.push(renderJSPivotInter.measures[I].attributes.getNamedItem("picture").nodeValue);se.push(renderJSPivotInter.measures[I].attributes.getNamedItem("dataField").nodeValue)}}if(renderJSPivotInter.measures[I].attributes.getNamedItem("formula")!=undefined&&renderJSPivotInter.measures[I].attributes.getNamedItem("formula").nodeValue!=""){ee.measureFormula.push({hasFormula:true,textFormula:renderJSPivotInter.measures[I].attributes.getNamedItem("formula").nodeValue})}else{ee.measureFormula.push({hasFormula:false})}renderJSPivotInter.forPivotCustomPicture.push(renderJSPivotInter.measures[I].attributes.getNamedItem("picture").nodeValue);re.push(renderJSPivotInter.measures[I].attributes.getNamedItem("dataField").nodeValue)}renderJSPivotInter.header=K.concat(Y);renderJSPivotInter.getDataFromXML=function(e,r){var t=e.split("<Record>");if(renderJSPivotInter.serverPaging){renderJSPivotInter.ServerRecordCount=parseToIntRegisterValue(t[0],"RecordCount");renderJSPivotInter.ServerPageCount=parseToIntRegisterValue(t[0],"PageCount");renderJSPivotInter.ServerPageNumber=parseToIntRegisterValue(t[0],"PageNumber")}filds=r;for(var i=1;i<t.length;i++){var a=[];var s=[];for(var n=0;n<filds.length;n++){a[n]="#NuN#";var f=t[i].split("<"+filds[n]+">");if(f.length>1){var l=f[1].split("</"+filds[n]+">");a[n]=l[0];s[n]=a[n]}else{if(t[i].indexOf("<"+filds[n]+"/>")>=0){a[n]="";s[n]=""}}}renderJSPivotInter.data.push(a);var o=filds.length;for(var n=0;n<renderJSPivotInter.HideDataFilds.length;n++){s[o+n]=undefined;var f=t[i].split("<"+renderJSPivotInter.HideDataFilds[n]+">");if(f.length>1){var l=f[1].split("</"+renderJSPivotInter.HideDataFilds[n]+">");s[o+n]=l[0]}}renderJSPivotInter.fullRecord.push(s);if(s.length>renderJSPivotInter.maxLengthRecord)renderJSPivotInter.maxLengthRecord=s.length}};renderJSPivotInter.maxLengthRecord=0;renderJSPivotInter.data=[];renderJSPivotInter.fullRecord=[];renderJSPivotInter.orderFildsHidden=B;renderJSPivotInter.TableOrderFilds=re;if(!e.ServerPagingPivot){renderJSPivotInter.getDataFromXML(e.data,renderJSPivotInter.TableOrderFilds)}else{O=O&&renderJSPivotInter.measures.length>1;renderJSPivotInter.pagingData={};renderJSPivotInter.pagingData.dataFields=re}var ce={};for(var C=0;C<B.length;C++){ce[B[C]]=re.length+C}renderJSPivotInter.orderFildsHidden=U;ee.itemPosition=ce;ee.recordDataLength=renderJSPivotInter.maxLengthRecord;ee.cantFormulaMeasures=0;for(var fe=0;fe<ee.measureFormula.length;fe++){if(ee.measureFormula[fe].hasFormula){ee.cantFormulaMeasures++;var ve=ee.measureFormula[fe].textFormula;var de=ve;var he=["*","-","+","/","(",")"];for(var C=0;C<he.length;C++){var pe=de.split(he[C]);if(pe.length>1){de="";for(var I=0;I<pe.length-1;I++){de=de+pe[I]+" "+he[C]+" "}de=de+pe[pe.length-1]}}var me=InfixToPostfix(de);ee.measureFormula[fe].polishNotationText=me;var Te=me.split(" ");while(Te.indexOf("")!=-1){Te.splice(Te.indexOf(""),1)}var Ae=[];for(var W=0;W<Te.length;W++){if(he.indexOf(Te[W])==-1&&isNaN(parseInt(Te[W]))){var ye=ee.itemPosition[Te[W]];if(Ae.indexOf(ye)==-1)Ae.push(ye)}}ee.measureFormula[fe].relatedMeasures=Ae;var we=me.split(" ");while(we.indexOf("")!=-1){we.splice(we.indexOf(""),1)}ee.measureFormula[fe].PolishNotation=we}}var Oe=0;var ne=0;var ge=0;for(var I=0;I<K.length;I++){if(contains2(G,K[I])!=-1){renderJSPivotInter.columnNumbers[Oe]=I;Oe++}if(contains2(X,K[I])!=-1){renderJSPivotInter.rowNumbers[ne]=I;ne++}if(contains2($,K[I])!=-1){renderJSPivotInter.filterNumbers[ge]=I;ge++}}var _e=new Array;for(var y=0;y<Z.length;y++){_e[y]=Z[y]}var be="";for(var I=0;I<jquery("script").length;I++){var xe=jquery("script")[I].src;if(xe.indexOf("gxpivotjs")>0){be=xe;break}if(xe.indexOf("oat_loader")>0){be=xe;break}}var Se=be.substring(0,be.indexOf("QueryViewer/oatPivot"));renderJSPivotInter.relativePath=Se;renderJSPivotInter.fireOnPageChangeTable=function(e,r){setTimeout((function(){var t={QueryviewerId:e,Navigation:r};var i=document.createEvent("Events");i.initEvent("TableOnPageChangeEvent",true,true);i.parameter=t;document.dispatchEvent(i)}),0)};var Ie;u=u.replace(/\./g,"");renderJSPivotInter.query=u;renderJSPivotInter.translations=t;if(s=="PivotTable"){Ie=OAT_JS.pivot.cb(renderJSPivotInter,renderJSPivotInter.pivotDiv,f,l,H,r,_e,renderJSPivotInter.formatValues,renderJSPivotInter.conditionalFormatsColumns,renderJSPivotInter.formatValuesMeasures,renderJSPivotInter.autoResize,renderJSPivotInter.disableColumnSort,renderJSPivotInter.UcId,renderJSPivotInter.IdForQueryViewerCollection,m,O,ee,renderJSPivotInter.fullRecord,e.ServerPagingPivot,renderJSPivotInter.pagingData,renderJSPivotInter.HideDataFilds,renderJSPivotInter.orderFildsHidden,renderJSPivotInter.InitMetadata,renderJSPivotInter.relativePath,renderJSPivotInter.pivotParams);if(Ie=="error"){return}}else{if(s=="Table"){Ie=OAT_JS.grid.cb(renderJSPivotInter.pivotDiv,renderJSPivotInter.UcId+"_"+u,Q,H,renderJSPivotInter.forPivotCustomPicture,renderJSPivotInter.conditionalFormatsColumns,renderJSPivotInter.formatValues,renderJSPivotInter.forPivotCustomFormat,_e,Z,r,renderJSPivotInter.pageSize,renderJSPivotInter.disableColumnSort,renderJSPivotInter.UcId,renderJSPivotInter.IdForQueryViewerCollection,m,renderJSPivotInter)}}if(s=="Table"){renderJSPivotInter.pageSize=renderJSPivotInter.previousState?renderJSPivotInter.previousState.pageSize:v;var ke=renderJSPivotInter.pageSize;if(Ie.rowsPerPage!=undefined&&Ie.rowsPerPage!=""){ke=Ie.rowsPerPage}if(r[renderJSPivotInter.UcId]._ControlRenderedTo){jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination").remove()}if(renderJSPivotInter.pageSize){var qe={currPage:renderJSPivotInter.ServerPageNumber,ignoreRows:jquery("tbody tr[visibQ=tf]",jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query)),optionsForRows:OAT.AddItemToList([10,15,20],renderJSPivotInter.InitMetadata.RowsPerPage),rowsPerPage:ke!="undefined"?ke:10,jstype:"table",topNav:false,controlName:renderJSPivotInter.UcId+"_"+renderJSPivotInter.query,cantPages:renderJSPivotInter.ServerPageCount,controlUcId:renderJSPivotInter.UcId,translations:t,control:renderJSPivotInter};OAT.partialTablePagination(jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query),qe);var Fe=jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query)[0].clientWidth-1;jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination").css({width:Fe+"px"});if(jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination").css("display")==="none"){jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query).css({marginBottom:"0px"})}else{jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query).css("margin-bottom","0px")}if(jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination_paginater").length>0&&jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination")[0].getBoundingClientRect().bottom<jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom){jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination").css({marginBottom:"0px"})}var Pe=jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query)[0].offsetWidth-4;jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_grid_top_div").css({width:Pe+"px"});if(renderJSPivotInter.serverPaging&&(renderJSPivotInter.pageSize==10||renderJSPivotInter.ServerRecordCount<10)){if(renderJSPivotInter.ServerPageCount<=1){jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_tablePagination").css({display:"none"})}}}var Pe=jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query)[0].offsetWidth-4;try{if(jquery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1){Pe=Pe+4}}catch(e){}jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query+"_grid_top_div").css({width:Pe+"px"});if(self.serverPaging){setInterval((function(){for(var e=0;e<jquery(".oat_winrect_container .pivot_popup_fix").length;e++){if(!jquery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display||jquery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display!="none"){if(jquery(".oat_winrect_container .pivot_popup_fix").length>0){var r=jquery(".oat_winrect_container .pivot_popup_fix")[e];var t=r.scrollHeight-r.clientHeight-r.scrollTop;if(t<25){var i=r.getAttribute("ucid");var a=parseInt(r.getAttribute("columnNumber"));OAT_JS.grid.readScrollValue(i,a)}}}}}),250)}}if(!e.ServerPagingPivot){if(renderJSPivotInter.autoResize){jquery("#"+renderJSPivotInter.UcId+"_"+renderJSPivotInter.query).css({minWidth:"10px"})}}renderJSPivotInter.getDataForTable=function(e,r,t,i,a,s,n,f,l,o){var u=false;if(i||a!=""||n!=""){OAT_JS.grid.cleanCache(renderJSPivotInter,e);u=true}if(a!="")OAT_JS.grid.gridData[e].dataFieldOrder=a;if(s!="")OAT_JS.grid.gridData[e].orderType=s;if(n!="")OAT_JS.grid.updateFilterInfo(e,n,f);if(l){OAT_JS.grid.restoreDefaultView(e);t=OAT_JS.grid.gridData[e].rowsPerPage}OAT_JS.grid.gridData[e].rowsPerPage=t;if(i||a!=""||n!=""){OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[e],e,OAT_JS.grid.gridData[e].blackLists,OAT_JS.grid.gridData[e].columnVisible,OAT_JS.grid.gridData[e].columnDataField)}if(t==""){t=undefined;r=0}if(!OAT_JS.grid.pageInCache(e,r)){OAT_JS.grid.lastCallToQueryViewer="getDataForTable";OAT_JS.grid.lastCallData={self:renderJSPivotInter,UcId:OAT_JS.grid.gridData[e].IdForQueryViewerCollection,RecalculateCantPages:i,DataFieldOrder:a,PageNumber:r,fromExternalRefresh:o};renderJSPivotInter.requestPageDataForTable(r,t,i,OAT_JS.grid.gridData[e].dataFieldOrder,OAT_JS.grid.gridData[e].orderType,OAT_JS.grid.gridData[e].filterInfo,u,OAT_JS.grid.gridData[e].IdForQueryViewerCollection)}else{OAT_JS.grid.redraw(renderJSPivotInter,e,OAT_JS.grid.pageInCache(e,r),false,false,r,true)}};renderJSPivotInter.requestPageDataForTable=function(e,r,t,i,a,s,n,f){setTimeout((function(){var l={PageNumber:e,PageSize:r,RecalculateCantPages:t,DataFieldOrder:i,OrderType:a,Filters:s,LayoutChange:n,QueryviewerId:f};var o=document.createEvent("Events");o.initEvent("RequestPageDataForTable",true,true);o.parameter=l;document.dispatchEvent(o)}),0)};renderJSPivotInter.getActualCantPages=function(e){return OAT_JS.grid.gridData[e].actualCantPages};renderJSPivotInter.getValuesForColumn=function(e,r,t){var i=OAT_JS.grid.gridData[e].columnDataField[r];if(t!=""){var a=1;OAT_JS.grid.lastCallToQueryViewer="getValuesForColumn";OAT_JS.grid.lastCallData={self:renderJSPivotInter,UcId:e,columnNumber:r,filterValue:t,dataField:i};renderJSPivotInter.requestAttributeForTable(e,i,a,t,10)}else{OAT_JS.grid.resetScrollValue(e,i,r)}};renderJSPivotInter.requestAttributeForTable=function(e,r,t,i,a){setTimeout((function(){var s={Page:t,PageSize:a,DataField:r,Filters:i,QueryviewerId:e};var n=document.createEvent("Events");n.initEvent("RequestAttributeForTable",true,true);n.parameter=s;document.dispatchEvent(n)}),0)};renderJSPivotInter.fireOnFilterChanged=function(e,r){setTimeout((function(){var t={QueryViewerd:e,FilterChangedData:r};var i=document.createEvent("Events");i.initEvent("TableOnFilterChangedEvent",true,true);i.parameter=t;document.dispatchEvent(i)}),0)};a.oat_element=Ie};var OAT_JS={};OAT_JS.grid={panel:1,tab:4,div:"",needs:["grid"],gridData:[],cb:function(e,r,t,i,a,s,n,f,l,o,u,c,v,d,h,p,m){this.gridData[d]={};this.gridData[d].div=e;this.gridData[d].controlName=r;this.gridData[d].actualPageNumber=1;this.gridData[d].rowsPerPage=m.previousState?m.previousState.pageSize:c;this.gridData[d].actualCantPages=m.ServerPageCount;this.gridData[d].autoResize=m.autoResize;this.gridData[d].selection={Allow:m.pivotParams.AllowSelection,EntireLine:m.pivotParams.SelectLine,SelectedNode:[]};this.gridData[d].grid=new OAT.Grid(e,r,query,t,l,u,this.gridData[d].rowsPerPage,v,d,h,p,m.serverPaging,m.HideDataFilds,m.orderFildsHidden,m.TableOrderFilds,m.relativePath,this.gridData[d].selection,m.pivotParams.Title,m.translations);this.gridData[d].grid.oat_component=this;this.gridData[d].QueryViewerCollectionItem=u[h];this.gridData[d].columnDataField=[];if(m.previousState&&m.previousState.columnDataField){this.gridData[d].columnDataField=m.previousState.columnDataField;var T=[];for(var A=0;A<this.gridData[d].columnDataField.length;A++){var y=this.gridData[d].columnDataField[A];for(var w=0;w<o.length;w++){if(y==o[w].getAttribute("dataField")){T.push(o[w].getAttribute("displayName"))}}}this.gridData[d].grid.createHeader(T,this.gridData[d].columnDataField)}else{for(var O=0;O<o.length;O++){this.gridData[d].columnDataField[O]=o[O].getAttribute("dataField")}this.gridData[d].grid.createHeader(m.header,this.gridData[d].columnDataField)}this.gridData[d].redrawHeader=false;this.gridData[d].defaultValues={};this.gridData[d].defaultValues.rowsPerPage=c;this.gridData[d].defaultValues.dataFieldOrder="";this.gridData[d].defaultValues.orderType="";this.gridData[d].defaultValues.filterInfo=[];this.gridData[d].IdForQueryViewerCollection=h;this.gridData[d].TableOrderFields=m.TableOrderFilds;this.gridData[d].cacheSize=m.gridCacheSize==0?m.ServerPageCount*(this.gridData[d].rowsPerPage>0?this.gridData[d].rowsPerPage:1):m.gridCacheSize;this.gridData[d].gridCache=[];this.gridData[d].gridCache[0]={page:1,pageData:m.dataString};this.gridData[d].nextCachePos=1;this.gridData[d].originalColumnDataField=[];for(var O=0;O<o.length;O++){this.gridData[d].originalColumnDataField[O]=o[O].getAttribute("dataField")}this.gridData[d].columnVisible=[];for(var O=0;O<o.length;O++){this.gridData[d].columnVisible[O]=true;if(m.previousColumnVisible){this.gridData[d].columnVisible[O]=m.previousColumnVisible[O];if(!this.gridData[d].columnVisible[O]){var y=this.gridData[d].originalColumnDataField[O];this.gridData[d].grid.hideColumnHeader(this.gridData[d].columnDataField.indexOf(y))}}else if(m.initialColumnVisible){this.gridData[d].columnVisible[O]=m.initialColumnVisible[O];if(!this.gridData[d].columnVisible[O])this.gridData[d].grid.hideColumnHeader(O)}}this.gridData[d].filterInfo=[];this.gridData[d].differentValues=[];this.gridData[d].blackLists=[];this.gridData[d].differentValuesPaginationInfo=[];this.gridData[d].filteredValuesPaginationInfo=[];for(var O=0;O<o.length;O++){this.gridData[d].differentValues[o[O].getAttribute("dataField")]=[];this.gridData[d].blackLists[o[O].getAttribute("dataField")]={state:"all",visibles:[],hiddens:[],defaultAction:"Include",hasNull:true};this.gridData[d].differentValuesPaginationInfo[o[O].getAttribute("dataField")]={blocked:false,previousPage:0,totalPages:true,filtered:false};this.gridData[d].filteredValuesPaginationInfo[o[O].getAttribute("dataField")]={previousPage:0,totalPages:0,filteredText:"",values:[]}}this.gridData[d].defaultNullText=i.getAttribute("textForNullValues");if(m.previousFilters!=undefined){this.gridData[d].filterInfo=m.previousFilters;for(var g=0;g<this.gridData[d].filterInfo.length;g++){for(var _=0;_<this.gridData[d].filterInfo[g].NotNullValues.Included.length;_++){var b=this.gridData[d].filterInfo[g].NotNullValues.Included[_];if(this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].visibles.indexOf(b)==-1){this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].visibles.push(b)}}for(var _=0;_<this.gridData[d].filterInfo[g].NotNullValues.Excluded.length;_++){var b=this.gridData[d].filterInfo[g].NotNullValues.Excluded[_];if(this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].hiddens.indexOf(b)==-1){this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].hiddens.push(b)}}if(this.gridData[d].filterInfo[g].NotNullValues.Included.length>0){this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].state=""}else{this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].state="none"}this.gridData[d].blackLists[this.gridData[d].filterInfo[g].DataField].defaultAction=this.gridData[d].filterInfo[g].NotNullValues.DefaultAction}}else{if(m.customFilterInfo!=undefined&m.customFilterInfo!=""){this.gridData[d].filterInfo=m.customFilterInfo}}this.gridData[d].dataFieldOrder=m.previousDataFieldOrder!=undefined?m.previousDataFieldOrder:"";this.gridData[d].orderType=m.previousOrderType!=undefined?m.previousOrderType:"";this.gridData[d].customOrderValues=[];for(var x=0;x<o.length;x++){if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")==="custom"){result=this.gridData[d].grid.applyCustomSort(x,o[x],data);data=result[0];this.gridData[d].customOrderValues[x]=result[1]}else{this.gridData[d].customOrderValues[x]=false}}this.gridData[d].rowsMetadata={columnsDataType:t,defaultPicture:i,forPivotCustomPicture:a,conditionalFormatsColumns:s,formatValues:n,forPivotCustomFormat,columns:o};this.gridData[d].rowsData=data;for(var A=0;A<data.length;A++){OAT.CreateGridRow(m.data[A],this.gridData[d])}if(!m.serverPaging){for(var x=0;x<o.length;x++){if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")==="ascending"){this.gridData[d].grid.applySortOrderType(x,2)}if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")==="descending"){this.gridData[d].grid.applySortOrderType(x,3)}if(o[x].getAttribute("order")!=undefined){break}}}else{var S=false;for(var x=0;x<o.length;x++){if(o[x].getAttribute("order")!=undefined&&o[x].getAttribute("order")!=""){this.gridData[d].dataFieldOrder=o[x].getAttribute("dataField");this.gridData[d].orderType=o[x].getAttribute("order")=="descending"?"Descending":"Ascending";S=o[x].getAttribute("order")=="custom";break}}if(this.gridData[d].dataFieldOrder!=""&&!S){var I=0;for(var _=0;_<this.gridData[d].grid.columns.length;_++){if(this.gridData[d].dataFieldOrder==this.gridData[d].columnDataField[_]){I=_;break}}this.gridData[d].grid.applySortOrderType(I,this.gridData[d].orderType.toLowerCase()=="ascending"?2:3)}}for(var x=0;x<o.length;x++){this.gridData[d].grid.applyCustomFilter(x,o[x])}if(m.serverPaging){this.gridData[d].endValueRead=false;u[this.gridData[d].IdForQueryViewerCollection].CurrentPage=1;if(typeof u[this.gridData[d].IdForQueryViewerCollection].OnFirstPage=="function")self.fireOnPageChangeTable(this.gridData[d].IdForQueryViewerCollection,"OnFirstPage")}if(!m.serverPaging){this.gridData[d].grid.applySaveState(this.gridData[d].rowsPerPage)}if(m.previousState){var k=this;setTimeout((function(){self.getDataForTable(d,1,k.gridData[d].rowsPerPage,true,k.gridData[d].dataFieldOrder,k.gridData[d].orderType,"","","",false)}),0)}return this.gridData[d].grid},redraw:function(e,r,t,i,a,s,n){if(!this.pageInCache(r,s)){this.gridData[r].gridCache.push({page:s,pageData:t});if(this.gridData[r].gridCache.length>this.gridData[r].cacheSize){this.gridData[r].gridCache.splice(0,1)}}else{var f=-1;for(var l=0;l<this.gridData[r].gridCache.length;l++){if(this.gridData[r].gridCache[l].page==s){f=l}}this.gridData[r].gridCache.splice(f,1);this.gridData[r].gridCache.push({page:s,pageData:t})}e.data=[];e.getDataFromXML(t,this.gridData[r].TableOrderFields);if(e.ServerPageCount>=0){this.gridData[r].actualCantPages=e.ServerPageCount}if(this.gridData[r].redrawHeader){var o=[];for(var u=0;u<this.gridData[r].columnDataField.length;u++){var c=this.gridData[r].columnDataField[u];for(var v=0;v<this.gridData[r].rowsMetadata.columns.length;v++){if(c==this.gridData[r].rowsMetadata.columns[v].getAttribute("dataField")){o.push(this.gridData[r].rowsMetadata.columns[v].getAttribute("displayName"))}}}this.gridData[r].grid.createHeader(o,this.gridData[r].columnDataField);if(this.gridData[r].dataFieldOrder!=""){var d=0;for(var h=0;h<this.gridData[r].grid.columns.length;h++){if(this.gridData[r].dataFieldOrder==this.gridData[r].columnDataField[h]){d=h;break}}this.gridData[r].grid.applySortOrderType(d,this.gridData[r].orderType.toLowerCase()=="ascending"?2:3)}for(var u=0;u<this.gridData[r].columnVisible.length;u++){if(!this.gridData[r].columnVisible[u]){var c=this.gridData[r].originalColumnDataField[u];this.gridData[r].grid.hideColumnHeader(this.gridData[r].columnDataField.indexOf(c))}}}this.gridData[r].grid.removeAllRows();if(i){if(jquery("#"+this.gridData[r].controlName+"_tablePagination "+"#tablePagination_totalPages").length>0){OAT.replaceTextNode(jquery("#"+this.gridData[r].controlName+"_tablePagination "+"#tablePagination_totalPages")[0]," "+e.ServerPageCount);if(e.ServerPageCount<=1){jquery("#"+this.gridData[r].controlName+"_tablePagination ").css({display:"none"})}else{jquery("#"+this.gridData[r].controlName+"_tablePagination ").css({display:""});if(e.ServerPageCount==1){jquery("#"+this.gridData[r].controlName+"_tablePagination_paginater").css("display","none")}else{jquery("#"+this.gridData[r].controlName+"_tablePagination_paginater").css("display","")}}}}if(OAT_JS.grid.gridData[r].actualPageNumber!=s){this.gridData[r].QueryViewerCollectionItem.CurrentPage=s;if(s==1){if(typeof this.gridData[r].QueryViewerCollectionItem.OnFirstPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnFirstPage")}else if(s==this.gridData[r].actualCantPages){if(typeof this.gridData[r].QueryViewerCollectionItem.OnLastPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnLastPage")}else if(s<OAT_JS.grid.gridData[r].actualPageNumber){if(typeof this.gridData[r].QueryViewerCollectionItem.OnPreviousPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnPreviousPage")}else{if(typeof this.gridData[r].QueryViewerCollectionItem.OnNextPage=="function")self.fireOnPageChangeTable(this.gridData[r].IdForQueryViewerCollection,"OnNextPage")}}if(!n&&this.gridData[r].QueryViewerCollectionItem.AutoRefreshGroup!=""){OAT_JS.grid.initValueRead(r,0);var p=function(){if(!OAT_JS.grid.gridData[r].endValueRead){setTimeout(p,100)}else{var e=OAT.createXMLMetadata(OAT_JS.grid.gridData[r],null,true);var t=OAT_JS.grid.gridData[r].IdForQueryViewerCollection;setTimeout((function(){var r={QueryviewerId:t,Metadata:e};var i=document.createEvent("Events");i.initEvent("RequestUpdateLayoutSameGroup",true,true);i.parameter=r;document.dispatchEvent(i)}),50)}};p()}OAT_JS.grid.gridData[r].actualPageNumber=s;currPageNumber[this.gridData[r].controlName]=s;jquery("#"+this.gridData[r].controlName+"_tablePagination "+"#tablePagination_currPage").val(s);this.gridData[r].rowsData=e.data;for(var u=0;u<e.data.length;u++){OAT.CreateGridRow(e.data[u],this.gridData[r])}OAT.RedrawSelectedNode(this.gridData[r].grid)},getDifferentValues:function(e,r,t){var i=this.gridData[e].columnDataField[r];var a=this.gridData[e].differentValues[i][t];var s=this.gridData[e].originalColumnDataField.indexOf(this.gridData[e].columnDataField[r]);var n=OAT.ApplyPictureValue(a.trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[s],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[s]).replace(/ /g,"Â ");if(this.gridData[e].blackLists[i].hasNull&&a.trimpivot()==this.gridData[e].defaultNullText){a="#NuN#";return false}var f=true;if(this.gridData[e].blackLists[i].state!="all"){if(this.gridData[e].blackLists[i].visibles.indexOf(a)<0){f=false}}return{value:a,checked:f,pict_value:n}},getCantDifferentValues:function(e,r){var t=this.gridData[e].columnDataField[r];return this.gridData[e].differentValues[t].length},cleanCache:function(e,r){for(var t=0;t<this.gridData[r].gridCache.length;t++){this.gridData[r].gridCache[t]={page:-1,pageData:""}}this.gridData[r].nextCachePos=0},pageInCache:function(e,r){for(var t=0;t<this.gridData[e].gridCache.length;t++){if(this.gridData[e].gridCache[t].page==r){return this.gridData[e].gridCache[t].pageData}}return false},updateFilterInfo:function(e,r,t){if(t.op=="all"){var i=-1;for(var a=0;a<this.gridData[e].filterInfo.length;a++){if(r==this.gridData[e].filterInfo[a].DataField){i=a;break}}if(i>-1)this.gridData[e].filterInfo.splice(i,1);this.gridData[e].blackLists[r].state="all";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];this.gridData[e].blackLists[r].defaultAction="Include";return}if(this.gridData[e].blackLists[r].state=="none"){this.gridData[e].blackLists[r].visibles=[];for(var s=0;s<this.gridData[e].differentValues[r].length;s++){if(this.gridData[e].blackLists[r].hiddens.indexOf(this.gridData[e].differentValues[r][s])==-1){this.gridData[e].blackLists[r].hiddens.push(this.gridData[e].differentValues[r][s])}}}else if(this.gridData[e].blackLists[r].state=="all"){this.gridData[e].blackLists[r].hiddens=[];for(var s=0;s<this.gridData[e].differentValues[r].length;s++){if(this.gridData[e].blackLists[r].visibles.indexOf(this.gridData[e].differentValues[r][s])==-1){this.gridData[e].blackLists[r].visibles.push(this.gridData[e].differentValues[r][s])}}}if(t.op=="none"){this.gridData[e].blackLists[r].state="none";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];this.gridData[e].blackLists[r].defaultAction="Exclude"}else{if(t.op=="push"){this.gridData[e].blackLists[r].state="";var i=this.gridData[e].blackLists[r].visibles.indexOf(t.values);if(i>-1)this.gridData[e].blackLists[r].visibles.splice(i,1);if(this.gridData[e].blackLists[r].hiddens.indexOf(t.values)==-1)this.gridData[e].blackLists[r].hiddens.push(t.values)}else if(t.op=="pop"){this.gridData[e].blackLists[r].state="";if(this.gridData[e].blackLists[r].visibles.indexOf(t.values)==-1)this.gridData[e].blackLists[r].visibles.push(t.values);var i=this.gridData[e].blackLists[r].hiddens.indexOf(t.values);if(i>-1)this.gridData[e].blackLists[r].hiddens.splice(i,1)}else if(t.op=="reverse"){if(this.gridData[e].blackLists[r].defaultAction=="Include"){this.gridData[e].blackLists[r].defaultAction="Exclude"}else{this.gridData[e].blackLists[r].defaultAction="Include"}if(this.gridData[e].blackLists[r].state=="none"){var i=-1;for(var a=0;a<this.gridData[e].filterInfo.length;a++){if(r==this.gridData[e].filterInfo[a].DataField){i=a;break}}if(i>-1)this.gridData[e].filterInfo.splice(i,1);this.gridData[e].blackLists[r].state="all";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];return}else if(this.gridData[e].blackLists[r].state=="all"){this.gridData[e].blackLists[r].state="none";this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[]}else{var n=[];for(var f=0;f<this.gridData[e].blackLists[r].visibles.length;f++){n.push(this.gridData[e].blackLists[r].visibles[f])}var l=[];for(var f=0;f<this.gridData[e].blackLists[r].hiddens.length;f++){l.push(this.gridData[e].blackLists[r].hiddens[f])}this.gridData[e].blackLists[r].visibles=[];this.gridData[e].blackLists[r].hiddens=[];for(var s=0;s<this.gridData[e].differentValues[r].length;s++){var o=this.gridData[e].differentValues[r][s];if(n.indexOf(o)==-1){this.gridData[e].blackLists[r].visibles.push(o)}else{this.gridData[e].blackLists[r].hiddens.push(o)}}for(var s=0;s<l.length;s++){if(this.gridData[e].blackLists[r].visibles.indexOf(l[s])==-1){this.gridData[e].blackLists[r].visibles.push(l[s])}}for(var s=0;s<n.length;s++){if(this.gridData[e].blackLists[r].hiddens.indexOf(n[s])==-1){this.gridData[e].blackLists[r].hiddens.push(n[s])}}}}}var u=false;var c=true;var v=[];for(var d=0;d<this.gridData[e].blackLists[r].visibles.length;d++){if(this.gridData[e].blackLists[r].visibles[d]!="#NuN#"){v.push(this.gridData[e].blackLists[r].visibles[d])}}var h=[];if(this.gridData[e].blackLists[r].state!="none"){for(var d=0;d<this.gridData[e].differentValues[r].length;d++){var o=this.gridData[e].differentValues[r][d];if(o!="#NuN#"&&v.indexOf(o)==-1){h.push(o)}}for(var d=0;d<this.gridData[e].blackLists[r].hiddens.length;d++){if(this.gridData[e].blackLists[r].hiddens[d]!="#NuN#"&&h.indexOf(this.gridData[e].blackLists[r].hiddens[d])==-1){h.push(this.gridData[e].blackLists[r].hiddens[d])}}if(v.length==0&&this.gridData[e].blackLists[r].defaultAction=="Exclude"){h=[]}}if(t.op=="none"){c=false;v=[];h=[]}else{if(this.gridData[e].differentValues[r].indexOf("#NuN#")>-1||h.indexOf(this.gridData[e].blackLists[r].hiddens[d])!=-1){if(this.gridData[e].blackLists[r].visibles.indexOf("#NuN#")==-1){c=false}}else{if(this.gridData[e].blackLists[r].defaultAction=="Exclude"){c=false}}}if(this.gridData[e].blackLists[r].hasNull&&!(t.op=="none")){var p=this.gridData[e].defaultNullText;var m=false;var T=0;for(var s=0;s<this.gridData[e].differentValues[r].length;s++){T=this.gridData[e].differentValues[r][s].length}for(var s=0;s<this.gridData[e].differentValues[r].length;s++){if(this.gridData[e].differentValues[r][s].trimpivot()==this.gridData[e].defaultNullText){p=this.gridData[e].differentValues[r][s];m=true;break}}if(!m){for(var d=0;d<T-this.gridData[e].defaultNullText.length;d++){p=p+" "}}if(!c){if(h.indexOf(p)==-1){h.push(p);if(this.gridData[e].blackLists[r].hiddens.indexOf(p)==-1){this.gridData[e].blackLists[r].hiddens.push(p)}}if(v.indexOf(p)!=-1){v.splice(v.indexOf(p),1)}if(this.gridData[e].blackLists[r].visibles.indexOf(p)!=-1){this.gridData[e].blackLists[r].visibles.splice(this.gridData[e].blackLists[r].visibles.indexOf(p),1)}}else{if(v.indexOf(p)==-1){if(h.indexOf(p)!=-1){h.splice(h.indexOf(p),1);v.push(p)}else{if(this.gridData[e].blackLists[r].defaultAction=="Exclude"){v.push(p)}}if(this.gridData[e].blackLists[r].hiddens.indexOf(p)!=-1){this.gridData[e].blackLists[r].hiddens.splice(this.gridData[e].blackLists[r].hiddens.indexOf(p),1);if(this.gridData[e].blackLists[r].visibles.indexOf(p)==-1){this.gridData[e].blackLists[r].visibles.push(p)}}}}}var A=false;if(this.gridData[e].differentValuesPaginationInfo[r]!=null){A=this.gridData[e].differentValuesPaginationInfo[r].previousPage==this.gridData[e].differentValuesPaginationInfo[r].totalPages}var y=(c||!this.gridData[e].blackLists[r].hasNull)&&h.length==0&&t.op!="none"&&t.op!="push"&&(this.gridData[e].blackLists[r].defaultAction=="Include"||A)&&!(t.op=="reverse");var i=0;for(var d=0;d<this.gridData[e].filterInfo.length;d++){if(this.gridData[e].filterInfo[d].DataField==r){u=true;this.gridData[e].filterInfo[d].NullIncluded=c;this.gridData[e].filterInfo[d].NotNullValues.Included=v;this.gridData[e].filterInfo[d].NotNullValues.Excluded=h;this.gridData[e].filterInfo[d].NotNullValues.DefaultAction=this.gridData[e].blackLists[r].defaultAction;i=d}}if(y){this.gridData[e].filterInfo.splice(i,1)}if(!u&&!y){var w={Included:v,Excluded:h,DefaultAction:this.gridData[e].blackLists[r].defaultAction};filter={DataField:r,NullIncluded:c,NotNullValues:w};this.gridData[e].filterInfo.push(filter)}},readScrollValue:function(e,r){var t=this.gridData[e].columnDataField[r];var i=this.gridData[e].originalColumnDataField.indexOf(this.gridData[e].columnDataField[r]);if(!this.gridData[e].differentValuesPaginationInfo[t].blocked){this.gridData[e].differentValuesPaginationInfo[t].blocked=true;if(!this.gridData[e].differentValuesPaginationInfo[t].filtered){var a=this.gridData[e].differentValuesPaginationInfo[t];var s=a.previousPage+1;this.gridData[e].lastRequestValue=t;OAT_JS.grid.lastCallToQueryViewer="readScrollValue";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,filterValue:"",dataField:t};self.requestAttributeForTable(e,t,s,"",10)}else{var a=this.gridData[e].filteredValuesPaginationInfo[t];var s=a.previousPage+1;this.gridData[e].lastRequestValue=t;var n=a.filteredText;OAT_JS.grid.lastCallToQueryViewer="readScrollValueFilter";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,posColumnNumber:i,filterValue:n,dataField:t,filterText:n};self.requestAttributeForTable(e,t,s,n,10)}}},appendNewValueData:function(e,r,t){var i=this.gridData[e].lastRequestValue;var a=this.gridData[e].differentValuesPaginationInfo[i];if(r.PageNumber>a.previousPage||t){this.gridData[e].differentValuesPaginationInfo[i].previousPage=r.PageNumber;this.gridData[e].differentValuesPaginationInfo[i].totalPages=r.PagesCount;var s=[];if(r.Null){if(this.gridData[e].differentValues[i].indexOf("#NuN#")==-1){this.gridData[e].differentValues[i].push("#NuN#")}}for(var n=0;n<r.NotNullValues.length;n++){var f=r.NotNullValues[n];if(this.gridData[e].differentValues[i].indexOf(f)==-1){this.gridData[e].differentValues[i].push(f);s.push(f)}if(this.gridData[e].blackLists[i].defaultAction=="Include"){if(this.gridData[e].blackLists[i].visibles.indexOf(f)==-1&&this.gridData[e].blackLists[i].hiddens.indexOf(f)==-1){this.gridData[e].blackLists[i].visibles.push(f)}}else{if(this.gridData[e].blackLists[i].visibles.indexOf(f)==-1&&this.gridData[e].blackLists[i].hiddens.indexOf(f)==-1){this.gridData[e].blackLists[i].hiddens.push(f)}}}var l=this.gridData[e].columnDataField.indexOf(i);var o=this.gridData[e].originalColumnDataField.indexOf(i);this.gridData[e].grid.loadDifferentValues(l,this.gridData[e].differentValues[i]);for(var u=0;u<s.length;u++){var c=true;if(this.gridData[e].blackLists[i].state!="all"){if(this.gridData[e].blackLists[i].visibles.indexOf(s[u])<0){c=false}}if(!(this.gridData[e].blackLists[i].hasNull&&s[u].trimpivot()==this.gridData[e].defaultNullText)){var v=OAT.ApplyPictureValue(s[u].trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[o],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[o]).replace(/ /g,"Â ");OAT.appendNewPairToPopUp(this.gridData[e],s[u],l,c,v,i)}}}if(this.gridData[e].differentValuesPaginationInfo[i].previousPage<r.PagesCount)this.gridData[e].differentValuesPaginationInfo[i].blocked=false},resetScrollValue:function(e,r,t){this.gridData[e].differentValuesPaginationInfo[r].filtered=false;this.gridData[e].differentValuesPaginationInfo[r].blocked=true;var t=this.gridData[e].columnDataField.indexOf(r);var i=this.gridData[e].originalColumnDataField.indexOf(r);OAT.removeAllPairsFromPopUp(this.gridData[e],t,OAT_JS.grid.cantPages(e,r)>1);for(var a=0;a<this.gridData[e].differentValues[r].length;a++){var s=true;var n=this.gridData[e].differentValues[r][a];if(this.gridData[e].blackLists[r].state!="all"){if(this.gridData[e].blackLists[r].visibles.indexOf(n)<0){s=false}}var f=OAT.ApplyPictureValue(n.trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[i],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[i]).replace(/ /g,"Â ");if(!(this.gridData[e].blackLists[r].hasNull&&n.trimpivot()==this.gridData[e].defaultNullText)){OAT.appendNewPairToPopUp(this.gridData[e],n,t,s,f,r)}}if(this.gridData[e].differentValuesPaginationInfo[r].previousPage<OAT_JS.grid.cantPages(e,r))this.gridData[e].differentValuesPaginationInfo[r].blocked=false},resetAllScrollValue:function(e){for(var r=0;r<this.gridData[e].grid.columns.length;r++){var t=this.gridData[e].grid.columns[r].getAttribute("dataField");this.gridData[e].differentValuesPaginationInfo[t].filtered=false;this.gridData[e].differentValuesPaginationInfo[t].blocked=true;if(this.gridData[e].differentValuesPaginationInfo[t].previousPage<this.gridData[e].differentValuesPaginationInfo[t].totalPages)this.gridData[e].differentValuesPaginationInfo[t].blocked=false}},appendNewFilteredValueData:function(e,r,t,i){var a=this.gridData[e].lastRequestValue;var t=this.gridData[e].columnDataField.indexOf(a);var s=this.gridData[e].originalColumnDataField.indexOf(a);var n=this.gridData[e].filteredValuesPaginationInfo[a];if((i||i=="")&&n.filteredText!=i){return}if(r.PageNumber>n.previousPage){this.gridData[e].filteredValuesPaginationInfo[a].previousPage=r.PageNumber;this.gridData[e].filteredValuesPaginationInfo[a].totalPages=r.PagesCount;if(r.Null){if(this.gridData[e].differentValues[a].indexOf("#NuN#")==-1){this.gridData[e].differentValues[a].push("#NuN#")}}for(var f=0;f<r.NotNullValues.length;f++){var l=this.gridData[e].differentValues[a].indexOf(r.NotNullValues[f])!=-1;if(this.gridData[e].differentValues[a].indexOf(r.NotNullValues[f])==-1){this.gridData[e].differentValues[a].push(r.NotNullValues[f])}if(this.gridData[e].blackLists[a].defaultAction=="Include"&&!l){if(this.gridData[e].blackLists[a].visibles.indexOf(r.NotNullValues[f])==-1&&this.gridData[e].blackLists[a].hiddens.indexOf(r.NotNullValues[f])==-1){this.gridData[e].blackLists[a].visibles.push(r.NotNullValues[f])}}else{if(this.gridData[e].blackLists[a].visibles.indexOf(r.NotNullValues[f])==-1&&this.gridData[e].blackLists[a].hiddens.indexOf(r.NotNullValues[f])==-1){this.gridData[e].blackLists[a].hiddens.push(r.NotNullValues[f])}}var o=true;if(this.gridData[e].blackLists[a].state!="all"){if(this.gridData[e].blackLists[a].visibles.indexOf(r.NotNullValues[f])<0){o=false}}var u=OAT.ApplyPictureValue(r.NotNullValues[f].trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[s],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[s]).replace(/ /g,"Â ");if(!(this.gridData[e].blackLists[a].hasNull&&r.NotNullValues[f].trimpivot()==this.gridData[e].defaultNullText)){OAT.appendNewPairToPopUp(this.gridData[e],r.NotNullValues[f],t,o,u,a)}}if(this.gridData[e].filteredValuesPaginationInfo[a].previousPage<r.PagesCount)this.gridData[e].differentValuesPaginationInfo[a].blocked=false}},initValueRead:function(e,r,t){if(r>=this.gridData[e].grid.columns.length){this.gridData[e].endValueRead=true;return}else{if(this.gridData[e].grid.columns[r].getAttribute("visible")!="Never"){if(t==undefined){this.gridData[e].grid.lastRequestValue=this.gridData[e].grid.columns[r].getAttribute("dataField")}else{this.gridData[e].grid.lastRequestValue=t}if(this.gridData[e].differentValuesPaginationInfo[this.gridData[e].grid.lastRequestValue].previousPage>0){if(t==undefined){r++;OAT_JS.grid.initValueRead(e,r)}}var i=10;if(this.gridData[e].QueryViewerCollectionItem.AutoRefreshGroup!=""){i=0}OAT_JS.grid.lastCallToQueryViewer="initValueRead";OAT_JS.grid.lastCallData={self:this,UcId:e,columnNumber:r,filterValue:"",dataField:t};self.requestAttributeForTable(e,this.gridData[e].grid.lastRequestValue,1,"",i)}else{r++;OAT_JS.grid.initValueRead(e,r,t)}}},initValueLoad:function(e,r,t){dataField=this.gridData[r].grid.lastRequestValue;this.gridData[r].differentValuesPaginationInfo[dataField].previousPage=e.PageNumber;this.gridData[r].differentValuesPaginationInfo[dataField].totalPages=e.PagesCount;var i=0;for(var a=0;a<this.gridData[r].grid.columns.length;a++){if(this.gridData[r].grid.lastRequestValue==this.gridData[r].grid.columns[a].getAttribute("dataField")){i=a;break}}if(e.Null){this.gridData[r].blackLists[dataField].hasNull=true;if(this.gridData[r].differentValues[dataField].indexOf("#NuN#")==-1){this.gridData[r].differentValues[dataField].push("#NuN#")}var s=true;for(var n=0;n<this.gridData[r].filterInfo.length;n++){if(this.gridData[r].filterInfo[n].DataField==dataField){if(!this.gridData[r].filterInfo[n].NullIncluded){s=false}}}if(s&&this.gridData[r].blackLists[dataField].visibles.indexOf("#NuN#")==-1){this.gridData[r].blackLists[dataField].visibles.push("#NuN#")}}else{this.gridData[r].blackLists[dataField].hasNull=false}for(var n=0;n<e.NotNullValues.length;n++){if(this.gridData[r].differentValues[dataField].indexOf(e.NotNullValues[n])==-1){this.gridData[r].differentValues[dataField].push(e.NotNullValues[n])}if(this.gridData[r].blackLists[dataField].state=="all"&&this.gridData[r].blackLists[dataField].visibles.indexOf(e.NotNullValues[n])==-1){this.gridData[r].blackLists[dataField].visibles.push(e.NotNullValues[n])}if(this.gridData[r].blackLists[dataField].state=="none"&&this.gridData[r].blackLists[dataField].hiddens.indexOf(e.NotNullValues[n])==-1){this.gridData[r].blackLists[dataField].hiddens.push(e.NotNullValues[n])}if(this.gridData[r].blackLists[dataField].defaultAction=="Exclude"&&this.gridData[r].blackLists[dataField].state==""&&e.NotNullValues[n].trimpivot()!=""&&this.gridData[r].blackLists[dataField].visibles.length>0){for(var f=0;f<this.gridData[r].blackLists[dataField].visibles.length;f++){if(this.gridData[r].blackLists[dataField].visibles[f]==e.NotNullValues[n].trimpivot()){this.gridData[r].blackLists[dataField].visibles[f]=e.NotNullValues[n]}}}}this.gridData[r].grid.loadDifferentValues(i,this.gridData[r].differentValues[dataField]);if(t==undefined){i++;OAT_JS.grid.initValueRead(r,i)}},changeValues:function(e,r,t,i,a){var s=jquery("#"+e+r)[0];if((s.value||s.value=="")&&s.value!=a){return}var t=this.gridData[e].columnDataField.indexOf(r);var n=this.gridData[e].originalColumnDataField.indexOf(r);this.gridData[e].differentValuesPaginationInfo[r].filtered=true;this.gridData[e].differentValuesPaginationInfo[r].blocked=true;OAT.removeAllPairsFromPopUp(this.gridData[e],t,i.PagesCount>1);this.gridData[e].filteredValuesPaginationInfo[r].previousPage=1;this.gridData[e].filteredValuesPaginationInfo[r].totalPages=i.PagesCount;this.gridData[e].filteredValuesPaginationInfo[r].filteredText=a;for(var f=0;f<i.NotNullValues.length;f++){var l=this.gridData[e].differentValues[r].indexOf(i.NotNullValues[f])!=-1;if(this.gridData[e].differentValues[r].indexOf(i.NotNullValues[f])==-1){this.gridData[e].differentValues[r].push(i.NotNullValues[f])}if(this.gridData[e].blackLists[r].state=="all"||this.gridData[e].blackLists[r].defaultAction=="Include"&&!l){if(this.gridData[e].blackLists[r].visibles.indexOf(i.NotNullValues[f])==-1&&this.gridData[e].blackLists[r].hiddens.indexOf(i.NotNullValues[f])==-1){this.gridData[e].blackLists[r].visibles.push(i.NotNullValues[f])}}var o=true;if(this.gridData[e].blackLists[r].state!="all"){if(this.gridData[e].blackLists[r].visibles.indexOf(i.NotNullValues[f])<0){o=false}}this.gridData[e].filteredValuesPaginationInfo[r].values.push(i.NotNullValues[f]);var u=OAT.ApplyPictureValue(i.NotNullValues[f].trimpivot(),this.gridData[e].rowsMetadata.columnsDataType[n],this.gridData[e].rowsMetadata.defaultPicture,this.gridData[e].rowsMetadata.forPivotCustomPicture[n]).replace(/ /g,"Â ");if(!(this.gridData[e].blackLists[r].hasNull&&i.NotNullValues[f].trimpivot()==this.gridData[e].defaultNullText)){OAT.appendNewPairToPopUp(this.gridData[e],i.NotNullValues[f],t,o,u,r)}}if(i.PagesCount>0)this.gridData[e].differentValuesPaginationInfo[r].blocked=false},setColumnVisibleValue:function(e,r,t){var i=this.gridData[e].originalColumnDataField.indexOf(this.gridData[e].columnDataField[r]);this.gridData[e].columnVisible[i]=t;OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[e],e,OAT_JS.grid.gridData[e].blackLists,OAT_JS.grid.gridData[e].columnVisible,OAT_JS.grid.gridData[e].columnDataField);if(this.gridData[e].QueryViewerCollectionItem.AutoRefreshGroup!=""){OAT_JS.grid.initValueRead(e,0);var a=function(){if(!OAT_JS.grid.gridData[e].endValueRead){setTimeout(a,100)}else{var r=OAT.createXMLMetadata(OAT_JS.grid.gridData[e],null,true);var t=OAT_JS.grid.gridData[e].IdForQueryViewerCollection;setTimeout((function(){var e={QueryviewerId:t,Metadata:r};var i=document.createEvent("Events");i.initEvent("RequestUpdateLayoutSameGroup",true,true);i.parameter=e;document.dispatchEvent(i)}),50)}};a()}},getTableWhenServerPagination:function(e,r){var t=r.split("<Recordset");var i="<Recordset"+t[1];var a=i.split("</Page>");var s=a[0]+"</Page>\n</Recordset>";return s},setFilterChangedWhenServerPagination:function(e,r){if(this.gridData[e].QueryViewerCollectionItem.FilterChanged){var t=r.getAttribute("dataField");var i=OAT_JS.grid.gridData[e].differentValues[t];if(OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t].previousPage==OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t].totalPages){var a='<DATA event="FilterChanged" name="'+r.getAttribute("name")+'" displayName="'+r.getAttribute("displayName")+'">';for(var s=0;s<i.length;s++){var n=true;if(OAT_JS.grid.gridData[e].blackLists[t].state!="all"){if(OAT_JS.grid.gridData[e].blackLists[t].visibles.indexOf(i[s])<0){n=false}}if(n){a=a+"<VALUE>"+i[s]+"</VALUE>"}}a=a+"</DATA>";var f=new DOMParser;var l=f.parseFromString(a,"text/xml");var o=function(e,r){var t;var i;if(e.evaluate){t=e.evaluate(r,e,null,XPathResult.ANY_TYPE,null);i=t.iterateNext()}else{t=e.selectNodes(r);i=t.length>0?t[0]:null}return i};var u=o(l,"/DATA");var c={};c.Name=u.getAttribute("name");c.SelectedValues=[];var v=-1;for(var d=0;d<u.childNodes.length;d++)if(u.childNodes[d].nodeName=="VALUE"){v++;c.SelectedValues[v]=u.childNodes[d].firstChild.nodeValue}self.fireOnFilterChanged(e,c)}else{OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t].blocked=true;var h=OAT_JS.grid.gridData[e].differentValuesPaginationInfo[t];var p=h.previousPage+1;OAT_JS.grid.gridData[e].lastRequestValue=t;OAT_JS.grid.lastCallToQueryViewer="filterChange";OAT_JS.grid.lastCallData={self:this,UcId:e,filterValue:"",dataField:t,oatDimension:r};self.requestAttributeForTable(e,t,p,"",0)}}},getAllDataRowsForExport:function(e,r,t,i){OAT_JS.grid.lastCallToQueryViewer="getAllDataRowsForExport";OAT_JS.grid.lastCallData={UcId:e,_selfgrid:r,fileName:t,format:i};self.requestPageDataForTable(1,0,false,OAT_JS.grid.gridData[e].dataFieldOrder,OAT_JS.grid.gridData[e].orderType,OAT_JS.grid.gridData[e].filterInfo,false,OAT_JS.grid.gridData[e].IdForQueryViewerCollection)},restoreDefaultView:function(e){this.gridData[e].redrawHeader=true;this.gridData[e].columnDataField=this.gridData[e].originalColumnDataField;OAT_JS.grid.gridData[e].dataFieldOrder="";OAT_JS.grid.gridData[e].orderType="";this.gridData[e].filterInfo=[];var r=[];for(var t=0;t<OAT_JS.grid.gridData[e].grid.columns.length;t++){r[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")]=this.gridData[e].blackLists[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")].hasNull}for(var t=0;t<OAT_JS.grid.gridData[e].grid.columns.length;t++){this.gridData[e].blackLists[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")]={state:"all",visibles:[],defaultAction:"Include",hiddens:[],hasNull:r[OAT_JS.grid.gridData[e].grid.columns[t].getAttribute("dataField")]}}var i=0;for(var a=0;a<this.gridData[e].columnVisible.length;a++){this.gridData[e].grid.applySortOrderType(a,1);this.gridData[e].columnVisible[a]=OAT_JS.grid.gridData[e].grid.columns[a].getAttribute("visible").toLowerCase()=="yes";if(this.gridData[e].columnVisible[a]){this.gridData[e].grid.showColumnHeader(i);i=i+1}else{this.gridData[e].grid.hideColumnHeader(i);i=i+1}}this.gridData[e].rowsPerPage=this.gridData[e].defaultValues.rowsPerPage;if(jquery("#"+this.gridData[e].grid.controlName+"tablePagination_rowsPerPage").length>0){jquery("#"+this.gridData[e].grid.controlName+"tablePagination_rowsPerPage")[0].value=this.gridData[e].defaultValues.rowsPerPage}},getStateChange:function(e){if(this.gridData[e].rowsPerPage!=this.gridData[e].defaultValues.rowsPerPage){return true}if(this.gridData[e].defaultValues.dataFieldOrder!=OAT_JS.grid.gridData[e].dataFieldOrder||this.gridData[e].defaultValues.orderType!=OAT_JS.grid.gridData[e].orderType){return true}if(this.gridData[e].filterInfo!=undefined&&this.gridData[e].filterInfo.length>0){return true}for(var r=0;r<this.gridData[e].columnVisible.length;r++){var t=OAT_JS.grid.gridData[e].grid.columns[r].getAttribute("visible").toLowerCase()=="yes";if(this.gridData[e].columnVisible[r]!=t){return true}}for(var i=0;i<this.gridData[e].columnDataField.length;i++){if(this.gridData[e].columnDataField[i]!=this.gridData[e].originalColumnDataField[i])return true}return false},refreshPivotWhenServerPagination:function(e,r,t,i){self.getDataForTable(e,1,this.gridData[e].rowsPerPage,true,r,t,"","","",true)},moveToFirstPage:function(e){if(this.gridData[e].actualPageNumber>1){self.getDataForTable(e,1,this.gridData[e].rowsPerPage,false,"","","","",false)}},moveToNextPage:function(e){if(this.gridData[e].actualPageNumber<this.gridData[e].actualCantPages){self.getDataForTable(e,this.gridData[e].actualPageNumber+1,this.gridData[e].rowsPerPage,false,"","","","",false)}},moveToLastPage:function(e){if(this.gridData[e].actualPageNumber<this.gridData[e].actualCantPages){self.getDataForTable(e,this.gridData[e].actualCantPages,this.gridData[e].rowsPerPage,false,"","","","",false)}},moveToPreviousPage:function(e){if(this.gridData[e].actualPageNumber>1){self.getDataForTable(e,this.gridData[e].actualPageNumber-1,this.gridData[e].rowsPerPage,false,"","","","",false)}},cantPages:function(e,r){return this.gridData[e].differentValuesPaginationInfo[r].totalPages},setDataFieldPosition:function(e,r){this.gridData[e].columnDataField=[];this.gridData[e].columnDataField=r;OAT.SaveStateWhenServerPaging(this.gridData[e],e,this.gridData[e].blackLists,this.gridData[e].columnVisible,this.gridData[e].columnDataField);if(this.gridData[e].QueryViewerCollectionItem.AutoRefreshGroup!=""){OAT_JS.grid.initValueRead(e,0);var t=function(){if(!OAT_JS.grid.gridData[e].endValueRead){setTimeout(t,100)}else{var r=OAT.createXMLMetadata(OAT_JS.grid.gridData[e],null,true);var i=OAT_JS.grid.gridData[e].IdForQueryViewerCollection;setTimeout((function(){var e={QueryviewerId:i,Metadata:r};var t=document.createEvent("Events");t.initEvent("RequestUpdateLayoutSameGroup",true,true);t.parameter=e;document.dispatchEvent(t)}),50)}};t()}},fireOnItemClickEvent:function(e,r){setTimeout((function(){var t={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection};var i=document.createEvent("Events");i.initEvent("TableOnItemClickEvent",true,true);i.parameter=t;document.dispatchEvent(i)}),0)},requestDataSynForTable:function(e){setTimeout((function(){var r={QueryviewerId:e};var t=document.createEvent("Events");t.initEvent("RequestDataSynForTable",true,true);t.parameter=r;document.dispatchEvent(t)}),0)},addValueToDifferentValues:function(e,r,t){var i=this.gridData[e].originalColumnDataField.indexOf(r);var a=this.gridData[e].grid.columnsDataType[i];var s=false;if(a=="integer"||a=="real"){s=true}var n=[];var f=false;if(t=="#NuN#"){n.push(t);f=true}for(var l=0;l<this.gridData[e].differentValues[r].length;l++){if(!s){if(t<this.gridData[e].differentValues[r][l]&&!f){n.push(t);f=true}n.push(this.gridData[e].differentValues[r][l])}else{if(parseFloat(t)<parseFloat(this.gridData[e].differentValues[r][l])&&!f){n.push(t);f=true}n.push(this.gridData[e].differentValues[r][l])}}if(!f){n.push(t)}this.gridData[e].differentValues[r]=n}};OAT_JS.pivot={panel:1,tab:5,div:"",needs:["pivot","statistics"],cb:function(e,r,t,i,a,s,n,f,l,o,u,c,v,d,h,p,m,T,A,y,w,O,g,_,b){this.div=r;var x=e.columnNumbers.length+e.rowNumbers.length+e.filterNumbers.length;if(e.measures.length>1){var S=x;x=x+e.measures.length-1;for(var I=S;I<x;I++){e.columnNumbers.push(I)}}else{for(var I=0;I<e.data.length;I++){e.data[I].push("0")}}var k;k=new OAT.Pivot(e,i,t,e.header,e.data,e.columnNumbers,e.rowNumbers,e.filterNumbers,x,e.query,e.conditionalFormats,v,e.pageSize,a,s,n,r,f,l,o,e.measures,u,c,v,d,h,p,m,T,A,y,w,O,g,_,{Allow:b.AllowSelection,EntireLine:b.SelectLine},{TotalForRows:b.TotalForRows,TotalForColumns:b.TotalForColumns},b.Title);return k}};function parseToIntRegisterValue(e,r){if(e.indexOf(r)>0){var t=e.split(r+'="');if(t.length==1){t=e.split(r+"='");return t[1]?parseInt(t[1].split("'")[0]):-1}return t[1]?parseInt(t[1].split('"')[0]):-1}return-1}function parseToStringRegisterValue(e,r){if(e.indexOf(r)>0){var t=e.split(r+'="');if(t.length==1){t=e.split(r+"='");return t[1]?t[1].split("'")[0]:-1}return t[1]?t[1].split('"')[0]:-1}return-1}function EvaluateExpressionPivotJs(e,r,t){var i=[];for(var a=0;a<e.length;a++){i[a]=e[a]}var s=[];while(i.length!=0){var n=i.shift();if(isOperator(n)){var f=s.pop();var l=s.pop();var o=PerformOperation(parseFloat(f),parseFloat(l),n);s.push(o)}else{if(isNaN(parseInt(n))){if(r[t.itemPosition[n]]=="#NuN#")return"#NuN#";s.push(r[t.itemPosition[n]])}else{s.push(n)}}}return s.pop()}function PerformOperation(e,r,t){switch(t){case"+":return e+r;case"-":return r-e;case"*":return e*r;case"/":return r/e;default:return}}function InfixToPostfix(e){var r=e.split(" ");var t=[];var i=[];while(r.length!=0){var a=r.shift();if(isOperator(a)){while(getAssociativity(a)=="left"&&getPrecedence(a)<=getPrecedence(i[i.length-1])||getAssociativity(a)=="right"&&getPrecedence(a)<getPrecedence(i[i.length-1])){t.push(i.pop())}i.push(a)}else if(a=="("){i.push(a)}else if(a==")"){while(i[i.length-1]!="("){if(i.length==0)throw"";t.push(i.pop())}i.pop()}else{t.push(a)}}while(i.length!=0){if(!i[i.length-1].match(/([()])/))t.push(i.pop());else throw"Parenthesis balancing error! Shame on you!"}return t.join(" ")}function isOperator(e){if(!e.match(/([*+-\/])/))return false;else return true}function getPrecedence(e){switch(e){case"^":return 9;case"*":case"/":case"%":return 8;case"+":case"-":return 6;default:return-1}}function getAssociativity(e){switch(e){case"+":case"-":case"*":case"/":return"left";case"^":return"right"}}function OATSetCookie(e,r,t,i,a,s){document.cookie=e+"="+escape(r)+(t==null?"":"; expires="+t.toGMTString())+(i==null?"":"; path="+i)+(a==null?"":"; domain="+a)+(s==null?"":"; secure")}function OATGetCookie(e){var r=e+"=";var t=document.cookie;if(t.length>0){begin=t.indexOf(r);if(begin!=-1){begin+=r.length;end=t.indexOf(";",begin);if(end==-1)end=t.length;return unescape(t.substring(begin,end))}}return null}function OATGetRowsFromXML(e,r,t){var i=[];var a=e.split("<Rows>");if(a.length){a=a[1].split("</Rows>");a=a[0].split("<Row>");for(var s=1;s<a.length;s++){var n={headers:[],cells:[],subTotal:false,dataField:-1,rowSpan:0};var f=parseToStringRegisterValue(a[s],"Subtotal");if(f=="true"){n.subTotal=true}var l;if(a[s].indexOf("</Header>")>0){l=a[s].split("</Header>")[0].replace("<Header>","")}else{l=a[s].split("/>")[0].replace("<Header","")}n.dataField=parseToStringRegisterValue(l,"DataField");var o=l.replace(/<\//g,"-*-5").replace(/\/>/g,"-*-5");var u=o.split("-*-5");for(var c=1;c<u.length;c++){var v;var d=u[c].split(">")[0];if(d==""){d=u[c-1].split("<")[1].split(" ")[0];v="#NuN#"}else{try{v=u[c-1].split(d+">")[1].split("<")[0]}catch(e){v="#NuN#"}}var h={dataField:d,value:v,rowSpan:1};var p=u.length-1;if(t){p=u.length;if(n.subTotal){p--}}var m=c-p>=0;if(i.length>0&&!m){if(c-1==0||n.headers[c-2].rowSpan==0){if(v==i[s-2].headers[c-1].value){h.rowSpan=0;var T=s-2;while(T>=0){if(i[T].headers[c-1].rowSpan>0){i[T].headers[c-1].rowSpan++;break}T--}}}}n.headers.push(h)}if(t&&n.subTotal){if(s==1||!i[s-2].subTotal||n.headers.length!=i[s-2].headers.length){n.rowSpan=1}else{var T=s-2;while(T>=0){if(i[T].rowSpan>0){i[T].rowSpan++;break}T--}}}var A=a[s].split("<Cells>")[1].split("</Cell>");for(var y=0;y<A.length-1;y++){var w=n.dataField!=-1?n.dataField:r.columnsHeaders[y].dataField;for(var O=1;O<A[y].split("<Cell />").length;O++){var g={value:"#NuN#",dataField:w};n.cells.push(g)}var v=A[y].split("<Cell>")[1];var g={value:v,dataField:w};n.cells.push(g)}for(var O=1;O<A[y].split("<Cell />").length;O++){var g={value:"#NuN#",dataField:w};n.cells.push(g)}i.push(n)}}return i}function OATGetColumnsHeadersFromXML(e){var r=e.split("<Columns>");var t=[];if(r.length>1){r=r[1].split("</Columns>")[0];var i=r.split("<Header");for(var a=1;a<i.length;a++){var s=parseToStringRegisterValue(i[a],"DataField");var n=parseToStringRegisterValue(i[a],"Subtotal");var f=[];var l=i[a].replace('DataField="'+s+'">',"").replace("DataField='"+s+"'>","").replace("</Header>","").replace(/IsNull="true" \/>/g,">#NuN#<F>").replace(/IsNull='true' \/>/g,">#NuN#<F>").replace(/IsNull="true"\/>/g,">#NuN#<F>").split("<");if(l.length>1){for(var o=1;o<l.length-1;o++){if(o%2==1){var u=l[o].split(">")[0];var c=l[o].split(u+">")[1];var v={dataField:u,value:c,colSpan:1};f.push(v)}}}t.push({dataField:s,subTotal:n=="true",subHeaders:f})}}return t}function OATGetNewDataFromXMLForPivot(e,r,t,i){e=e.replace(/<Cell\/>/g,"<Cell />");if(i==undefined||i==""){if(parseToIntRegisterValue(e,"RecordCount")!=-1){r.ServerRecordCount=parseToIntRegisterValue(e,"RecordCount")}if(parseToIntRegisterValue(e,"PageCount")!=-1){r.ServerPageCount=parseToIntRegisterValue(e,"PageCount")}}r.ServerPageNumber=parseToIntRegisterValue(e,"PageNumber");if(e.split("<Columns>").length>1){r.columnsHeaders=OATGetColumnsHeadersFromXML(e)}r.rows=OATGetRowsFromXML(e,r,t);return r}function OATgetDataFromXMLOldFormat(e,r,t){var i=e.split("<Record>");var a=[];var s=[];for(var n=1;n<i.length;n++){var f=[];var l=[];for(var o=0;o<r.length;o++){f[o]="#NuN#";var u=i[n].split("<"+r[o]+">");if(u.length>1){var c=u[1].split("</"+r[o]+">");f[o]=c[0];l[o]=f[o]}}a.push(f);if(t!=undefined){var v=r.length;for(var o=0;o<t.length;o++){l[v+o]=undefined;var u=i[n].split("<"+t[o]+">");if(u.length>1){var c=u[1].split("</"+t[o]+">");l[v+o]=c[0]}}s.push(l)}}if(t!=undefined){return[a,s]}else{return a}}var OATParseMetadata=function(e,r,t,i,a){var s=[];var n=[];var f=[];var l;if(e.indexOf("<OLAPDimension")!=-1){l=e.substring(0,e.indexOf("<OLAPDimension"))}else{l=e.substring(0,e.indexOf("<OLAPMeasure"))}var o=e.substring(e.indexOf("<OLAPDimension"),e.length);var u=o.split("<OLAPDimension");for(var c=1;c<u.length;c++){if(u[c].length>0){if(u[c].indexOf("</OLAPDimension>")!=-1){u[c]=u[c].substring(0,u[c].indexOf("</OLAPDimension>"))}else{u[c]=u[c].substring(0,u[c].indexOf("/>"))+">"}var v=false;if(r!=undefined&&r.length>0){var d=u[c].split('dataField="')[1].split('"')[0];v=r.indexOf(d)!=-1}if((u[c].indexOf('visible="No"')!=-1||u[c].indexOf('visible="Never"')!=-1)&&r==undefined||v&&r!=undefined){try{if(u[c].indexOf("displayName=")!=-1){var h=u[c].substring(u[c].indexOf("displayName=")+13);s.push(h.split('"')[0]);n.push(u[c].substring(u[c].indexOf("dataField=")+11).split('"')[0]);try{f.push(u[c].substring(u[c].indexOf("name=")+6).split('"')[0])}catch(e){}}}catch(e){}u[c]=""}else{u[c]="<OLAPDimension "+u[c]+"</OLAPDimension>"}}else{u[c]=""}}var p=o.split("<OLAPMeasure");var m=true;for(var c=1;c<p.length;c++){var v=false;if(t!=undefined&&t.length>0){var d=p[c].split('dataField="')[1].split('"')[0];v=t.indexOf(d)!=-1}if(!v){if(p[c].indexOf("</OLAPMeasure")!=-1){p[c]="<OLAPMeasure "+p[c].substring(0,p[c].indexOf("</OLAPMeasure>"))+"</OLAPMeasure>"}else if(p[c].indexOf("/>")!=-1){p[c]="<OLAPMeasure "+p[c].substring(0,p[c].indexOf("/>"))+"/>"}else{p[c]=""}m=false}else{p[c]=""}}if(i&&m){p.push('<OLAPMeasure name="Quantity" displayName="'+a.GXPL_QViewerQuantity+'" description="'+a.GXPL_QViewerQuantity+'" dataField="F0" aggregation="count" summarize="yes" align="right" picture="" targetValue="0" defaultPosition="data" validPositions="data" dataType="integer" format="borderThickness:1"> </OLAPMeasure>')}var T="</OLAPCube>";e="";e=l;for(var c=1;c<u.length;c++){if(u[c].length>0){e=e+u[c]}}for(var c=1;c<p.length;c++){if(p[c].length>0){e=e+p[c]}}e=e+T;return[e,s,n,f]};var OATGetColumnsAndMeasureMeatadata=function(e,r,t,i){var a=[];var s=[];var n=[];var f=[];var l=[];var o=[];var u=[];var c=0;var v=0;var d=[];var h=[];var p=[];var m=[];for(var T=0;T<e.length;T++){if(e[T].attributes.getNamedItem("axis").nodeValue.toLowerCase()=="rows"||e[T].attributes.getNamedItem("axis").nodeValue==""){s[c]=e[T].attributes.getNamedItem("displayName").nodeValue;a[T]=s[c];c++}if(e[T].attributes.getNamedItem("axis").nodeValue.toLowerCase()=="columns"){n[v]=e[T].attributes.getNamedItem("displayName").nodeValue;a[T]=n[v];v++}if(e[T].attributes.getNamedItem("axis").nodeValue.toLowerCase()=="pages"){f[v]=e[T].attributes.getNamedItem("displayName").nodeValue;a[T]=f[v];v++}d[T]=e[T].attributes.getNamedItem("dataType").nodeValue;if(e[T].childNodes.length>0){if(e[T].childNodes!=null){for(var A=0;A<e[T].childNodes.length;A++){if(e[T].childNodes[A].localName=="formatValues"){for(var y=0;y<e[T].childNodes[A].childNodes.length;y++){if(e[T].childNodes[A].childNodes[y].localName=="value"){var w={};w.format=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("format").nodeValue;w.recursive=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("recursive").nodeValue;var O=e[T].childNodes[A].childNodes[y].textContent;w.value=O.replace(/^\s+|\s+$/g,"");w.columnNumber=T}}}}}}if(e[T].childNodes.length>0){if(e[T].childNodes!=null){for(var A=0;A<e[T].childNodes.length;A++){if(e[T].childNodes[A].localName=="conditionalFormats"){for(var y=0;y<e[T].childNodes[A].childNodes.length;y++){if(e[T].childNodes[A].childNodes[y].localName=="rule"){var g={};g.format=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("format").nodeValue;g.operation1=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("op1").nodeValue;g.value1=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("value1").nodeValue;if(e[T].childNodes[A].childNodes[y].attributes.getNamedItem("op2")!=null){g.operation2=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("op2").nodeValue;g.value2=e[T].childNodes[A].childNodes[y].attributes.getNamedItem("value2").nodeValue}g.columnNumber=T;l.push(g)}}}}}}p.push(e[T].attributes.getNamedItem("picture").nodeValue);m.push(e[T].attributes.getNamedItem("format").nodeValue);u.push(e[T].attributes.getNamedItem("dataField").nodeValue)}var _=[];for(var T=0;T<r.length;T++){h[T]=r[T].attributes.getNamedItem("displayName").nodeValue;if(r[T].childNodes.length>0){if(r[T].childNodes!=null){for(var A=0;A<r[T].childNodes.length;A++){if(r[T].childNodes[A].localName=="formatValues"){for(var y=0;y<r[T].childNodes[A].childNodes.length;y++){if(r[T].childNodes[A].childNodes[y].localName=="value"){var w={};w.format=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("format").nodeValue;w.recursive=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("recursive").nodeValue;var O=r[T].childNodes[A].childNodes[y].textContent;w.value=O.replace(/^\s+|\s+$/g,"");w.columnNumber=T}}}}}}if(r[T].childNodes.length>0){if(r[T].childNodes!=null){for(var A=0;A<r[T].childNodes.length;A++){if(r[T].childNodes[A].localName=="conditionalFormats"){for(var y=0;y<r[T].childNodes[A].childNodes.length;y++){if(r[T].childNodes[A].childNodes[y].localName=="rule"){var g={};g.format=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("format").nodeValue;g.operation1=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("op1").nodeValue;g.value1=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("value1").nodeValue;if(r[T].childNodes[A].childNodes[y].attributes.getNamedItem("op2")!=null){g.operation2=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("op2").nodeValue;g.value2=r[T].childNodes[A].childNodes[y].attributes.getNamedItem("value2").nodeValue}g.columnNumber=T;o.push(g)}}}}}}if(r[T].attributes.getNamedItem("formula")!=undefined&&r[T].attributes.getNamedItem("formula").nodeValue!=""){_.push({hasFormula:true,textFormula:r[T].attributes.getNamedItem("formula").nodeValue})}else{_.push({hasFormula:false})}p.push(r[T].attributes.getNamedItem("picture").nodeValue);u.push(r[T].attributes.getNamedItem("dataField").nodeValue)}var b={};for(var c=0;c<i.length;c++){b[i[c]]=u.length+c}t.itemPosition=b;t.measureFormula=_;t.cantFormulaMeasures=0;for(var y=0;y<t.measureFormula.length;y++){if(t.measureFormula[y].hasFormula){t.cantFormulaMeasures++;var x=t.measureFormula[y].textFormula;var S=x;var I=["*","-","+","/","(",")"];for(var c=0;c<I.length;c++){var k=S.split(I[c]);if(k.length>1){S="";for(var T=0;T<k.length-1;T++){S=S+k[T]+" "+I[c]+" "}S=S+k[k.length-1]}}var q=InfixToPostfix(S);t.measureFormula[y].polishNotationText=q;var F=q.split(" ");while(F.indexOf("")!=-1){F.splice(F.indexOf(""),1)}var P=[];for(var v=0;v<F.length;v++){if(I.indexOf(F[v])==-1&&isNaN(parseInt(F[v]))){var N=t.itemPosition[F[v]];if(P.indexOf(N)==-1)P.push(N)}}t.measureFormula[y].relatedMeasures=P;var D=q.split(" ");while(D.indexOf("")!=-1){D.splice(D.indexOf(""),1)}t.measureFormula[y].PolishNotation=D}}return[a.concat(h),u,_,o,l,p,m]};var OATgetState=function(query,controlName){if(typeof JSON.retrocycle!=="function"){JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function rez(value){var i,item,name,path;if(value&&typeof value==="object"){if(Object.prototype.toString.apply(value)==="[object Array]"){for(i=0;i<value.length;i+=1){item=value[i];if(item&&typeof item==="object"){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[i]=eval(path)}else{rez(item)}}}}else{for(name in value){if(typeof value[name]==="object"){item=value[name];if(item){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[name]=eval(path)}else{rez(item)}}}}}}})($);return $}}try{var i;if(localStorage.getItem(OAT.getURL()+query+controlName+"HiddenState")!=null){var retrievedObject=localStorage.getItem(OAT.getURL()+query+controlName+"HiddenState");i=JSON.retrocycle(JSON.parse(retrievedObject))}if(i==null){var cookieValue=OATGetCookie('"'+OAT.getURL()+query+controlName+"HiddenState"+"cookie"+'"');if(cookieValue!=null){i=JSON.parse(cookieValue)}}return i}catch(e){try{var cookieValue=OATGetCookie('"'+OAT.getURL()+query+controlName+"HiddenState"+"cookie"+'"');var i=JSON.parse(cookieValue);return i}catch(e){return null}}};OAT.Layers=function(e){var r=this;this.baseOffset=e;this.layers=[];this.currentIndex=0;this.raise=function(e){if(-1!=r.layers.indexOf(e)){for(var t=e.style.zIndex,i=0;i<r.layers.length;i++){var a=r.layers[i];a.style.zIndex>t&&a.style.zIndex--}e.style.zIndex=r.currentIndex}};this.addLayer=function(e,t){var i=OAT.$(e);i&&(r.currentIndex++,i.style.zIndex=r.currentIndex,r.layers.push(i),OAT.Dom.attach(i,t?t:"mousedown",(function(){r.raise(i)})))};this.removeLayer=function(e){e=OAT.$(e);e=r.layers.indexOf(e);-1!=e&&r.layers.splice(e,1)};r.currentIndex=r.baseOffset};(function(){function e(e){e.fn._fadeIn=e.fn.fadeIn;var r=e.noop||function(){};var t=/MSIE/.test(navigator.userAgent);var i=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var a=e.isFunction(document.createElement("div").style.setExpression);e.blockUI=function(e){f(window,e)};e.unblockUI=function(e){l(window,e)};e.growlUI=function(r,t,i,a){var s=e('<div class="growlUI"></div>');if(r)s.append("<h1>"+r+"</h1>");if(t)s.append("<h2>"+t+"</h2>");if(i===undefined)i=3e3;var n=function(r){r=r||{};e.blockUI({message:s,fadeIn:typeof r.fadeIn!=="undefined"?r.fadeIn:700,fadeOut:typeof r.fadeOut!=="undefined"?r.fadeOut:1e3,timeout:typeof r.timeout!=="undefined"?r.timeout:i,centerY:false,showOverlay:false,onUnblock:a,css:e.blockUI.defaults.growlCSS})};n();s.css("opacity");s.mouseover((function(){n({fadeIn:0,timeout:3e4});var r=e(".blockMsg");r.stop();r.fadeTo(300,1)})).mouseout((function(){e(".blockMsg").fadeOut(1e3)}))};e.fn.block=function(r){if(this[0]===window){e.blockUI(r);return this}var t=e.extend({},e.blockUI.defaults,r||{});this.each((function(){var r=e(this);if(t.ignoreIfBlocked&&r.data("blockUI.isBlocked"))return;r.unblock({fadeOut:0})}));return this.each((function(){if(e.css(this,"position")=="static"){this.style.position="relative";e(this).data("blockUI.static",true)}this.style.zoom=1;f(this,r)}))};e.fn.unblock=function(r){if(this[0]===window){e.unblockUI(r);return this}return this.each((function(){l(this,r)}))};e.blockUI.version=2.7;e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.1,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1e3,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var s=null;var n=[];function f(f,o){var c,p;var m=f==window;var T=o&&o.message!==undefined?o.message:undefined;o=e.extend({},e.blockUI.defaults,o||{});if(o.ignoreIfBlocked&&e(f).data("blockUI.isBlocked"))return;o.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,o.overlayCSS||{});c=e.extend({},e.blockUI.defaults.css,o.css||{});if(o.onOverlayClick)o.overlayCSS.cursor="pointer";p=e.extend({},e.blockUI.defaults.themedCSS,o.themedCSS||{});T=T===undefined?o.message:T;if(m&&s)l(window,{fadeOut:0});if(T&&typeof T!="string"&&(T.parentNode||T.jquery)){var A=T.jquery?T[0]:T;var y={};e(f).data("blockUI.history",y);y.el=A;y.parent=A.parentNode;y.display=A.style.display;y.position=A.style.position;if(y.parent)y.parent.removeChild(A)}e(f).data("blockUI.onUnblock",o.onUnblock);var w=o.baseZ;var O,g,_,b;if(t||o.forceIframe)O=e('<iframe class="blockUI" style="z-index:'+w+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+o.iframeSrc+'"></iframe>');else O=e('<div class="blockUI" style="display:none"></div>');if(o.theme)g=e('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+w+++';display:none"></div>');else g=e('<div class="blockUI blockOverlay" style="z-index:'+w+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');if(o.theme&&m){b='<div class="blockUI '+o.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(w+10)+';display:none;position:fixed">';if(o.title){b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"}b+='<div class="ui-widget-content ui-dialog-content"></div>';b+="</div>"}else if(o.theme){b='<div class="blockUI '+o.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(w+10)+';display:none;position:absolute">';if(o.title){b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"}b+='<div class="ui-widget-content ui-dialog-content"></div>';b+="</div>"}else if(m){b='<div class="blockUI '+o.blockMsgClass+' blockPage" style="z-index:'+(w+10)+';display:none;position:fixed"></div>'}else{b='<div class="blockUI '+o.blockMsgClass+' blockElement" style="z-index:'+(w+10)+';display:none;position:absolute"></div>'}_=e(b);if(T){if(o.theme){_.css(p);_.addClass("ui-widget-content")}else _.css(c)}if(!o.theme)g.css(o.overlayCSS);g.css("position",m?"fixed":"absolute");if(t||o.forceIframe)O.css("opacity",0);var x=[O,g,_],S=m?e("body"):e(f);e.each(x,(function(){this.appendTo(S)}));if(o.theme&&o.draggable&&e.fn.draggable){_.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var I=a&&(!e.support.boxModel||e("object,embed",m?null:f).length>0);if(i||I){if(m&&o.allowBodyStretch&&e.support.boxModel)e("html,body").css("height","100%");if((i||!e.support.boxModel)&&!m){var k=h(f,"borderTopWidth"),q=h(f,"borderLeftWidth");var F=k?"(0 - "+k+")":0;var P=q?"(0 - "+q+")":0}e.each(x,(function(e,r){var t=r[0].style;t.position="absolute";if(e<2){if(m)t.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+o.quirksmodeOffsetHack+') + "px"');else t.setExpression("height",'this.parentNode.offsetHeight + "px"');if(m)t.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');else t.setExpression("width",'this.parentNode.offsetWidth + "px"');if(P)t.setExpression("left",P);if(F)t.setExpression("top",F)}else if(o.centerY){if(m)t.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');t.marginTop=0}else if(!o.centerY&&m){var i=o.css&&o.css.top?parseInt(o.css.top,10):0;var a="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+i+') + "px"';t.setExpression("top",a)}}))}if(T){if(o.theme)_.find(".ui-widget-content").append(T);else _.append(T);if(T.jquery||T.nodeType)e(T).show()}if((t||o.forceIframe)&&o.showOverlay)O.show();if(o.fadeIn){var N=o.onBlock?o.onBlock:r;var D=o.showOverlay&&!T?N:r;var E=T?N:r;if(o.showOverlay)g._fadeIn(o.fadeIn,D);if(T)_._fadeIn(o.fadeIn,E)}else{if(o.showOverlay)g.show();if(T)_.show();if(o.onBlock)o.onBlock.bind(_)()}u(1,f,o);if(m){s=_[0];n=e(o.focusableElements,s);if(o.focusInput)setTimeout(v,20)}else d(_[0],o.centerX,o.centerY);if(o.timeout){var C=setTimeout((function(){if(m)e.unblockUI(o);else e(f).unblock(o)}),o.timeout);e(f).data("blockUI.timeout",C)}}function l(r,t){var i;var a=r==window;var f=e(r);var l=f.data("blockUI.history");var c=f.data("blockUI.timeout");if(c){clearTimeout(c);f.removeData("blockUI.timeout")}t=e.extend({},e.blockUI.defaults,t||{});u(0,r,t);if(t.onUnblock===null){t.onUnblock=f.data("blockUI.onUnblock");f.removeData("blockUI.onUnblock")}var v;if(a)v=e("body").children().filter(".blockUI").add("body > .blockUI");else v=f.find(">.blockUI");if(t.cursorReset){if(v.length>1)v[1].style.cursor=t.cursorReset;if(v.length>2)v[2].style.cursor=t.cursorReset}if(a)s=n=null;if(t.fadeOut){i=v.length;v.stop().fadeOut(t.fadeOut,(function(){if(--i===0)o(v,l,t,r)}))}else o(v,l,t,r)}function o(r,t,i,a){var s=e(a);if(s.data("blockUI.isBlocked"))return;r.each((function(e,r){if(this.parentNode)this.parentNode.removeChild(this)}));if(t&&t.el){t.el.style.display=t.display;t.el.style.position=t.position;t.el.style.cursor="default";if(t.parent)t.parent.appendChild(t.el);s.removeData("blockUI.history")}if(s.data("blockUI.static")){s.css("position","static")}if(typeof i.onUnblock=="function")i.onUnblock(a,i);var n=e(document.body),f=n.width(),l=n[0].style.width;n.width(f-1).width(f);n[0].style.width=l}function u(r,t,i){var a=t==window,n=e(t);if(!r&&(a&&!s||!a&&!n.data("blockUI.isBlocked")))return;n.data("blockUI.isBlocked",r);if(!a||!i.bindEvents||r&&!i.showOverlay)return;var f="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(r)e(document).bind(f,i,c);else e(document).unbind(f,c)}function c(r){if(r.type==="keydown"&&r.keyCode&&r.keyCode==9){if(s&&r.data.constrainTabKey){var t=n;var i=!r.shiftKey&&r.target===t[t.length-1];var a=r.shiftKey&&r.target===t[0];if(i||a){setTimeout((function(){v(a)}),10);return false}}}var f=r.data;var l=e(r.target);if(l.hasClass("blockOverlay")&&f.onOverlayClick)f.onOverlayClick(r);if(l.parents("div."+f.blockMsgClass).length>0)return true;return l.parents().children().filter("div.blockUI").length===0}function v(e){if(!n)return;var r=n[e===true?n.length-1:0];if(r)r.focus()}function d(e,r,t){var i=e.parentNode,a=e.style;var s=(i.offsetWidth-e.offsetWidth)/2-h(i,"borderLeftWidth");var n=(i.offsetHeight-e.offsetHeight)/2-h(i,"borderTopWidth");if(r)a.left=s>0?s+"px":"0";if(t)a.top=n>0?n+"px":"0"}function h(r,t){return parseInt(e.css(r,t),10)||0}}{if(typeof jquery!="undefined"){e(jquery)}}})();try{OAT.Loader.featureLoaded("layers")}catch(e){}OAT.Layers=function(e){var r=this;this.baseOffset=e;this.layers=[];this.currentIndex=0;this.raise=function(e){if(-1!=r.layers.indexOf(e)){for(var t=e.style.zIndex,i=0;i<r.layers.length;i++){var a=r.layers[i];a.style.zIndex>t&&a.style.zIndex--}e.style.zIndex=r.currentIndex}};this.addLayer=function(e,t){var i=OAT.$(e);i&&(r.currentIndex++,i.style.zIndex=r.currentIndex,r.layers.push(i),OAT.Dom.attach(i,t?t:"mousedown",(function(){r.raise(i)})))};this.removeLayer=function(e){e=OAT.$(e);e=r.layers.indexOf(e);-1!=e&&r.layers.splice(e,1)};r.currentIndex=r.baseOffset};(function(){function e(e){e.fn._fadeIn=e.fn.fadeIn;var r=e.noop||function(){};var t=/MSIE/.test(navigator.userAgent);var i=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var a=e.isFunction(document.createElement("div").style.setExpression);e.blockUI=function(e){f(window,e)};e.unblockUI=function(e){l(window,e)};e.growlUI=function(r,t,i,a){var s=e('<div class="growlUI"></div>');if(r)s.append("<h1>"+r+"</h1>");if(t)s.append("<h2>"+t+"</h2>");if(i===undefined)i=3e3;var n=function(r){r=r||{};e.blockUI({message:s,fadeIn:typeof r.fadeIn!=="undefined"?r.fadeIn:700,fadeOut:typeof r.fadeOut!=="undefined"?r.fadeOut:1e3,timeout:typeof r.timeout!=="undefined"?r.timeout:i,centerY:false,showOverlay:false,onUnblock:a,css:e.blockUI.defaults.growlCSS})};n();s.css("opacity");s.mouseover((function(){n({fadeIn:0,timeout:3e4});var r=e(".blockMsg");r.stop();r.fadeTo(300,1)})).mouseout((function(){e(".blockMsg").fadeOut(1e3)}))};e.fn.block=function(r){if(this[0]===window){e.blockUI(r);return this}var t=e.extend({},e.blockUI.defaults,r||{});this.each((function(){var r=e(this);if(t.ignoreIfBlocked&&r.data("blockUI.isBlocked"))return;r.unblock({fadeOut:0})}));return this.each((function(){if(e.css(this,"position")=="static"){this.style.position="relative";e(this).data("blockUI.static",true)}this.style.zoom=1;f(this,r)}))};e.fn.unblock=function(r){if(this[0]===window){e.unblockUI(r);return this}return this.each((function(){l(this,r)}))};e.blockUI.version=2.7;e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.1,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1e3,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var s=null;var n=[];function f(f,o){var c,p;var m=f==window;var T=o&&o.message!==undefined?o.message:undefined;o=e.extend({},e.blockUI.defaults,o||{});if(o.ignoreIfBlocked&&e(f).data("blockUI.isBlocked"))return;o.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,o.overlayCSS||{});c=e.extend({},e.blockUI.defaults.css,o.css||{});if(o.onOverlayClick)o.overlayCSS.cursor="pointer";p=e.extend({},e.blockUI.defaults.themedCSS,o.themedCSS||{});T=T===undefined?o.message:T;if(m&&s)l(window,{fadeOut:0});if(T&&typeof T!="string"&&(T.parentNode||T.jquery)){var A=T.jquery?T[0]:T;var y={};e(f).data("blockUI.history",y);y.el=A;y.parent=A.parentNode;y.display=A.style.display;y.position=A.style.position;if(y.parent)y.parent.removeChild(A)}e(f).data("blockUI.onUnblock",o.onUnblock);var w=o.baseZ;var O,g,_,b;if(t||o.forceIframe)O=e('<iframe class="blockUI" style="z-index:'+w+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+o.iframeSrc+'"></iframe>');else O=e('<div class="blockUI" style="display:none"></div>');if(o.theme)g=e('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+w+++';display:none"></div>');else g=e('<div class="blockUI blockOverlay" style="z-index:'+w+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');if(o.theme&&m){b='<div class="blockUI '+o.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(w+10)+';display:none;position:fixed">';if(o.title){b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"}b+='<div class="ui-widget-content ui-dialog-content"></div>';b+="</div>"}else if(o.theme){b='<div class="blockUI '+o.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(w+10)+';display:none;position:absolute">';if(o.title){b+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(o.title||"&nbsp;")+"</div>"}b+='<div class="ui-widget-content ui-dialog-content"></div>';b+="</div>"}else if(m){b='<div class="blockUI '+o.blockMsgClass+' blockPage" style="z-index:'+(w+10)+';display:none;position:fixed"></div>'}else{b='<div class="blockUI '+o.blockMsgClass+' blockElement" style="z-index:'+(w+10)+';display:none;position:absolute"></div>'}_=e(b);if(T){if(o.theme){_.css(p);_.addClass("ui-widget-content")}else _.css(c)}if(!o.theme)g.css(o.overlayCSS);g.css("position",m?"fixed":"absolute");if(t||o.forceIframe)O.css("opacity",0);var x=[O,g,_],S=m?e("body"):e(f);e.each(x,(function(){this.appendTo(S)}));if(o.theme&&o.draggable&&e.fn.draggable){_.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var I=a&&(!e.support.boxModel||e("object,embed",m?null:f).length>0);if(i||I){if(m&&o.allowBodyStretch&&e.support.boxModel)e("html,body").css("height","100%");if((i||!e.support.boxModel)&&!m){var k=h(f,"borderTopWidth"),q=h(f,"borderLeftWidth");var F=k?"(0 - "+k+")":0;var P=q?"(0 - "+q+")":0}e.each(x,(function(e,r){var t=r[0].style;t.position="absolute";if(e<2){if(m)t.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+o.quirksmodeOffsetHack+') + "px"');else t.setExpression("height",'this.parentNode.offsetHeight + "px"');if(m)t.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');else t.setExpression("width",'this.parentNode.offsetWidth + "px"');if(P)t.setExpression("left",P);if(F)t.setExpression("top",F)}else if(o.centerY){if(m)t.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');t.marginTop=0}else if(!o.centerY&&m){var i=o.css&&o.css.top?parseInt(o.css.top,10):0;var a="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+i+') + "px"';t.setExpression("top",a)}}))}if(T){if(o.theme)_.find(".ui-widget-content").append(T);else _.append(T);if(T.jquery||T.nodeType)e(T).show()}if((t||o.forceIframe)&&o.showOverlay)O.show();if(o.fadeIn){var N=o.onBlock?o.onBlock:r;var D=o.showOverlay&&!T?N:r;var E=T?N:r;if(o.showOverlay)g._fadeIn(o.fadeIn,D);if(T)_._fadeIn(o.fadeIn,E)}else{if(o.showOverlay)g.show();if(T)_.show();if(o.onBlock)o.onBlock.bind(_)()}u(1,f,o);if(m){s=_[0];n=e(o.focusableElements,s);if(o.focusInput)setTimeout(v,20)}else d(_[0],o.centerX,o.centerY);if(o.timeout){var C=setTimeout((function(){if(m)e.unblockUI(o);else e(f).unblock(o)}),o.timeout);e(f).data("blockUI.timeout",C)}}function l(r,t){var i;var a=r==window;var f=e(r);var l=f.data("blockUI.history");var c=f.data("blockUI.timeout");if(c){clearTimeout(c);f.removeData("blockUI.timeout")}t=e.extend({},e.blockUI.defaults,t||{});u(0,r,t);if(t.onUnblock===null){t.onUnblock=f.data("blockUI.onUnblock");f.removeData("blockUI.onUnblock")}var v;if(a)v=e("body").children().filter(".blockUI").add("body > .blockUI");else v=f.find(">.blockUI");if(t.cursorReset){if(v.length>1)v[1].style.cursor=t.cursorReset;if(v.length>2)v[2].style.cursor=t.cursorReset}if(a)s=n=null;if(t.fadeOut){i=v.length;v.stop().fadeOut(t.fadeOut,(function(){if(--i===0)o(v,l,t,r)}))}else o(v,l,t,r)}function o(r,t,i,a){var s=e(a);if(s.data("blockUI.isBlocked"))return;r.each((function(e,r){if(this.parentNode)this.parentNode.removeChild(this)}));if(t&&t.el){t.el.style.display=t.display;t.el.style.position=t.position;t.el.style.cursor="default";if(t.parent)t.parent.appendChild(t.el);s.removeData("blockUI.history")}if(s.data("blockUI.static")){s.css("position","static")}if(typeof i.onUnblock=="function")i.onUnblock(a,i);var n=e(document.body),f=n.width(),l=n[0].style.width;n.width(f-1).width(f);n[0].style.width=l}function u(r,t,i){var a=t==window,n=e(t);if(!r&&(a&&!s||!a&&!n.data("blockUI.isBlocked")))return;n.data("blockUI.isBlocked",r);if(!a||!i.bindEvents||r&&!i.showOverlay)return;var f="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(r)e(document).bind(f,i,c);else e(document).unbind(f,c)}function c(r){if(r.type==="keydown"&&r.keyCode&&r.keyCode==9){if(s&&r.data.constrainTabKey){var t=n;var i=!r.shiftKey&&r.target===t[t.length-1];var a=r.shiftKey&&r.target===t[0];if(i||a){setTimeout((function(){v(a)}),10);return false}}}var f=r.data;var l=e(r.target);if(l.hasClass("blockOverlay")&&f.onOverlayClick)f.onOverlayClick(r);if(l.parents("div."+f.blockMsgClass).length>0)return true;return l.parents().children().filter("div.blockUI").length===0}function v(e){if(!n)return;var r=n[e===true?n.length-1:0];if(r)r.focus()}function d(e,r,t){var i=e.parentNode,a=e.style;var s=(i.offsetWidth-e.offsetWidth)/2-h(i,"borderLeftWidth");var n=(i.offsetHeight-e.offsetHeight)/2-h(i,"borderTopWidth");if(r)a.left=s>0?s+"px":"0";if(t)a.top=n>0?n+"px":"0"}function h(r,t){return parseInt(e.css(r,t),10)||0}}{if(typeof jquery!="undefined"){e(jquery)}}})();try{OAT.Loader.featureLoaded("layers")}catch(e){}if(GlobalPivotInterval==undefined){var GlobalPivotInterval=[]}OAT.Pivot=function(_mthis,div,filterDiv,headerRow,dataRows,headerRowIndexes,headerColIndexes,filterIndexes,dataColumnIndex,query,condFormats,control,pageSize,defaultPicture,QueryViewerCollection,columns,containerName,formatValue,conditionalFormatsColumns,formatValueMeasures,measures,autoResize,disableColumnSort,UcId,IdForQueryViewerCollection,rememberLayout,ShowMeasuresAsRows,formulaInfo,fullRecord,serverPagination,pageData,hideDataFilds,orderFildsHidden,initMetadata,relativePath,selection,GrandTotalVisibility,pivotTitle){var self=this;this.autoPaging=false;this.nextRowWhenAutopaging=0;this.prevRowWhenAutopaging=0;this.paginationInfo=false;this.TempDataStructForAggStepOptimization=[];this.actualPaginationPage=1;this.allDataWithoutSort=jquery.extend(true,[],dataRows);this.IdForQueryViewerCollection=IdForQueryViewerCollection;this.UcId=UcId;this.ShowMeasuresAsRows=ShowMeasuresAsRows;this.rememberLayoutStateVersion=serverPagination?"4.3.8SP":"4.3.8";if(measures.length<2){this.ShowMeasuresAsRows=false}this.allRowsPivot="vacio";this.HideDataFilds=hideDataFilds;this.OrderFildsHidden=orderFildsHidden;this.initMetadata=initMetadata;this.relativePath=relativePath;this.selection=selection;this.GrandTotalVisibility=GrandTotalVisibility;this.translations=_mthis.translations;this.isSD=OAT.isSD();fromUndefinedToBlanck(dataRows);if(dataRows[0]!=undefined){if(formulaInfo.cantFormulaMeasures>0){for(var i=0;i<dataRows.length;i++){dataRows[i][headerRow.length]=i}}var sortIntMemory=[];for(var index=headerRow.length-1;index>-1;index--){var sortInt=true;for(var ival=0;ival<dataRows.length;ival++){if(sortInt&&dataRows[ival][index]!=parseInt(dataRows[ival][index])){sortInt=false;break}}sortIntMemory[index]=sortInt}var index=0;if(sortIntMemory[index]){dataRows=dataRows.sort(function(e){return function(r,t){return parseInt(r[e])===parseInt(t[e])?0:parseInt(r[e])<parseInt(t[e])?-1:1}}(index))}else{dataRows=dataRows.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]<t[e]?-1:1}}(index))}var actualVal=dataRows[0][index];var initPos=0;for(var i=0;i<dataRows.length;i++){if(actualVal!=dataRows[i][index]){actualVal=dataRows[i][index];dataRows=OAT.PartialSort(dataRows,initPos,i-1,index+1,headerRow.length,sortIntMemory);initPos=i}else if(i==dataRows.length-1){dataRows=OAT.PartialSort(dataRows,initPos,i,index+1,headerRow.length,sortIntMemory)}}}var tempDataRows=dataRows;dataRows=[];if(tempDataRows.length>0){dataRows[0]=tempDataRows[0]}var act_pos=0;for(var i=1;i<tempDataRows.length;i++){var repeated=true;for(var j=0;j<columns.length;j++){if(tempDataRows[i][j]!=tempDataRows[i-1][j]){repeated=false;break}}if(repeated){for(var j=columns.length;j<columns.length+measures.length;j++){var tot=parseFloat(dataRows[act_pos][j])+parseFloat(tempDataRows[i][j]);if(dataRows[act_pos][j]=="#NuN#"&&tempDataRows[i][j]=="#NuN#"){tot="#NuN#"}else if(dataRows[act_pos][j]=="#NuN#"){tot=tempDataRows[i][j]+""}else if(tempDataRows[i][j]=="#NuN#"){tot=dataRows[act_pos][j]+""}dataRows[act_pos][j]=tot+""}if(formulaInfo.cantFormulaMeasures>0){var filaSumar=dataRows[act_pos][headerRow.length];var filaRepetida=tempDataRows[i][headerRow.length];for(var formulasI=0;formulasI<formulaInfo.measureFormula.length;formulasI++){if(formulaInfo.measureFormula[formulasI].hasFormula){for(var formulasJ=0;formulasJ<formulaInfo.measureFormula[formulasI].relatedMeasures.length;formulasJ++){var pos=formulaInfo.measureFormula[formulasI].relatedMeasures[formulasJ];var tot=parseFloat(fullRecord[filaSumar][pos])+parseFloat(fullRecord[filaRepetida][pos]);fullRecord[filaSumar][pos]=tot+""}}}for(var j=columns.length;j<columns.length+measures.length;j++){var tot=parseFloat(fullRecord[filaSumar][j])+parseFloat(fullRecord[filaRepetida][j]);fullRecord[filaSumar][j]=tot+""}for(var posB=0;posB<headerRow.length;posB++){fullRecord[filaRepetida][posB]=""}}}else{act_pos++;dataRows[act_pos]=tempDataRows[i]}}if(formulaInfo.cantFormulaMeasures>0){if(dataRows[0]!=undefined){for(var it=0;it<dataRows.length;it++){dataRows[it].splice(headerRow.length,1)}}}this.serverPagination=serverPagination;this.pageData=pageData;if(this.serverPagination){this.pageData.PreviousPageNumber=-1;this.pageData.AxisInfo=[];this.pageData.FilterInfo=[]}this.autoPaging=false;this.recordForFormula=fullRecord;this.formulaInfo=formulaInfo;this.filterIndexes=filterIndexes;this.initFilterIndexes=[];for(var i=0;i<this.filterIndexes.length;i++){this.initFilterIndexes[i]=this.filterIndexes[i]}this.getFormulaRowByDataRow=function(e,r,t){var i=false;var a=self.recordForFormula;var s=[];for(var n=0;n<self.formulaInfo.recordDataLength;n++){s[n]=0}for(var f=0;f<a.length;f++){var l=false;for(var o=0;o<e.length;o++){if(self.filterIndexes.indexOf(o)!=-1){var u=self.filterIndexes.indexOf(o);if(self.filterDiv!=undefined){var c=self.filterDiv.selects[u];var v=OAT.$v(c);if(v=="[all]"){l=true}else{l=v==a[f][o];if(!l)break}}else{l=true}}else if(self.filterIndexes.length>0&&o>=e.length-measures.length){l=true}else if(a[f][o]==e[o]||e[o]=="#FoE#"&&a[f][o]==0){l=true}else if(headerRowIndexes!=undefined&&headerRowIndexes.indexOf(o)!=-1&&headerRowIndexes.indexOf(o)>headerRowIndexes.length-measures.length){l=true}else if(dataColumnIndex>0&&dataColumnIndex==o){l=true}else{if(e[o]==undefined&&self.filterIndexes.length>0){l=true}else{l=false;break}}}if(l){for(var d=0;d<self.formulaInfo.measureFormula[r].relatedMeasures.length;d++){var u=self.formulaInfo.measureFormula[r].relatedMeasures[d];s[u]=s[u]+parseFloat(a[f][u])}i=true}}if(i)return s;else return"#NuN#"};for(var mforF=0;mforF<measures.length;mforF++){if(formulaInfo.measureFormula[mforF].hasFormula){for(var rforF=0;rforF<dataRows.length;rforF++){if(dataRows[rforF][dataRows[rforF].length-measures.length+mforF]==0){var formula=this.getFormulaRowByDataRow(dataRows[rforF],mforF,"");var result=EvaluateExpressionPivotJs(formulaInfo.measureFormula[mforF].PolishNotation,formula,formulaInfo);if(result==Infinity||isNaN(result)){dataRows[rforF][dataRows[rforF].length-measures.length+mforF]="#FoE#"}}}}}this.GeneralDataRows=dataRows;this.autoPagingRowsPerPage=pageSize!=undefined?parseInt(pageSize):10;this.TotalPagesPaging=parseInt(dataRows.length/this.autoPagingRowsPerPage);if(dataRows.length%this.autoPagingRowsPerPage!=0){this.TotalPagesPaging++}this.GeneralDistinctValues=[];this.GrandTotalsPaging=[];this.columns=columns;if(dataRows.length>0){fillGeneralDistinctValues(headerRow.length-measures.length,self,dataRows)}this.RowsWhenMoveToFilter=[];this.FilterByTopFilter=false;this.options={headingBefore:1,headingAfter:0,agg:1,aggTotals:1,customType:function(e){return e},showEmpty:0,subtotals:1,totals:1};this.firstTime=true;this.readState=false;this.deleteState=false;this.defaultPicture=defaultPicture;this.gd=new OAT.GhostDrag;this.div=OAT.$(div);this.filterDiv=OAT.$(filterDiv);this.hasShowValuesAs=_mthis.hasShowValuesAs;this.TitleDivId=filterDiv.replace("pivot_page","title_div");if(pivotTitle){this.PivotTitle=pivotTitle;this.TitleDiv=OAT.$(this.TitleDivId);if(!this.TitleDiv){jquery("#"+this.TitleDivId).remove();this.TitleDiv=OAT.Dom.create("div",{});this.TitleDiv.id=this.TitleDivId;jquery("#"+containerName).prepend(this.TitleDiv)}}else{jquery("#"+this.TitleDivId).remove()}this.defCArray=["rgb(153,153,255)","rgb(153,51,205)","rgb(255,255,204)","rgb(204,255,255)","rgb(102,0,102)","rgb(255,128,128)","rgb(0,102,204)","rgb(204,204,255)","rgb(0,0,128)","rgb(255,0,255)","rgb(0,255,255)","rgb(255,255,0)"];this.QueryViewerCollection=QueryViewerCollection;this.containerName=containerName;this.formatValues=formatValue;this.formatValuesMeasures=formatValueMeasures;this.tempBlackLists=[];this.tempCollapsedValues=[];this.oldSortValues=[];this.stateChanged=false;this.rowsPerPage=pageSize;this.headerRow=headerRow;this.allData=dataRows;this.filteredData=[];this.tabularData=[];this.dataColumnIndex=dataColumnIndex;this.rowConditions=headerRowIndexes;this.colConditions=headerColIndexes;this.initRowConditions=[];for(var i=0;i<this.rowConditions.length;i++){this.initRowConditions[i]=this.rowConditions[i]}this.initColConditions=[];for(var i=0;i<this.colConditions.length;i++){this.initColConditions[i]=this.colConditions[i]}if(columns.length==1&&measures.length==0){this.rowConditions=[0]}this.conditions=[];this.filterDiv.selects=[];this.rowStructure={};this.colStructure={};this.colPointers=[];this.rowPointers=[];this.rowTotals=[[],[]];this.colTotals=[[],[]];this.gTotal=[];this.query=query;this.controlName=control;this.conditionalFormats=condFormats;this.conditionalFormatsColumns=conditionalFormatsColumns;this.GreyList=[];this.EmptyValue="#NaV#";this.NullValue="#NuN#";this.initState={};if(typeof JSON.decycle!=="function"){JSON.decycle=function e(r){var t=[],i=[];return function e(r,a){var s,n,f;switch(typeof r){case"object":if(!r){return null}for(s=0;s<t.length;s+=1){if(t[s]===r){return{$ref:i[s]}}}t.push(r);i.push(a);if(Object.prototype.toString.apply(r)==="[object Array]"){f=[];for(s=0;s<r.length;s+=1){f[s]=e(r[s],a+"["+s+"]")}}else{f={};for(n in r){if(Object.prototype.hasOwnProperty.call(r,n)){f[n]=e(r[n],a+"["+JSON.stringify(n)+"]")}}}return f;case"number":case"string":case"boolean":return r}}(r,"$")}}this.saveState=function(e){try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+self.query+self.controlName);localStorage.setItem(OAT.getURL()+self.query+self.controlName,JSON.stringify(JSON.decycle(e)))}else{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"',JSON.stringify(e),null,"/")}}catch(r){try{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"',JSON.stringify(e),null,"/")}catch(e){}}};this.saveHiddenState=function(e){try{if(!!window.localStorage){localStorage.removeItem(OAT.getURL()+self.query+self.controlName+"HiddenState");localStorage.setItem(OAT.getURL()+self.query+self.controlName+"HiddenState",JSON.stringify(JSON.decycle(e)))}else{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"HiddenState"+"cookie"+'"',JSON.stringify(e),null,"/")}}catch(r){try{OATSetCookie('"'+OAT.getURL()+self.query+self.controlName+"HiddenState"+"cookie"+'"',JSON.stringify(e),null,"/")}catch(e){}}};this.getState=function(){if(typeof JSON.retrocycle!=="function"){JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function rez(value){var i,item,name,path;if(value&&typeof value==="object"){if(Object.prototype.toString.apply(value)==="[object Array]"){for(i=0;i<value.length;i+=1){item=value[i];if(item&&typeof item==="object"){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[i]=eval(path)}else{rez(item)}}}}else{for(name in value){if(typeof value[name]==="object"){item=value[name];if(item){path=item.$ref;if(typeof path==="string"&&px.test(path)){value[name]=eval(path)}else{rez(item)}}}}}}})($);return $}}try{var i;if(localStorage.getItem(OAT.getURL()+self.query+self.controlName)!=null){var retrievedObject=localStorage.getItem(OAT.getURL()+self.query+self.controlName);i=JSON.retrocycle(JSON.parse(retrievedObject))}if(i==null){var cookieValue=OATGetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"');if(cookieValue!=null){i=JSON.parse(cookieValue)}}return i}catch(e){try{var cookieValue=OATGetCookie('"'+OAT.getURL()+self.query+self.controlName+"cookie"+'"');var i=JSON.parse(cookieValue);return i}catch(e){return null}}};this.cleanState=function(){for(var e=0;e<self.filterDiv.selects.length;e++){self.filterDiv.selects[e].value="[all]"}for(var r=0;r<=self.conditions.length-1;r++){self.conditions[r].blackList=[];self.conditions[r].whiteList=[];self.conditions[r].greyList=[]}localStorage.removeItem(OAT.getURL()+self.query+self.controlName);self.deleteState=false;var t=new Array;for(var i=0;i<self.initState.colConditions.length;i++){t[i]=self.initState.colConditions[i]}var a=new Array;for(var i=0;i<self.initState.rowConditions.length;i++){a[i]=self.initState.rowConditions[i]}var s=new Array;for(var i=0;i<self.initState.filterIndexes.length;i++){s[i]=self.initState.filterIndexes[i]}this.conditions=jquery.extend(true,[],self.initState.conditions);this.rowConditions=a;this.colConditions=t;this.filterIndexes=s;this.stateChanged=self.initState.stateChanged;this.rowsPerPage=self.initState.rowsPerPage;var n={query:self.query,conditions:self.conditions,colConditions:self.colConditions,rowConditions:self.rowConditions,filterIndexes:self.filterIndexes,filterDivSelects:[],rowsPerPage:self.rowsPerPage,version:self.rememberLayoutStateVersion};self.saveState(n)};this.cleanStateWhenServerPagination=function(){for(var e=0;e<self.filterDiv.selects.length;e++){self.filterDiv.selects[e].value="[all]"}for(var r=0;r<=self.conditions.length-1;r++){self.conditions[r].blackList=[]}var t=new Array;for(var i=0;i<self.initState.colConditions.length;i++){t[i]=self.initState.colConditions[i]}var a=new Array;for(var i=0;i<self.initState.rowConditions.length;i++){a[i]=self.initState.rowConditions[i]}var s=new Array;for(var i=0;i<self.initState.filterIndexes.length;i++){s[i]=self.initState.filterIndexes[i]}for(var i=0;i<self.conditions.length;i++){if(self.conditions[i]&&self.conditions[i].distinctValues&&self.conditions[i].dataField){var n=-1;for(var f=0;f<self.initState.conditions.length;f++){if(self.initState.conditions[f]){if(self.initState.conditions[f].dataField==self.conditions[i].dataField){n=f}}}if(n>-1){self.initState.conditions[n].distinctValues=[];for(var l=0;l<self.conditions[i].distinctValues.length;l++){if(self.initState.conditions[n]&&self.initState.conditions[n].distinctValues.indexOf(self.conditions[i].distinctValues[l])==-1){self.initState.conditions[n].distinctValues.push(self.conditions[i].distinctValues[l])}}self.initState.conditions[n].previousPage=self.conditions[i].previousPage;self.initState.conditions[n].totalPages=self.conditions[i].totalPages}}}self.conditions=jquery.extend(true,[],self.initState.conditions);self.pageData.AxisInfo=jquery.extend(true,[],self.initState.AxisInfo);self.pageData.DataInfo=jquery.extend(true,[],self.initState.DataInfo);self.pageData.FilterInfo=jquery.extend(true,[],self.initState.FilterInfo);self.pageData.CollapseInfo=jquery.extend(true,[],self.initState.CollapseInfo);self.rowConditions=a;self.colConditions=t;self.filterIndexes=s;self.stateChanged=self.initState.stateChanged;self.rowsPerPage=self.initState.rowsPerPage;self.DefaultAction=self.initState.DefaultAction;self.initMetadata=jquery.extend(true,{},self.initState.InitMetadata);for(var o=0;o<self.initMetadata.Conditions.length;o++){self.initMetadata.Conditions[o]=""}for(var u=0;u<self.initState.conditions.length;u++){var c=self.initState.conditions[u].dataField;if(c){var v=self.initMetadata.DataFields.indexOf(c);self.initMetadata.Conditions[v]=self.conditions[u]}}if(!OAT.isIE()){self.goWhenHide(true)}};this.getDataXML=function(e){var r=e.split("<Recordset")[1];r="<Recordset"+r;return r};this.requestPageDataForPivotTable=function(e,r,t,i,a,s,n,f){setTimeout((function(){var l={PageNumber:e,PageSize:r,ReturnTotPages:t,AxesInfo:i,DataInfo:a,Filters:s,ExpandCollapse:n,LayoutChange:f,QueryviewerId:self.IdForQueryViewerCollection,callback:self.setPageDataForPivotTable};var o=document.createEvent("Events");o.initEvent("RequestPageDataForPivotTable",true,true);o.parameter=l;document.dispatchEvent(o)}),0)};this.setPageDataForPivotTable=function(e){switch(self.lastCallToQueryViewer){case"initWhenServerPagination":self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.preGoWhenServerPagination(true);if(self.filterIndexes.length>0){self.initValueRead(self,0,self.stateLoad)}jquery("#"+self.containerName).removeClass("gx-qv-loading");break;case"callServiceWhenCustomeValues":self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.preGoWhenServerPagination(true);jquery("#"+self.containerName).removeClass("gx-qv-loading");break;case"refreshPivot":self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.goWhenServerPagination(false,true);jquery("#"+self.containerName).removeClass("gx-qv-loading");break;case"hiddenDimension":self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows);self.goWhenServerPagination(false,false);jquery("#"+self.containerName).removeClass("gx-qv-loading");break;case"DataForPivot":self.pageData=OATGetNewDataFromXMLForPivot(e,self.pageData,self.ShowMeasuresAsRows,self.ExportTo);self.preGoWhenServerPagination(self.lastNotAutorefreshIndicator);if(self.ExportTo!=""){var r=self.query;if(r==""){r="Query";try{r=self.controlName.split("_")[0]}catch(e){}}if(self.ExportTo=="HTML"){self.ExportToHTMLWhenServerPagination()}if(self.ExportTo=="PDF"){OAT.GeneratePDFOutput(self,r)}if(self.ExportTo=="XLS"){self.ExportToExcel(r)}if(self.ExportTo=="XML"){self.ExportToXMLWhenServerPagination()}if(self.ExportTo=="XLSX"){self.ExportToXLSXWhenServerPagination()}self.cleanGridCache()}jquery("#"+self.containerName).removeClass("gx-qv-loading");break}};this.requestAttributeValues=function(e,r,t,i){setTimeout((function(){var a={DataField:e,Page:r,PageSize:t,FilterText:i,QueryviewerId:self.IdForQueryViewerCollection};var s=document.createEvent("Events");s.initEvent("RequestAttributeValuesForPivotTable",true,true);s.parameter=a;document.dispatchEvent(s)}),0)};this.setAttributeValuesForPivotTable=function(e){switch(self.lastRequestAttributeValues){case"initValueRead":var r=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;allData=self.lastRequestAttributeAllData;requestDataField=self.lastRequestAttributeRequestDataField;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=false;if(allData){self.conditions[t].distinctValues=[]}if(r.Null){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}var i=true;if(!self.conditions[t].NullIncluded){i=false}if(i&&self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{self.conditions[t].hasNull=false}var a=[];for(var n=0;n<r.NotNullValues.length;n++){var f=r.NotNullValues[n];var l=false;if(self.conditions[t].state=="none"&&self.UserFilterValues.length>0&&self.UserFilterValues[t]!=undefined&&self.UserFilterValues[t].length>0&&self.UserFilterValues[t].indexOf(f.trimpivot())!=-1){l=true;a.push(f)}if(self.conditions[t].distinctValues.indexOf(f)==-1){self.conditions[t].distinctValues.push(f)}if(self.conditions[t].state=="all"&&self.conditions[t].visibles.indexOf(f)==-1){self.conditions[t].visibles.push(f)}if(self.conditions[t].state=="none"&&self.conditions[t].blackList.indexOf(f)==-1&&!l){self.conditions[t].blackList.push(f)}if(allData&&self.UserExpandValues.length>0){if(self.UserExpandValues[t]!=undefined){if(self.UserExpandValues[t][0]=="#ALLCOLLAPSE#"||self.UserExpandValues[t].indexOf(f.trimpivot())==-1){self.conditions[t].collapsedValues.push(f)}}}}for(var n=0;n<a.length;n++){self.createFilterInfo({op:"pop",values:a[n],dim:t},true)}if(requestDataField==undefined){t++;self.initValueRead(self,t,allData)}break;case"DrawFilters":var r=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=true;if(r.Null&&!self.conditions[t].hasNull){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}if(self.conditions[t].defaultAction=="Include"){if(self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{if(self.conditions[t].blackList.indexOf("#NuN#")==-1){self.conditions[t].blackList.push("#NuN#")}}}for(var n=0;n<r.NotNullValues.length;n++){var f=r.NotNullValues[n];if(self.conditions[t].distinctValues.indexOf(f)==-1){self.conditions[t].distinctValues.push(f);if(self.conditions[t].defaultAction=="Include"&&self.conditions[t].visibles.indexOf(f)==-1){self.conditions[t].visibles.push(f)}if(self.conditions[t].state=="Exclude"&&self.conditions[t].blackList.indexOf(f)==-1){self.conditions[t].blackList.push(f)}}}var o=self.conditions[t].distinctValues;for(var u=0;u<o.length;u++){var c=o[u];if(self.conditions[t].filteredShowValues.indexOf(c)==-1){self.conditions[t].filteredShowValues.push(c);if(c!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(c,t),c,s)}catch(e){OAT.Dom.option(c,c,s)}}else{OAT.Dom.option(" ",c,s)}}}break;case"hiddenDimension":var r=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=false;if(r.Null){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}var i=true;if(!self.conditions[t].NullIncluded){i=false}if(i&&self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{self.conditions[t].hasNull=false}var a=[];for(var n=0;n<r.NotNullValues.length;n++){var f=r.NotNullValues[n];var l=false;if(self.conditions[t].state=="none"&&self.UserFilterValues.length>0&&self.UserFilterValues[t]!=undefined&&self.UserFilterValues[t].length>0&&self.UserFilterValues[t].indexOf(f.trimpivot())!=-1){l=true;a.push(f)}if(self.conditions[t].distinctValues.indexOf(f)==-1){self.conditions[t].distinctValues.push(f)}if(self.conditions[t].state=="all"&&self.conditions[t].visibles.indexOf(f)==-1){self.conditions[t].visibles.push(f)}if(self.conditions[t].state=="none"&&self.conditions[t].blackList.indexOf(f)==-1&&!l){self.conditions[t].blackList.push(f)}if(self.UserExpandValues.length>0){if(self.UserExpandValues[t]!=undefined){if(self.UserExpandValues[t][0]=="#ALLCOLLAPSE#"||self.UserExpandValues[t].indexOf(f.trimpivot())==-1){self.conditions[t].collapsedValues.push(f)}}}}for(var n=0;n<a.length;n++){self.createFilterInfo({op:"pop",values:a[n],dim:t},true)}break;case"readScrollValueWithoutFilters":var v=JSON.parse(e);self.appendNewValueData(self.lastRequestValue,v);break;case"readScrollValueWithFilters":var v=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;var d=self.lastRequestAttributeFilterText;self.appendNewFilteredValueData(v,t,d);break;case"ValuesForColumn":var v=JSON.parse(e);var t=self.lastRequestAttributeColumnNumber;var h=self.lastRequestAttributeFilterText;var p=self.lastRequestAttributeDataField;var m=self.lastRequestAttributeUcId=m;self.changeValues(m,p,t,v,h);break;case"ExpandCollapse":var r=JSON.parse(e);var t=self.lastColumnNumber;var T=self.lastRequestAttributeValuesElemValue;var A=self.lastRequestAttributeValuesAction;self.conditions[t].previousPage=r.PageNumber;self.conditions[t].totalPages=r.PagesCount;self.conditions[t].blocked=true;if(r.Null&&!self.conditions[t].hasNull){self.conditions[t].hasNull=true;if(self.conditions[t].distinctValues.indexOf("#NuN#")==-1){self.conditions[t].distinctValues.push("#NuN#")}if(self.conditions[t].defaultAction=="Include"){if(self.conditions[t].visibles.indexOf("#NuN#")==-1){self.conditions[t].visibles.push("#NuN#")}}else{if(self.conditions[t].blackList.indexOf("#NuN#")==-1){self.conditions[t].blackList.push("#NuN#")}}}for(var n=0;n<r.NotNullValues.length;n++){var y=r.NotNullValues[n];if(self.conditions[t].distinctValues.indexOf(y)==-1){self.conditions[t].distinctValues.push(y);if(self.conditions[t].defaultAction=="Include"&&self.conditions[t].visibles.indexOf(y)==-1){self.conditions[t].visibles.push(y)}if(self.conditions[t].state=="Exclude"&&self.conditions[t].blackList.indexOf(y)==-1){self.conditions[t].blackList.push(y)}}}var w=self.ExpandCollapseHandleWhenServerPaginationCreateXML(T,A);w=w.replace(/\&/g,"&amp;");self.getDataForPivot(self.UcId,self.pageData.ServerPageNumber,self.rowsPerPage,true,"","","","",true);setTimeout((function(){self.fireOnItemExpandCollapseEvent(self.QueryViewerCollection[IdForQueryViewerCollection],w,A=="collapse")}),2e3);break;case"FilteredChanged":setTimeout((function(){var r=JSON.parse(e);self.onFilteredChangedEventHandleWhenServerPaginationCreateXML(self.lastColumnNumber,r.NotNullValues,self.conditions[self.lastColumnNumber].blackList)}),200);break}};this.fireOnItemExpandCollapseEvent=function(e,r,t){setTimeout((function(){var i={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection,IsCollapse:t};var a=document.createEvent("Events");a.initEvent("PivotTableOnItemExpandCollapseEvent",true,true);a.parameter=i;document.dispatchEvent(a)}),0)};this.requestCalculatePivottableData=function(){setTimeout((function(){var e=document.createEvent("Events");var r={QueryviewerId:self.IdForQueryViewerCollection};e.initEvent("RequestCalculatePivottableData",true,true);e.parameter=r;document.dispatchEvent(e)}),0)};this.setPivottableDataCalculation=function(e){switch(self.lastRequestCalculation){case"ExportToXML":self.allDataWithoutSort=OATgetDataFromXMLOldFormat(e,self.pageData.dataFields);self.allData=self.allDataWithoutSort;var r=jquery.extend(true,[],self.conditions);for(var t=0;t<self.conditions.length;t++){if(self.conditions[t]){for(var i=0;i<self.allData.length;i++){var a=self.allData[i][t];if(a==undefined){a=" ";self.allData[i][l]=" "}if(self.conditions[t].distinctValues.indexOf(a)==-1){self.conditions[t].distinctValues.push(a)}}try{self.sort(self.conditions[t],t)}catch(e){}}}self.applyFilters();self.createAggStructure();self.fillAggStructure();self.checkAggStructure();str=self.ExportToXML();self.allDataWithoutSort=[];self.allData=[];self.filteredData=[];self.conditions=r;if(OAT.isSafari()||self.isSD){window.open("data:text/xml,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+str))}else{var s=new Blob([str],{type:"text/xml"});if(self.query!=""){saveAs(s,self.query+".xml")}else{var n="Query";try{n=self.controlName.substr(4).split("_")[0]}catch(e){}saveAs(s,n+".xml")}}break;case"ExportToXLSX":var f=[];for(var t=0;t<self.initMetadata.Dimensions.length;t++){if(self.initMetadata.Dimensions[t].Visible)f.push(self.initMetadata.Dimensions[t].dataField)}for(var t=0;t<self.pageData.AxisInfo.length;t++){if(self.pageData.AxisInfo[t].Axis!=undefined&&self.pageData.AxisInfo[t].Axis.Type=="Hidden"){var l=f.indexOf(self.pageData.AxisInfo[t].DataField);if(l>-1){f.splice(l,1)}}}for(var t=0;t<self.initMetadata.Measures.length;t++){if(self.initMetadata.Measures[t].Visible&&f.indexOf(self.initMetadata.Measures[t].dataField)<0){f.push(self.initMetadata.Measures[t].dataField)}}for(var t=0;t<measures.length;t++){if(measures[t].getAttribute("aggregation")=="average"){self.formulaInfo.measureFormula[t].hasFormula=true;self.formulaInfo.measureFormula[t].textFormula=measures[t].getAttribute("dataField")+"_N/"+measures[t].getAttribute("dataField")+"_D";self.formulaInfo.cantFormulaMeasures++;var o=self.formulaInfo.measureFormula[t].textFormula;var u=o;var c=["*","-","+","/","(",")"];for(var v=0;v<c.length;v++){var d=u.split(c[v]);if(d.length>1){u="";for(var i=0;i<d.length-1;i++){u=u+d[i]+" "+c[v]+" "}u=u+d[d.length-1]}}var h=InfixToPostfix(u);formulaInfo.measureFormula[t].polishNotationText=h;var p=h.split(" ");while(p.indexOf("")!=-1){p.splice(p.indexOf(""),1)}var m=[];for(var T=0;T<p.length;T++){if(c.indexOf(p[T])==-1&&isNaN(parseInt(p[T]))){var A=formulaInfo.itemPosition[p[T]];if(m.indexOf(A)==-1)m.push(A)}}self.formulaInfo.measureFormula[t].relatedMeasures=m;var y=h.split(" ");while(y.indexOf("")!=-1){y.splice(y.indexOf(""),1)}self.formulaInfo.measureFormula[t].PolishNotation=y}}e=e.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&apos;/g,"'").replace(/\&quot/g,'"');var w=OATgetDataFromXMLOldFormat(e,f,self.OrderFildsHidden);self.GeneralDataRows=w[0];self.recordForFormula=w[1];self.allData=self.GeneralDataRows;var r=jquery.extend(true,[],self.conditions);self.GeneralDistinctValues=[];for(var t=0;t<self.conditions.length;t++){if(self.conditions[t]){self.GeneralDistinctValues[t]=[];for(var i=0;i<self.allData.length;i++){var a=self.allData[i][t];if(a==undefined){a=" ";self.allData[i][l]=" "}if(self.conditions[t].distinctValues.indexOf(a)==-1){self.conditions[t].distinctValues.push(a)}if(self.GeneralDistinctValues[t].indexOf(a)==-1){self.GeneralDistinctValues[t].push(a)}}try{self.sort(self.conditions[t],t)}catch(e){}}}self.applyFilters();self.createAggStructure();self.fillAggStructure();self.checkAggStructure();var O=self.query;if(O==""){O="Query";try{O=self.controlName.split("_")[0]}catch(e){}}OAT.GenerateExcelOutput(O,self,measures);str=self.ExportToXML();self.GeneralDataRows=[];self.allData=[];self.filteredData=[];self.GeneralDistinctValues=[];self.conditions=r;for(var t=0;t<measures.length;t++){if(measures[t].getAttribute("aggregation")=="average"){self.formulaInfo.measureFormula[t]={hasFormula:false};self.formulaInfo.cantFormulaMeasures--}}break}};this.getFilteredDataXML=function(e){temp=e.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&apos;/g,"'").replace(/\&quot/g,'"');var r=temp.split("<Record>");var t=[];for(var i=1;i<r.length;i++){var a=[];var s=[];var n=[];for(var f=0;f<self.pageData.dataFields.length;f++){a[f]="#NuN#";var l=r[i].split("<"+self.pageData.dataFields[f]+">");if(l.length>1){var o=l[1].split("</"+self.pageData.dataFields[f]+">");a[f]=o[0];s[f]=a[f];for(var u=0;u<self.initMetadata.Dimensions.length;u++){if(self.initMetadata.Dimensions[u].dataField==self.pageData.dataFields[f]){var c=self.initMetadata.Dimensions[u].displayName;if(self.headerRow.indexOf(c)!=-1){n.push(o[0])}}}if(f>=self.initMetadata.Dimensions.length){n.push(o[0])}}else{if(r[i].indexOf("<"+self.pageData.dataFields[f]+"/>")>=0){a[f]="";s[f]=""}}}if(self.filterDataXMLOK(n)){t.push(a)}}var v='<Recordset RecordCount="'+t.length+'" PageCount="1">\n';v=v+'<Page PageNumber="1">\n';for(var i=0;i<t.length;i++){v=v+"  <Record>\n";for(var d=0;d<self.initMetadata.DataFields.length;d++){var h=self.initMetadata.DataFields[d];v=v+"    <"+h+">";v=v+(t[i][d]||"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");v=v+"</"+h+">\n"}for(var d=0;d<measures.length;d++){v=v+"    <"+measures[d].getAttribute("dataField")+">";v=v+(t[i][d+self.initMetadata.DataFields.length]||"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");v=v+"</"+measures[d].getAttribute("dataField")+">\n"}v=v+"  </Record>\n"}v=v+"</Page>\n</Recordset>";return v};this.getMetadataXML=function(){xml='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">';var e=this.columns;if(self.initMetadata.Metadata){var r=jquery.parseXML(self.initMetadata.Metadata);e=[];e=r.getElementsByTagName("OLAPDimension")}var t=0;var i=0;var a=0;var s=0;var n=0;var f=0;for(var l=0;l<e.length;l++){var o=l;if(self.initMetadata.Metadata){o=-1;for(var u=0;u<self.conditions.length;u++){if(self.conditions[u].dataField==self.initMetadata.Dimensions[l].dataField){o=u}}}xml=xml+"<OLAPDimension>";xml=xml+"<name>"+e[l].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+e[l].getAttribute("displayName")+"</displayName> ";xml=xml+"<description>"+e[l].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+e[l].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+e[l].getAttribute("dataType")+"</dataType> ";if(self.initMetadata.Dimensions&&!self.initMetadata.Dimensions[l].Visible){xml=xml+"<hidden>true</hidden>"}xml=xml+"<axis>";var c=0;if(o==-1){if(e[l].getAttribute("visible").toLowerCase()!="never"){xml=xml+e[l].getAttribute("axis").toLowerCase();var v=self.initMetadata.Dimensions[l].defaultPosition;if(v=="Rows"){i=i+1;c=t+1;t=c}if(v=="Columns"){s=s+1;c=a+1;a=c}if(v=="Pages"){f=f+1;c=n+1;n=c}}else{xml=xml+""}}else if(self.rowConditions.indexOf(o)!=-1){xml=xml+"rows";c=self.rowConditions.indexOf(o)+1+i;t=c}else if(self.colConditions.indexOf(o)!=-1){xml=xml+"columns";c=self.colConditions.indexOf(o)+1+s;a=c}else{xml=xml+"pages";c=self.filterIndexes.indexOf(o)+1+f;n=c}xml=xml+"</axis> ";if(e[l].getAttribute("visible").toLowerCase()!="never"){xml=xml+"<position>"+c+"</position> "}else{xml=xml+"<position/>"}var d=e[l].getAttribute("summarize");if(o>=0){d=self.conditions[o].subtotals?"yes":"no"}xml=xml+"<summarize>"+d+"</summarize> ";xml=xml+"<align>"+e[l].getAttribute("align")+"</align> ";if(e[l].getAttribute("picture")===""){xml=xml+"<picture/> "}else{xml=xml+"<picture>"+e[l].getAttribute("picture")+"</picture> "}if(e[l].getAttribute("picture")===""){xml=xml+"<format/> "}else{xml=xml+"<format>"+e[l].getAttribute("format")+"</format> "}var h=-1;if(self.initMetadata.Metadata){h=-1;for(var u=0;u<self.initMetadata.Conditions.length;u++){if(self.initMetadata.Conditions[u].dataField==self.initMetadata.Dimensions[l].dataField){h=u}}}if(e[l].getAttribute("visible").toLowerCase()!="never"){var p=o>-1?self.conditions[o].sort:h>-1?self.initMetadata.Conditions[h].sort:"metadata";if(p=="metadata"){xml=xml+"<order>"+(e[l].getAttribute("order")!=""?e[l].getAttribute("order"):"Ascending")+"</order> "}else{if(p==1)xml=xml+"<order>Ascending</order> ";else if(p==-1)xml=xml+"<order>Descending</order> ";else xml=xml+"<order>Custom</order> "}}else{xml=xml+"<order>"+e[l].getAttribute("order")+"</order> "}xml=xml+"<customOrder/> ";xml=xml+"<filterType>";var m=o>-1?self.conditions[o].blackList:h>-1?self.initMetadata.Conditions[h].blackList:[];if(m.length==0){if(o>-1&&self.conditions[o].defaultAction=="Exclude"){if(self.conditions[o].visibles.length==0)xml=xml+"HideAllValues";else xml=xml+"ShowAllValues"}else{xml=xml+"ShowAllValues"}}else{xml=xml+"ShowSomeValues"}xml=xml+"</filterType>";xml=xml+"<include> ";var T=o>-1?self.filterIndexes.indexOf(o):-1;if(T!=-1&&self.filterDiv.selects.length>T&&self.filterDiv.selects[T].value!="[all]"){xml=xml+"<value>"+self.filterDiv.selects[T].value+"</value> "}else{var A=o>-1?self.conditions[o].distinctValues:h>-1?self.initMetadata.Conditions[h].distinctValues:[];if(!(o>-1&&self.conditions[o].defaultAction=="Exclude"&&m.length==0)){for(var y=0;y<A.length;y++){if(m.indexOf(A[y])===-1){xml=xml+"<value>"+A[y]+"</value> "}}}}xml=xml+"<value>TOTAL</value> </include>";xml=xml+"<collapseType>";var w=o>-1?self.conditions[o].collapsedValues:h>-1?self.initMetadata.Conditions[h].collapsedValues:[];if(w==undefined||w.length==0){xml=xml+"ExpandAllValues";xml=xml+"</collapseType>"}else{xml=xml+"ExpandSomeValues";xml=xml+"</collapseType>";var A=[];A=o>-1?self.conditions[o].distinctValues:h>-1?self.initMetadata.Conditions[h].distinctValues:[];xml=xml+"<includeExpand> ";for(var y=0;y<A.length;y++){if(A[y]!=undefined&&w.indexOf(A[y])==-1){xml=xml+"<value>"+A[y]+"</value>"}}xml=xml+"</includeExpand> "}xml=xml+"</OLAPDimension>"}var O=measures;if(self.initMetadata.Metadata){var r=jquery.parseXML(self.initMetadata.Metadata);O=[];O=r.getElementsByTagName("OLAPMeasure")}var g=t;for(var l=0;l<O.length;l++){xml=xml+"<OLAPMeasure> ";xml=xml+"<name>"+O[l].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+O[l].getAttribute("displayName")+"</displayName> ";xml=xml+"<description>"+O[l].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+O[l].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+O[l].getAttribute("dataType")+"</dataType> ";xml=xml+"<defaultAggregator>"+O[l].getAttribute("defaultAggregator")+"</defaultAggregator> ";xml=xml+"<validAggregators>"+O[l].getAttribute("validAggregators")+"</validAggregators> ";xml=xml+"<summarize>"+O[l].getAttribute("summarize")+"</summarize> ";if(O[l].getAttribute("format")===""){xml=xml+"<format/> "}else{xml=xml+"<format>"+O[l].getAttribute("format")+"</format> "}xml=xml+"<align>"+O[l].getAttribute("align")+"</align> ";if(O[l].getAttribute("picture")===""){xml=xml+"<picture/> "}else{xml=xml+"<picture>"+O[l].getAttribute("picture")+"</picture> "}if(self.initMetadata.Measures&&!self.initMetadata.Measures[l].Visible){xml=xml+"<hidden>true</hidden>"}if(O[l].getAttribute("visible").toLowerCase()!="never"){g=g+1;xml=xml+"<position>"+g+"</position> "}else{xml=xml+"<position/>"}xml=xml+"</OLAPMeasure>"}xml=xml+"</OLAPCube>";xml=xml.replace(/\&/g,"&amp;");return xml};this.createXMLMetadata=function(){var e='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">';for(var r=0;r<this.columns.length;r++){if(this.conditions[r]!=false&&this.conditions[r]!=undefined){e=e+"<OLAPDimension> ";e=e+"<name>"+this.columns[r].getAttribute("name")+"</name> ";e=e+"<displayName>"+this.columns[r].getAttribute("displayName")+"</displayName> ";e=e+"<description>"+this.columns[r].getAttribute("description")+"</description> ";e=e+"<dataField>"+this.columns[r].getAttribute("dataField")+"</dataField> ";e=e+"<dataType>"+this.columns[r].getAttribute("dataType")+"</dataType> ";e=e+"<summarize>"+this.columns[r].getAttribute("summarize")+"</summarize> ";e=e+"<align>"+this.columns[r].getAttribute("align")+"</align> ";if(this.columns[r].getAttribute("picture")===""){e=e+"<picture/> "}else{e=e+"<picture>"+this.columns[r].getAttribute("picture")+"</picture> "}if(this.columns[r].getAttribute("picture")===""){e=e+"<format/> "}else{e=e+"<format>"+this.columns[r].getAttribute("format")+"</format> "}if(this.conditions[r].sort===1)e=e+"<order>ascending</order> ";else e=e+"<order>descending</order> ";e=e+"<customOrder/> ";e=e+"<include> ";var t=self.filterIndexes.indexOf(r);if(t!=-1&&self.filterDiv.selects[t].value!="[all]"){if(this.conditions[r].blackList.indexOf(self.filterDiv.selects[t].value)===-1){e=e+"<value>"+self.filterDiv.selects[t].value.toString().trimpivot()+"</value> "}}else{if(self.conditions[r].state!="none"){for(var i=0;i<this.conditions[r].distinctValues.length;i++){if(this.conditions[r].blackList.indexOf(this.conditions[r].distinctValues[i])===-1){e=e+"<value>"+this.conditions[r].distinctValues[i].toString().trimpivot()+"</value> "}}}}e=e+"<value>TOTAL</value> </include> <collapse/> ";e=e+"<hide> ";if(self.conditions[r].state=="none"){for(var i=0;i<this.conditions[r].distinctValues.length;i++){e=e+"<value>"+this.conditions[r].distinctValues[i].toString().trimpivot()+"</value> "}}else if(self.conditions[r].state!="all"){for(var a=0;a<this.conditions[r].blackList.length;a++){e=e+"<value>"+this.conditions[r].blackList[a].toString().trimpivot()+"</value> "}}e=e+"</hide> ";if(self.rowConditions.indexOf(r)!=-1){e=e+"<condition>row</condition> ";e=e+"<filterbar>no</filterbar> ";e=e+"<position>"+self.rowConditions.indexOf(r)+"</position>"}else if(self.colConditions.indexOf(r)!=-1){e=e+"<condition>col</condition> ";e=e+"<filterbar>no</filterbar> ";e=e+"<position>"+self.colConditions.indexOf(r)+"</position>"}else{e=e+"<condition>none</condition> ";e=e+"<filterbar>yes</filterbar> "}e=e+"<filterdivs> ";if(t!=-1){e=e+"<value>"+self.filterDiv.selects[t].value.toString().trimpivot()+"</value> "}e=e+"</filterdivs> ";e=e+"<restoreview>no</restoreview> ";e=e+" </OLAPDimension>"}}for(var r=0;r<measures.length;r++){e=e+"<OLAPMeasure> ";e=e+"<name>"+measures[r].getAttribute("name")+"</name> ";e=e+"<displayName>"+measures[r].getAttribute("displayName")+"</displayName> ";e=e+"<description>"+measures[r].getAttribute("description")+"</description> ";e=e+"<dataField>"+measures[r].getAttribute("dataField")+"</dataField> ";e=e+"<dataType>"+measures[r].getAttribute("dataType")+"</dataType> ";e=e+"<defaultAggregator>"+measures[r].getAttribute("defaultAggregator")+"</defaultAggregator> ";e=e+"<validAggregators>"+measures[r].getAttribute("validAggregators")+"</validAggregators> ";e=e+"<summarize>"+measures[r].getAttribute("summarize")+"</summarize> ";if(measures[r].getAttribute("format")===""){e=e+"<format/> "}else{e=e+"<format>"+measures[r].getAttribute("format")+"</format> "}e=e+"<align>"+measures[r].getAttribute("align")+"</align> ";if(measures[r].getAttribute("picture")===""){e=e+"<picture/> "}else{e=e+"<picture>"+measures[r].getAttribute("picture")+"</picture> "}e=e+" </OLAPMeasure>"}e=e+"</OLAPCube>";return e};this.ExportToXML=function(){var e='<EXPORT format="XML" type="pivot">';e=e+"<METADATA>";for(var r=0;r<this.columns.length;r++){var t="row";if(self.rowConditions.indexOf(r)!=-1){t="row"}else if(self.colConditions.indexOf(r)!=-1){t="column"}else{t="filter"}e=e+"<OLAPDimension ";e=e+'name="'+this.columns[r].getAttribute("dataField")+'" ';e=e+'label="'+this.columns[r].getAttribute("displayName")+'" ';e=e+'picture="'+this.columns[r].getAttribute("picture")+'" ';e=e+'datatype="'+this.columns[r].getAttribute("dataType")+'" ';e=e+'showAll="true" ';e=e+'position="'+t+'">';if(this.conditions[r]!=undefined&&this.conditions[r].distinctValues!=undefined){for(var i=0;i<this.conditions[r].distinctValues.length;i++){e=e+"<VALUE CHECKED=";if(this.conditions[r].blackList.indexOf(this.conditions[r].distinctValues[i])===-1){e=e+'"true"'}else{e=e+'"false"'}if(this.conditions[r].collapsedValues.indexOf(this.conditions[r].distinctValues[i])==-1){e=e+' COLLAPSED="false">'}else{e=e+' COLLAPSED="true">'}e=e+this.conditions[r].distinctValues[i]+"</VALUE>"}}e=e+"</OLAPDimension>"}for(var r=0;r<measures.length;r++){e=e+"<OLAPMeasure ";e=e+'name="'+measures[r].getAttribute("dataField")+'" ';e=e+'label="'+measures[r].getAttribute("displayName")+'" ';e=e+'picture="'+measures[r].getAttribute("picture")+'" ';e=e+'datatype="'+measures[r].getAttribute("dataType")+'" ';e=e+'showAll="true" ';e=e+'aggregator="sum"/>'}e=e+"</METADATA>";e=e+"<FLATDATA>";for(var a=0;a<this.allDataWithoutSort.length;a++){e=e+"<ROW ";for(var r=0;r<this.columns.length;r++){e=e+this.columns[r].getAttribute("dataField")+'="'+this.allDataWithoutSort[a][r]+'" '}for(var r=0;r<measures.length;r++){e=e+measures[r].getAttribute("dataField")+'="'+this.allDataWithoutSort[a][r+this.columns.length]+'" '}e=e+"/>"}e=e+"</FLATDATA>";e=e+"<COLITEMS>";var s=e;try{var n=0;var f=this.colConditions.length;if(n===f){for(var r=0;r<measures.length;r++){e=e+'<COLITEM measure="'+measures[r].getAttribute("displayName")+'" type=""';e=e+"/>"}}else{n++;for(var r=0;r<this.colStructure.items.length;r++){e=e+this.createXMLCOLITEMS(this.colStructure.items[r],n,f)}}}catch(r){e=s}e=e+"</COLITEMS>";e=e+"<ROWITEMS>";s=e;try{for(var r=0;r<this.rowStructure.items.length;r++){var n=0;var f=this.columns.length-this.colConditions.length-this.filterIndexes.length-1;if(f>=n){e=e+this.createXMLROWITEMS(this.rowStructure.items[r],n,f)}}}catch(r){e=s}e=e+"</ROWITEMS>";e=e+"<HTML>";e=e+"<HEAD>";e=e+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';e=e+"<STYLE>";e=e+".h2title {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt; height: 44px; color: #E0E0E0;}\n";e=e+".h2titlewhite {background-color: #ffffff; font-family: Verdana; font-size: 10pt; font-weight: normal; height: 25px; color: black;}\n";e=e+".even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\n";e=e+".h2subtitle {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt;\theight: 22px; color: #E0E0E0;}\n";e=e+".gtotal {background-color: #EBEBEB; font-weight: normal; font-family: Verdana; font-size: 10pt;}\n";e=e+".pivot_table td.total {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n";e=e+".pivot_table td.subtotal {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n";e=e+"</STYLE>";e=e+"</HEAD>";e=e+"<BODY>";e=e+'<TABLE border="2">';for(var a=0;a<jquery("#"+self.controlName+"_"+self.query+" tr").length;a++){e=e+"<TR>";var l=jquery("#"+self.controlName+"_"+self.query+" tr")[a];for(var o=0;o<l.children.length;o++){var u=OAT.removeIconFont(l.children[o].textContent).trim();var c=l.children[o].getAttribute("hidden");var v="";if(l.children[o].getAttribute("style")!=undefined&&l.children[o].getAttribute("style")!=null){v=' style="'+l.children[o].getAttribute("style")+'" '}var d="";if(l.children[o].getAttribute("class")!=undefined&&l.children[o].getAttribute("class")!=null){d=' class="'+l.children[o].getAttribute("class")+'" '}if(c===null){var h=l.children[o].getAttribute("rowspan");var p=l.children[o].getAttribute("colspan");if(h===null&&p===null||o===l.children.length-1){e=e+"<TD "+d+" "+v+">"+u+"</TD>"}else if(p===null){e=e+"<TD "+d+" "+'rowspan="'+h+'" '+v+" >"+u+"</TD>"}else if(h===null){e=e+"<TD "+d+" "+'colspan="'+p+'" '+v+" >"+u+"</TD>"}else{e=e+"<TD "+d+" "+'colspan="'+p+'" rowspan="'+h+'" '+v+" >"+u+"</TD>"}}}e=e+"</TR>"}e=e+"</TABLE>";e=e+"</BODY>";e=e+"</HTML>";e=e+"</EXPORT>";return e.replace(/\&/g,"&amp;")};this.createXMLROWITEMS=function(e,r,t){var i=e.parent==undefined||e.parent.collapsed==undefined?false:e.parent.collapsed;var a='<ROWITEM dimension="'+columns[r].getAttribute("dataField")+'" collapsed="'+e.collapsed+'" parentCollapsed="'+i+'" value="'+e.value+'" level="'+r+'"';if(r===t){return a+"/>"}else{r++;a=a+">";for(var s=0;s<e.items.length;s++){a=a+this.createXMLROWITEMS(e.items[s],r,t)}a=a+"</ROWITEM>";return a}};this.createXMLCOLITEMS=function(e,r,t){var i="";if(r===t){for(var a=0;a<measures.length;a++){i=i+'<COLITEM measure="'+measures[a].getAttribute("displayName")+'" type="">';var s=self.rowConditions.length-measures.length+1;i=i+'<VALITEM dimension="'+columns[r-1+s].getAttribute("dataField")+'" value="'+e.value+'"/>';var n=e;while(n.parent.depth!=-1){n=n.parent;i=i+'<VALITEM dimension="'+columns[r-1+s].getAttribute("dataField")+'" value="'+n.value+'"/>'}i=i+"</COLITEM>"}return i}else{r++;for(var f=0;f<e.items.length;f++){i=i+this.createXMLCOLITEMS(e.items[f],r,t)}return i}};this.ExportToExcel=function(e){var r='<table border="2">';for(var t=0;t<jquery("#"+self.controlName+"_"+self.query+" tr").length;t++){r=r+"<tr>";var i=jquery("#"+self.controlName+"_"+self.query+" tr")[t];for(var a=0;a<i.children.length;a++){var s=OAT.removeIconFont(i.children[a].textContent.replace(/^\s+|\s+$/g,"")).trim();var n=i.children[a].getAttribute("hidden");var f="";if(i.children[a].getAttribute("style")!=undefined&&i.children[a].getAttribute("style")!=null){f=' style="'+i.children[a].getAttribute("style")+'" '}var l="";var o=false;for(var u=0;u<s.length;u++){if(s.charCodeAt(u)<1e3){if(o){l=l+" "+s[u]}else{l=l+s[u]}o=false}else{var c=s.charCodeAt(u).toString(16);l=l+"&#x"+c;o=true}}if(n===null){var v=i.children[a].getAttribute("rowspan");var d=i.children[a].getAttribute("colspan");if(v===null&&d===null||a===i.children.length-1){r=r+"<td "+f+">"+l+"</td>"}else if(d===null){r=r+'<td rowspan="'+v+'" '+f+" >"+l+"</td>"}else if(v===null){r=r+'<td colspan="'+d+'" '+f+" >"+l+"</td>"}else{r=r+'<td colspan="'+d+'" rowspan="'+v+'" '+f+" >"+l+"</td>"}}}r=r+"</tr>"}r=r+"</table>";var h='<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></head><body>';r=h+r+"</body>";var p=r;if(OAT.isSafari()||self.isSD){window.open("data:application/vnd.ms-excel,"+encodeURIComponent(p))}else{var m=new Blob([p],{type:"application/vnd.ms-excel"});saveAs(m,e+".xls")}};this.lightOn=function(){for(var e=0;e<self.gd.targets.length;e++){var r=self.gd.targets[e][0];if(OAT.isIE()){r.className+=" drag-drop"}else{r.classList.add("drag-drop")}}};this.lightOff=function(){for(var e=0;e<self.gd.targets.length;e++){var r=self.gd.targets[e][0];try{r.classList.remove("drag-drop")}catch(e){}}};self.gd.onFail=self.lightOff;this.process=function(e){self.lightOn();var r=OAT.Dom.create("div");var t=OAT.Dom.create("div");r.setAttribute("class","drag_drop_indicator");t.setAttribute("class","drag_drop_arrow");OAT.addImageNode(r,"drag_indicator","");OAT.addImageNode(t,"arrow_drop_up","");e.className="att_drag_drop";e.appendChild(t);e.appendChild(r)};this.filterOK=function(e){for(var r=0;r<self.filterIndexes.length;r++){var t=self.filterIndexes[r];var i=self.filterDiv.selects[r];if(i.selectedIndex&&OAT.$v(i)!=e[t]){return false}}for(var r=0;r<self.rowConditions.length;r++){var a=e[self.rowConditions[r]];var s=self.conditions[self.rowConditions[r]];if(s.blackList.length>0&&s.blackList.indexOf(a)!=-1){return false}}for(var r=0;r<self.colConditions.length;r++){var a=e[self.colConditions[r]];var s=self.conditions[self.colConditions[r]];if(s.blackList.length>0&&s.blackList.indexOf(a)!=-1){return false}}return true};this.filterDataXMLOK=function(e){for(var r=0;r<self.filterIndexes.length;r++){var t=self.filterIndexes[r];var i=self.filterDiv.selects[r];if(i.selectedIndex&&OAT.$v(i)!=e[t]){return false}}for(var r=0;r<self.rowConditions.length;r++){var a=e[self.rowConditions[r]];var s=self.conditions[self.rowConditions[r]];if(s.state=="none"){return false}if(s.defaultAction=="Exclude"){if(s.visibles.indexOf(a)==-1){return false}}else{if(s.blackList.indexOf(a)!=-1){return false}}}for(var r=0;r<self.colConditions.length;r++){var a=e[self.colConditions[r]];var s=self.conditions[self.colConditions[r]];if(s.state=="none"){return false}if(s.defaultAction=="Exclude"){if(s.visibles.indexOf(a)==-1){return false}}else{if(s.blackList.indexOf(a)!=-1){return false}}}return true};this.sort=function(e,r){var t;var i=e.sort;if(e.sort==0){i=1}if(e.sort==2){i=-1}var a=function(e,r){if(e==r){return 0}return i*(parseInt(e)>parseInt(r)?1:-1)};var s=function(e,r){if(e==r){return 0}return i*(e>r?1:-1)};if(e.distinctValues==undefined)return;var n=true;for(var f=0;f<e.distinctValues.length;f++){if(n&&e.distinctValues[f]!=parseInt(e.distinctValues[f])){n=false}}if(n){t=a}else{t=s}if(e.sort!=0&&e.sort!=2){e.distinctValues.sort(t)}else{if(r!=undefined&&self.columns[r]!=undefined){e.distinctValues.sort(t);var l=[];for(var o=0;o<e.distinctValues.length;o++){l[o]=e.distinctValues[o]}e.distinctValues=[];if(e.sort==0){for(var o=0;o<self.columns[r].childNodes.length;o++){if(self.columns[r].childNodes[o]!=undefined&&self.columns[r].childNodes[o].localName!=undefined&&self.columns[r].childNodes[o].localName==="customOrder"){for(var u=0;u<self.columns[r].childNodes[o].childNodes.length;u++){if(self.columns[r].childNodes[o].childNodes[u].localName=="Value"){var c=self.columns[r].childNodes[o].childNodes[u].textContent;for(var v=0;v<l.length;v++){if(l[v].trimpivot()==c.trimpivot()){e.distinctValues.push(l[v])}}}}}}}else{for(var o=0;o<self.columns[r].childNodes.length;o++){if(self.columns[r].childNodes[o]!=undefined&&self.columns[r].childNodes[o].localName!=undefined&&self.columns[r].childNodes[o].localName==="customOrder"){for(var u=self.columns[r].childNodes[o].childNodes.length-1;u>=0;u--){if(self.columns[r].childNodes[o].childNodes[u].localName=="Value"){var c=self.columns[r].childNodes[o].childNodes[u].textContent;for(var v=0;v<l.length;v++){if(l[v].trimpivot()==c.trimpivot()){e.distinctValues.push(l[v])}}}}}}}if(e.distinctValues.length<l.length){for(var o=0;o<l.length;o++){if(e.distinctValues.indexOf(l[o])==-1){e.distinctValues.push(l[o])}}}}}if(columns.length==1||(measures.length=0)){if(e.sort==1){self.allData.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]<t[e]?-1:1}}(0))}else if(e.sort==-1){self.allData.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]>t[e]?-1:1}}(0))}}};this.initCondition=function(e){if(e==self.dataColumnIndex&&(columns.length>1||measures.length>0)){self.conditions.push(false);return}var r=1;var t=1;var i=false;var a="filters;rows;columns;hidden";var s=false;if(self.columns[e]!=undefined){s=true;if(self.columns[e].getAttribute("order")!=undefined&&self.columns[e].getAttribute("order")==="ascending"){r=1}if(self.columns[e].getAttribute("order")!=undefined&&self.columns[e].getAttribute("order")==="descending"){r=-1}if(self.columns[e].getAttribute("order")!=undefined&&self.columns[e].getAttribute("order")==="custom"){r=1}if(self.columns[e].getAttribute("summarize")!=undefined&&self.columns[e].getAttribute("summarize")==="yes"){t=1;for(var n=0;n<self.columns[e].childNodes.length;n++){if(self.columns[e].childNodes[n]!=undefined&&self.columns[e].childNodes[n].localName!=undefined&&self.columns[e].childNodes[n].localName==="include"){t=false;for(var f=0;f<self.columns[e].childNodes[n].childNodes.length;f++){if(self.columns[e].childNodes[n].childNodes[f].localName!=null&&self.columns[e].childNodes[n].childNodes[f].localName.toLowerCase()==="value"){if(self.columns[e].childNodes[n].childNodes[f].textContent=="TOTAL"){t=true}}}}else if(self.columns[e].childNodes[n]!=undefined&&self.columns[e].childNodes[n].localName!=undefined&&self.columns[e].childNodes[n].localName==="exclude"){t=false}}}if(self.columns[e].getAttribute("summarize")!=undefined&&self.columns[e].getAttribute("summarize")==="no"){t=false;i=true}var a="";var l=self.columns[e].getAttribute("visible");if(l!="Never"){a=self.columns[e].getAttribute("canDragToPages")=="true"?"filters;":"";a=a+"rows;columns;hidden"}}var o={distinctValues:[],blackList:[],whiteList:[],greyList:[],collapsedValues:[],sort:r,subtotals:t,hideSubtotalOption:i,validPosition:a,dataRowPosition:e,isDimension:s,topFilterValue:self.translations.GXPL_QViewerJSAllOption};o.topFilterValue="[all]";o.topFilterString=self.translations.GXPL_QViewerJSAllOption;self.conditions.push(o);if(self.columns[e]!=undefined){for(var n=0;n<self.columns[e].childNodes.length;n++){if(self.columns[e].childNodes[n]!=undefined&&self.columns[e].childNodes[n].localName!=undefined&&self.columns[e].childNodes[n].localName==="include"){for(var f=0;f<self.columns[e].childNodes[n].childNodes.length;f++){if(self.columns[e].childNodes[n].childNodes[f].localName!=null&&self.columns[e].childNodes[n].childNodes[f].localName.toLowerCase()==="value"){if(self.columns[e].childNodes[n].childNodes[f].textContent!="TOTAL"){self.conditions[e].topFilterValue=self.columns[e].childNodes[n].childNodes[f].textContent}}}}}}};this.restoreSubtotalsAndSortLayout=function(e){try{if(rememberLayout){mState=self.getState();if(mState!=undefined&&mState.version!=undefined&&mState.version===self.rememberLayoutStateVersion){if(mState.query==self.query&&self.conditions.length==mState.conditions.length){self.conditions[e].subtotals=mState.conditions[e].subtotals;self.conditions[e].sort=mState.conditions[e].sort;self.conditions[e].collapsedValues=mState.conditions[e].collapsedValues}}}}catch(e){}};this.applyCustomFilters=function(e){try{if(e==self.dataColumnIndex){return}if(self.columns[e]!=undefined){for(var r=0;r<self.columns[e].childNodes.length;r++){if(self.columns[e].childNodes[r]!=undefined&&self.columns[e].childNodes[r].localName!=undefined&&self.columns[e].childNodes[r].localName==="include"){self.createFilterInfo({op:"none",values:"",dim:e});for(var t=0;t<self.columns[e].childNodes[r].childNodes.length;t++){if(self.columns[e].childNodes[r].childNodes[t].localName!=null&&self.columns[e].childNodes[r].childNodes[t].localName.toLowerCase()==="value"){if(self.columns[e].childNodes[r].childNodes[t].textContent!="TOTAL"){if(self.UserFilterValues[e]==undefined)self.UserFilterValues[e]=[];self.UserFilterValues[e].push(self.columns[e].childNodes[r].childNodes[t].textContent.trimpivot())}}}}var i=self.rowConditions.indexOf(e);var a=self.colConditions.indexOf(e);if(a<self.colConditions.length-1&&a!=-1||i<self.rowConditions.length-measures.length&&i!=-1){if(self.columns[e].childNodes[r]!=undefined&&self.columns[e].childNodes[r].localName!=undefined&&self.columns[e].childNodes[r].localName==="expand"){for(var t=0;t<self.columns[e].childNodes[r].childNodes.length;t++){if(self.columns[e].childNodes[r].childNodes[t].localName!=null&&self.columns[e].childNodes[r].childNodes[t].localName.toLowerCase()==="value"){if(self.UserExpandValues[e]==undefined)self.UserExpandValues[e]=[];self.UserExpandValues[e].push(self.columns[e].childNodes[r].childNodes[t].textContent.trimpivot())}}if(self.UserExpandValues[e]==undefined){self.UserExpandValues[e]=["#ALLCOLLAPSE#"]}}}}}}catch(e){}};this.initWhenServerPagination=function(){self.propPage=OAT.Dom.create("div",{});if(self.QueryViewerCollection[self.IdForQueryViewerCollection].AutoRefreshGroup==""){jquery(".oat_winrect_container").remove()}self.UserFilterValues=[];self.UserExpandValues=[];for(var e=0;e<self.headerRow.length;e++){self.initCondition(e);if(self.conditions[e]&&self.columns[e]){self.conditions[e].dataField=self.columns[e].getAttribute("dataField");self.conditions[e].state="all";self.conditions[e].defaultAction="Include";self.conditions[e].visibles=[];self.conditions[e].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}self.applyCustomFilters(e)}var r=jquery.extend(true,[],self.conditions);var t=new Array;for(var e=0;e<self.initRowConditions.length;e++){t[e]=self.initRowConditions[e]}var i=new Array;for(var e=0;e<self.initColConditions.length;e++){i[e]=self.initColConditions[e]}var a=new Array;for(var e=0;e<self.initFilterIndexes.length;e++){a[e]=self.initFilterIndexes[e]}var s=jquery.extend(true,{},self.initMetadata);self.initState={query:self.query,conditions:r,colConditions:i,rowConditions:t,filterDivSelects:[],filterIndexes:a,stateChanged:false,rowsPerPage:pageSize,AxisInfo:self.createAxisInfo(""),NewAxisInfo:self.createNewAxisInfo(""),DataInfo:self.createDataInfo(),NewDataInfo:self.createNewDataInfo(),CollapseInfo:[],FilterInfo:[],InitMetadata:s};for(var e=0;e<self.headerRow.length;e++){self.restoreSubtotalsAndSortLayout(e)}var n;if(rememberLayout){n=self.getState()}else{n=null}var f=[];self.stateLoad=false;if(n!=null){if(n.version!=undefined&&n.version===self.rememberLayoutStateVersion){if(n.query==self.query&&self.conditions.length==n.conditions.length){self.stateLoad=true;self.UserFilterValues=[];for(var l=0;l<=n.conditions.length-1;l++){if(n.conditions[l]!=false&&self.conditions[l]!=false){for(var o=0;o<n.conditions[l].distinctValues.length;o++){if(self.conditions[l].distinctValues.indexOf(n.conditions[l].distinctValues[o])==-1){self.conditions[l].distinctValues.push(n.conditions[l].distinctValues[o])}}for(var o=0;o<n.conditions[l].blackList.length;o++){if(self.conditions[l].blackList.indexOf(n.conditions[l].blackList[o])==-1){self.conditions[l].blackList.push(n.conditions[l].blackList[o])}}if(n.conditions[l].visibles){for(var o=0;o<n.conditions[l].visibles.length;o++){if(self.conditions[l].visibles.indexOf(n.conditions[l].visibles[o])==-1){self.conditions[l].visibles.push(n.conditions[l].visibles[o])}}}for(var o=0;o<n.conditions[l].collapsedValues.length;o++){if(self.conditions[l].collapsedValues.indexOf(n.conditions[l].collapsedValues[o])==-1){self.conditions[l].collapsedValues.push(n.conditions[l].collapsedValues[o])}}try{self.conditions[l].sort=n.conditions[l].sort;self.oldSortValues[l]=n.conditions[l].sort;self.conditions[l].subtotals=n.conditions[l].subtotals;self.conditions[l].defaultAction=n.conditions[l].defaultAction;self.conditions[l].state=n.conditions[l].state;self.conditions[l].topFilterValue=n.conditions[l].topFilterValue;self.conditions[l].totalPages=n.conditions[l].totalPages;self.conditions[l].previousPage=n.conditions[l].previousPage;self.conditions[l].blocked=n.conditions[l].blocked}catch(e){}}}self.rowConditions=n.rowConditions;self.colConditions=n.colConditions;self.rowsPerPage=n.rowsPerPage;self.filterIndexes=n.filterIndexes;if(n.filterDivSelects!=undefined){for(var u=0;u<n.filterDivSelects.length;u++){f[u]=n.filterDivSelects[u]}}self.stateChanged=true}}}try{if(n!=null&&n.version===self.rememberLayoutStateVersion&&n.filterIndexes.length>0){var c=false;for(var e=0;e<self.conditions.length;e++){var v=[];if(self.conditions[e]&&self.conditions[e].blackList){for(var d=0;d<self.conditions[e].blackList.length;d++){v.push(self.conditions[e].blackList[d]);c=true}}self.tempBlackLists.push([v]);var h=[];if(self.conditions[e]&&self.conditions[e].collapsedValues){for(var d=0;d<self.conditions[e].collapsedValues.length;d++){h.push(self.conditions[e].collapsedValues[d]);c=true}}self.tempCollapsedValues.push([h])}if(!c){self.tempBlackLists=false}}else{self.tempBlackLists=false}}catch(e){self.tempBlackLists=false}self.gd.clearSources();self.gd.clearTargets();if(GlobalPivotInterval[UcId]!=undefined){clearInterval(GlobalPivotInterval[UcId])}var p=0;var m=0;GlobalPivotInterval[UcId]=setInterval((function(){var e=0;var r=jquery("#"+UcId+"_"+self.query+"_pivot_page").find(".inner_filter_div");var t=0;for(var i=0;i<r.length;i++){if(t<r[i].offsetWidth){t=r[i].offsetWidth}}t=t>0?t+8:t;if(jquery("#"+self.controlName+"_"+self.query+"tablePagination_rowsPerPage").length>0){e=parseInt(jquery("#"+self.controlName+"_"+self.query+"tablePagination_rowsPerPage")[0].value);if(!isNaN(e)){if(jquery("#"+self.controlName+"_"+self.query)[0].getAttribute("class")==="pivot_table"){if(!autoResize){var a=jquery("#"+self.containerName)[0].clientWidth;if(a<t){jquery("#"+self.controlName+"_"+self.query).css({width:t+"px"})}else{jquery("#"+self.controlName+"_"+self.query).css({width:a+"px"})}}var s=jquery("#"+self.controlName+"_"+self.query)[0].offsetWidth;if(s>=t){var n=jquery("#"+self.controlName+"_"+self.query+"_tablePagination")[0].clientWidth;if(n>t+1||n<t-1){jquery("#"+UcId+"_"+self.query+"_title_div").css({width:s+"px"});jquery("#"+UcId+"_"+self.query+"_pivot_page").css({width:s+"px"});jquery("#"+self.controlName+"_"+self.query+"_tablePagination").css({width:s+"px"});m=p;p=s}}else{jquery("#"+UcId+"_"+self.query+"_title_div").css({width:t+"px"});jquery("#"+UcId+"_"+self.query+"_pivot_page").css({width:t+"px"});jquery("#"+self.controlName+"_"+self.query+"_tablePagination").css({width:t+"px"});jquery("#"+self.controlName+"_"+self.query).css({width:t+"px"});m=p;p=t}}}}else{if(jquery("#"+self.controlName+"_"+self.query)[0]!=undefined){if(jquery("#"+self.controlName+"_"+self.query)[0].getAttribute("class")==="pivot_table"){if(!autoResize){var a=jquery("#"+self.containerName)[0].clientWidth;if(a<t){jquery("#"+self.controlName+"_"+self.query).css({width:t+"px"})}else{jquery("#"+self.controlName+"_"+self.query).css({width:a+"px"})}}var s=jquery("#"+self.controlName+"_"+self.query)[0].offsetWidth;if(s<t){if(m==0||m==p||(p>t+6||p<t-6||m>p+6||m<p-6)){jquery("#"+UcId+"_"+self.query+"_title_div").css({width:t+"px"});jquery("#"+UcId+"_"+self.query+"_pivot_page").css({width:t+"px"});m=p;p=t;jquery("#"+self.controlName+"_"+self.query).css({width:t+"px"})}}else{if(m==0||m==p||(p>s+6||p<s-6||m>p+6||m<p-6)){jquery("#"+UcId+"_"+self.query+"_title_div").css({width:s+"px"});jquery("#"+UcId+"_"+self.query+"_pivot_page").css({width:s+"px"});m=p;p=s}}}}}}),20);var T;if(n!=null&&n.AxisInfo!=null){self.pageData.AxisInfo=n.AxisInfo;T=jquery.extend(true,{},n.NewAxisInfo)}else{self.pageData.AxisInfo=self.createAxisInfo("");T=self.createNewAxisInfo("")}var A;if(n!=null&&n.DataInfo!=null){self.pageData.DataInfo=n.DataInfo;A=jquery.extend(true,{},n.NewDataInfo)}else{self.pageData.DataInfo=self.createDataInfo();A=self.createNewDataInfo()}if(n!=null&&n.FilterInfo!=null){self.pageData.FilterInfo=n.FilterInfo}if(self.UserFilterValues.length==0&&self.UserExpandValues.length==0){self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");self.lastCallToQueryViewer="initWhenServerPagination";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,T,A,self.pageData.FilterInfo,self.pageData.CollapseInfo,true)}else{self.initValueRead(self,0,true)}setInterval((function(){for(var e=0;e<jquery(".oat_winrect_container .pivot_popup_fix").length;e++){if(!jquery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display||jquery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[e].style.display!="none"){if(jquery(".oat_winrect_container .pivot_popup_fix").length>0){var r=jquery(".oat_winrect_container .pivot_popup_fix")[e];var t=r.scrollHeight-r.clientHeight-r.scrollTop;if(t<25){var i=r.getAttribute("ucid");var a=parseInt(r.getAttribute("columnNumber"));if(i==self.UcId){self.readScrollValue(a)}}}}}}),250)};this.initValueRead=function(e,r,t,i){if(r>=e.columns.length){try{for(var a=0;a<jquery("#"+e.UcId+"_"+e.query+"_pivot_page").find("select").length;a++){var s=jquery("#"+e.UcId+"_"+e.query+"_pivot_page").find("select")[a];var n=parseInt(s.getAttribute("id").replace("page_select_",""));var f=e.filterIndexes[n];if(e.conditions[f].filteredShowValues==undefined){e.conditions[f].filteredShowValues=[]}var l=e.conditions[f].distinctValues;for(var o=0;o<l.length;o++){var u=l[o];if(e.conditions[f].filteredShowValues.indexOf(u)==-1){e.conditions[f].filteredShowValues.push(u);if(u!="#NuN#"){OAT.Dom.option(u,u,s)}else{OAT.Dom.option(" ",u,s)}}}if(e.conditions[f].topFilterValue!="[all]"){var u=e.conditions[f].topFilterValue;var c=-1;for(var v=0;v<e.conditions[f].filteredShowValues.length;v++){if(String(e.conditions[f].filteredShowValues[v]).trim()==String(u).trim()){c=v}}if(c>-1){s.selectedIndex=c+1}else{e.conditions[f].filteredShowValues.push(u);if(u!="#NuN#"){OAT.Dom.option(u,u,s)}else{OAT.Dom.option(" ",u,s)}s.selectedIndex=1}}}}catch(e){}if(t){e.callServiceWhenCustomeValues()}return}else{var d=10;if(e.QueryViewerCollection[e.IdForQueryViewerCollection].AutoRefreshGroup!=""||t){d=0}e.lastRequestValue=r;e.lastRequestAttributeValues="initValueRead";e.lastRequestAttributeColumnNumber=r;e.lastRequestAttributeAllData=t;e.lastRequestAttributeRequestDataField=i;e.requestAttributeValues(e.columns[r].getAttribute("dataField"),1,d,"")}};this.callServiceWhenCustomeValues=function(){self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");var e=self.createNewAxisInfo();var r=self.createNewDataInfo();self.lastCallToQueryViewer="callServiceWhenCustomeValues";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,e,r,self.pageData.FilterInfo,self.pageData.CollapseInfo,true)};this.getOrderReference=function(e,r,t,i){return function(a,s,n){if(self.conditions[e].validPosition!=undefined&&self.conditions[e].validPosition.indexOf("filters")==-1){return}self.lightOff();var f=e;var l=a.conditionIndex;if(f!=l&&self.conditions[0].previousPage==undefined){self.initValueRead(self,0,self.stateLoad)}if(a==self.filterDiv){self.stateChanged=true;var o=false;for(var u=0;u<self.filterIndexes.length&&!o;u++){if(self.filterIndexes[u]>e){self.filterIndexes.splice(u,0,e);o=true}}if(!o){self.filterIndexes.push(e)}self.conditions[e].blackList=[];for(var c=0;c<self.rowConditions.length;c++){if(self.rowConditions[c]==e){self.rowConditions.splice(c,1)}}for(var c=0;c<self.colConditions.length;c++){if(self.colConditions[c]==e){self.colConditions.splice(c,1)}}self.onDragundDropEventHandle(e,"pages",self.filterIndexes.indexOf(e));self.DiseablePivot();setTimeout((function(){self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,{op:"all",value:"",dim:e},"","");self.EneablePivot()}),200);return}var v=self.rowConditions.indexOf(e)>-1;if(f==l){if(OAT.isWebkit()){if(r!=undefined){r.displayRef2([s,n]);t([s,n,i])}}return}var d=false;var h=-1;var p=false;var m=-1;for(var c=0;c<self.rowConditions.length;c++){if(self.rowConditions[c]==f){d=self.rowConditions;h=c}if(self.rowConditions[c]==l){p=self.rowConditions;m=c}}for(var c=0;c<self.colConditions.length;c++){if(self.colConditions[c]==f){d=self.colConditions;h=c}if(self.colConditions[c]==l){p=self.colConditions;m=c}}if(d==p){if(h+1==m){p.splice(m+1,0,f);p.splice(h,1)}else{p.splice(h,1);p.splice(m,0,f)}self.changesrowposition=true;self.onDragundDropEventHandle(e,v?"rows":"columns",v?self.rowConditions.indexOf(e):self.colConditions.indexOf(e))}else{d.splice(h,1);p.splice(m,0,f);self.onDragundDropEventHandle(e,v?"columns":"rows",v?self.colConditions.indexOf(e):self.rowConditions.indexOf(e))}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,"","","")}};this.getOrderReferenceProg=function(e){if(self.conditions[e].validPosition!=undefined&&self.conditions[e].validPosition.indexOf("filters")==-1){return}self.stateChanged=true;if(self.filterIndexes.indexOf(e)<0){self.filterIndexes.push(e)}self.conditions[e].blackList=[];for(var r=0;r<self.rowConditions.length;r++){if(self.rowConditions[r]==e){self.rowConditions.splice(r,1)}}for(var r=0;r<self.colConditions.length;r++){if(self.colConditions[r]==e){self.colConditions.splice(r,1)}}self.onDragundDropEventHandle(e,"pages",self.filterIndexes.indexOf(e));self.DiseablePivot();setTimeout((function(){self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,{op:"all",value:"",dim:e},"","");self.EneablePivot()}),200);return};this.getClickReference=function(e,r,t){var i=OAT.Anchor.assign(t,{title:" ",content:self.propPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:self.IdForQueryViewerCollection+"-pivottable"+" FilterPopup "});jquery(t).data("anchorRef",i);return[function(t){if(self.conditions[r].previousPage==undefined){self.initValueRead(self,r,self.stateLoad,self.conditions[r].dataField);jquery(".oat_winrect_container").css({left:"-10000000px",top:"-10000000px"});var i=jquery.extend(true,{},t);var a=function(){if(self.conditions[r].previousPage==undefined){setTimeout(a,100)}else{self.ShowPopUp(e,r,i)}};a()}else{self.ShowPopUp(e,r,t)}},i]};this.ShowPopUp=function(e,r,t){var i=function(){jquery(".oat_winrect_container").css({display:"none"})};var a;var s;if(t.currentTarget!=undefined){a=t.currentTarget;s=OAT.Dom.eventPos(t)}else{a=t[2];s=[t[0],t[1]]}var n=[];self.propPage.style.left=s[0]+"px";self.propPage.style.top=s[1]+"px";if(self.isSD){jquery(".oat_winrect_container").css({left:"-1500px",top:jquery(a).offset().top+"px"});jquery(".oat_winrect_container").addClass("oat_winrect_container_small")}else{jquery(".oat_winrect_container").css({left:jquery(a).offset().left+"px",top:jquery(a).offset().top+"px"})}self.propPage.setAttribute("id","pop-up");self.propPage.setAttribute("class","oat_pop-up");OAT.Dom.clear(self.propPage);n.push(self.propPage);jquery(".oat_winrect_title").find(".winrect_title_label").remove();var f=OAT.Dom.create("label");if(self.isSD){f.setAttribute("class","winrect_title_label winrect_title_label_small")}else{f.setAttribute("class","winrect_title_label")}OAT.addTextNode(f,self.columns[r].getAttribute("displayName"));jquery(".oat_winrect_title").append(f);if(!disableColumnSort){var l=document.createElement("div");l.setAttribute("class","first_popup_subdiv");var o=OAT.Dom.radio("order");var u="pivot_order_asc"+"_"+self.containerName+"_"+self.columns[r].getAttribute("dataField");o.id=u;o.className="input_radio_popup";OAT.Dom.attach(o,"change",(function(){try{'<DATA event="OrderChanged" name="'+self.columns[r].getAttribute("name")+'" displayName="'+self.columns[r].getAttribute("displayName")+'"  order="ascending">'}catch(e){}e.sort=1;self.stateChanged=true;self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");var t="i_"+this.getAttribute("id");var i=document.getElementById(t);i.textContent="radio_button_checked";var a=document.getElementById(t.replace("asc","desc"));a.textContent="radio_button_unchecked"}));l.appendChild(o);var c=OAT.isIE()?"top:-10px;":"";var v=OAT.Dom.create("label");v.className="first_div_label";v.htmlFor=u;l.appendChild(v);l.appendChild(OAT.Dom.create("br"));OAT.addImageNode(v,e.sort==1?"radio_button_checked":"radio_button_unchecked",c,"i_"+u);OAT.addTextNode(v,self.translations.GXPL_QViewerJSAscending);var d=OAT.Dom.radio("order");var h="pivot_order_desc"+"_"+self.containerName+"_"+self.columns[r].getAttribute("dataField");d.id=h;d.className="input_radio_popup";OAT.Dom.attach(d,"change",(function(){try{'<DATA event="OrderChanged" name="'+self.columns[r].getAttribute("name")+'" displayName="'+self.columns[r].getAttribute("displayName")+'"  order="descending">'}catch(e){}e.sort=-1;self.stateChanged=true;self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");var t="i_"+this.getAttribute("id");var i=document.getElementById(t);i.textContent="radio_button_checked";var a=document.getElementById(t.replace("desc","asc"));a.textContent="radio_button_unchecked"}));l.appendChild(d);var p=OAT.Dom.create("label");p.className="first_div_label";p.htmlFor=h;l.appendChild(p);OAT.addImageNode(p,e.sort==1?"radio_button_unchecked":"radio_button_checked",c,"i_"+h);OAT.addTextNode(p,self.translations.GXPL_QViewerJSDescending);n.push(l);var m=OAT.Dom.create("hr",{});n.push(m)}var T=OAT.Dom.create("hr",{});var A=OAT.Dom.create("hr",{});if((e.hideSubtotalOption===undefined||!e.hideSubtotalOption)&&(!self.autoPaging||self.colConditions.length==0)){var y=OAT.Dom.create("div");if(disableColumnSort){y.setAttribute("class","first_popup_subdiv")}var w=document.createElement("div");var O=e.subtotals?"check_item_img":"uncheck_item_img";if(self.isSD){var O=e.subtotals?"check_item_img_small":"uncheck_item_img_small"}w.setAttribute("class",O);OAT.Dom.attach(w,"click",(function(){var t="check_item_img";var i="uncheck_item_img";if(self.isSD){t="check_item_img_small";i="uncheck_item_img_small"}e.subtotals=!(this.getAttribute("class")===t);var a=this.getAttribute("class")===t?i:t;this.setAttribute("class",a);jquery(this).find("i")[0].textContent=e.subtotals?"check_box":"check_box_outline_blank";self.stateChanged=true;try{'<DATA event="SubtotalsChanged" name="'+self.columns[r].getAttribute("name")+'" displayName="'+self.columns[r].getAttribute("displayName")+'"  subtotals="'+e.subtotals+'">'}catch(e){}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","")}));var g=OAT.Dom.create("label");OAT.addImageNode(g,e.subtotals?"check_box":"check_box_outline_blank","");OAT.addTextNode(g,self.translations.GXPL_QViewerJSSubtotals);g.htmlFor="pivot_checkbox_subtotals";w.appendChild(g);OAT.Dom.append([y,w]);n.push(y);n.push(T)}if(self.stateChanged||self.pivotStateChanged()){var _=OAT.Dom.create("div");var b=document.createElement("div");OAT.Dom.attach(b,"click",(function(){self.cleanStateWhenServerPagination();self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");i();self.stateChanged=false}));var x=OAT.Dom.create("label");OAT.addTextNode(x,self.translations.GXPL_QViewerJSRestoreDefaultView);x.setAttribute("id","restore_default_view");x.htmlFor="pivot_checkbox_restoreview";x.setAttribute("class","pivot_checkbox_restoreview");b.appendChild(x);OAT.Dom.append([_,b]);n.push(_)}var S=false;if(measures.length>0){var I=OAT.Dom.create("div");var k=document.createElement("div");OAT.Dom.attach(k,"click",(function(){self.stateChanged=true;self.changedFromColumnToRow(r);self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,e.dataField,"","","");i()}));var q=OAT.Dom.create("label");if(self.rowConditions.indexOf(r)!=-1)OAT.addTextNode(q,self.translations.GXPL_QViewerJSPivotDimensionToColumn);else OAT.addTextNode(q,self.translations.GXPL_QViewerJSPivotDimensionToRow);q.htmlFor="pivot_checkbox_restoreview";q.setAttribute("class","pivot_checkbox_restoreview");q.setAttribute("id","move_to_column");k.appendChild(q);OAT.Dom.append([I,k]);n.push(I);S=true}if(measures.length>0){if(OAT.isSD()){if(self.filterIndexes.indexOf(r)===-1){var F=OAT.Dom.create("div");var P=document.createElement("div");OAT.Dom.attach(P,"click",(function(){self.getOrderReferenceProg(r);i()}));var N=OAT.Dom.create("label");OAT.addTextNode(N,self.translations.GXPL_QViewerJSMoveToFilterBar);N.htmlFor="pivot_checkbox_movetocolumn";P.appendChild(N);OAT.Dom.append([F,P]);n.push(F);S=true}}}if(S)n.push(A);var D=OAT.Dom.create("div");D.setAttribute("class","last_div_popup");if(!OAT.isIE()){OAT.Dom.create("br");OAT.Dom.create("br");OAT.Dom.create("br")}else{OAT.Dom.create("span");OAT.Dom.create("span");OAT.Dom.create("span")}n.push(D);OAT.Dom.append(n);self.distinctDivs(e,D,r);if(!disableColumnSort){o.checked=e.sort==1||e.sort==0;o.__checked=o.checked;d.checked=e.sort==-1||e.sort==2;d.__checked=d.checked}if(self.isSD){setTimeout((function(){var e=window.innerWidth;var r=jquery(".oat_winrect_container")[0].clientWidth;if(r==0){var t=jquery(".oat_winrect_container").length;r=jquery(".oat_winrect_container")[t-1].clientWidth}if(r<245){r=245}var i=(e-r)/2+jquery(window).scrollLeft();jquery(".oat_winrect_container").css({left:i+"px",width:r+"px"})}),50)}};this.updateRowConditions=function(e,r,t){var i=false;var a=self.initRowConditions.length+self.initColConditions.length<=self.rowConditions.length+self.colConditions.length;if(a)i=true;var s=[];for(var n=0;n<self.initRowConditions.length-(r.length-1);n++){if(self.initRowConditions[n]==e){s.push(e)}if(self.rowConditions.indexOf(self.initRowConditions[n])>-1){s.push(self.initRowConditions[n])}}for(var n=0;n<self.initColConditions.length;n++){if(self.initColConditions[n]==e){s.push(e)}if(self.rowConditions.indexOf(self.initColConditions[n])>-1){s.push(self.initColConditions[n])}}for(var n=0;n<self.initFilterIndexes.length;n++){if(self.initFilterIndexes[n]==e&&s.indexOf(e)==-1){s.push(e)}if(self.rowConditions.indexOf(self.initFilterIndexes[n])>-1){if(s.indexOf(self.initFilterIndexes[n])==-1)s.push(self.initFilterIndexes[n])}}if(s.indexOf(e)<0){s.push(e)}if(i){for(var f=0;f<self.rowConditions.length;f++){if(s.indexOf(self.rowConditions[f])<0){s.push(self.rowConditions[f])}}}s.sort(function(){return function(e,r){return e==r?0:e<r?-1:1}}());for(var n=self.initRowConditions.length-(r.length-1);n<Math.min(self.initRowConditions.length,self.dataColumnIndex);n++){if(s.indexOf(self.initRowConditions[n])<0)s.push(self.initRowConditions[n])}self.rowConditions=[];for(var n=0;n<s.length;n++){self.rowConditions[n]=s[n]}};this.changedFromColumnToRow=function(e){var r=self.rowConditions.indexOf(e);var t="columns";var i=0;if(r!=-1){self.rowConditions.splice(r,1);if(measures.length>1)self.colConditions=[e].concat(self.colConditions);else self.colConditions.push(e);i=self.colConditions.indexOf(e)}else{t="rows";r=self.colConditions.indexOf(e);self.colConditions.splice(r,1);self.updateRowConditions(e,measures,false);i=self.rowConditions.indexOf(e)}self.onDragundDropEventHandle(e,t,i)};this.getDelFilterReference=function(e){return function(){var r=self.filterIndexes.indexOf(e);if(r!=-1){self.filterIndexes.splice(r,1)}self.updateRowConditions(e,measures,true);for(var t=0;t<self.filterDiv.selects.length;t++){if(e==self.filterDiv.selects[t].filterIndex){self.filterDiv.selects.splice(t,1);break}}self.stateChanged=true;self.onDragundDropEventHandle(e,"rows",self.rowConditions.indexOf(e));self.DiseablePivot();setTimeout((function(){self.conditions[e].topFilterValue="[all]";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[e].dataField,{op:"all",values:"",dim:e},"","");self.EneablePivot()}),200)}};this.valueIsShowed=function(e,r){if(self.conditions[r].state=="all"){return true}else if(self.conditions[r].state=="none"){return false}else if(self.conditions[r].blackList.indexOf(e)!=-1){return false}else if(self.conditions[r].distinctValues.indexOf(e)!=-1){return true}else if(self.conditions[r].defaultAction=="Exclude"){return false}else{return true}};this.distinctDivs=function(e,r,t,i){var a=function(r,i){var a=OAT.Dom.create("div");var s="check_item_img";var n="uncheck_item_img";if(self.isSD){s="check_item_img_small";n="uncheck_item_img_small"}OAT.addImageNode(a,self.valueIsShowed(A,t)?"check_box":"check_box_outline_blank","");var f=e.blackList.indexOf(A)==-1&&self.valueIsShowed(A,t)?s:n;var f=self.valueIsShowed(A,t)?s:n;a.setAttribute("class",f);var l=OAT.Dom.create("input");l.type="checkbox";l.id=i;var o=OAT.Dom.create("label");OAT.addTextNode(o,r);o.htmlFor=i;a.appendChild(o);return[a,l]};var s=function(e,r){setTimeout((function(){var i="pop";if(!e){i="push"}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:i,values:r,dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.EneablePivot()}),200)};var n=function(){self.DiseablePivot();setTimeout((function(){var i="all";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:i,values:"",dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.distinctDivs(e,r,t);self.EneablePivot();return}),200)};var f=function(){self.DiseablePivot();setTimeout((function(){var i="none";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:i,values:"",dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.distinctDivs(e,r,t);self.EneablePivot();return}),200)};var l=function(){self.DiseablePivot();setTimeout((function(){var i="reverse";self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[t].dataField,{op:i,values:"",dim:t},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(t);self.distinctDivs(e,r,t);self.EneablePivot();return}),200)};var o=function(){self.getValuesForColumn(self.UcId,t,this.value)};OAT.Dom.clear(r);var u=OAT.Dom.create("div");u.setAttribute("class","div_buttons_popup");var c=document.createElement("button");c.textContent=self.translations.GXPL_QViewerJSAll;c.setAttribute("class","btn");jquery(c).click(n);var v=document.createElement("button");v.textContent=self.translations.GXPL_QViewerJSNone;v.setAttribute("class","btn");jquery(v).click(f);var d=document.createElement("button");d.textContent=self.translations.GXPL_QViewerJSReverse;d.setAttribute("class","btn");jquery(d).click(l);OAT.Dom.append([u,c,v,d],[r,u]);var h=OAT.Dom.create("div");h.setAttribute("class","div_filter_input");var p=document.createElement("input");OAT.addImageNode(h,"search","");p.textContent="none";p.setAttribute("class","search_input");p.setAttribute("type","text");p.setAttribute("label",self.translations.GXPL_QViewerSearch);p.setAttribute("title",self.translations.GXPL_QViewerSearch);p.setAttribute("placeholder",self.translations.GXPL_QViewerSearch);p.setAttribute("id",self.UcId+t);jquery(p).keyup(o);OAT.Dom.append([h,p],[r,h]);var m=OAT.Dom.create("div");e=self.conditions[t];if(e.distinctValues.length<=9){m.setAttribute("class","pivot_popup_auto")}else{m.setAttribute("class","pivot_popup_fix")}for(var T=0;T<e.distinctValues.length;T++){var A=e.distinctValues[T];if(!(self.conditions[t].hasNull&&A.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){var y=self.dimensionPictureValue(A,t);y=y.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(y.length>33){var w=y.substring(32,y.length).trimpivot().length>0?"...":"";y=y.substring(0,32)+w}y=y.replace(/ /g,"Â ")+"Â Â Â Â Â ";var O=a(y,"pivot_distinct_"+T);O[0].setAttribute("value",A);m.appendChild(O[0]);OAT.Dom.attach(O[0],"click",(function(){self.DiseablePivot();var e="check_item_img";var r="uncheck_item_img";if(self.isSD){e="check_item_img_small";r="uncheck_item_img_small"}var t=!(this.getAttribute("class")===e);var i=this.getAttribute("class")===e?r:e;this.setAttribute("class",i);jquery(this).find("i")[0].textContent=t?"check_box":"check_box_outline_blank";s(t,this.getAttribute("value"))}))}}m.setAttribute("ucid",self.UcId);m.setAttribute("columnnumber",t);m.setAttribute("id","values_"+self.UcId+"_"+t);r.appendChild(m)};this.DiseablePivot=function(){try{var e=jquery('<div class="disable_popup" ></div>');if(jquery("#"+self.containerName).length>0){var r=Math.min(jquery("#"+UcId+"_"+self.query+"_pivot_page")[0].clientHeight+jquery("#"+UcId+"_"+self.query+"_pivot_content")[0].clientHeight,jquery("#"+self.containerName)[0].clientHeight);var t=Math.min(jquery("#"+UcId+"_"+self.query)[0].clientWidth,jquery("#"+self.containerName)[0].clientWidth);if(jquery("#"+self.containerName).closest(".gxwebcomponent").length>0){if(jquery("#"+UcId+"_"+self.query+"_tablePagination").length>0){r=r+jquery("#"+UcId+"_"+self.query+"_tablePagination")[0].clientHeight}jquery(e).css({width:t,height:r,position:"absolute",top:jquery("#"+self.containerName)[0].offsetTop,left:jquery("#"+self.containerName)[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99})}else{jquery(e).css({width:t,height:r,position:"absolute",top:jquery("#"+self.containerName)[0].offsetTop,left:jquery("#"+UcId+"_"+self.query).offset().left,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":999})}jquery("#"+self.containerName).append(e)}else{var r=Math.min(jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").find(".pivot_filter_div")[0].clientHeight+jquery("#"+UcId+"_"+self.query).closest(".conteiner_table_div")[0].clientHeight,jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].clientHeight);var t=Math.min(jquery("#"+UcId+"_"+self.query)[0].clientWidth,jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].clientWidth);if(jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").find(".pivot_pag_div").length>0){r=r+jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").find(".pivot_pag_div")[0].clientHeight}jquery(e).css({width:t,height:r,position:"absolute",top:jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].offsetTop,left:jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol")[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99});jquery("#"+UcId+"_"+self.query).closest(".gx_usercontrol").append(e)}jquery(".oat_winrect_container").block({message:null})}catch(e){}};this.EneablePivot=function(){jquery(".disable_popup").remove();while(jquery(".disable_popup").length>0){jquery(".disable_popup").remove()}jquery(".oat_winrect_container").unblock()};this.addExpandCollapseFunctionality=function(e,r,t,i,a){{var s=OAT.Dom.create("div",{});if(i){s.className+=" expanded";OAT.addImageNode(s,"remove","")}else{s.className+=" collapsed";OAT.addImageNode(s,"add","")}e.insertBefore(s,e.firstChild);e.style.paddingLeft="0px";var n=jquery(e).find("#span_txt_pivot")[0];if(a){self.setExpandCollapseEventHandlers(s,r.value,"DIMENSION",self.rowConditions[t],r);if(self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemDoubleClick==undefined&&self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemClick==undefined&&!self.selection.Allow){self.setExpandCollapseEventHandlers(n,r.value,"DIMENSION",self.rowConditions[t],r);jquery(n).css({cursor:"pointer"})}}else{self.setExpandCollapseEventHandlers(s,r.value,"DIMENSION",self.colConditions[t],r);if(self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemDoubleClick==undefined&&self.QueryViewerCollection[self.IdForQueryViewerCollection].ItemClick==undefined&&!self.selection.Allow){self.setExpandCollapseEventHandlers(n,r.value,"DIMENSION",self.colConditions[t],r);jquery(n).css({cursor:"pointer"})}}}return e};this.setClickEventHandlers=function(e,r,t,i,a){if(!self.ShowMeasuresAsRows||self.h<500){var s=jquery(e).find("#span_txt_pivot")[0];if(s){jquery(s).data("itemValue",r);jquery(s).data("typeMorD",t);jquery(s).data("numberMorD",i);jquery(s).data("itemInfo",a);jquery(e).data("itemValue",r);jquery(e).data("typeMorD",t);jquery(e).data("numberMorD",i);jquery(e).data("itemInfo",a);var n=self.QueryViewerCollection[IdForQueryViewerCollection];var f=t=="DIMENSION"?n.Metadata.Axes[i].RaiseItemClick:n.Metadata.Data[i].RaiseItemClick;if(n.ItemClick&&f){s.onclick=function(){self.onClickEventHandle(this);if(self.selection.Allow){self.onClickSelectNode(this)}};s.classList.add("gx-qv-clickable-element")}else if(self.selection.Allow){s.onclick=function(){self.onClickSelectNode(this)}}}}};this.setExpandCollapseEventHandlers=function(e,r,t,i,a){if(!self.ShowMeasuresAsRows||self.h<500){jquery(e).data("itemValue",r);jquery(e).data("numberMorD",i);jquery(e).data("itemInfoEC",a);e.onclick=function(){self.onClickExpandCollapse(this)}}};this.getPerFilterValue=function(e,r){var t=false;for(var i=0;i<e.length;i++){if(e[i]!=null){t=true}}if(!t)return false;var a=[];for(var i=0;i<self.GeneralDataRows.length;i++){var s=true;for(var n=0;n<e.length;n++){if(e[n]!=null){if(self.GeneralDataRows[i][self.filterIndexes[n]]!=e[n]){s=false}}}if(s){a.push(self.GeneralDataRows[i][self.filterIndexes[r]])}}return a};this.drawTitleDiv=function(){if(self.PivotTitle){OAT.Dom.clear(self.TitleDiv);var e=navigator.userAgent.toLowerCase();e.indexOf("android")>-1;if(OAT.isIE()||OAT.isAndroid()){self.TitleDiv.className+=" pivot_title_div"}else{self.TitleDiv.classList.add("pivot_title_div")}OAT.addTextNode(self.TitleDiv,self.PivotTitle)}};this.drawFilters=function(){var e=[];var r=self.filterDiv;var t=OAT.Dom.create("div");var i=OAT.Dom.create("span");var a=navigator.userAgent.toLowerCase();a.indexOf("android")>-1;if(OAT.isIE()||OAT.isAndroid()){self.filterDiv.className+=" pivot_filter_div"}else{self.filterDiv.classList.add("pivot_filter_div")}if(!self.isSD&&self.filterIndexes.length==0){t.href="#";t.setAttribute("class","filterInfoUser");i.setAttribute("class","spanHoverLabel");i.setAttribute("id","filterSpanInfo");OAT.addImageNode(t,"info","");OAT.addTextNode(i,self.translations.GXPL_QViewerInfoUser)}for(var s=0;s<r.selects.length;s++){e.push([r.selects[s].filterIndex,r.selects[s].selectedIndex,r.selects[s].value])}OAT.Dom.clear(r);self.gd.addTarget(r);r.selects=[];if(!self.filterIndexes.length){var n=self.translations.GXPL_QViewerJSDropFiltersHere;if(self.isSD){n=""}if(n[n.length-1]==='"'||n[n.length-1]==="'"||n[n.length-1]==="]"||n[n.length-1]==="}"||n[n.length-1]==="`"){n=n.substring(0,n.length-1)}if(n!=""){var f=document.createElement("span");f.textContent=n;r.appendChild(f)}}var l=function(){var e=this;var r=self.conditions[this.filterIndex].distinctValues;for(var t=0;t<r.length;t++){var i=r[t];if(self.conditions[this.filterIndex].filteredShowValues.indexOf(i)==-1){self.conditions[this.filterIndex].filteredShowValues.push(i);if(i!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(i,this.filterIndex),i,e)}catch(r){OAT.Dom.option(i,i,e)}}else{OAT.Dom.option(" ",i,e)}}}self.lastRequestValue=this.filterIndex;var a=this.filterIndex;if(self.conditions[a].previousPage<self.conditions[a].totalPages){self.lastRequestAttributeValues="DrawFilters";self.lastRequestAttributeColumnNumber=a;self.requestAttributeValues(self.columns[this.filterIndex].getAttribute("dataField"),1,0,"")}};var o=function(){self.stateChanged=true;self.DiseablePivot();self.conditions[this.filterIndex].topFilterValue=this.value;self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[this.filterIndex].dataField,{op:"pagefilter",values:this.value,dim:this.filterIndex},"","");self.EneablePivot();return};var u=[];var c=[];for(var s=0;s<self.filterIndexes.length;s++){if(c.indexOf(self.filterIndexes[s])<0){c.push(self.filterIndexes[s]);var v=self.filterIndexes[s];var d=OAT.Dom.create("select");d.setAttribute("id","page_select_"+s);OAT.Dom.option(self.translations.GXPL_QViewerJSAllOption,"[all]",d);var h;h=[];if(self.GeneralDistinctValues.length>0){for(var p=0;p<self.GeneralDistinctValues[v].length;p++){var m=self.GeneralDistinctValues[v][p];if(!h){if(m!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(m,v),m,d)}catch(e){OAT.Dom.option(m,m,d)}}else{OAT.Dom.option(" ",m,d)}}else{if(h.indexOf(m)!=-1){if(m!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(m,v),m,d)}catch(e){OAT.Dom.option(m,m,d)}}else{OAT.Dom.option(" ",m,d)}}}}try{var T=0;for(var p=0;p<self.GeneralDistinctValues[v].length;p++){var m=self.GeneralDistinctValues[v][p];if(self.conditions[v].topFilterValue===m){d.selectedIndex=T+1}if(!h){T++}else{if(h.indexOf(m)!=-1){T++}}}}catch(e){}}self.conditions[v].filteredShowValues=[];var h=self.conditions[v].distinctValues;for(var p=0;p<h.length;p++){var m=h[p];if(self.conditions[v].filteredShowValues.indexOf(m)==-1){self.conditions[v].filteredShowValues.push(m);if(m!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(m,v),m,d)}catch(e){OAT.Dom.option(m,m,d)}}else{OAT.Dom.option(" ",m,d)}}}if(self.conditions[v].topFilterValue!="[all]"){var m=self.conditions[v].topFilterValue;var A=-1;for(var y=0;y<self.conditions[v].filteredShowValues.length;y++){if(String(self.conditions[v].filteredShowValues[y]).trim()==String(m).trim()){A=y}}if(A>-1){d.selectedIndex=A+1}else{self.conditions[v].filteredShowValues.push(m);if(m!="#NuN#"){try{OAT.Dom.option(self.dimensionPictureValue(m,v),m,d)}catch(e){OAT.Dom.option(m,m,d)}}else{OAT.Dom.option(" ",m,d)}d.selectedIndex=1}}d.filterIndex=v;for(var p=0;p<e.length;p++){if(e[p][0]==v){for(var w=0;w<d.length;w++){if(d[w].value==e[p][2]){d.selectedIndex=w}}}}if(d.selectedIndex>0){u[s]=d.value}else{u[s]=null}OAT.Dom.attach(d,"click",l);OAT.Dom.attach(d,"change",o);r.selects.push(d);var O=OAT.Dom.create("div");O.setAttribute("class","inner_filter_div");OAT.addTextNode(O,self.headerRow[v]);var g=document.createElement("div");g.setAttribute("class","close_span_filter");OAT.addImageNode(g,"close","");g.style.cursor="pointer";var _=self.getDelFilterReference(v);OAT.Dom.attach(g,"click",_);OAT.Dom.append([self.filterDiv,O],[O,d,g])}}var b=OAT.Dom.create("div");b.href="#";if(self.isSD){b.setAttribute("class","exportOptionsAnchor exportOptionsAnchor_small")}else{b.setAttribute("class","exportOptionsAnchor")}OAT.addImageNode(b,"menu","");self.filterIcon=OAT.Dom.create("div",{});self.exportPage=OAT.Dom.create("div",{});var x=function(e){var r=OAT.Event.source(e);var t=false;var i=false;for(var a=0;a<jquery(".oat_winrect_container").length;a++){var s=jquery(".oat_winrect_container")[a];if(!(r==s)&&!OAT.Dom.isChild(r,s)){t=true}else{t=false;break}}for(var a=0;a<jquery(".oat_winrect_container").length;a++){if(jquery(".oat_winrect_container")[a].style.display!="none"){i=true}}if((r.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(r,s))&&i){self.resetAllScrollValue(self.UcId)}if(t){jquery(".oat_winrect_container").css({display:"none"})}};var S=function(e){source=OAT.Event.source(e);var r=false;var t=false;for(var i=0;i<jquery(".oat_winrect_container").length;i++){var a=jquery(".oat_winrect_container")[i];if(!(source==a)&&!OAT.Dom.isChild(source,a)){r=true}else{r=false;break}}for(var i=0;i<jquery(".oat_winrect_container").length;i++){if(jquery(".oat_winrect_container")[i].style.display!="none"){t=true}}if((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,a))&&t){self.resetAllScrollValue(self.UcId)}if(r){jquery(".oat_winrect_container").css({display:"none"})}};OAT.Dom.attach(document,"mousedown",x);OAT.Dom.attach(document,"onmouseout",S);OAT.Anchor.assign(b,{title:" ",content:self.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:self.IdForQueryViewerCollection+"-pivottable"+" ExportPopup "});var I=function(e){var r=OAT.Event.position(e);self.exportPage.style.left=r[0]+"px";self.exportPage.style.top=r[1]+"px";self.exportPage.id="exportOptionsContainer";Math.max(jquery(".ExportPopup")[0].clientWidth,300);jquery(e.currentTarget).offset().left;var t=e.currentTarget;jquery(".oat_winrect_title").find(".winrect_title_label").remove();var i=OAT.Dom.create("label");if(self.isSD){jquery(".oat_winrect_container").addClass("oat_winrect_container_small");i.setAttribute("class","winrect_title_label winrect_title_label_small")}else{i.setAttribute("class","winrect_title_label")}OAT.addTextNode(i,self.translations.GXPL_QViewerPopupTitle);jquery(".oat_winrect_title").append(i);jquery(".ExportPopup").css({left:-2500+"px",top:0+"px"});OAT.Dom.clear(self.exportPage);var a=document.createElement("div");a.setAttribute("class","upper_container");jquery("#divtoxml").remove();jquery("#divtoxls").remove();jquery("#divtoxlsx").remove();jquery("#divtoexport").remove();jquery("#divtohtml").remove();var s=false;self.appendExportToXmlOption(a,s);self.appendExportToHtmlOption(a,s);self.appendExportToPdfOption(a,s);self.appendExportToExcelOption(a,s);self.appendExportToExcel2010Option(a,s);self.exportPage.appendChild(a);if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXML||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToHTML||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToPDF||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLS||self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLSX){var n=OAT.Dom.create("hr",{});self.exportPage.appendChild(n)}var f=document.createElement("div");f.setAttribute("class","down_container");self.exportPage.appendChild(f);var l=document.createElement("span");l.textContent=self.translations.GXPL_QViewerJSVisibleColumns;var o=document.createElement("div");o.setAttribute("class","div_label_win");o.appendChild(l);f.appendChild(o);var u=function(e,r){if(r&&self.initMetadata.Dimensions[e].validPosition==""){return false}if(!r&&self.initMetadata.Measures[e].validPosition=="hidden"){return false}var t;var i;if(r){t=self.initMetadata.Dimensions[e].dataField;i=self.initMetadata.Dimensions[e].displayName}else{t=self.initMetadata.Measures[e].dataField;i=self.initMetadata.Measures[e].displayName}var a=self.headerRow.indexOf(i)!=-1;var s=OAT.Dom.create("div");var n=a?"check_item_img":"uncheck_item_img";if(self.isSD){n=a?"check_item_img_small":"uncheck_item_img_small"}OAT.addImageNode(s,a?"check_box":"check_box_outline_blank","");s.setAttribute("class",n);s.setAttribute("dataField",i);s.setAttribute("isDimension",r);s.setAttribute("index",e);var f=OAT.Dom.create("span");if(r){OAT.addTextNode(f," "+self.initMetadata.Dimensions[e].displayName)}else{OAT.addTextNode(f," "+self.initMetadata.Measures[e].displayName)}var l=self.formulaInfo.itemPosition[t]==undefined||self.formulaInfo.cantFormulaMeasures==0;if(r){l=l&&self.initMetadata.Dimensions[e].validPosition!="hidden"}else{l=l&&self.initMetadata.Measures[e].validPosition!="hidden"}if(l){s.appendChild(f);OAT.Event.attach(s,"click",(function(){var e=s.getAttribute("isDimension")=="true";s.getAttribute("dataField");var r=parseInt(s.getAttribute("index"));var t="check_item_img";var i="uncheck_item_img";if(self.isSD){t="check_item_img_small";i="uncheck_item_img_small"}var a=this.getAttribute("class")===t?i:t;this.setAttribute("class",a);jquery(this).find("i")[0].textContent=this.getAttribute("class")===t?"check_box":"check_box_outline_blank";if(e){self.initMetadata.Dimensions[r].Visible=!self.initMetadata.Dimensions[r].Visible;self.preGoWhenShowHideDimension(r)}else{self.initMetadata.Measures[r].Visible=!self.initMetadata.Measures[r].Visible;self.preGoWhenShowHideMeasures(r)}}))}return s};var c=self.autoNumber?1:0;for(var v=c;v<self.initMetadata.Dimensions.length;v++){var d=u(v,true);if(d)f.appendChild(d)}for(var v=c;v<self.initMetadata.Measures.length;v++){var d=u(v,false);if(d)f.appendChild(d)}setTimeout((function(){var e=window.innerWidth;var r=jquery(".ExportPopup")[0].clientWidth;if(r==0){var i=jquery(".ExportPopup").length;r=jquery(".ExportPopup")[i-1].clientWidth}if(self.isSD){if(r<240){r=240}var a=(e-r)/2+jquery(window).scrollLeft();jquery(".ExportPopup").css({left:a+"px",top:jquery(t).offset().top+"px",width:r+"px"})}else{var s=jquery(t).offset().left;if(s+r+15<e){jquery(".ExportPopup").css({left:jquery(t).offset().left+"px",top:jquery(t).offset().top+"px"})}else{jquery(".ExportPopup").css({left:s-r+16+"px",top:jquery(t).offset().top+"px"})}}}),50)};OAT.Event.attach(b,"click",I);self.filterDiv.appendChild(b);t.appendChild(i);self.filterDiv.appendChild(t)};this.appendExportToXmlOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXML){t=OAT.Dom.create("div");exportXMLButtonSub=self.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,self.translations.GXPL_QViewerContextMenuExportXml);i.htmlFor="pivot_checkbox_restoreview";i.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(i);var a=document.createElement("span");t.appendChild(a);OAT.Dom.attach(exportXMLButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","XML","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.ExportToXMLWhenServerPagination=function(){self.lastRequestPivotDataCalculation="";self.lastRequestCalculation="ExportToXML";self.requestCalculatePivottableData()};this.ExportToHTMLWhenServerPagination=function(){var e=OAT.resourceURL(self.relativePath+"QueryViewer/oatPivot/css/pivot.css");var r="<!DOCTYPE><HTML><BODY>";r=r+"<HEAD>";r=r+'<META content="text/html; charset=utf-8" http-equiv="Content-Type"/>';r=r+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+e+'" />';for(var t=0;t<jquery("link").length;t++){if(jquery("link")[t].href.indexOf("QueryViewer.css")<0){r=r+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+jquery("link")[t].href+'" />'}}r=r+'</HEAD><DIV style="margin-bottom: 5px;">';r=r+'<div class="gx_usercontrol qv-pivottable QueryViewer-pivottable">';r=r+'<table class="pivot_table" style="width: 100%;">';r=r+OAT.removeIconFont(jquery("#"+self.controlName+"_"+self.query)[0].innerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,""));r=r+"</table>";r=r+"</div>";r=r+"</DIV></BODY></HTML>";if(OAT.isSafari()||self.isSD){window.open("data:text/html,"+r)}else{var i=new Blob([r],{type:"text/html"});if(self.query!=""){saveAs(i,self.query+".html")}else{var a="Query";try{a=self.controlName.substr(4).split("_")[0]}catch(e){}saveAs(i,a+".html")}}};this.appendExportToHtmlOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToHTML){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,self.translations.GXPL_QViewerContextMenuExportHtml);i.htmlFor="pivot_checkbox_restoreview";i.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(i);OAT.Dom.attach(exportButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","HTML","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.appendExportToPdfOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToPDF){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,self.translations.GXPL_QViewerContextMenuExportPdf);i.htmlFor="pivot_checkbox_restoreview";i.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(i);var a=self.query;if(a==""){a="Query";try{a=self.controlName.split("_")[0]}catch(e){}}OAT.Dom.attach(exportButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","PDF","","",true)}));e.appendChild(t)}};this.appendExportToExcelOption=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLS){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,self.translations.GXPL_QViewerContextMenuExportXls2003);i.htmlFor="pivot_checkbox_restoreview";i.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(i);var a=self.query;if(a==""){a="Query";try{a=self.controlName.split("_")[0]}catch(e){}}OAT.Dom.attach(exportButtonSub,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","XLS","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.ExportToXLSXWhenServerPagination=function(){self.lastRequestCalculation="ExportToXLSX";self.requestCalculatePivottableData()};this.appendExportToExcel2010Option=function(e,r){var t;if(self.QueryViewerCollection[IdForQueryViewerCollection].ExportToXLSX&&(self.allData.length>0||self.serverPagination)){var t=OAT.Dom.create("div");exportButtonSub=self.createExportButton(t);var i=OAT.Dom.create("label");OAT.addTextNode(i,self.translations.GXPL_QViewerContextMenuExportXlsx);i.htmlFor="pivot_checkbox_restoreview";i.setAttribute("class","pivot_checkbox_restoreview");t.appendChild(i);var a=self.query;if(a==""){a="Query";try{a=self.controlName.split("_")[0]}catch(e){}}OAT.Dom.attach(t,"click",(function(){self.getDataForPivot(self.UcId,1,-1,true,"","","XLSX","","",true)}));if(r){if(!OAT.isIE()){e.appendChild(OAT.Dom.create("br"))}}e.appendChild(t);r=true}};this.createExportButton=function(e){var r=OAT.Dom.create("div",{});r.setAttribute("id","divtoxml");e.appendChild(r);if(self.isSD){r.setAttribute("class","download_file_img_small")}else{r.setAttribute("class","download_file_img")}OAT.addImageNode(r,"download","");e.setAttribute("class","export_item_div");if(self.isSD){e.setAttribute("class","export_item_div export_item_div_small")}return e};this._drawCorner=function(e,r){if(measures.length>0){OAT.addTextNode(e,self.headerRow[self.dataColumnIndex]);e.className="h2titlewhite";this.setTitleTexrtAlign(e,e.textContent)}};this._drawRowConditionsHeadingsCustom=function(e){for(var r=0;r<self.rowConditions.length;r++){var t=self.conditions[self.rowConditions[r]];if(self.isMeasureByName(self.headerRow[self.rowConditions[r]],t.dataField,t.isDimension)){if(!self.ShowMeasuresAsRows){var i=OAT.Dom.create("th",{},"h2titlewhite");var a=OAT.Dom.create("div");OAT.addTextNode(a,self.headerRow[self.rowConditions[r]]);this.setTitleTexrtAlign(a,self.headerRow[self.rowConditions[r]]);i.rowSpan=self.colConditions.length+2}}else{var i=OAT.Dom.create("th",{},"h2title");var s=OAT.Dom.create("div",{position:"relative"});var a=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(a,self.headerRow[self.rowConditions[r]].replace(/ /g,"Â ")+"Â Â Â Â ");if(self.GeneralDataRows.length>0||self.serverPagination){var n=self.getClickReference(t,self.rowConditions[r],a);var f=n[0];var l=n[1];OAT.Dom.attach(i,"click",f);var o=self.getOrderReference(self.rowConditions[r],l,f,a);self.gd.addSource(a,self.process,o);self.gd.addTarget(i)}i.conditionIndex=self.rowConditions[r];if(!self.ShowMeasuresAsRows){i.rowSpan=self.colConditions.length+2}else{i.rowSpan=self.colConditions.length+1}var u=OAT.Dom.create("div",{position:"absolute",right:"-6px",bottom:"0px"});OAT.addImageNode(u,"arrow_drop_down","");var c=OAT.Dom.create("div");c.className="div_settings";OAT.addImageNode(c,"settings","");try{this.updateSortImage(u,t.sort)}catch(e){}OAT.Dom.append([i,s],[s,a],[s,u],[a,c],[e,i])}}if(self.ShowMeasuresAsRows){var v=80;var i=OAT.Dom.create("th",{},"h2title");var s=OAT.Dom.create("div",{position:"relative",minWidth:v+"px"});var a=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(a,self.translations.GXPL_QViewerJSMeasures+"Â Â Â ");OAT.Dom.append([i,s],[s,a],[e,i]);i.rowSpan=self.colConditions.length+1;OAT.Dom.append([i,a],[e,i])}};this.isMeasureByName=function(e,r,t){var i=false;for(var a=0;a<measures.length-1;a++){if(measures[a].attributes.getNamedItem("displayName").nodeValue==e){i=true}}if(r){var i=false;for(var s=0;s<self.pageData.DataInfo.length;s++){if(r==self.pageData.DataInfo[s].DataField)i=true}}return i};this.setTitleTexrtAlign=function(e,r){for(var t=0;t<measures.length;t++){if(measures[t].getAttribute("displayName")===r){if(measures[t].getAttribute("dataType")==="integer"||measures[t].getAttribute("dataType")==="real"){e.style.textAlign="left"}if(measures[t].getAttribute("date")==="integer"){e.style.textAlign="right"}}}};this.updateSortImage=function(e,r){var t="none";switch(r){case 0:t="asc";break;case 1:t="asc";break;case-1:t="desc";break;case 2:t="desc";break}if(OAT.isIE()||OAT.isAndroid()){e.className.replace("sort-none");e.className.replace("sort-asc");e.className.replace("sort-desc")}else{e.classList.remove("sort-none");e.classList.remove("sort-asc");e.classList.remove("sort-desc")}if(OAT.isIE()||OAT.isAndroid()){e.className+=" sort-"+t}else{e.classList.add("sort-"+t)}jquery(e).find("i")[0].textContent=t=="asc"?"arrow_drop_up":"arrow_drop_down"};this._drawRowConditionsHeadings=function(e){var r=OAT.Dom.create("tr");for(var t=0;t<self.rowConditions.length;t++){var i=self.conditions[self.rowConditions[t]];if(self.isMeasureByName(self.headerRow[self.rowConditions[t]],i.dataField,i.isDimension)){if(!self.ShowMeasuresAsRows){var a=OAT.Dom.create("th",{},"h2titlewhite");var s=OAT.Dom.create("div");OAT.addTextNode(s,self.headerRow[self.rowConditions[t]]);self.setTitleTexrtAlign(s,self.headerRow[self.rowConditions[t]]);OAT.Dom.append([a,s],[r,a])}}else{var n=self.headerRow[self.rowConditions[t]].length>8?self.headerRow[self.rowConditions[t]].length*10:80;var a=OAT.Dom.create("th",{},"h2title");var f=OAT.Dom.create("div",{position:"relative",minWidth:n+"px"});var s=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(s,self.headerRow[self.rowConditions[t]]+"Â Â Â ");var l=self.getClickReference(i,self.rowConditions[t],s);var o=l[0];var u=l[1];OAT.Dom.attach(a,"click",o);var c=self.getOrderReference(self.rowConditions[t],u,o,s);self.gd.addSource(s,self.process,c);self.gd.addTarget(a);a.conditionIndex=self.rowConditions[t];var v=OAT.Dom.create("div",{position:"absolute",right:"-6px",bottom:"0px"});OAT.addImageNode(v,"arrow_drop_down","");var d=OAT.Dom.create("div");d.className="div_settings";OAT.addImageNode(d,"settings","");if(i!=undefined){this.updateSortImage(v,i.sort)}else{this.updateSortImage(v,0)}OAT.Dom.append([a,f],[f,s],[f,v],[s,d],[r,a])}}if(self.ShowMeasuresAsRows){var n=80;var a=OAT.Dom.create("th",{},"h2title");var f=OAT.Dom.create("div",{position:"relative",minWidth:n+"px"});var s=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(s,self.translations.GXPL_QViewerJSMeasures+"Â Â Â ");OAT.Dom.append([a,f],[f,s],[r,a]);var a=OAT.Dom.create("th",{},"h2titlewhite");var s=OAT.Dom.create("div");OAT.addTextNode(s,self.translations.GXPL_QViewerJSValue);a.style.textAlign="end";OAT.Dom.append([a,s],[r,a])}var a=OAT.Dom.create("th");if(!self.colConditions.length){self._drawCorner(a,true);a.conditionIndex=-1}else{a.style.border="none"}if(self.colStructure.span!=null){a.colSpan=self.colStructure.span+(self.options.headingBefore?1:0)+(self.options.totals?1:0)}else{a.colSpan=(self.options.headingBefore?1:0)+(self.options.totals?1:0)}if(measures.length>0&&!self.ShowMeasuresAsRows){r.appendChild(a)}if(self.colConditions.length){var a=OAT.Dom.create("th",{border:"none",width:"0px;"});r.appendChild(a)}self.appendRowToTable(e,r,true);if(measures.length>0&&r.cells[1]!=undefined&&r.cells[1].textContent==""){var h=document.getElementById(self.controlName+"_"+self.query+"_toolbar");if(h.rows[0])h.rows[0].appendChild(r.cells[0])}};this._drawColConditionsHeadingsCustom=function(e,r,t){var i=self.conditions[self.colConditions[r]];var a=OAT.Dom.create("th",{cursor:"pointer"},"h2title");var s=self.headerRow[self.colConditions[r]].length>8?(self.headerRow[self.colConditions[r]].length+3)*10:80;var n=OAT.Dom.create("div",{position:"relative",minWidth:s+"px"});if(t){a.style.borderRightColor="transparent"}var f=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(f,self.headerRow[self.colConditions[r]].replace(/ /g,"Â ")+"Â Â Â ");if(self.GeneralDataRows.length>0||self.serverPagination){var l=self.getClickReference(i,self.colConditions[r],f);var o=l[0];var u=l[1];OAT.Dom.attach(a,"click",o);var c=self.getOrderReference(self.colConditions[r],u,o,f);self.gd.addSource(f,self.process,c);self.gd.addTarget(a)}var v=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});OAT.addImageNode(v,"arrow_drop_down","");var d=OAT.Dom.create("div");d.className="div_settings";OAT.addImageNode(d,"settings","");try{this.updateSortImage(v,i.sort)}catch(e){}n.appendChild(f);f.appendChild(d);n.appendChild(v);a.conditionIndex=self.colConditions[r];a.appendChild(n);e.appendChild(a);return e};this._drawColConditionsHeadings=function(e,r){var t=self.conditions[self.colConditions[r]];var i=OAT.Dom.create("th",{cursor:"pointer"},"even gx-pv-even-row");var a=OAT.Dom.create("div");OAT.addTextNode(a,self.headerRow[self.colConditions[r]]);var s=self.getClickReference(t,self.colConditions[r],a);var n=s[0];var f=s[1];OAT.Dom.attach(i,"click",n);var l=self.getOrderReference(self.colConditions[r],f,n,a);self.gd.addSource(a,self.process,l);self.gd.addTarget(i);i.conditionIndex=self.colConditions[r];i.appendChild(a);i.hidden=true;if(i.textContent==self.headerRow[self.colConditions[r]]){var o=document.getElementById(self.controlName+"_"+self.query+"_toolbar");i.hidden=false;if(o.rows[0])o.rows[0].appendChild(i)}};this.getClassName=function(e,r){return"even gx-pv-even-row"};this.setStyleValues=function(e,r){function t(e){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(r,(function(e,r,t,i){return r+r+t+t+i+i}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}var i=r.split(";");for(var a=0;a<i.length;a++){var s=i[a].split(":");var n=s[0].replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ");var f=s[1].replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ");switch(n){case"color":if(f[0]!=undefined&&f[0]==="#"){e.style.color="rgb("+t(f).r+","+t(f).g+","+t(f).b+")"}else{e.style.color=f}break;case"fontStyle":e.style.fontStyle=f;break;case"backgroundColor":e.style.backgroundColor=f;break;case"textDecoration":e.style.textDecoration=f;break;case"fontWeight":e.style.fontWeight=f;break;case"fontFamily":e.style.fontFamily=f;break;case"fontVariant":e.style.fontVariant=f;break;case"fontSize":e.style.fontSize=f.replace("px","")+"px";break;case"textAlign":e.style.textAlign=f;break;case"lineHeight":e.style.lineHeight=f;break;case"textIndent":e.style.textIndent=f;break;case"verticalAlign":e.style.verticalAlign=f;break;case"wordSpacing":e.style.wordSpacing=f;break;case"display":e.style.display=f;break;case"borderThickness":e.style.borderThickness=f;e.style.borderWidth=f+"px";break;case"borderColor":e.style.borderColor=f;break;case"borderWith":e.style.borderWith=f;break;case"borderStyle":e.style.borderStyle=f;break;case"padding":e.style.padding=f;break;case"paddingBottom":e.style.paddingBottom=f;break;case"paddingLeft":e.style.paddingLeft=f;break;case"paddingRight":e.style.paddingRight=f;break;case"paddingTop":e.style.paddingTop=f;break}}return e};this.underRecursionStyle=[];this.applyFormatValues=function(e,r,t){var i=self.columns[t].getAttribute("dataType");if(i=="date"){r=self.dimensionPictureValue(r,t)}var a=self.columns[t].getAttribute("format");if(a!=null&&a!=""){e=self.setStyleValues(e,a)}self.underRecursionStyle=[];for(var s=0;s<self.formatValues.length;s++){if(self.formatValues[s].columnNumber==t){if(self.formatValues[s].value===r.trimpivot()){e=self.setStyleValues(e,self.formatValues[s].format);if(self.formatValues[s].recursive!=undefined&&self.formatValues[s].recursive=="yes"){self.underRecursionStyle.push(self.formatValues[s])}}}}var n=self.columns[t].getAttribute("dataType");var f=[];var l=[];var o=[];var u=[];var c=[];var v=[];var u=[];var d=[];for(var s=0;s<self.conditionalFormatsColumns.length;s++){if(self.conditionalFormatsColumns[s].columnNumber==t){if(self.conditionalFormatsColumns[s].operation1=="equal"){if(n==="real"||n==="integer"){f[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{f[0]=self.conditionalFormatsColumns[s].value1}f[1]=self.conditionalFormatsColumns[s].format}if(self.conditionalFormatsColumns[s].operation1=="notequal"){if(n==="real"||n==="integer"){l[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{l[0]=self.conditionalFormatsColumns[s].value1}l[1]=self.conditionalFormatsColumns[s].format}if(self.conditionalFormatsColumns[s].operation1=="less"){if(n==="real"||n==="integer"){c[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{c[0]=self.conditionalFormatsColumns[s].value1}c[1]=self.conditionalFormatsColumns[s].format}if(self.conditionalFormatsColumns[s].operation1=="greater"){if(n==="real"||n==="integer"){o[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{o[0]=self.conditionalFormatsColumns[s].value1}o[1]=self.conditionalFormatsColumns[s].format}if(self.conditionalFormatsColumns[s].operation1=="greaterequal"&&self.conditionalFormatsColumns[s].operation2==undefined){if(n==="real"||n==="integer"){u[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{u[0]=self.conditionalFormatsColumns[s].value1}o[1]=self.conditionalFormatsColumns[s].format}if(self.conditionalFormatsColumns[s].operation1=="lessequal"){if(n==="real"||n==="integer"){v[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{v[0]=self.conditionalFormatsColumns[s].value1}c[1]=self.conditionalFormatsColumns[s].format}if(self.conditionalFormatsColumns[s].operation2&&self.conditionalFormatsColumns[s].operation1=="greaterequal"){if(n==="real"||n==="integer"){d[0]=parseFloat(self.conditionalFormatsColumns[s].value1)}else{d[0]=self.conditionalFormatsColumns[s].value1}if(self.conditionalFormatsColumns[s].operation2&&self.conditionalFormatsColumns[s].operation2=="lessequal"){if(n==="real"||n==="integer"){d[1]=parseFloat(self.conditionalFormatsColumns[s].value2)}else{d[1]=self.conditionalFormatsColumns[s].value2}d[2]=self.conditionalFormatsColumns[s].format}}}}new Array(3);e.style.textAlign="start";if(n==="real"){e.style.textAlign="start";r=parseFloat(r)}if(n==="integer"){e.style.textAlign="right";r=parseInt(r)}if(n==="real"){e.style.textAlign="end"}if(n!="date"){if(f[0]!=undefined&&r==f[0]){e=self.setStyleValues(e,f[1])}if(l[0]!=undefined&&r!=l[0]){e=self.setStyleValues(e,l[1])}if(o[0]!=undefined&&r>o[0]||u[0]!=undefined&&r>=u[0]){e=self.setStyleValues(e,o[1])}if(c[0]!=undefined&&r<c[0]||v[0]!=undefined&&r<=v[0]){e=self.setStyleValues(e,c[1])}if(d[0]!=undefined&&d[1]!=undefined&&(r>=d[0]&&r<=d[1])){e=self.setStyleValues(e,d[2])}return e}if(n==="date"){e.style.textAlign="right";var h=r.split("-");if(self.defaultPicture.getAttribute("dateFormat")!=undefined&&self.defaultPicture.getAttribute("dateFormat")!=null){picture=self.defaultPicture.getAttribute("dateFormat").split("")}var p=new Array(3);p[0]=parseInt(h[0]);p[1]=parseInt(h[1]);p[2]=parseInt(h[2]);if(o[0]!=undefined){var m=o[0].split("-");var T=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);if(T[0]<p[0]||T[0]<=p[0]&&T[1]<p[1]||T[0]<=p[0]&&T[1]<=p[1]&&T[2]<p[2]){e=self.setStyleValues(e,o[1])}}if(c[0]!=undefined){var m=c[0].split("-");T=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);if(T[0]>p[0]||T[0]>=p[0]&&T[1]>p[1]||T[0]>=p[0]&&T[1]>=p[1]&&T[2]>p[2]){e=self.setStyleValues(e,c[1])}}if(d[0]!=undefined&&d[1]!=undefined){var m=d[0].split("-");var A=d[1].split("-");T=new Array(3);cmparElements2=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);cmparElements2[1]=parseInt(A[1]);cmparElements2[2]=parseInt(A[2]);cmparElements2[0]=parseInt(A[0]);if((T[0]<=p[0]||T[0]<=p[0]&&T[1]<p[1]||T[0]<=p[0]&&T[1]<=p[1]&&T[2]<p[2])&&(cmparElements2[0]>p[0]||cmparElements2[0]>=p[0]&&cmparElements2[1]>p[1]||cmparElements2[0]>=p[0]&&cmparElements2[1]>=p[1]&&cmparElements2[2]>p[2])){e=self.setStyleValues(e,d[2])}}}if(r>o[0]){e=self.setStyleValues(e,o[1])}else{if(r<c[0]){e=self.setStyleValues(e,c[1])}else{if(r>=d[0]&&r<=d[1]){e=self.setStyleValues(e,d[2])}}}return e};this.applyConditionalFormats=function(e,r,t,i){if(measures.length>0){var a;var s;if(t){i=measures.length-1;s=measures[measures.length-1].getAttribute("dataType");a=measures[measures.length-1].getAttribute("format")}else{s=measures[i].getAttribute("dataType");a=measures[i].getAttribute("format")}if(a!=null&&a!=""){e=self.setStyleValues(e,a)}for(var n=0;n<self.formatValuesMeasures.length;n++){if(self.formatValuesMeasures[n].columnNumber==i){if(self.formatValuesMeasures[n].value===r){e=self.setStyleValues(e,self.formatValuesMeasures[n].format)}}}if(self.underRecursionStyle){for(var n=0;n<self.underRecursionStyle.length;n++){e=self.setStyleValues(e,self.underRecursionStyle[n].format)}}var f=[];var l=[];var o=[];var u=[];var c=[];var v=[];var u=[];var d=[];for(var n=0;n<self.conditionalFormats.length;n++){if(self.conditionalFormats[n].columnNumber==i){if(self.conditionalFormats[n].operation1=="equal"){if(s==="real"||s==="integer"){f[0]=parseFloat(self.conditionalFormats[n].value1)}else{f[0]=self.conditionalFormats[n].value1}f[1]=self.conditionalFormats[n].format}if(self.conditionalFormats[n].operation1=="notequal"){if(s==="real"||s==="integer"){l[0]=parseFloat(self.conditionalFormats[n].value1)}else{l[0]=self.conditionalFormats[n].value1}l[1]=self.conditionalFormats[n].format}if(self.conditionalFormats[n].operation1=="less"){if(s==="real"||s==="integer"){c[0]=parseFloat(self.conditionalFormats[n].value1)}else{c[0]=self.conditionalFormats[n].value1}c[1]=self.conditionalFormats[n].format}if(self.conditionalFormats[n].operation1=="lessequal"&&!self.conditionalFormats[n].operation2){if(s==="real"||s==="integer"){v[0]=parseFloat(self.conditionalFormats[n].value1)}else{v[0]=self.conditionalFormats[n].value1}c[1]=self.conditionalFormats[n].format}if(self.conditionalFormats[n].operation1=="greater"){if(s==="real"||s==="integer"){o[0]=parseFloat(self.conditionalFormats[n].value1)}else{o[0]=self.conditionalFormats[n].value1}o[1]=self.conditionalFormats[n].format}if(self.conditionalFormats[n].operation1=="greaterequal"&&!self.conditionalFormats[n].operation2){if(s==="real"||s==="integer"){u[0]=parseFloat(self.conditionalFormats[n].value1)}else{u[0]=self.conditionalFormats[n].value1}o[1]=self.conditionalFormats[n].format}if(self.conditionalFormats[n].operation2&&self.conditionalFormats[n].operation1=="greaterequal"){if(s==="real"||s==="integer"){d[0]=parseFloat(self.conditionalFormats[n].value1)}else{d[0]=self.conditionalFormats[n].value1}if(self.conditionalFormats[n].operation2&&self.conditionalFormats[n].operation2=="lessequal"){if(s==="real"||s==="integer"){d[1]=parseFloat(self.conditionalFormats[n].value2)}else{d[1]=self.conditionalFormats[n].value2}d[2]=self.conditionalFormats[n].format}}}}if(s!="date"){if(f[0]!=undefined&&r==f[0]){e=self.setStyleValues(e,f[1])}if(l[0]!=undefined&&r!=l[0]){e=self.setStyleValues(e,l[1])}if(o[0]!=undefined&&r>o[0]||u[0]!=undefined&&r>=u[0]){e=self.setStyleValues(e,o[1])}if(c[0]!=undefined&&r<c[0]||v[0]!=undefined&&r<=v[0]){e=self.setStyleValues(e,c[1])}if(d[0]!=undefined&&d[1]!=undefined&&(r>=d[0]&&r<=d[1])){e=self.setStyleValues(e,d[2])}}if(s==="date"){var h=r.split("-");if(self.defaultPicture.getAttribute("dateFormat")!=undefined&&self.defaultPicture.getAttribute("dateFormat")!=null){picture=self.defaultPicture.getAttribute("dateFormat").split("")}var p=new Array(3);p[0]=parseInt(h[0]);p[1]=parseInt(h[1]);p[2]=parseInt(h[2]);try{if(f[0]!=undefined||u[0]!=undefined||v[0]!=undefined){var m;if(f[0]!=undefined){m=f[0].split("-")}else if(u[0]!=undefined){m=u[0].split("-")}else if(u[0]!=undefined){m=v[0].split("-")}var T=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);if(T[0]==p[0]||T[0]==p[0]&&T[1]==p[1]){if(f[1]!=undefined)e=self.setStyleValues(e,f[1]);else if(o[1]!=undefined)e=self.setStyleValues(e,o[1]);else if(c[1]!=undefined)e=self.setStyleValues(e,c[1])}}if(l[0]!=undefined){var m=l[0].split("-");var T=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);if(T[0]!=p[0]||T[0]!=p[0]&&T[1]!=p[1]){e=self.setStyleValues(e,l[1])}}if(o[0]!=undefined||u[0]!=undefined){var m;if(o[0].split("-")!=undefined){m=o[0].split("-")}else{m=u[0].split("-")}var T=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);if(T[0]<p[0]||T[0]<=p[0]&&T[1]<p[1]||T[0]<=p[0]&&T[1]<=p[1]&&T[2]<p[2]){e=self.setStyleValues(e,o[1])}}if(c[0]!=undefined||v[0]!=undefined){var m;if(c[0].split("-")!=undefined){m=c[0].split("-")}else{m=v[0].split("-")}T=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);if(T[0]>p[0]||T[0]>=p[0]&&T[1]>p[1]||T[0]>=p[0]&&T[1]>=p[1]&&T[2]>p[2]){e=self.setStyleValues(e,c[1])}}if(d[0]!=undefined&&d[1]!=undefined){var m=d[0].split("-");var A=d[1].split("-");T=new Array(3);cmparElements2=new Array(3);T[1]=parseInt(m[1]);T[2]=parseInt(m[2]);T[0]=parseInt(m[0]);cmparElements2[1]=parseInt(A[1]);cmparElements2[2]=parseInt(A[2]);cmparElements2[0]=parseInt(A[0]);if((T[0]<=p[0]||T[0]<=p[0]&&T[1]<p[1]||T[0]<=p[0]&&T[1]<=p[1]&&T[2]<p[2])&&(cmparElements2[0]>p[0]||cmparElements2[0]>=p[0]&&cmparElements2[1]>p[1]||cmparElements2[0]>=p[0]&&cmparElements2[1]>=p[1]&&cmparElements2[2]>p[2])){e=self.setStyleValues(e,d[2])}}}catch(e){}}}return e};this.dimensionPictureValue=function(e,r){if(e=="#NuN#"){var t=self.defaultPicture.getAttribute("textForNullValues");if(t!=undefined){return t}return""}var i;var a;i=self.columns[r].getAttribute("dataType");a=self.columns[r].getAttribute("picture");var s=OAT.ApplyPictureValue(e,i,self.defaultPicture,a);return s};this.getMeasureNumber=function(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("dataField")==e){return t}}};this.getMeasureName=function(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("dataField")==e){return r[t].getAttribute("displayName")}}};this.defaultPictureValue=function(e,r,t){if(e=="#NuN#"){var i=self.defaultPicture.getAttribute("textForNullValues");if(i!=undefined){return i}return""}if(e=="#NaV#"||isNaN(e)){return"-"}var a;var s;if(measures.length>0){if(r){a=measures[measures.length-1].getAttribute("dataType");s=measures[measures.length-1].getAttribute("picture")}else{a=measures[t].getAttribute("dataType");s=measures[t].getAttribute("picture")}var n=OAT.ApplyPictureValue(e,a,self.defaultPicture,s);return n}else{return e}};this.countedRows=0;this.appendRowToTable=function(e,r,t){if(pageSize&&!self.serverPagination){if(!t){self.countedRows++}if(self.countedRows>pageSize){r.style.display="none"}}if(self.serverPagination&&self.ExportTo){if(!t){self.countedRows++}if(self.countedRows>self.rowsPerPage){r.style.display="none"}}if(t){r.setAttribute("title_row",true)}e.appendChild(r)};this.drawTableWhenServerPagination=function(){OAT.Dom.clear(self.div);self.div.setAttribute("class","conteiner_table_div");var e=OAT.Dom.create("table",{},"");e.id=self.controlName+"_"+self.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");self.div.appendChild(e);var r=OAT.Dom.create("table",{},"pivot_table");r.id=this.controlName+"_"+this.query;var t=OAT.Dom.create("tbody");self.drawTitleDiv();self.drawFilters();self.countedRows=0;if(OAT.isIE()){var i=document.createElement("div");i.setAttribute("class","divIeContainer");self.div.appendChild(i);OAT.Dom.append([r,t],[i,r]);r.style.marginBottom="0px"}else{OAT.Dom.append([r,t],[self.div,r])}self.countedRows=0;var a;if(self.colConditions.length>0){var s=0;var n=OAT.Dom.create("tr");self._drawRowConditionsHeadingsCustom(n);for(var f=0;f<self.colConditions.length;f++){n=self._drawColConditionsHeadingsCustom(n,f,f===self.colConditions.length-1)}self.appendRowToTable(t,n,true);a=n}try{for(var s=0;s<self.colConditions.length;s++){var n=OAT.Dom.create("tr");var l=0;while(l<self.pageData.columnsHeaders.length){var o;if(!self.pageData.columnsHeaders[l].subTotal){o=l;var u=1;var c=self.pageData.columnsHeaders[l].subHeaders.length>s?self.pageData.columnsHeaders[l].subHeaders[s].value:"";while(l+1<self.pageData.columnsHeaders.length&&(!self.pageData.columnsHeaders[l+1].subTotal||s<self.pageData.columnsHeaders[l+1].subHeaders.length-1)&&(self.pageData.columnsHeaders[l+1].subHeaders.length>s&&self.pageData.columnsHeaders[l+1].subHeaders[s].value==c)){u++;l++}l++;var v=OAT.Dom.create("th",{},"even gx-pv-even-row");v.colSpan=u;OAT.addTextNode(v,self.dimensionPictureValue(c.trimpivot(),self.colConditions[s]));self.setClickEventHandlers(v,c,"DIMENSION",self.colConditions[s],{axis:"columns",columnnumber:o,columndimension:self.pageData.columnsHeaders[o],rownumber:s});v=self.applyFormatValues(v,c.trimpivot(),self.colConditions[s]);n.appendChild(v)}else{var d=self.GrandTotalVisibility.TotalForColumns=="No"?measures.length:0;var h=l>=self.pageData.columnsHeaders.length-measures.length+d;if(self.ShowMeasuresAsRows){h=l>=self.pageData.columnsHeaders.length-1&&self.GrandTotalVisibility.TotalForColumns=="Yes"}if(h){if(self.GrandTotalVisibility.TotalForColumns=="Yes"){if(s==0){var v=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(v,self.translations.GXPL_QViewerJSTotal);v.rowSpan=self.colConditions.length;if(!self.ShowMeasuresAsRows){v.colSpan=measures.length}n.appendChild(v)}}if(!self.ShowMeasuresAsRows){l=l+measures.length}else{l++}}else{if(s<self.pageData.columnsHeaders[l].subHeaders.length){var v=OAT.Dom.create("th",{},"h2subtitle ");var c=self.pageData.columnsHeaders[l].subHeaders.length>s?self.pageData.columnsHeaders[l].subHeaders[s].value:"";OAT.addTextNode(v,self.translations.GXPL_QViewerJSTotalFor+" "+self.dimensionPictureValue(c.trimpivot(),self.colConditions[s]));self.setClickEventHandlers(v,self.translations.GXPL_QViewerJSTotalFor+" "+self.dimensionPictureValue(c.trimpivot(),self.colConditions[s]),"DIMENSION",self.colConditions[s],["PtrTotals",c,"",o,"columns",s]);v.rowSpan=self.colConditions.length-s;if(!self.ShowMeasuresAsRows){v.colSpan=measures.length}n.appendChild(v)}if(!self.ShowMeasuresAsRows){l=l+measures.length}else{l++}}}}self.appendRowToTable(t,n,true)}if(self.colConditions.length>0){if(self.pageData.columnsHeaders.length-self.colConditions.length>0){var v=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(v,"");v.colSpan=self.pageData.columnsHeaders.length-self.colConditions.length;v.style.borderLeftColor="transparent";a.appendChild(v)}if(!self.ShowMeasuresAsRows){var n=OAT.Dom.create("tr");var p=self.pageData.columnsHeaders.length/measures.length;for(var l=0;l<p;l++){for(var m=0;m<measures.length;m++){var v=OAT.Dom.create("th",{},"h2titlewhite");v.colSpan=1;OAT.addTextNode(v,measures[m].attributes.getNamedItem("displayName").nodeValue);self.setTitleTexrtAlign(v,v.textContent);n.appendChild(v)}}self.appendRowToTable(t,n,true)}}if(self.rowConditions.length&&self.options.headingBefore&&self.colConditions.length===0){self._drawRowConditionsHeadings(t)}else if(self.rowConditions.length==0&&self.options.headingBefore&&self.colConditions.length===0){try{self._drawRowConditionsHeadings(t)}catch(e){}}var T=measures.length>1;var u;if(T){u=self.rowConditions.length-(measures.length-1)}else{u=self.rowConditions.length}if(self.colConditions.length>0)self.underRecursionStyle=[];var A=false;for(var s=0;s<self.pageData.rows.length;s++){var n=OAT.Dom.create("tr");var y=self.pageData.rows[s];for(var l=0;l<y.headers.length;l++){var w=y.headers[l];if(w.rowSpan>0){var v=OAT.Dom.create("th",{},"even gx-pv-even-row");v.rowSpan=w.rowSpan;OAT.addTextNode(v,self.dimensionPictureValue(w.value.trimpivot(),self.rowConditions[l]));v=self.applyFormatValues(v,w.value,self.rowConditions[l]);self.setClickEventHandlers(v,w.value,"DIMENSION",self.rowConditions[l],{cell:l,row:y});if(l<self.rowConditions.length-(measures.length-1)-1&&!self.ShowMeasuresAsRows){var O=self.conditions[self.rowConditions[l]].collapsedValues.indexOf(w.value)!=-1;v=self.addExpandCollapseFunctionality(v,w,l,!O,true)}n.appendChild(v)}}if(y.headers.length<self.rowConditions.length-(measures.length-1)){var g=self.rowConditions.length-(measures.length-1)-y.headers.length;for(var _=0;_<g;_++){var v=OAT.Dom.create("th",{},"even gx-pv-even-row");OAT.addTextNode(v,"");n.appendChild(v)}}if(self.ShowMeasuresAsRows){var b=OAT.Dom.create("td",{},"even gx-pv-even-row");var x=self.getMeasureName(y.dataField,measures);OAT.addTextNode(b,x);b.style.textAlign="start";self.setClickEventHandlers(b,x,"MEASURE",getMeasureNumberByName(x,measures),"GrandTotal");n.appendChild(b)}new Array;if(!y.subTotal){for(var S=0;S<y.cells.length;S++){var I=y.cells[S].value;if(self.colConditions.length>0&&self.pageData.columnsHeaders[S].subTotal){var b=OAT.Dom.create("td",{},"subtotal");if(I!=self.EmptyValue){var k=self.getMeasureNumber(y.cells[S].dataField,measures);OAT.addTextNode(b,self.defaultPictureValue(I,false,k));b=self.applyConditionalFormats(b,I,false,k);self.setClickEventHandlers(b,I,"MEASURE",k,["PtrTotals",I,y,S])}else{OAT.addTextNode(b,"")}n.appendChild(b)}else{var b=OAT.Dom.create("td",{},"even gx-pv-even-row");if(I!=self.EmptyValue){var k=self.getMeasureNumber(y.cells[S].dataField,measures);OAT.addTextNode(b,self.defaultPictureValue(I,false,k));b=self.applyConditionalFormats(b,I,false,k);self.setClickEventHandlers(b,I,"MEASURE",k,{cell:S,row:y})}else{OAT.addTextNode(b,"")}n.appendChild(b)}}}else{var n=OAT.Dom.create("tr");if(y.headers.length==0){if(self.GrandTotalVisibility.TotalForRows!="Yes"){A=true}else{var v=OAT.Dom.create("th",{},"h2subtitle grandtotaltitle");OAT.addTextNode(v,self.translations.GXPL_QViewerJSTotal);v.colSpan=u;if(self.ShowMeasuresAsRows){if(y.rowSpan>0){v.rowSpan=y.rowSpan;n.appendChild(v)}}else{n.appendChild(v)}}}else{if(s==0){for(var o=0;o<y.headers.length-1;o++){var w=y.headers[o];var v=OAT.Dom.create("th",{},"even gx-pv-even-row");v.rowSpan=w.rowSpan;OAT.addTextNode(v,self.dimensionPictureValue(w.value.trimpivot(),self.rowConditions[o]));v=self.applyFormatValues(v,w.value,self.rowConditions[o]);self.setClickEventHandlers(v,w.value,"DIMENSION",self.rowConditions[o],{cell:o,row:y,isTotal:false});n.appendChild(v)}}var q=y.headers.length==1?"subtitleFirstLevel":"";var v=OAT.Dom.create("th",{},"h2subtitle "+q);v.colSpan=u-(y.headers.length-1);var I=y.headers[y.headers.length-1].value.trimpivot();if(I=="#NuN#"){OAT.addTextNode(v,self.translations.GXPL_QViewerJSTotalFor+" "+self.defaultPicture.getAttribute("textForNullValues"))}else{OAT.addTextNode(v,self.translations.GXPL_QViewerJSTotalFor+" "+self.dimensionPictureValue(OAT.Dom.fromSafeXML(I),self.rowConditions[y.headers.length-1]))}self.setClickEventHandlers(v,self.translations.GXPL_QViewerJSTotalFor+" "+w.value,"DIMENSION",getMeasureNumberByDataField(w.dataField,columns),["PtrTotals",I,y,-1]);if(self.ShowMeasuresAsRows){if(y.rowSpan>0){v.rowSpan=y.rowSpan;n.appendChild(v)}}else{n.appendChild(v)}}if(self.ShowMeasuresAsRows){var F=y.headers.length==0?"grandtotalvalue":y.headers.length==1?"firstlevelvalue":"";var b=OAT.Dom.create("td",{},"gtotal "+F);var x=self.getMeasureName(y.dataField,measures);OAT.addTextNode(b,x);b.style.textAlign="start";n.appendChild(b)}for(var P=0;P<y.cells.length;P++){var I=y.cells[P].value;var k=self.getMeasureNumber(y.cells[P].dataField,measures);var F=y.headers.length==0?"grandtotalvalue":y.headers.length==1?"firstlevelvalue":"";var b=OAT.Dom.create("td",{},"gtotal "+F);OAT.addTextNode(b,self.defaultPictureValue(I,false,k));if(y.headers.length==0&&self.colConditions.length==0){self.underRecursionStyle=[];b=self.applyConditionalFormats(b,I,false,k);self.setClickEventHandlers(b,I,"MEASURE",k,"GrandTotal")}else{b=self.applyConditionalFormats(b,I,false,k);self.setClickEventHandlers(b,I,"MEASURE",k,["PtrTotals",I,y,P])}n.appendChild(b)}}if(!A)self.appendRowToTable(t,n,false);if(self.colConditions.length>0)self.underRecursionStyle=[]}}catch(e){}};this.drawTableWhenShowMeasuresAsRows=function(){OAT.Dom.clear(self.div);self.div.setAttribute("class","conteiner_table_div");var e=OAT.Dom.create("table",{},"");e.id=self.controlName+"_"+self.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");self.div.appendChild(e);var r=OAT.Dom.create("table",{},"pivot_table");r.id=this.controlName+"_"+this.query;var t=OAT.Dom.create("tbody");self.drawTitleDiv();self.drawFilters();self.countedRows=0;if(OAT.isIE()){var i=document.createElement("div");i.setAttribute("class","divIeContainer");self.div.appendChild(i);OAT.Dom.append([r,t],[i,r]);r.style.marginBottom="0px"}else{OAT.Dom.append([r,t],[self.div,r])}if(self.autoPaging&&self.allData.length<self.filteredData.length&&self.colPointers.length>1){self.allData=self.filteredData}else if(self.autoPaging&&self.filteredData.length>self.allData.length&&self.colPointers.length===0){self.filteredData=self.allData}var a;var s=self.colConditions.length;if(self.colConditions.length>0){var n=0;var f=OAT.Dom.create("tr");self._drawRowConditionsHeadingsCustom(f);for(var l=0;l<self.colConditions.length;l++){f=self._drawColConditionsHeadingsCustom(f,l,l===self.colConditions.length-1)}f.setAttribute("title_row",true);self.appendRowToTable(t,f,true);a=f}try{var o=0-s;var u=[false,0,0];var c=[];var v=[];var d=[];for(var n=0;n<measures.length;n++){d[n]=false}for(var n=0;n<self.colConditions.length;n++){var f=OAT.Dom.create("tr");var h=self.colPointers[n];for(var p=0;p<h.length;p++){var m=h[p];var T=OAT.Dom.create("th",{},"even gx-pv-even-row");if(m.span===0)m.span=1;T.colSpan=m.span;if(n==0){if(m.span===0){o++}else{o=o+m.span*measures.length}}OAT.addTextNode(T,self.dimensionPictureValue(m.value,self.colConditions[n]));T=self.applyFormatValues(T,m.value,self.colConditions[n]);var A=m;var y=false;var w=false;while(A.parent){if(A.parent.collapsed==undefined){u[0]=false;break}if(A.parent.collapsed){if(!u[0]||A.parent!=u[1]){w=true;if(n==self.colConditions.length-1){v.push(p)}}else{u[2]++}if(n==self.colConditions.length-1&&!w){c.push(p)}u[0]=true;u[1]=A.parent;OAT.addTextNode(T,"");y=true;T.colSpan=1;break}else{A=A.parent}}if(!y||w){f.appendChild(T)}}if(self.options.totals&&n==0&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var T=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(T,self.translations.GXPL_QViewerJSTotal);T.rowSpan=self.colConditions.length;if(self.colConditions.length>0){T.colSpan=measures.length;o=o+self.colConditions.length+(measures.length-1)}else{o=o+self.colConditions.length}totalSpan=self.colConditions.length;f.appendChild(T)}if(self.options.headingAfter){self._drawColConditionsHeadings(f,n)}f.setAttribute("title_row",true);self.appendRowToTable(t,f,true)}if(o>2){var T=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(T,"");if(o<1e3){T.colSpan=o}T.style.borderLeftColor="transparent";a.appendChild(T)}if(self.rowConditions.length&&self.options.headingBefore&&self.colConditions.length===0){self._drawRowConditionsHeadings(t)}var O=measures.length>1;var g;if(O){g=self.rowConditions.length-(measures.length-1)}else{g=self.rowConditions.length}var _=[false,9999,true,0];var b=[];for(var x=0;x<measures.length;x++){b[x]=[];b[x][0]=[]}var S=[];for(var x=0;x<measures.length;x++){S[x]=[];S[x][0]=[]}var I=[];for(var x=0;x<self.recordForFormula.length;x++){I[x]=self.recordForFormula[x]}var k=[];if(self.colConditions.length>0){k=[];for(var x=0;x<self.allData.length;x++){k[x]=self.allData[x]}}var q=[];for(var n=0;n<self.h;n++){var f=OAT.Dom.create("tr");if(self.rowConditions.length){var F=self.rowConditions.length-(measures.length-1);var m=self.rowPointers[F][n];var P=[];var N=m;while(N.parent){P.unshift(N);N=N.parent}}else{var P=[self.rowPointers[0][0]]}for(var p=0;p<self.rowConditions.length-(measures.length-1);p++){var m=P[p];if(m!=undefined&&m.offset==n){var D=self.conditions[self.rowConditions[p]].collapsedValues.indexOf(m.value)!=-1;if(p>=self.rowConditions.length-(measures.length-1)-1){D=false}var T=OAT.Dom.create("th",{},"even gx-pv-even-row");if(!_[0]||_[1]>=p){T.rowSpan=P[p].span;OAT.addTextNode(T,self.dimensionPictureValue(m.value,self.rowConditions[p]));T=self.applyFormatValues(T,m.value,self.rowConditions[p]);self.setClickEventHandlers(T,m.value,"DIMENSION",self.rowConditions[p],m)}else{T.rowSpan=1;OAT.addTextNode(T,"")}if(_[1]>=p){_[0]=D;_[3]=m;if(D){_[1]=p}else{_[1]=9999}_[2]=true}f.appendChild(T)}}var E=measures.length;if(E===0){E=1}var C=OAT.Dom.create("td",{},"even gx-pv-even-row");var m=P[self.rowConditions.length-(E-1)];if(m.value!=self.EmptyValue){if(!_[0]){OAT.addTextNode(C,m.value);C.style.textAlign="start";self.setClickEventHandlers(C,m.value,"MEASURE",getMeasureNumberByName(M,measures),"GrandTotal")}}else{OAT.addTextNode(C,"")}f.appendChild(C);var j=new Array;var R=[];var M=m.value;var J=getMeasureNumberByName(M,measures);if(self.colConditions.length==0){var L=m.items[0];var C=OAT.Dom.create("td",{},"even gx-pv-even-row");if(L!=self.EmptyValue){if(!_[0]){OAT.addTextNode(C,self.defaultPictureValue(L.value,false,J));C=self.applyConditionalFormats(C,L.value,false,J);self.setClickEventHandlers(C,L.value,"MEASURE",J,[Math.floor(m.row/measures.length)]);if(self.formulaInfo.measureFormula[J].hasFormula){var V=self.getFormulaRowByCoord(m,[],J,"MeasureInRows",I);if(V!=self.EmptyValue){S[J][0].push(V);b[J][0].push([V,-1])}}else{var B=L.value!="#NuN#"?parseFloat(L.value):"#NuN#";S[J][0].push(B);b[J][0].push([B,-1])}}}else{OAT.addTextNode(C,"")}if(_[0]&&!d[ji]){d[ji]=C}j.push([[L.value,[L.row]]]);if(self.colConditions.length===0){f.appendChild(C)}}else{var U=self.colPointers.length-1;if(self.colPointers[self.colPointers.length-1].length==0)U--;if(self.colPointers[U]!=undefined){if(J==0){if(q.length>0&&!isNaN(q[0])){k.splice(q[0],1)}q=[]}for(var p=0;p<self.colPointers[U].length;p++){var z=self.colPointers[U][p];var H=m;var Z;if(J>0){try{if(q[p]!=self.EmptyValue){Z=[k[q[p]][self.headerRow.indexOf(M)],q[p]]}else{Z=self.EmptyValue}}catch(e){}}else{Z=self.getMeasureValueCoord(H,z,self.headerRow.indexOf(M),k);if(Z!=self.EmptyValue&&J==0){q.push(Z[1])}else if(J==0){q.push(self.EmptyValue)}}var C=OAT.Dom.create("td",{},"even gx-pv-even-row");if(Z!=self.EmptyValue){OAT.addTextNode(C,self.defaultPictureValue(Z[0],false,J));C=self.applyConditionalFormats(C,Z[0],false,J);self.setClickEventHandlers(C,Z[0],"MEASURE",J,[Z[1]]);var G=parseFloat(Z[0]);if(Z[0]=="#NuN#"){G="#NuN#"}if(self.formulaInfo.measureFormula[J].hasFormula){G=self.getFormulaRowByCoord(H,z,J,"MeasureInRows",I);if(G==self.EmptyValue){G=NaN}}if(S[J][p]==undefined){S[J][p]=[G]}else{S[J][p].push(G)}if(b[J][p]==undefined){b[J][p]=[[G,-1]]}else{b[J][p].push([G,-1])}R.push(G)}else{OAT.addTextNode(C,"");if(S[J][p]==undefined){S[J][p]=[0]}else{S[J][p].push(0)}if(b[J][p]==undefined){b[J][p]=[[NaN,-1]]}else{b[J][p].push([NaN,-1])}}f.appendChild(C)}}}if(self.colConditions.length&&n==0&&self.options.headingAfter){var T=OAT.Dom.create("th");if(!self.rowConditions.length){self._drawCorner(T,true);T.conditionIndex=-2}else{T.style.border="none"}T.rowSpan=self.rowStructure.span+(self.options.totals&&self.rowConditions.length?1:0);f.appendChild(T)}if(_[0]&&!_[2]);else{self.appendRowToTable(t,f,false);_[2]=false}if(self.options.totals&&self.colConditions.length&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var C=OAT.Dom.create("td",{},"total");ae=0;if(R.length>0){if(self.formulaInfo.measureFormula[getMeasureNumberByName(M,measures)].hasFormula){ae=self.calculateFormulaTotal(R,getMeasureNumberByName(M,measures),"MeasureInRows")}else{ae=R.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}));if(isNaN(ae)&&ae!="#NuN#"&&ae!="#FoE#")ae=0}}if(ae!=0){OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,getMeasureNumberByName(M,measures)));C=self.applyConditionalFormats(C,ae.toString(),false,getMeasureNumberByName(M,measures))}else{OAT.addTextNode(C,"")}f.appendChild(C)}R=[];if(self.options.totals){if(self.rowConditions.length-(measures.length-1)>1){var X=self.rowConditions.length-(measures.length-1)-2;for(var $=X;$>=0;$--){var Q=false;if(n+1<self.rowPointers[F].length){var Y=self.rowPointers[F][n+1];var W=[];var K=Y;while(K.parent){W.unshift(K);K=K.parent}for(var ee=$;ee>=0;ee--){if(W[ee].value!=P[ee].value){Q=true}}}else{Q=true}Q=Q&&self.conditions[self.rowConditions[$]].subtotals==1;if(Q){for(var re=0;re<measures.length;re++){var f=OAT.Dom.create("tr");if(re==0){var T=OAT.Dom.create("th",{},"h2subtitle");T.colSpan=self.rowConditions.length-(measures.length-1)-$;T.rowSpan=measures.length;OAT.addTextNode(T,self.translations.GXPL_QViewerJSTotalFor+" "+P[$].value);f.appendChild(T)}var C=OAT.Dom.create("td",{},"total");var Z=measures[re].getAttribute("displayName");OAT.addTextNode(C,Z);C.style.textAlign="start";self.setClickEventHandlers(C,Z,"MEASURE",re,"GrandTotal");f.appendChild(C);if(self.colConditions.length==0){var C=OAT.Dom.create("td",{},"total");var te=[];for(var ie=0;ie<b[re][0].length;ie++){if(b[re][0][ie][1]==-1||b[re][0][ie][1]>$){if(!isNaN(b[re][0][ie][0])||b[re][0][ie][0]=="#NuN#"||self.formulaInfo.measureFormula[re].hasFormula){te.push(b[re][0][ie][0]);b[re][0][ie][1]=$}}}var ae=0;if(te.length!=0){if(self.formulaInfo.measureFormula[re].hasFormula){ae=self.calculateFormulaTotal(te,re,"MeasureInRows")}else{if(self.IsReduceNuN(te))ae="#NuN#";else ae=te.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}));if(isNaN(ae)&&ae!="#NuN#"&&ae!="#FoE#")ae=0}}R.push(parseFloat(ae));if(ae!=0){OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,re));C=self.applyConditionalFormats(C,ae.toString(),false,re)}else{OAT.addTextNode(C,"")}f.appendChild(C)}else{var U=self.colPointers.length-1;if(self.colPointers[self.colPointers.length-1].length==0)U--;if(self.colPointers[U]!=undefined){for(var se=0;se<self.colPointers[U].length;se++){var C=OAT.Dom.create("td",{},"total");var te=[];for(var ie=0;ie<b[re][se].length;ie++){if(b[re][se][ie][1]==-1||b[re][se][ie][1]>$){if(!isNaN(b[re][se][ie][0])||b[re][se][ie][0]=="#NuN#"||self.formulaInfo.measureFormula[re].hasFormula){te.push(b[re][se][ie][0]);b[re][se][ie][1]=$}}}var ae=0;if(te.length!=0){if(self.formulaInfo.measureFormula[re].hasFormula){ae=self.calculateFormulaTotal(te,re,"MeasureInRows")}else{if(self.IsReduceNuN(te))ae="#NuN#";else ae=te.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}));if(isNaN(ae)&&ae!="#NuN#"&&ae!="#FoE#")ae=0}}if(ae!=0&&(!isNaN(ae)||ae=="#NuN#"||ae=="#FoE#")){if(self.formulaInfo.measureFormula[re].hasFormula){R.push(te)}else{R.push(parseFloat(ae))}OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,re));C=self.applyConditionalFormats(C,ae.toString(),false,re)}else{OAT.addTextNode(C,"")}f.appendChild(C)}}if(self.colConditions.length&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var C=OAT.Dom.create("td",{},"gtotal");var ae=0;if(R.length!=0){if(self.formulaInfo.measureFormula[re].hasFormula){ae=self.calculateFormulaTotal(R,re,"MeasureInRows")}else{if(self.IsReduceNuN(R))ae="#NuN#";else ae=R.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,re));C=self.applyConditionalFormats(C,ae.toString(),false,re);f.appendChild(C);R=[]}}self.appendRowToTable(t,f,false)}}}}}}if(measures.length>0&&self.rowConditions.length-measures.length+1>0&&self.GrandTotalVisibility.TotalForRows=="Yes"){if(self.options.totals&&self.rowConditions.length&&(!self.autoPaging||self.TotalPagesPaging==self.actualPaginationPage||self.FilterByTopFilter)){for(var ne=0;ne<measures.length;ne++){var f=OAT.Dom.create("tr");if(g!=0&&ne==0){var T=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(T,self.translations.GXPL_QViewerJSTotal);T.colSpan=g;T.rowSpan=measures.length;f.appendChild(T)}var C=OAT.Dom.create("td",{},"gtotal");var Z=measures[ne].getAttribute("displayName");if(Z!=self.EmptyValue){OAT.addTextNode(C,Z);C.style.textAlign="start";self.setClickEventHandlers(C,Z,"MEASURE",ne,"GrandTotal")}else{OAT.addTextNode(C,"")}f.appendChild(C);var R=[];if(self.colConditions.length==0){var C=OAT.Dom.create("td",{},"gtotal");var ae=0;if(S[ne][0].length>0){if(self.formulaInfo.measureFormula[ne].hasFormula){ae=self.calculateFormulaTotal(S[ne][0],ne,"MeasureInRows")}else{if(self.IsReduceNuN(S[ne][0]))ae="#NuN#";else ae=S[ne][0].reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}if(!isNaN(ae)||ae=="#NuN#"||ae=="#FoE#"){OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,ne));C=self.applyConditionalFormats(C,ae.toString(),false,ne)}else{OAT.addTextNode(C,"")}f.appendChild(C)}else{var U=self.colPointers.length-1;if(self.colPointers[self.colPointers.length-1].length==0)U--;if(self.colPointers[U]!=undefined){for(var p=0;p<self.colPointers[U].length;p++){var C=OAT.Dom.create("td",{},"gtotal");var ae=0;if(S[ne][p]!=undefined&&S[ne][p].length>0){if(self.formulaInfo.measureFormula[ne].hasFormula){ae=self.calculateFormulaTotal(S[ne][p],ne,"MeasureInRows")}else{if(self.IsReduceNuN(S[ne][p]))ae="#NuN#";else ae=S[ne][p].reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}if(!isNaN(ae)||ae=="#NuN#"||ae=="#FoE#"){OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,ne));C=self.applyConditionalFormats(C,ae.toString(),false,ne)}else{OAT.addTextNode(C,"")}f.appendChild(C);if(self.formulaInfo.measureFormula[ne].hasFormula){R.push(S[ne][p])}else{if(!isNaN(ae)){R.push(parseFloat(ae))}}}}}if(self.options.totals&&self.colConditions.length&&self.GrandTotalVisibility.TotalForColumns=="Yes"){var C=OAT.Dom.create("td",{},"gtotal");var ae=0;if(R.length!=0){if(self.formulaInfo.measureFormula[ne].hasFormula){ae=self.calculateFormulaTotal(R,ne,"MeasureInRows")}else{if(self.IsReduceNuN(R))ae="#NuN#";else ae=R.reduce((function(e,r){if(!isNaN(e)&&!isNaN(r)){return e+r}if(isNaN(e)&&isNaN(r)){return 0}else if(isNaN(e)){return r}else{return e}}))}}OAT.addTextNode(C,self.defaultPictureValue(ae.toString(),false,ne));C=self.applyConditionalFormats(C,ae.toString(),false,ne);f.appendChild(C)}self.appendRowToTable(t,f,false)}}}}catch(e){}};this.IsReduceNuN=function(e){isNuN=false;for(var r=0;r<e.length;r++){if(e[r]!="#NuN#"&&e[r]!=0){return false}if(e[r]=="#NuN#")isNuN=true}return isNuN};this.applyFilters=function(){self.filteredData=[];for(var e=0;e<self.allData.length;e++){if(self.filterOK(self.allData[e])){self.filteredData.push(self.allData[e])}}};this.createTempDataStructForAggStepOptimization=function(){try{for(var e=0;e<self.GeneralDataRows.length;e++){for(var r=0;r<self.GeneralDataRows[0].length;r++){for(var t=0;t<self.GeneralDataRows[0].length;t++){if(self.TempDataStructForAggStepOptimization[self.GeneralDataRows[e][r]]==undefined){self.TempDataStructForAggStepOptimization[self.GeneralDataRows[e][r]]=[]}self.TempDataStructForAggStepOptimization[self.GeneralDataRows[e][r]][self.GeneralDataRows[e][t]]=true}}}}catch(e){}};this.getMeasureValue=function(e,r,t){var i=e;var a=[];var s=[];for(var n=0;n<t.length-measures.length+1;n++){s[n]=t[t.length-measures.length+1-(n+1)]}for(var n=0;n<s.length;n++){a[s[n]]=i.value;i=i.parent}var f="";var l=false;var o=self.allData;if(self.filterIndexes.length>0){o=self.filteredData}for(var n=0;n<o.length;n++){var u=false;for(var c=0;c<s.length;c++){if(o[n][s[c]]==a[s[c]]){u=true}else{u=false;break}}if(u){f=o[n][t.length+self.filterIndexes.length-measures.length+1+r];l=true;break}}if(l)return f;else return self.EmptyValue};this.getMeasureValueCoord=function(e,r,t,i){var a=[];var s=[];for(var n=0;n<self.rowConditions.length-measures.length+1;n++){s[n]=self.rowConditions[self.rowConditions.length-measures.length+1-(n+1)]}for(var n=self.colConditions.length-1;n>=0;n--){a[self.colConditions[n]]=r.value;r=r.parent}var f=e.parent;for(var n=0;n<s.length;n++){a[s[n]]=f.value;f=f.parent}var l="";var o=false;var u=0;var c=i;for(var n=0;n<c.length;n++){var v=false;for(var d=0;d<a.length;d++){if(c[n][d]==a[d]){v=true}else{if(a[d]==undefined&&self.filterIndexes.length>0){v=true}else{v=false;break}}}if(v){l=c[n][t];u=n;o=true;break}}if(o){return[l,u]}else return self.EmptyValue};this.getFormulaRowByCoord=function(e,r,t,i,a){var s=[];var n=[];for(var f=0;f<self.rowConditions.length-measures.length+1;f++){n[f]=self.rowConditions[self.rowConditions.length-measures.length+1-(f+1)]}if(r){for(var f=self.colConditions.length-1;f>=0;f--){s[self.colConditions[f]]=r.value;r=r.parent}}var l=e.parent;for(var f=0;f<n.length;f++){s[n[f]]=l.value;l=l.parent}for(var f=0;f<self.filterIndexes.length;f++){var o=self.filterDiv.selects[f];var u=OAT.$v(o);if(u=="[all]"){s[self.filterIndexes[f]]=undefined}else{s[self.filterIndexes[f]]=u}}var c=false;if(a!=undefined){v=a}else{var v=self.recordForFormula}var d=[];var h=[];for(var p=0;p<self.formulaInfo.recordDataLength;p++){h[p]=0}for(var f=0;f<v.length;f++){var m=false;for(var T=0;T<s.length;T++){if(v[f][T]==s[T]){m=true}else{if(s[T]==undefined&&self.filterIndexes.indexOf(T)!=-1){m=true}else{m=false;break}}}if(m){for(var A=0;A<self.formulaInfo.measureFormula[t].relatedMeasures.length;A++){var y=self.formulaInfo.measureFormula[t].relatedMeasures[A];if(v[f][y]==undefined){if(h[y]==0)h[y]="#NuN#"}else{if(h[y]=="#NuN#")h[y]=0;h[y]=h[y]+parseFloat(v[f][y])}}c=true;d.push(f)}}if(c){if(self.formulaInfo.cantFormulaMeasures==1){for(var w=0;w<d.length;w++){a.splice(d[w],1)}}return h}else return self.EmptyValue};this.calculateFormulaTotal=function(e,r,t){try{var i=[];if(e.length==0)return"#NuN#";for(var a=0;a<e.length;a++){if(e[a]!=self.EmptyValue&&e[a]!=0&&(e[a]!="#NuN#"||self.ShowMeasuresAsRows)){for(var s=0;s<e[a].length;s++){if(i[s]==undefined){i[s]=0}if(!isNaN(e[a][s])&&e[a][s]!="#NuN#"){if(i[s]=="#NuN#")i[s]=0;i[s]=i[s]+e[a][s]}if(e[a][s]=="#NuN#"&&i[s]==0){i[s]="#NuN#"}}}}if(!self.ShowMeasuresAsRows){if(i.length==0)return"#NuN#"}else{if(i.length==0)return NaN}var n=EvaluateExpressionPivotJs(self.formulaInfo.measureFormula[r].PolishNotation,i,self.formulaInfo);if(n==Infinity||isNaN(n)){return"#FoE#"}return n}catch(e){return self.EmptyValue}};this.addToStack=function(e,r,t,i){if(self.GeneralDataRows.length>3e3)return true;if(e<1)return true;if(r.value==undefined)return true;var a=self.conditions[i[e]].dataRowPosition;var s=self.conditions[i[e-1]].dataRowPosition;if(self.allData.length>800&&self.filterIndexes.length>0){return true}for(var n=0;n<self.allData.length;n++){if(self.allData[n][a]==t){if(r.value==self.allData[n][s]){return true}}}if(self.rowConditions.length<8){for(var n=0;n<self.GeneralDataRows.length;n++){if(self.GeneralDataRows[n][a]==t){if(r.value==self.GeneralDataRows[n][s]){return true}}}}return false};this.createAggStructure=function(){function e(e,r,t,i){e.items=false;e.depth=-1;var a=[e];var s=r.length;if(self.ShowMeasuresAsRows&&t){s-=measures.length-1}for(var n=0;n<s;n++){var f=self.conditions[r[n]];var l=self.conditions[r[n]].dataRowPosition;var o=l;var u=f.sort;if(n>=1&&self.rowConditions.length>16&&self.GeneralDataRows.length>1200){f=self.conditions[r[n-1]];l=self.conditions[r[n-1]].dataRowPosition;o=l;u=f.sort}if(u!=0&&u!=2){var c=true;for(var v=0;v<f.distinctValues.length;v++){if(c&&f.distinctValues[v]!=parseInt(f.distinctValues[v])){c=false;break}}if(c){i.sort(function(e){return function(r,t){return u*(parseInt(r[e])===parseInt(t[e])?0:parseInt(r[e])<parseInt(t[e])?-1:1)}}(o))}else{i.sort(function(e){return function(r,t){return u*(r[e]===t[e]?0:r[e]<t[e]?-1:1)}}(o))}}var d=[];var h=f.distinctValues.length;if(n>=1&&self.rowConditions.length>16&&self.GeneralDataRows.length>1200){var p=self.conditions[r[n]].dataRowPosition;var m=[];for(var T=0;T<a.length;T++){var A=[];for(var y=0;y<i.length;y++){x=i[y][p];var w=self.addToStack3(n,a[T],i[y],r,u,c);if(w=="break")break;if(m.indexOf(x)==-1){if(w){m.push(x);var O=false;if(f.collapsedValues.indexOf(x)!=-1)O=true;var g={value:x,parent:a[T],used:false,items:false,depth:n,collapsed:O,conditionNumber:r[n]};A.push(g);d.push(g)}}}m=[];a[T].items=A}}else{for(var T=0;T<a.length;T++){var A=[];var _=[0];for(var b=0;b<h;b++){var x=f.distinctValues[b];if(f.blackList.indexOf(x)==-1){if(self.addToStack2(n,a[T],x,r,i,_,u,c)){var O=false;if(f.collapsedValues.indexOf(x)!=-1)O=true;var g={value:x,parent:a[T],used:false,items:false,depth:n,collapsed:O,conditionNumber:r[n]};A.push(g);d.push(g)}}}a[T].items=A}}a=d}if(self.ShowMeasuresAsRows&&t){var d=[];for(var T=0;T<a.length;T++){var A=[];var h=measures.length;for(var b=0;b<h;b++){var S=measures[b].getAttribute("displayName");var O=false;var g={value:S,parent:a[T],used:false,items:false,depth:s,collapsed:O};var I=false;if(self.colConditions.length==0){var k=self.getMeasureValue(a[T],b,r);if(k==self.EmptyValue){I=true}else{var q={value:k,parent:g,used:false,items:false,depth:s+1,collapsed:O};g.items=[];g.items.push(q)}}if(!I){A.push(g);if(self.colConditions.length==0){d.push(q)}else{d.push(g)}}}a[T].items=A}a=d}}var r=[];for(var t=0;t<self.allData.length;t++){r.push(self.allData[t])}e(self.rowStructure,self.rowConditions,true,r);e(self.colStructure,self.colConditions,false,r)};this.addToStack3=function(e,r,t,i,a,s){if(r.value==undefined)return true;var n=self.conditions[i[e-1]].dataRowPosition;if(r.value==t[n]){var f=r;var l=true;for(var o=1;o<e;o++){var u=self.conditions[i[e-1-o]].dataRowPosition;f=f.parent;if(f.value!=t[u]){l=false;break}}if(l)return true}else{if(a==0||a==2||a==1&&!s&&t[n]<=r.value||a==-1&&!s&&t[n]>=r.value||a==1&&s&&parseInt(t[n])<=parseInt(r.value)||a==-1&&s&&parseInt(t[n])>=parseInt(r.value)){return false}else{return"break"}}};this.addToStack2=function(e,r,t,i,a,s,n,f){if(self.GeneralDataRows.length>3e3)return true;if(e<1)return true;if(r.value==undefined)return true;var l=self.conditions[i[e]].dataRowPosition;var o=self.conditions[i[e-1]].dataRowPosition;if(self.allData.length>1e3&&self.filterIndexes.length>0&&self.rowConditions.length<8){return true}var u=true;for(var c=s[0];c<a.length;c++){if(n==0||n==2||n==1&&!f&&a[c][l]<=t||n==-1&&!f&&a[c][l]>=t||n==1&&f&&parseInt(a[c][l])<=parseInt(t)||n==-1&&f&&parseInt(a[c][l])>=parseInt(t)){if(a[c][l]==t){if(u&&n!=0&&n!=2){s[0]=c;u=false}if(r.value==a[c][o]){var v=r;var d=true;for(var h=1;h<e;h++){var p=self.conditions[i[e-1-h]].dataRowPosition;v=v.parent;if(v.value!=a[c][p]){d=false;break}}if(d)return true}}}else{break}}if(self.GeneralDataRows.length<500&&self.GeneralDataRows.length>self.allData.length){for(var c=0;c<self.GeneralDataRows.length;c++){if(self.GeneralDataRows[c][l]==t){if(r.value==self.GeneralDataRows[c][o]){if(e>1){var p=self.conditions[i[e-2]].dataRowPosition;if(r.parent.value==self.GeneralDataRows[c][p]){return true}}else{return true}}}}}return false};this.fillAggStructure=function(){function e(e,r,t,i){if(!self.ShowMeasuresAsRows){var a=e;for(var s=0;s<r.length;s++){var n=r[s];var f=t[n];var l=false;for(var o=0;o<a.items.length;o++){if(a.items[o].value==f){l=a.items[o];a.items[o].row=i;break}}if(l)a=l}a.used=true}else{var u=t.length-measures.length;t.splice(u,0,"");for(var c=0;c<measures.length;c++){var v=measures[c].getAttribute("displayName");t[u]=v;var a=e;for(var s=0;s<r.length;s++){var n=r[s];var f=t[n];var l=false;for(var o=0;o<a.items.length;o++){if(a.items[o].value==f){l=a.items[o];break}}if(!self.autoPaging){if(l)a=l}else{if(l)a=l}}a.used=true}t.splice(u,1)}}function r(e){var t=e;if(!t.items){t.used=true;return}for(var i=0;i<t.items.length;i++){r(t.items[i])}}if(self.options.showEmpty){r(self.rowStructure);r(self.colStructure)}else{for(var t=0;t<self.filteredData.length;t++){var i=self.filteredData[t];e(self.rowStructure,self.rowConditions,i,t);e(self.colStructure,self.colConditions,i,t)}}};this.checkAggStructure=function(){function e(r){if(!self.ShowMeasuresAsRows){if(!r.items){return r.used}for(var t=r.items.length-1;t>=0;t--){if(!e(r.items[t])){r.items.splice(t,1)}}return r.items.length>0}else{if(self.colConditions>0){var i=r;if(!i.items){return i.used}var a=i.items.length;var s;for(s=a-1;s>-1;s--){if(s>-1){var n=e(i.items[s]);if(n!=undefined&&!n){i.items.splice(s,1)}}}return i.items.length>0}}}e(self.rowStructure);if(!self.ShowMeasuresAsRows){e(self.colStructure)}};this.applyDefaultFormats=function(e,r){var t=typeof r;switch(t){case"number":r=OAT.charReplace(r.toString(),".",gx.decimalPoint);OAT.addTextNode(e,r);break}return e};this.refreshPivot=function(e,r,t){if(e!=""&&r!=""){var i=new DOMParser;var a=i.parseFromString(e,"text/xml");var s=a.getElementsByTagName("OLAPDimension");var n;for(var f=0;f<self.conditions.length;f++){if(self.conditions[f]){var l=jquery.extend(true,[],self.conditions[f].blackList);for(var o=0;o<l.length;o++){self.createFilterInfo({op:"pop",values:l[o],dim:f})}}self.conditions[f].blackList=[]}var u=[];var c=[];for(var v=0;v<s.length;v++){var d=s[v].getElementsByTagName("name")[0].childNodes[0].nodeValue;var h=-1;for(var p=0;p<self.columns.length;p++){if(self.columns[p].attributes.getNamedItem("name").nodeValue===d)h=p}if(h!=-1){var m=s[v].getElementsByTagName("condition")[0].childNodes[0].nodeValue;if(m==="row"){n=self.colConditions.indexOf(h);if(n!=-1){self.colConditions.splice(n,1);if(measures.length>1)self.rowConditions=[h].concat(self.rowConditions);else self.rowConditions.push(h)}else{n=self.filterIndexes.indexOf(h);if(n!=-1){self.filterIndexes.splice(n,1);if(measures.length>1)self.rowConditions=[h].concat(self.rowConditions);else self.rowConditions.push(h)}}u[parseInt(s[v].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=h}else if(m==="col"){n=self.rowConditions.indexOf(h);if(n!=-1){self.rowConditions.splice(n,1);if(measures.length>1)self.colConditions=[h].concat(self.colConditions);else self.colConditions.push(h)}else{n=self.filterIndexes.indexOf(h);if(n!=-1){self.filterIndexes.splice(n,1);if(measures.length>1)self.colConditions=[h].concat(self.colConditions);else self.colConditions.push(h)}}c[parseInt(s[v].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=h}else if(m==="none"){n=self.colConditions.indexOf(h);if(n!=-1){self.colConditions.splice(n,1);if(measures.length>1)self.filterIndexes=[h].concat(self.filterIndexes);else self.filterIndexes.push(h)}else{n=self.rowConditions.indexOf(h);if(n!=-1){self.rowConditions.splice(n,1);if(measures.length>1)self.filterIndexes=[h].concat(self.filterIndexes);else self.filterIndexes.push(h)}}}var T=s[v].getElementsByTagName("order")[0].childNodes[0].nodeValue;if(T=="descending"){self.conditions[h].sort=-1}else{self.conditions[h].sort=1}var A=s[v].getElementsByTagName("hide")[0].childNodes;for(var y=0;y<A.length;y++){if(A[y].tagName==="value"){var n=self.conditions[h].blackList.indexOf(A[y].textContent);if(n===-1){for(var w=0;w<self.conditions[h].distinctValues.length;w++){var O=self.conditions[h].distinctValues[w].toString().trimpivot();if(O==A[y].textContent){self.createFilterInfo({op:"push",values:self.conditions[h].distinctValues[w],dim:h})}}}}}if(s[v].getElementsByTagName("filterdivs").length>0){var g=s[v].getElementsByTagName("filterdivs")[0].childNodes;for(var y=0;y<g.length;y++){if(g[y].tagName==="value"){var _=self.filterIndexes.indexOf(h);if(_!=-1){if(self.filterDiv.selects[_]!=undefined){self.filterDiv.selects[_].value=g[y].textContent}}}}}}}if(self.rowConditions.length-(measures.length-1)==u.length){for(var b=0;b<u.length;b++){self.rowConditions[b]=u[b]}}if(self.colConditions.length==c.length){for(var b=0;b<c.length;b++){self.colConditions[b]=c[b]}}for(var x=0;x<self.columns.length;x++){self.pageData.AxisInfo=self.createAxisInfo(self.columns[x].getAttribute("dataField"))}self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");self.pageData.DataInfo=self.createDataInfo();var S=self.createNewDataInfo();var I=self.createNewAxisInfo();self.lastCallToQueryViewer="refreshPivot";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,I,S,self.pageData.FilterInfo,self.pageData.CollapseInfo,true)}};this.getRowFromDimensionRow=function(e,r){for(var t=0;t<r.length;t++){var i=true;for(var a=0;a<e.length;a++){if(e[a]!=undefined){if(e[a]!=r[t][a]){i=false;break}}}if(i){return r[t]}}return null};this.notInBlackList=function(e,r){var t=false;for(var i=0;i<e.length;i++){if(r[i]!=undefined&&r[i].blackList!=undefined&&r[i].blackList.indexOf(e[i])!=-1){t=true}}return t};this.preGoWhenShowHideMeasures=function(e){var r=self.initMetadata.Measures[e].displayName;self.headerRow.indexOf(r);if(!self.initMetadata.Measures[e].Visible){if(measures.length>1){self.rowConditions.splice(self.rowConditions.length-1,1);self.dataColumnIndex=self.dataColumnIndex-1}}else{var t=measures.length-1;for(var i=0;i<t;i++){self.rowConditions.splice(self.rowConditions.length-1,1)}if(t>=0&&measures[0].getAttribute("dataField")!="F0"){var a=self.rowConditions.length+self.colConditions.length+self.filterIndexes.length;if(measures.length>0){var s=a;a=a+measures.length;for(var n=s;n<a;n++){self.rowConditions.push(n)}}}}for(var n=0;n<self.columns.length;n++){var f=self.columns[n].getAttribute("dataField");var e=self.initMetadata.DataFields.indexOf(f);self.initMetadata.Conditions[e]=self.conditions[n]}this.goWhenHide()};this.preGoWhenShowHideDimension=function(e){for(var r=0;r<self.columns.length;r++){var t=self.columns[r].getAttribute("dataField");var i=self.initMetadata.DataFields.indexOf(t);self.initMetadata.Conditions[i]=self.conditions[r]}var a;var s=self.initMetadata.DataFields[e];for(var r=0;r<self.columns.length;r++){var t=self.columns[r].getAttribute("dataField");if(s==t){a=r}}if(!self.initMetadata.Dimensions[e].Visible){self.initMetadata.DimensionPosition[e]="row";if(self.colConditions.indexOf(a)>-1){self.initMetadata.DimensionPosition[e]="col"}if(self.filterIndexes.indexOf(a)>-1){self.initMetadata.DimensionPosition[e]="fil"}}var n=self.initMetadata.Dimensions[e].displayName;var f=self.headerRow.indexOf(n);if(!self.initMetadata.Dimensions[e].Visible){if(self.rowConditions.indexOf(f)>-1){self.rowConditions.splice(self.rowConditions.indexOf(f),1)}else if(self.colConditions.indexOf(f)>-1){self.colConditions.splice(self.colConditions.indexOf(f),1)}else if(self.filterIndexes.indexOf(f)>-1){self.filterIndexes.splice(self.filterIndexes.indexOf(f),1)}self.dataColumnIndex=self.dataColumnIndex-1;for(var l=0;l<self.rowConditions.length;l++){if(self.rowConditions[l]>f){self.rowConditions[l]=self.rowConditions[l]-1}}for(var l=0;l<self.colConditions.length;l++){if(self.colConditions[l]>f){self.colConditions[l]=self.colConditions[l]-1}}for(var l=0;l<self.filterIndexes.length;l++){if(self.filterIndexes[l]>f){self.filterIndexes[l]=self.filterIndexes[l]-1}}}else{var o=self.initMetadata.DimensionPosition[e];if(o==undefined){var u=self.initMetadata.Dimensions[e].defaultPosition.toLowerCase();if(u.indexOf("rows")>-1)o="row";else if(u.indexOf("columns")>-1)o="col";else if(u.indexOf("filters")>-1||u.indexOf("pages")>-1)o="fil";else o="row"}var c=0;for(var l=0;l<e;l++){if(self.initMetadata.Dimensions[l].Visible)c=c+1}e=c;if(o=="row"){var v=[];var d=self.rowConditions.indexOf(e)>-1;for(var h=0;h<self.rowConditions.length;h++){if(self.rowConditions[h]<e){v.push(self.rowConditions[h])}else if(self.rowConditions[h]==e){v.push(e);v.push(e+1);d=true}else{if(!d){v.push(e);d=true}v.push(self.rowConditions[h]+1)}}if(!d){v.push(e)}self.rowConditions=[];self.rowConditions=v;self.dataColumnIndex=self.dataColumnIndex+1;var p=[];for(var h=0;h<self.colConditions.length;h++){if(self.colConditions[h]>=e){p.push(self.colConditions[h]+1)}else{p.push(self.colConditions[h])}}self.colConditions=[];self.colConditions=p;var m=[];for(var h=0;h<self.filterIndexes.length;h++){if(self.filterIndexes[h]>=e){m.push(self.filterIndexes[h]+1)}else{m.push(self.filterIndexes[h])}}self.filterIndexes=[];self.filterIndexes=m}else if(o=="col"){var v=[];for(var h=0;h<self.rowConditions.length;h++){if(self.rowConditions[h]>=e){v.push(self.rowConditions[h]+1)}else{v.push(self.rowConditions[h])}}self.rowConditions=[];self.rowConditions=v;self.dataColumnIndex=self.dataColumnIndex+1;var p=[];var d=self.colConditions.indexOf(e)>-1;for(var h=0;h<self.colConditions.length;h++){if(self.colConditions[h]<e){p.push(self.colConditions[h])}else if(self.colConditions[h]==e){p.push(e);p.push(e+1);d=true}else{if(!d){p.push(e);d=true}p.push(self.colConditions[h]+1)}}if(!d){p.push(e)}self.colConditions=[];self.colConditions=p;var m=[];for(var h=0;h<self.filterIndexes.length;h++){if(self.filterIndexes[h]>=e){m.push(self.filterIndexes[h]+1)}else{m.push(self.filterIndexes[h])}}self.filterIndexes=[];self.filterIndexes=m}else if(o=="fil"){var v=[];for(var h=0;h<self.rowConditions.length;h++){if(self.rowConditions[h]>=e){v.push(self.rowConditions[h]+1)}else{v.push(self.rowConditions[h])}}self.rowConditions=[];self.rowConditions=v;self.dataColumnIndex=self.dataColumnIndex+1;var p=[];for(var h=0;h<self.colConditions.length;h++){if(self.colConditions[h]>=e){p.push(self.colConditions[h]+1)}else{p.push(self.colConditions[h])}}self.colConditions=[];self.colConditions=p;var m=[];var d=self.filterIndexes.indexOf(e)>-1;for(var h=0;h<self.filterIndexes.length;h++){if(self.filterIndexes[h]<e){m.push(self.filterIndexes[h])}else if(self.filterIndexes[h]==e){m.push(e);m.push(e+1);d=true}else{if(!d){m.push(e);d=true}m.push(self.filterIndexes[h]+1)}}if(!d){m.push(e)}self.filterIndexes=[];self.filterIndexes=m}}self.initRowConditions=[];for(var l=0;l<self.rowConditions.length;l++){self.initRowConditions.push(self.rowConditions[l])}this.goWhenHide()};this.goWhenHide=function(e){var r=[];for(var t=0;t<self.initMetadata.Dimensions.length;t++){if(!self.initMetadata.Dimensions[t].Visible){r.push(self.initMetadata.Dimensions[t].dataField)}}var i=[];for(var t=0;t<self.initMetadata.Measures.length;t++){if(!self.initMetadata.Measures[t].Visible){i.push(self.initMetadata.Measures[t].dataField)}}var a={DataFields:self.initMetadata.DataFields,Dimensions:self.initMetadata.Dimensions,Measures:self.initMetadata.Measures,DimensionPosition:self.initMetadata.DimensionPosition,Conditions:self.initMetadata.Conditions,version:self.rememberLayoutStateVersion};self.saveHiddenState(a);var s=OATParseMetadata(self.initMetadata.Metadata,r,i,self.serverPagination);var n=s[0];self.HideDataFilds=s[2];self.OrderFildsHidden=s[1];var f=jquery.parseXML(n);measures=f.getElementsByTagName("OLAPMeasure");console.log("Imprimo el measures");console.log(measures);self.columns=f.getElementsByTagName("OLAPDimension");var s=OATGetColumnsAndMeasureMeatadata(self.columns,measures,self.formulaInfo,self.OrderFildsHidden);self.headerRow=s[0];self.formulaInfo.measureFormula=s[2];self.conditionalFormats=s[3];self.conditionalFormatsColumns=s[4];if(measures.length>0){self.dataColumnIndex=self.headerRow.length-1}self.conditions=[];for(var t=0;t<self.headerRow.length;t++){self.initCondition(t);if(self.conditions[t]&&self.columns[t]){self.conditions[t].dataField=self.columns[t].getAttribute("dataField");self.conditions[t].state="all";self.conditions[t].defaultAction="Include";self.conditions[t].visibles=[];self.conditions[t].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}self.applyCustomFilters(t)}for(var t=0;t<self.columns.length;t++){var l=self.columns[t].getAttribute("dataField");var o=self.initMetadata.DataFields.indexOf(l);if(self.initMetadata.Conditions[o]!=""){self.initMetadata.Conditions[o].dataRowPosition=self.conditions[t].dataRowPosition;self.conditions[t]=self.initMetadata.Conditions[o]}}self.cleanGridCache();self.pageData.AxisInfo=self.createAxisInfo();var u=self.createNewAxisInfo();self.pageData.DataInfo=self.createDataInfo();var c=self.createNewDataInfo();self.lastCallToQueryViewer="hiddenDimension";self.requestPageDataForPivotTable(1,self.rowsPerPage,true,u,c,self.pageData.FilterInfo,self.pageData.CollapseInfo,true);if(e){self.initValueRead(self,0)}else{for(var t=0;t<self.columns.length;t++){if(self.conditions[t].totalPages==undefined){var v=10;if(self.QueryViewerCollection[self.IdForQueryViewerCollection].AutoRefreshGroup!=""){v=0}var d=t;self.lastRequestAttributeValues="hiddenDimension";self.lastRequestAttributeColumnNumber=d;self.requestAttributeValues(self.columns[d].getAttribute("dataField"),1,v,"")}}}};this.canBeConsiderNoNew=function(e,r,t){if(self.colConditions.length>0){var i=false;for(var a=0;a<r.length;a++){var s=true;for(var n=0;n<self.rowConditions.length;n++){if(r[a][self.rowConditions[n]]!=e[self.rowConditions[n]]){s=false}}if(s==true){i=true;break}}}if(self.filterIndexes.length>0){var i=false;for(var a=0;a<t.length;a++){var s=true;for(var n=0;n<self.rowConditions.length-measures.length+1;n++){if(t[a][self.rowConditions[n]]!=e[self.rowConditions[n]]){s=false}}if(s==true){i=true;break}}if(!i){t.push(e)}}return i};this.preGoWhenMoveTopFilter=function(e,r){if(r==undefined){for(var t=0;t<self.filterDiv.selects.length;t++){self.filterDiv.selects[t].value="[all]"}}else{var i=false;for(var t=0;t<self.filterDiv.selects.length;t++){if(self.filterDiv.selects[t].value!="[all]"){i=true}}if(i)return}self.FilterByTopFilter=false;var a=[];for(var t=0;t<columns.length;t++){var s=t;if(s!=e&&self.filterIndexes.indexOf(s)==-1){a.push(s)}}var n=self.GeneralDataRows;var f=[];for(var t=0;t<n.length;t++){var l=false;var o=0;for(var u=0;u<f.length;u++){var c=true;for(var v=0;v<a.length;v++){if(n[t][a[v]]!=f[u][a[v]]){c=false;break}}if(c){o=u;l=true;break}}if(!l){var d=[];for(var h=0;h<n[t].length;h++){d.push([n[t][h]])}f.push([d]);for(var p=0;p<measures.length;p++){var s;if(p<measures.length-1){s=self.rowConditions[self.rowConditions.length-measures.length+1+p]}else{s=self.dataColumnIndex}if(self.formulaInfo.measureFormula[p].hasFormula&&self.filterIndexes.length>0){var m=self.getFormulaRowByDataRow(n[t],p,"");if(m!=self.EmptyValue&&m!="#NuN#"){var T=self.calculateFormulaTotal([m],p,"MeasureInRows");if(!isNaN(T)){d[s]=T.toString()}}}}}else{if(measures.length>0){if(!self.formulaInfo.measureFormula[measures.length-1].hasFormula){if(f[o][self.dataColumnIndex]!="#NuN#"&&n[t][self.dataColumnIndex]!="#NuN#"){f[o][self.dataColumnIndex]=(parseFloat(f[o][self.dataColumnIndex])+parseFloat(n[t][self.dataColumnIndex])).toString()}else if(f[o][self.dataColumnIndex]=="#NuN#"){f[o][self.dataColumnIndex]=n[t][self.dataColumnIndex]}}}for(var p=0;p<measures.length-1;p++){var s=self.rowConditions[self.rowConditions.length-measures.length+1+p];if(self.formulaInfo.measureFormula[p].hasFormula&&self.filterIndexes.length>0);else{f[o][s]=(parseFloat(f[o][s])+parseFloat(n[t][s])).toString()}}}}self.allData=f;self.conditions=[];for(var t=0;t<self.headerRow.length;t++){self.initCondition(t)}for(var t=0;t<self.headerRow.length;t++){self.restoreSubtotalsAndSortLayout(t)}};this.isNotFilterByTopFilter=function(e){for(var r=0;r<self.filterIndexes.length;r++){var t=self.filterIndexes[r];var i=self.filterDiv.selects[r];if(i!=undefined&&(i.selectedIndex&&OAT.$v(i)!="[all]"&&OAT.$v(i)!=e[t])){return false}}return true};this.preGoWhenFilterByTopFilter=function(e){self.FilterByTopFilter=true;self.allData=self.GeneralDataRows;self.conditions=[];for(var r=0;r<self.headerRow.length;r++){self.initCondition(r)}for(var r=0;r<self.headerRow.length;r++){self.restoreSubtotalsAndSortLayout(r)}};this.gridCache=[];this.cleanGridCache=function(){self.gridCache=[]};this.addPageToCache=function(e,r){self.gridCache.push({page:e,data:r})};this.getPageDataFromCache=function(e){for(var r=0;r<self.gridCache.length;r++){if(self.gridCache[r].page==e){return self.gridCache[r].data}}return false};this.fireOnPageChange=function(e){setTimeout((function(){var r={QueryviewerId:self.IdForQueryViewerCollection,Navigation:e};var t=document.createEvent("Events");t.initEvent("PivotTableOnPageChangeEvent",true,true);t.parameter=r;document.dispatchEvent(t)}),0)};this.goWhenServerPagination=function(e,r){if(!self.getPageDataFromCache(self.pageData.ServerPageNumber)){self.addPageToCache(self.pageData.ServerPageNumber,self.pageData.rows)}if(self.pageData.ServerPageNumber!=self.pageData.PreviousPageNumber){self.QueryViewerCollection[self.IdForQueryViewerCollection].CurrentPage=self.pageData.ServerPageNumber;if(self.pageData.ServerPageNumber==1){if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnFirstPage=="function")self.fireOnPageChange("OnFirstPage")}else if(self.pageData.ServerPageNumber==self.pageData.ServerPageCount){if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnLastPage=="function")self.fireOnPageChange("OnLastPage")}else if(self.pageData.ServerPageNumber<self.pageData.PreviousPageNumber){if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnPreviousPage=="function")self.fireOnPageChange("OnPreviousPage")}else{if(typeof self.QueryViewerCollection[self.IdForQueryViewerCollection].OnNextPage=="function")self.fireOnPageChange("OnNextPage")}self.pageData.PreviousPageNumber=self.pageData.ServerPageNumber}if(!e){self.gd.clearSources();self.gd.clearTargets();self.drawFilters();if(self.QueryViewerCollection[self.IdForQueryViewerCollection].AutoRefreshGroup!=""){if(r===undefined||r===null||!r){if(!self.firstTime||self.getState()&&self.getState().version==self.rememberLayoutStateVersion){var t;t=self.getMetadataXML();t=t.replace(/\&amp;/g,"&");setTimeout((function(){var e={QueryviewerId:self.IdForQueryViewerCollection,Metadata:t};var r=document.createEvent("Events");r.initEvent("RequestUpdateLayoutSameGroup",true,true);r.parameter=e;document.dispatchEvent(r)}),50)}}}}var i=new Array;for(var a=0;a<self.filterDiv.selects.length;a++){i[a]=self.filterDiv.selects[a].value}if(!self.firstTime){var s={query:self.query,conditions:self.conditions,colConditions:self.colConditions,rowConditions:self.rowConditions,filterIndexes:self.filterIndexes,filterDivSelects:i,rowsPerPage:self.rowsPerPage,AxisInfo:self.pageData.AxisInfo,FilterInfo:self.pageData.FilterInfo,version:self.rememberLayoutStateVersion,DataInfo:self.pageData.DataInfo,NewAxisInfo:self.createNewAxisInfo(),NewDataInfo:self.createNewDataInfo()};if(!self.deleteState){self.saveState(s)}else{self.cleanState()}self.readState=true}else{self.firstTime=false}self.drawTableWhenServerPagination();if(self.pageData.ServerPageCount>0&&(self.pageData.ServerPageCount>1||self.pageData.rows.length>10)&&self.rowsPerPage>0){var n={currPage:self.pageData.ServerPageNumber,ignoreRows:jquery("tbody tr[title_row=true]",jquery("#"+this.controlName+"_"+self.query)),optionsForRows:OAT.AddItemToList([10,15,20],initMetadata.RowsPerPage),rowsPerPage:self.rowsPerPage,topNav:false,controlName:this.controlName+"_"+self.query,cantPages:self.pageData.ServerPageCount,controlUcId:UcId,translations:self.translations,control:self};OAT.partialTablePagination(jquery("#"+self.controlName+"_"+self.query),n);jquery("#"+this.controlName+"_"+self.query).css("margin-bottom","0px")}if(jquery("#"+this.controlName+"_"+self.query).length>0&&!autoResize){var f=jquery("#"+this.containerName)[0].clientWidth;jquery("#"+this.controlName+"_"+self.query).css({width:f-4+"px"})}try{var l=jquery("#"+this.controlName+"_"+self.query)[0].offsetWidth-4;if(jquery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1){l=l+4}}catch(e){}try{var o=jquery("#"+this.controlName+"_"+self.query)[0].offsetWidth-1;jquery("#"+UcId+"_"+self.query+"_title_div").css({width:l+"px"});jquery("#"+UcId+"_"+self.query+"_pivot_page").css({width:l+"px"});jquery("#"+this.controlName+"_"+self.query+"_tablePagination").css({width:o+"px"});if(jquery("#"+this.controlName+"_"+self.query+"_tablePagination_paginater").length>0&&jquery("#"+this.controlName+"_"+self.query+"_tablePagination")[0].getBoundingClientRect().bottom<jquery("#"+this.controlName+"_"+self.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom){jquery("#"+this.controlName+"_"+self.query+"_tablePagination")}}catch(e){}self.RedrawSelectedNode();setInterval((function(){if(jquery("#"+self.controlName+"_"+self.query).length>0&&jquery("#"+self.controlName+"_"+self.query)[0].getAttribute("class")==="pivot_table"){if(jquery("#"+self.controlName+"_"+self.query+"_tablePagination_paginater").length>0&&jquery("#"+self.controlName+"_"+self.query+"_tablePagination")[0].getBoundingClientRect().bottom<jquery("#"+self.controlName+"_"+self.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom){jquery("#"+this.controlName+"_"+self.query+"_tablePagination")}}}),150)};this.getDataForPivot=function(e,r,t,i,a,s,n,f,l,o){if(i){self.cleanGridCache()}if(i&&t>-1){self.rowsPerPage=t}self.pageData.PreviousPageNumber=self.pageData.ServerPageNumber;if(!i&&self.getPageDataFromCache(r)){self.pageData.ServerPageNumber=r;self.pageData.rows=self.getPageDataFromCache(self.pageData.ServerPageNumber);self.preGoWhenServerPagination(true)}else{if(a!=""){self.pageData.AxisInfo=self.createAxisInfo(a)}if(s!=""){self.createFilterInfo(s)}self.pageData.CollapseInfo=self.CreateExpandCollapseInfo("");self.ExportTo="";if(t<0){t=0;self.ExportTo=n}var u=true;if(r>1||!i){u=false}if(l!=undefined&&l!=""){u=true}self.pageData.AxisInfo=self.createAxisInfo(a);var c=self.createNewAxisInfo(a);self.pageData.DataInfo=self.createDataInfo();var v=self.createNewDataInfo();self.lastCallToQueryViewer="DataForPivot";self.lastNotAutorefreshIndicator=o;self.requestPageDataForPivotTable(r,t,i,c,v,self.pageData.FilterInfo,self.pageData.CollapseInfo,u)}};this.CreateExpandCollapseInfo=function(e){var r=[];var t={};for(var i=0;i<self.columns.length;i++){var a=-1;for(var s=0;s<self.conditions.length;s++){if(self.conditions[s].dataField==self.columns[i].getAttribute("dataField")){a=s}}if(self.conditions[a].collapsedValues.length){var n={Expanded:[],Collapsed:self.conditions[a].collapsedValues,DefaultAction:"Expand"};var t={DataField:self.conditions[a].dataField,NullExpanded:true,NotNullValues:n};r.push(t)}}return r};this.createAxisInfo=function(e){var r=[];var t=1;for(var i=0;i<self.initMetadata.Dimensions.length;i++){var a=-1;var s=!self.initMetadata.Dimensions[i].Visible;var n="Rows";var f=1;var l="Ascending";var o=true;if(!s){for(var u=0;u<self.conditions.length;u++){if(self.conditions[u].dataField==self.initMetadata.Dimensions[i].dataField){a=u}}l=self.conditions[a].sort==1?"Ascending":"Descending";o=self.conditions[a].subtotals==1||self.conditions[a].subtotals?true:false;if(self.rowConditions.indexOf(a)>-1){f=self.rowConditions.indexOf(a)+1}if(self.colConditions.indexOf(a)>-1){n="Columns";f=self.colConditions.indexOf(a)+1}if(self.filterIndexes.indexOf(a)>-1){n="Pages";f=self.filterIndexes.indexOf(a)+1}}else{n="Hidden";f=t;t=t+1}var c={DataField:self.initMetadata.Dimensions[i].dataField,Order:l,Axis:{Type:n,Position:f},Subtotals:o};r.push(c)}return r};this.createNewAxisInfo=function(e){var r=[];var t=0;var i=0;var a=0;var s=0;var n=0;var f=0;for(var l=0;l<self.initMetadata.Dimensions.length;l++){var o=-1;var u=!self.initMetadata.Dimensions[l].Visible;var c="Rows";var v=1;var d="Ascending";var h=true;if(!u){for(var p=0;p<self.conditions.length;p++){if(self.conditions[p].dataField==self.initMetadata.Dimensions[l].dataField){o=p}}d=self.conditions[o].sort==1?"Ascending":"Descending";h=self.conditions[o].subtotals==1||self.conditions[o].subtotals?true:false;if(self.rowConditions.indexOf(o)>-1){if(self.changesrowposition){v=self.rowConditions.indexOf(o)+1+i;t=v;var m=self.rowConditions.indexOf(o);var T=0;var A=true;for(var y=m+1;y<self.rowConditions.length&&A;y++){T++;if(self.rowConditions[y]<o){dataFieldRC=self.conditions[self.rowConditions[y]].dataField;for(var w=0;w<r.length;w++){if(dataFieldRC==r[w].DataField)positionDF=r[w].Axis.Position}v=positionDF-T;t=v;A=false}}}else{v=self.rowConditions.indexOf(o)+1+i;t=v}}if(self.colConditions.indexOf(o)>-1){c="Columns";v=self.colConditions.indexOf(o)+1+s;a=v}if(self.filterIndexes.indexOf(o)>-1){c="Pages";v=self.filterIndexes.indexOf(o)+1+f;n=v}}else{if(self.initMetadata.Dimensions[l].defaultPosition!="hidden"){c=self.initMetadata.Dimensions[l].defaultPosition;if(c=="Rows"){i=i+1;v=t+1;t=v}if(c=="Columns"){s=s+1;v=a+1;a=v}if(c=="Pages"){f=f+1;v=n+1;n=v}}else{c="";v=""}}var O={DataField:self.initMetadata.Dimensions[l].dataField,Order:d,Axis:{Type:c,Position:v},Subtotals:h,Hidden:u};r.push(O)}return r};this.createDataInfo=function(){var e=[];var r=1;var t=1;for(var i=0;i<self.initMetadata.Measures.length;i++){var a=self.initMetadata.Measures[i].Visible?"Data":"Hidden";var s=self.initMetadata.Measures[i].Visible?t:r;var n={DataField:self.initMetadata.Measures[i].dataField,Axis:{Type:a,Position:s}};e.push(n);if(self.initMetadata.Measures[i].Visible){t=t+1}else{r=r+1}}return e};this.createNewDataInfo=function(){var e=[];for(var r=0;r<self.initMetadata.Measures.length;r++){var t=!self.initMetadata.Measures[r].Visible;var i={DataField:self.initMetadata.Measures[r].dataField,Hidden:t,Position:r+1};e.push(i)}return e};this.createFilterInfo=function(e,r){DataFieldFilter=self.conditions[e.dim].dataField;if(e.op=="all"||e.op=="pagefilter"&&e.values=="[all]"){var t=-1;for(var i=0;i<self.pageData.FilterInfo.length;i++){if(DataFieldFilter==self.pageData.FilterInfo[i].DataField){t=i;break}}if(t>-1)self.pageData.FilterInfo.splice(t,1);self.conditions[e.dim].state="all";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];self.conditions[e.dim].defaultAction="Include";return}if(self.conditions[e.dim].state=="none"){self.conditions[e.dim].visibles=[];for(var a=0;a<self.conditions[e.dim].distinctValues.length;a++){if(self.conditions[e.dim].blackList.indexOf(self.conditions[e.dim].distinctValues[a])==-1){self.conditions[e.dim].blackList.push(self.conditions[e.dim].distinctValues[a])}}}else if(self.conditions[e.dim].state=="all"){self.conditions[e.dim].blackList=[];for(var a=0;a<self.conditions[e.dim].distinctValues.length;a++){if(self.conditions[e.dim].visibles.indexOf(self.conditions[e.dim].distinctValues[a])==-1){self.conditions[e.dim].visibles.push(self.conditions[e.dim].distinctValues[a])}}}if(e.op=="none"){self.conditions[e.dim].state="none";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];self.conditions[e.dim].defaultAction="Exclude"}else{if(e.op=="push"){self.conditions[e.dim].state="";var t=self.conditions[e.dim].visibles.indexOf(e.values);if(t>-1)self.conditions[e.dim].visibles.splice(t,1);if(self.conditions[e.dim].blackList.indexOf(e.values)==-1)self.conditions[e.dim].blackList.push(e.values)}else if(e.op=="pop"){self.conditions[e.dim].state="";if(self.conditions[e.dim].visibles.indexOf(e.values)==-1)self.conditions[e.dim].visibles.push(e.values);var t=self.conditions[e.dim].blackList.indexOf(e.values);if(t>-1)self.conditions[e.dim].blackList.splice(t,1)}else if(e.op=="pagefilter"){self.conditions[e.dim].state="";self.conditions[e.dim].defaultAction="Exclude";self.conditions[e.dim].visibles=[];self.conditions[e.dim].visibles.push(e.values);for(var i=0;i<self.conditions[e.dim].distinctValues.length;i++){var s=self.conditions[e.dim].distinctValues[i];if(self.conditions[e.dim].blackList.indexOf(s)==-1&&s!=e.values){self.conditions[e.dim].blackList.push(s)}}}else if(e.op=="reverse"){if(self.conditions[e.dim].defaultAction=="Include"){self.conditions[e.dim].defaultAction="Exclude"}else{self.conditions[e.dim].defaultAction="Include"}if(self.conditions[e.dim].state=="none"){var t=-1;for(var i=0;i<self.pageData.FilterInfo.length;i++){if(DataFieldFilter==self.pageData.FilterInfo[i].DataField){t=i;break}}if(t>-1)self.pageData.FilterInfo.splice(t,1);self.conditions[e.dim].state="all";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];return}else if(self.conditions[e.dim].state=="all"){self.conditions[e.dim].state="none";self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[]}else{var n=[];for(var f=0;f<self.conditions[e.dim].visibles.length;f++){n.push(self.conditions[e.dim].visibles[f])}var l=[];for(var f=0;f<self.conditions[e.dim].blackList.length;f++){l.push(self.conditions[e.dim].blackList[f])}self.conditions[e.dim].visibles=[];self.conditions[e.dim].blackList=[];for(var a=0;a<self.conditions[e.dim].distinctValues.length;a++){var s=self.conditions[e.dim].distinctValues[a];if(n.indexOf(s)==-1){self.conditions[e.dim].visibles.push(s)}else{self.conditions[e.dim].blackList.push(s)}}for(var a=0;a<l.length;a++){if(self.conditions[e.dim].visibles.indexOf(l[a])==-1){self.conditions[e.dim].visibles.push(l[a])}}for(var a=0;a<n.length;a++){if(self.conditions[e.dim].blackList.indexOf(n[a])==-1){self.conditions[e.dim].blackList.push(n[a])}}}}}var o=false;var u=true;var c=[];for(var v=0;v<self.conditions[e.dim].visibles.length;v++){if(self.conditions[e.dim].visibles[v]!="#NuN#"){c.push(self.conditions[e.dim].visibles[v])}}var d=[];if(self.conditions[e.dim].state!="none"){for(var v=0;v<self.conditions[e.dim].distinctValues.length;v++){var s=self.conditions[e.dim].distinctValues[v];if(s!="#NuN#"&&c.indexOf(s)==-1){d.push(s)}}for(var v=0;v<self.conditions[e.dim].blackList.length;v++){if(self.conditions[e.dim].blackList[v]!="#NuN#"&&d.indexOf(self.conditions[e.dim].blackList[v])==-1){d.push(self.conditions[e.dim].blackList[v])}}if(c.length==0&&self.conditions[e.dim].defaultAction=="Exclude"){d=[]}}if(e.op=="none"){u=false;c=[];d=[]}else{if(self.conditions[e.dim].distinctValues.indexOf("#NuN#")>-1||d.indexOf(self.conditions[e.dim].blackList[v])!=-1){if(self.conditions[e.dim].visibles.indexOf("#NuN#")==-1){u=false}}else{if(self.conditions[e.dim].defaultAction=="Exclude"){u=false}}}if(self.conditions[e.dim].hasNull&&!(e.op=="none")){var h=self.defaultPicture.getAttribute("textForNullValues");var p=false;var m=0;for(var a=0;a<self.conditions[e.dim].distinctValues.length;a++){m=self.conditions[e.dim].distinctValues[a].length}for(var a=0;a<self.conditions[e.dim].distinctValues.length;a++){if(self.conditions[e.dim].distinctValues[a].trimpivot()==self.defaultPicture.getAttribute("textForNullValues")){h=self.conditions[e.dim].distinctValues[a];p=true;break}}if(!p){for(var v=0;v<m-self.defaultPicture.getAttribute("textForNullValues").length;v++){h=h+" "}}if(!u){if(d.indexOf(h)==-1){d.push(h);if(self.conditions[e.dim].blackList.indexOf(h)==-1){self.conditions[e.dim].blackList.push(h)}}if(c.indexOf(h)!=-1){c.splice(c.indexOf(h),1)}if(self.conditions[e.dim].visibles.indexOf(h)!=-1){self.conditions[e.dim].visibles.splice(self.conditions[e.dim].visibles.indexOf(h),1)}}else{if(c.indexOf(h)==-1){if(d.indexOf(h)!=-1){d.splice(d.indexOf(h),1);c.push(h)}else{if(self.conditions[e.dim].defaultAction=="Exclude"){c.push(h)}}if(self.conditions[e.dim].blackList.indexOf(h)!=-1){self.conditions[e.dim].blackList.splice(self.conditions[e.dim].blackList.indexOf(h),1);if(self.conditions[e.dim].visibles.indexOf(h)==-1){self.conditions[e.dim].visibles.push(h)}}}}}var T=self.conditions[e.dim].previousPage==self.conditions[e.dim].totalPages;var A=(u||!self.conditions[e.dim].hasNull)&&d.length==0&&e.op!="none"&&e.op!="push"&&(self.conditions[e.dim].defaultAction=="Include"||T)&&!r&&!(e.op=="reverse");var t=0;var y=false;for(var v=0;v<self.pageData.FilterInfo.length;v++){if(self.pageData.FilterInfo[v].DataField==DataFieldFilter){o=true;y=true;self.pageData.FilterInfo[v].NullIncluded=u;self.pageData.FilterInfo[v].NotNullValues.Included=c;self.pageData.FilterInfo[v].NotNullValues.Excluded=d;self.pageData.FilterInfo[v].NotNullValues.DefaultAction=self.conditions[e.dim].defaultAction;t=v}}if(A&&y){self.pageData.FilterInfo.splice(t,1)}if(!o&&!A){var w={Included:c,Excluded:d,DefaultAction:self.conditions[e.dim].defaultAction};filter={DataField:DataFieldFilter,NullIncluded:u,NotNullValues:w};self.pageData.FilterInfo.push(filter)}};this.moveToNextPage=function(){if(this.pageData.ServerPageNumber<this.pageData.ServerPageCount){this.getDataForPivot(this.UcId,this.pageData.ServerPageNumber+1,this.rowsPerPage,false,"","","","")}};this.moveToFirstPage=function(){if(this.pageData.ServerPageNumber>1){this.getDataForPivot(this.UcId,1,this.rowsPerPage,false,"","","","")}};this.moveToLastPage=function(){if(this.pageData.ServerPageNumber<this.pageData.ServerPageCount){this.getDataForPivot(this.UcId,this.pageData.ServerPageCount,this.rowsPerPage,false,"","","","")}};this.moveToPreviousPage=function(){if(this.pageData.ServerPageNumber>1){self.getDataForPivot(UcId,this.pageData.ServerPageNumber-1,this.rowsPerPage,false,"","","","")}};this.preGoWhenServerPagination=function(e){self.goWhenServerPagination(e,false)};this.readScrollValue=function(e){var r=self.conditions[e].dataField;if(!self.conditions[e].blocked){self.conditions[e].blocked=true;if(!self.conditions[e].filtered){var t=self.conditions[e].previousPage+1;self.lastRequestValue=e;self.lastRequestAttributeValues="readScrollValueWithoutFilters";self.requestAttributeValues(r,t,10,"")}else{var i=self.conditions[e].searchInfo;var t=i.previousPage+1;self.lastRequestValue=r;var a=i.filteredText;self.lastRequestAttributeValues="readScrollValueWithFilters";self.lastRequestAttributeColumnNumber=e;self.lastRequestAttributeFilterText=a;self.requestAttributeValues(r,t,10,i.filteredText)}}};this.getValuesForColumn=function(e,r,t){var i=self.conditions[r].dataField;if(t!=""){var a=1;var s=t.replace(/\\/g,"\\\\");self.lastRequestAttributeValues="ValuesForColumn";self.lastRequestAttributeColumnNumber=r;self.lastRequestAttributeFilterText=s;self.lastRequestAttributeDataField=i;self.lastRequestAttributeUcId=e;self.requestAttributeValues(i,a,10,s)}else{self.resetScrollValue(e,i,r)}};this.appendNewValueData=function(e,r){if(r.PageNumber>self.conditions[e].previousPage){self.conditions[e].previousPage=r.PageNumber;self.conditions[e].totalPages=r.PagesCount;var t=[];if(r.Null){if(self.conditions[e].indexOf("#NuN#")==-1){self.conditions[e].distinctValues.push("#NuN#")}}for(var i=0;i<r.NotNullValues.length;i++){var a=r.NotNullValues[i];if(self.conditions[e].distinctValues.indexOf(a)==-1){self.conditions[e].distinctValues.push(a);t.push(a)}if(self.conditions[e].defaultAction=="Include"){if(self.conditions[e].visibles.indexOf(a)==-1&&self.conditions[e].blackList.indexOf(a)==-1){self.conditions[e].visibles.push(a)}}else{if(self.conditions[e].visibles.indexOf(a)==-1&&self.conditions[e].blackList.indexOf(a)==-1){self.conditions[e].blackList.push(a)}}}for(var s=0;s<t.length;s++){var n=true;if(self.conditions[e].state!="all"){if(self.conditions[e].blackList.indexOf(t[s])!=-1){n=false}}if(!(self.conditions[e].hasNull&&t[s].trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(t[s],e,n)}}}if(self.conditions[e].previousPage<r.PagesCount)self.conditions[e].blocked=false};this.changeValues=function(e,r,t,i,a){var s=jquery("#"+e+t)[0];var n=s.value;if(s.value){n=n.replace(/\\/g,"\\\\")}if((s.value||s.value=="")&&n!=a){return}self.conditions[t].filtered=true;self.conditions[t].blocked=true;self.removeAllPairsFromPopUp(t,i.PagesCount>1);self.conditions[t].searchInfo.previousPage=1;self.conditions[t].searchInfo.totalPages=i.PagesCount;self.conditions[t].searchInfo.filteredText=a;for(var f=0;f<i.NotNullValues.length;f++){var l=i.NotNullValues[f];var o=self.conditions[t].distinctValues.indexOf(l)!=-1;if(self.conditions[t].distinctValues.indexOf(l)==-1){self.conditions[t].distinctValues.push(l)}if(self.conditions[t].state=="all"||self.conditions[t].defaultAction=="Include"&&!o){if(self.conditions[t].visibles.indexOf(l)==-1&&self.conditions[t].blackList.indexOf(l)==-1){self.conditions[t].visibles.push(l)}}var u=true;if(self.conditions[t].state!="all"){if(self.conditions[t].visibles.indexOf(l)<0){u=false}}self.conditions[t].searchInfo.values.push(l);if(!(self.conditions[t].hasNull&&l.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(l,t,u)}}if(i.PagesCount>0)self.conditions[t].blocked=false};this.resetScrollValue=function(e,r,t){self.conditions[t].filtered=false;self.conditions[t].blocked=true;self.removeAllPairsFromPopUp(t,data.PagesCount>1);for(var i=0;i<self.conditions[t].distinctValues.length;i++){var a=true;var s=self.conditions[t].distinctValues[i];if(self.conditions[t].state!="all"){if(self.conditions[t].visibles.indexOf(s)<0){a=false}}if(!(self.conditions[t].hasNull&&s.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(s,t,a)}}if(self.conditions[t].previousPage<self.conditions[t].totalPages)self.conditions[t].blocked=false};this.resetAllScrollValue=function(e){for(var r=0;r<self.conditions.length;r++){self.conditions[r].filtered=false;self.conditions[r].blocked=true;if(self.conditions[r].previousPage<self.conditions[r].totalPages)self.conditions[r].blocked=false}};this.appendNewFilteredValueData=function(e,r,t){var i=self.conditions[r].searchInfo;if((t||t=="")&&i.filteredText!=t){return}if(e.PageNumber>i.previousPage){self.conditions[r].searchInfo.previousPage=e.PageNumber;self.conditions[r].searchInfo.totalPages=e.PagesCount;if(e.Null){if(self.conditions[r].distinctValues.indexOf("#NuN#")==-1){self.conditions[r].distinctValues.push("#NuN#")}}for(var a=0;a<e.NotNullValues.length;a++){var s=e.NotNullValues[a];var n=self.conditions[r].distinctValues.indexOf(s)!=-1;if(self.conditions[r].distinctValues.indexOf(s)==-1){self.conditions[r].distinctValues.push(s)}if(self.conditions[r].defaultAction=="Include"&&!n){if(self.conditions[r].visibles.indexOf(s)==-1&&self.conditions[r].blackList.indexOf(s)==-1){self.conditions[r].visibles.push(s)}}else{if(self.conditions[r].visibles.indexOf(s)==-1&&self.conditions[r].blackList.indexOf(s)==-1){self.conditions[r].blackList.push(s)}}var f=true;if(self.conditions[r].state!="all"){if(self.conditions[r].visibles.indexOf(s)<0){f=false}}if(!(self.conditions[r].hasNull&&s.trimpivot()==self.defaultPicture.getAttribute("textForNullValues"))){self.appendNewPairToPopUp(s,r,f)}}if(self.conditions[r].searchInfo.previousPage<self.conditions[r].searchInfo.totalPages)self.conditions[r].blocked=false}},this.appendNewPairToPopUp=function(e,r,t){var a=function(e,r,t){var i=OAT.Dom.create("div");var a=t?"check_item_img":"uncheck_item_img";if(self.isSD){a=t?"check_item_img_small":"uncheck_item_img_small"}OAT.addImageNode(i,t?"check_box":"check_box_outline_blank","");i.setAttribute("class",a);var s=OAT.Dom.create("input");s.type="checkbox";s.id=r;var n=OAT.Dom.create("label");OAT.addTextNode(n,e);n.htmlFor=r;i.appendChild(n);return[i,s]};var s=function(e,t){var i="pop";if(!e){i="push"}self.getDataForPivot(self.UcId,1,self.rowsPerPage,true,self.conditions[r].dataField,{op:i,values:t,dim:r},"","");self.stateChanged=true;self.onFilteredChangedEventHandleWhenServerPagination(r);self.EneablePivot();return};var n=self.dimensionPictureValue(e,r);if(e=="#NuN#"){n="Â "}n=n.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(n.length>33){var f=n.substring(32,n.length).trimpivot().length>0?"...":"";n=n.substring(0,32)+f}n=n.replace(/ /g,"Â ")+"Â Â Â Â Â ";var l=a(n,"pivot_distinct_"+i,t);l[0].setAttribute("value",e);var o=jquery("#values_"+self.UcId+"_"+r)[0];o.appendChild(l[0]);if(o.children.length>9){o.setAttribute("class","pivot_popup_fix")}OAT.Dom.attach(l[0],"click",(function(){self.DiseablePivot();var e="check_item_img";var r="uncheck_item_img";if(self.isSD){e="check_item_img_small";r="uncheck_item_img_small"}var t=!(this.getAttribute("class")===e);var i=this.getAttribute("class")===e?r:e;jquery(this).find("i")[0].textContent=t?"check_box":"check_box_outline_blank";this.setAttribute("class",i);s(t,this.getAttribute("value"))}))};this.removeAllPairsFromPopUp=function(e,r){var t="check_item_img";var i="uncheck_item_img";if(self.isSD){t="check_item_img_small";i="uncheck_item_img_small"}jquery("#values_"+self.UcId+"_"+e).find("."+t).remove();jquery("#values_"+self.UcId+"_"+e).find("."+i).remove();jquery(".last_div_popup ."+t).remove();jquery(".last_div_popup ."+i).remove();if(r){jquery("#values_"+self.UcId+"_"+e).removeClass("pivot_popup_auto");jquery("#values_"+self.UcId+"_"+e).addClass("pivot_popup_fix")}else{jquery("#values_"+self.UcId+"_"+e).removeClass("pivot_popup_fix");jquery("#values_"+self.UcId+"_"+e).addClass("pivot_popup_auto")}};this.onClickEventHandle=function(e,r,t,i){self.ClickHandle(e)};this.onClickExpandCollapse=function(e){var r=jquery(e).data("itemValue");var t=jquery(e).data("numberMorD");jquery(e).data("itemInfoEC");if(self.conditions[t].collapsedValues.indexOf(r)==-1){self.conditions[t].collapsedValues.push(r);self.ExpandCollapseHandleWhenServerPagination(e,"collapse")}else{self.conditions[t].collapsedValues.splice(self.conditions[t].collapsedValues.indexOf(r),1);self.ExpandCollapseHandleWhenServerPagination(e,"expande")}};this.cleanValueForNull=function(e){if(e=="#NuN#"){var r=self.defaultPicture.getAttribute("textForNullValues");if(r!=undefined){return r}return""}return e};this.isClickedRow=function(e,r,t,i,a,s){if(!s){if(self.rowConditions.indexOf(a)==-1){return true}for(var n=0;n<t;n++){var f=self.rowConditions[n];if(e[f]!=i[f]){return false}}}else{if(self.colConditions.indexOf(a)==-1){return true}for(var n=0;n<t;n++){var f=self.colConditions[n];if(e[f]!=i[f]){return false}}}return true};this.isClickedRowMeasure=function(e,r,t){for(var i=0;i<e.length;i++){if(e[i]!=undefined&&e[i]!=t[i]){return false}}return true};this.onClickSelectNode=function(e){var r=jquery(e).data("itemValue");var t=jquery(e).data("typeMorD");var i=jquery(e).data("numberMorD");var a=jquery(e).data("itemInfo");self.selection.SelectedNode=[];self.SelectNodes(r,t,i,a)};this.requestDataSynForPivotTable=function(){setTimeout((function(){var e={QueryviewerId:self.IdForQueryViewerCollection};var r=document.createEvent("Events");r.initEvent("RequestDataSynForPivotTable",true,true);r.parameter=e;document.dispatchEvent(r)}),0)};this.ClickHandle=function(e){self.LastElemValue=e;self.requestDataSynForPivotTable()};this.setDataSynForPivotTable=function(e){var r=self.LastElemValue;var t=e;var i=jquery(r).data("itemValue");var a=jquery(r).data("typeMorD");var s=jquery(r).data("numberMorD");var n=jquery(r).data("itemInfo");var f=OAT.IsNodeSelected(r.parentElement);var l='<DATA><ITEM type="'+a+'" ';if(a==="MEASURE"){l=l+'name="'+measures[s].getAttribute("name")+'" ';l=l+'displayName="'+measures[s].getAttribute("displayName")+'" ';l=l+'selected="'+f.toString()+'" ';l=l+'location="data">';l=l+self.cleanValueForNull(i)}else{l=l+'name="'+self.columns[s].getAttribute("name")+'" ';l=l+'displayName="'+self.columns[s].getAttribute("displayName")+'" ';l=l+'selected="'+f.toString()+'" ';if(n!=""&&(n.axis!=undefined&&n.axis=="columns"||n[4]=="columns"))l=l+'location="columns">';else l=l+'location="rows">';l=l+self.cleanValueForNull(i)}l=l+"</ITEM>";l=l+"<CONTEXT>";l=l+"<RELATED>";var o=l;try{var u=[];for(var c=0;c<self.conditions.length;c++){if(self.conditions[c].dataField!=undefined){u.push(self.conditions[c].dataField)}}for(var c=0;c<measures.length;c++){if(measures[c].getAttribute("dataField")!=undefined){u.push(measures[c].getAttribute("dataField"))}}self.allRowsPivot=[];self.allFullRowsPivot=[];var v=t.split("<Record>");for(var c=1;c<v.length;c++){var d=[];var h=[];for(var p=0;p<u.length;p++){d[p]="#NuN#";var m=v[c].split("<"+u[p]+">");if(m.length>1){var T=m[1].split("</"+u[p]+">");d[p]=T[0];h[p]=d[p]}else{if(v[c].indexOf("<"+u[p]+"/>")>=0){d[p]="";h[p]=""}else{d[p]="#NuN#";h[p]="#NuN#"}}}if(a=="MEASURE"&&self.formulaInfo.cantFormulaMeasures&&self.formulaInfo.measureFormula[s].hasFormula){d[s+this.columns.length]=parseFloat(d[s+this.columns.length]).toFixed(15).toString();h[s+this.columns.length]=parseFloat(h[s+this.columns.length]).toFixed(15).toString()}self.allRowsPivot.push(d);for(var p=0;p<self.HideDataFilds.length;p++){var m=v[c].split("<"+self.HideDataFilds[p]+">");if(m.length>1){var T=m[1].split("</"+self.HideDataFilds[p]+">");h[h.length]=T[0]}else{if(v[c].indexOf("<"+self.HideDataFilds[p]+"/>")>=0){h[h.length]=""}else{h[h.length]="#NuN#"}}}self.allFullRowsPivot.push(h)}var A=false;if(n.row){A=!n.row.subTotal;if(!A&&n.isTotal!=undefined&&!n.isTotal){A=true}}var y=n.axis!=undefined&&n.axis=="columns";if(y){A=true}if((n.row!=undefined||y)&&A){var w=n.row;var O=n.cell;self.pageData.rows.indexOf(w);var g=n.cell;var _=self.pageData.columnsHeaders[g];if(y){O=n.rownumber;g=n.columnnumber;_=self.pageData.columnsHeaders[g]}var b=[];for(var c=0;c<self.pageData.dataFields.length;c++){b[c]=undefined}if(n.row!=undefined){for(var c=0;c<w.headers.length;c++){var x=u.indexOf(w.headers[c].dataField);if(w.headers[c]!=undefined&&w.headers[c].value!=undefined){b[x]=w.headers[c].value}}}if(_!=undefined){for(var c=0;c<_.subHeaders.length;c++){if(y&&n.rownumber<c)break;if(_.subHeaders[c]!=undefined){var x=self.pageData.dataFields.indexOf(_.subHeaders[c].dataField);if(_.subHeaders[c].value!=undefined){b[x]=_.subHeaders[c].value}}}}for(var c=0;c<this.columns.length;c++){l=l+'<ITEM name="'+this.columns[c].getAttribute("name")+'">';l=l+"<VALUES";var S=false;var I="";if(a==="MEASURE"){if(b[c]!=undefined){if(b[c]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(b[c])+"</VALUE>"}else{S=true}}else{if(self.filterIndexes.indexOf(c)!=-1){var k=[];for(var q=0;q<self.allRowsPivot.length;q++){if(k.indexOf(self.allRowsPivot[q][c])===-1&&self.filterOK(self.allRowsPivot[q])&&self.isClickedRowMeasure(b,i,self.allRowsPivot[q])){k=k.concat(self.allRowsPivot[q][c]);if(self.allRowsPivot[q][c]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[q][c])+"</VALUE>"}else{S=true}}}}}}else{var k=[];for(var q=0;q<self.allRowsPivot.length;q++){if(self.allRowsPivot[q][s]===i&&self.isClickedRow(b,i,O,self.allRowsPivot[q],s,y)&&k.indexOf(self.allRowsPivot[q][c])===-1&&self.filterOK(self.allRowsPivot[q])){k=k.concat(self.allRowsPivot[q][c]);if(self.allRowsPivot[q][c]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[q][c])+"</VALUE>"}else{S=true}}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}for(var c=0;c<measures.length;c++){l=l+'<ITEM name="'+measures[c].getAttribute("name")+'">';l=l+"<VALUES";var S=false;var I="";if(a==="MEASURE"){if(b[c+this.columns.length]!=undefined){if(b[c+this.columns.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(b[c+this.columns.length])+"</VALUE>"}else{S=true}}else{if(s==c){if(i!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(i)+"</VALUE>"}else{S=true}}else{var k=[];for(var q=0;q<self.allRowsPivot.length;q++){if(parseFloat(self.allRowsPivot[q][s+this.columns.length])===parseFloat(i)&&self.isClickedRowMeasure(b,i,self.allRowsPivot[q])&&self.filterOK(self.allRowsPivot[q])&&k.indexOf(self.allRowsPivot[q][c+this.columns.length])===-1){if(self.allRowsPivot[q][c+this.columns.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[q][c+this.columns.length])+"</VALUE>"}else{S=true}}}}}}else{var k=[];for(var q=0;q<self.allRowsPivot.length;q++){if(self.allRowsPivot[q][s]===i&&self.isClickedRow(b,i,O,self.allRowsPivot[q],s,y)&&self.filterOK(self.allRowsPivot[q])&&k.indexOf(self.allRowsPivot[q][c+this.columns.length])===-1){k=k.concat(self.allRowsPivot[q][c+this.columns.length]);if(self.allRowsPivot[q][c+this.columns.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[q][c+this.columns.length])+"</VALUE>"}else{S=true}}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}for(var c=0;c<self.HideDataFilds.length;c++){l=l+'<ITEM name="'+self.OrderFildsHidden[c]+'">';l=l+"<VALUES";var S=false;var I="";var F=function(e,r){for(var t=0;t<e.length;t++){if(e[t]!=undefined&&e[t]!=r[t]){return false}}return true};var I="";if(a==="MEASURE"){var k=[];for(var q=0;q<self.allFullRowsPivot.length;q++){if(F(b,self.allFullRowsPivot[q])&&self.isClickedRowMeasure(b,i,self.allFullRowsPivot[q])&&self.filterOK(self.allFullRowsPivot[q])&&k.indexOf(self.allFullRowsPivot[q][c+this.columns.length+measures.length])===-1){k=k.concat(self.allFullRowsPivot[q][c+this.columns.length+measures.length]);if(self.allFullRowsPivot[q][c+this.columns.length+measures.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allFullRowsPivot[q][c+this.columns.length+measures.length])+"</VALUE>"}else{S=true}}}}else{var k=[];for(var q=0;q<self.allFullRowsPivot.length;q++){if(self.allFullRowsPivot[q][s]===i&&self.isClickedRow(b,i,O,self.allFullRowsPivot[q],s,y)&&self.filterOK(self.allFullRowsPivot[q])&&k.indexOf(self.allFullRowsPivot[q][c+this.columns.length+measures.length])===-1){k=k.concat(self.allFullRowsPivot[q][c+this.columns.length+measures.length]);if(self.allFullRowsPivot[q][c+this.columns.length+measures.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allFullRowsPivot[q][c+this.columns.length+measures.length])+"</VALUE>"}else{S=true}}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}}else{if(n==="GrandTotal"){for(var c=0;c<this.columns.length;c++){l=l+'<ITEM name="'+this.columns[c].getAttribute("name")+'">';l=l+"<VALUES";var S=false;var I="";var k=[];for(var q=0;q<self.allRowsPivot.length;q++){if(k.indexOf(self.allRowsPivot[q][c])===-1&&self.filterOK(self.allRowsPivot[q])){k=k.concat(self.allRowsPivot[q][c]);if(self.allRowsPivot[q][c]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[q][c])+"</VALUE>"}else{S=true}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}for(var c=0;c<self.HideDataFilds.length;c++){l=l+'<ITEM name="'+self.OrderFildsHidden[c]+'">';l=l+"<VALUES";var S=false;var I="";var k=[];for(var q=0;q<self.allFullRowsPivot.length;q++){if(k.indexOf(self.allFullRowsPivot[q][c+this.columns.length+measures.length])===-1&&self.filterOK(self.allFullRowsPivot[q])){k=k.concat(self.allFullRowsPivot[q][c+this.columns.length+measures.length]);if(self.allFullRowsPivot[q][c+this.columns.length+measures.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allFullRowsPivot[q][c+this.columns.length+measures.length])+"</VALUE>"}else{S=true}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}for(var c=0;c<measures.length;c++){l=l+'<ITEM name="'+measures[c].getAttribute("name")+'">';l=l+"<VALUES";var S=false;var I="";var k=[];for(var q=0;q<self.allRowsPivot.length;q++){if(k.indexOf(self.allRowsPivot[q][c+this.columns.length])===-1&&self.filterOK(self.allRowsPivot[q])){k=k.concat(self.allRowsPivot[q][c+this.columns.length]);if(self.allRowsPivot[q][c+this.columns.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(self.allRowsPivot[q][c+this.columns.length])+"</VALUE>"}else{S=true}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}}else if(n[0]==="PtrTotals"){var w=n[2];var g=n[3];if(g>-1){var _=self.pageData.columnsHeaders[g]}y=n[4]=="columns";var P=n[5];var b=[];for(var c=0;c<self.pageData.dataFields.length;c++){b[c]=undefined}if(!y){for(var c=0;c<w.headers.length;c++){var x=self.pageData.dataFields.indexOf(w.headers[c].dataField);if(w.headers[c]!=undefined&&w.headers[c].value!=undefined){b[x]=w.headers[c].value}}}if(g>-1){for(var c=0;c<_.subHeaders.length;c++){if(_.subHeaders[c]!=undefined){if(y&&P<c)break;var x=self.pageData.dataFields.indexOf(_.subHeaders[c].dataField);if(_.subHeaders[c].value!=undefined){b[x]=_.subHeaders[c].value}}}}var N=[];var D=[];for(var c=0;c<self.allRowsPivot.length;c++){if(self.filterOK(self.allRowsPivot[c])){if(self.isClickedRowMeasure(b,i,self.allRowsPivot[c])){N.push(self.allRowsPivot[c]);if(self.HideDataFilds.length>0){D.push(self.allFullRowsPivot[c])}}}}for(var c=0;c<this.columns.length;c++){l=l+'<ITEM name="'+this.columns[c].getAttribute("name")+'">';l=l+"<VALUES";var S=false;var I="";var k=[];for(var p=0;p<N.length;p++){if(k.indexOf(N[p][c])===-1){k=k.concat(N[p][c]);if(N[p][c]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(N[p][c])+"</VALUE>"}else{S=true}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}for(var c=0;c<self.HideDataFilds.length;c++){l=l+'<ITEM name="'+self.OrderFildsHidden[c]+'">';l=l+"<VALUES";var S=false;var I="";var k=[];for(var p=0;p<N.length;p++){if(k.indexOf(N[p][c])===-1){k=k.concat(N[p][c]);if(D[p][c+this.columns.length+measures.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(D[p][c+this.columns.length+measures.length])+"</VALUE>"}else{S=true}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}for(var c=0;c<measures.length;c++){l=l+'<ITEM name="'+measures[c].getAttribute("name")+'">';l=l+"<VALUES";var S=false;var I="";var k=[];for(var q=0;q<N.length;q++){if(k.indexOf(N[q][c+this.columns.length])===-1){k=k.concat(N[q][c+this.columns.length]);if(N[q][c+this.columns.length]!="#NuN#"){I=I+"<VALUE>"+self.cleanValueForNull(N[q][c+this.columns.length])+"</VALUE>"}else{S=true}}}if(S){l=l+' Null="true"'}l=l+">"+I;l=l+"</VALUES>";l=l+"</ITEM>"}}}}catch(e){l=o}l=l+"</RELATED>";l=l+"<FILTERS>";o=l;try{for(var c=0;c<self.filterIndexes.length;c++){l=l+'<ITEM name="'+this.columns[self.filterIndexes[c]].getAttribute("name")+'" displayName="'+this.columns[self.filterIndexes[c]].getAttribute("displayName")+'">';l=l+"<VALUES>";l=l+"<VALUE>";if(self.filterDiv.selects[c].value==="[all]"){l=l+self.translations.GXPL_QViewerJSAllOption}else{l=l+self.cleanValueForNull(self.filterDiv.selects[c].value)}l=l+"</VALUE>";l=l+"</VALUES>";l=l+"</ITEM>"}}catch(e){l=o}l=l+"</FILTERS>";l=l+"</CONTEXT>";l=l+"</DATA>";self.fireOnItemClickEvent(self.QueryViewerCollection[IdForQueryViewerCollection],l)};this.fireOnItemClickEvent=function(e,r){setTimeout((function(){var t={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection};var i=document.createEvent("Events");i.initEvent("PivotTableOnItemClickEvent",true,true);i.parameter=t;document.dispatchEvent(i)}),0)};this.SelectNodes=function(e,r,t,i,a,s,n){var f=false;var l=r=="DIMENSION"?self.columns[t].getAttribute("dataField"):measures[t].getAttribute("dataField");for(var o=0;o<jquery("#"+self.controlName+"_"+self.query+" tr").length&&!f;o++){var u=jquery("#"+self.controlName+"_"+self.query+" tr")[o];for(var c=0;c<u.children.length&&!f;c++){var v=jquery(u.children[c]).data("itemValue");var d=jquery(u.children[c]).data("typeMorD");var h=jquery(u.children[c]).data("numberMorD");var p=jquery(u.children[c]).data("itemInfo");if(p&&t==h&&r==d){if(i=="GrandTotal"&&p=="GrandTotal"){if(OAT.IsNodeSelected(u.children[c])){if(!a){OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{if(!a){OAT.SetSelectedNodeBackgroundColor(u.children[c],self.selection.Color,jquery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[c],self.selection.Color)}if(!a)self.selection.SelectedNode.push({value:e,dataField:l,type:r,rowData:["GrandTotal"],clicked:true});if(self.selection.EntireLine){selectedCellOffset=u.children[c].offsetLeft;var m=self.colConditions.length>0?self.colConditions.length+1:0;for(var T=m+1;T<jquery("#"+self.controlName+"_"+self.query+" tr").length;T++){var A=jquery("#"+self.controlName+"_"+self.query+" tr")[T];OAT.SelectAllRow(A,self.selection.Color)}}}}else if(i[0]=="PtrTotals"&&p!="GrandTotal"&&p.length>0&&r=="MEASURE"){var y=i[2].headers.length==p[2].headers.length&&i[3]==p[3];if(y){for(var w=0;w<i[2].headers.length;w++){if(i[2].headers[w].value!=p[2].headers[w].value){y=false}}}if(y){f=true;if(OAT.IsNodeSelected(u.children[c])){if(!a){OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{if(!a){OAT.SetSelectedNodeBackgroundColor(u.children[c],self.selection.Color,jquery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[c],self.selection.Color)}if(!a)self.selection.SelectedNode.push({value:e,dataField:l,type:r,rowData:[i],clicked:true});if(self.selection.EntireLine){var O=false;for(var g=0;g<u.children.length&&!O;g++){var _=jquery(u.children[g]).data("typeMorD");var b=jquery(u.children[g]).data("itemInfo");if(_=="DIMENSION"&&b[0]!=undefined&&b[0]=="PtrTotals"){OAT.SetNodeBackgroundColor(u.children[g],self.selection.Color);OAT.SelectAllRow(u,self.selection.Color,g);selectedCellOffset=u.children[g].offsetLeft;selectedRowOffset=u.children[0].offsetLeft;var x=false;var S=-1;var m=self.colConditions.length>0?self.colConditions.length+1:0;for(var T=o-1;T>m&&!x;T--){var A=jquery("#"+self.controlName+"_"+self.query+" tr")[T];var I=A.children[0].offsetLeft;if(jquery(A.children[0]).hasClass("h2subtitle")){if(I<=selectedRowOffset){x=true;S=T}}if(!x){OAT.SelectAllRow(A,self.selection.Color)}}for(var T=S;T>=0;T--){var k=jquery("#"+self.controlName+"_"+self.query+" tr")[T];if(!jquery(k.children[0]).hasClass("h2subtitle")){for(var q=0;q<k.children.length;q++){var F=parseInt(jquery(k.children[q]).attr("rowspan"));if(T+F>o){OAT.SetNodeBackgroundColor(k.children[q],self.selection.Color)}}}}}}}}}}else if(self.sameValue(e,v,r,t,i)){if(i.cell!=undefined&&i.cell==p.cell){if(i.row!=undefined&&p.row!=undefined){var y=i.row.headers.length==p.row.headers.length;for(var w=0;w<i.row.headers.length;w++){if(i.row.headers[w].value!=p.row.headers[w].value){y=false}}if(y){f=true;if(OAT.IsNodeSelected(u.children[c])){if(!a){OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{if(!a){OAT.SetSelectedNodeBackgroundColor(u.children[c],self.selection.Color,jquery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[c],self.selection.Color)}if(!a)self.selection.SelectedNode.push({value:e,dataField:l,type:r,rowData:[self.createDataRowFromItem(p,r)],clicked:true});if(self.selection.EntireLine){OAT.SelectAllRow(u,self.selection.Color,c);for(var T=o-1;T>=0;T--){var k=jquery("#"+self.controlName+"_"+self.query+" tr")[T];for(var q=0;q<k.children.length;q++){var F=parseInt(jquery(k.children[q]).attr("rowspan"));if(T+F>o){OAT.SetNodeBackgroundColor(k.children[q],self.selection.Color)}}}var P=parseInt(jquery(u.children[c]).attr("rowspan"));if(P>=1){for(var N=o+1;N<o+P;N++){var D=jquery("#"+self.controlName+"_"+self.query+" tr")[N];OAT.SelectAllRow(D,self.selection.Color)}var N=o+P;var D=jquery("#"+self.controlName+"_"+self.query+" tr")[N];if(D!=undefined&&jquery(D.children[0]).hasClass("h2subtitle")&&!jquery(D.children[0]).hasClass("grandtotaltitle")){selectedCellOffset=u.children[c].offsetLeft;rowOffset=D.children[0].offsetLeft;if(rowOffset==selectedCellOffset){OAT.SelectAllRow(D,self.selection.Color)}}}if(self.colConditions.length>0&&r=="MEASURE"){selectedCellOffset=u.children[c].offsetLeft;for(var T=1;T<jquery("#"+self.controlName+"_"+self.query+" tr").length;T++){if(T!=o){var x=false;var A=jquery("#"+self.controlName+"_"+self.query+" tr")[T];for(var E=0;E<A.children.length&&!x;E++){var C=A.children[E].offsetLeft+A.children[E].offsetWidth;if(C>selectedCellOffset+1){x=true;OAT.SetNodeBackgroundColor(A.children[E],self.selection.Color)}}}}}}}}}}else if(i[0]=="PtrTotals"&&i[1]==p[1]&&r=="DIMENSION"){var y=i[2].headers.length==p[2].headers.length&&i[3]==p[3];if(y){for(var w=0;w<i[2].headers.length;w++){if(i[2].headers[w].value!=p[2].headers[w].value){y=false}}}if(y){f=true;if(OAT.IsNodeSelected(u.children[c])){if(!a){OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]}}else{OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));if(!a){OAT.SetSelectedNodeBackgroundColor(u.children[c],self.selection.Color,jquery("#"+self.controlName+"_"+self.query))}else{OAT.SetNodeBackgroundColor(u.children[c],self.selection.Color)}if(!a)self.selection.SelectedNode.push({value:e,dataField:l,type:r,rowData:[i],clicked:true});if(self.selection.EntireLine){OAT.SelectAllRow(u,self.selection.Color,c);selectedCellOffset=u.children[c].offsetLeft;selectedRowOffset=u.children[0].offsetLeft;var x=false;var S=-1;var m=self.colConditions.length>0?self.colConditions.length+1:0;for(var T=o-1;T>m&&!x;T--){var A=jquery("#"+self.controlName+"_"+self.query+" tr")[T];var I=A.children[0].offsetLeft;if(jquery(A.children[0]).hasClass("h2subtitle")){if(I<=selectedRowOffset){x=true;S=T}}if(!x){OAT.SelectAllRow(A,self.selection.Color)}}for(var T=S;T>=0;T--){var k=jquery("#"+self.controlName+"_"+self.query+" tr")[T];if(!jquery(k.children[0]).hasClass("h2subtitle")){for(var q=0;q<k.children.length;q++){var F=parseInt(jquery(k.children[q]).attr("rowspan"));if(T+F>o){OAT.SetNodeBackgroundColor(k.children[q],self.selection.Color)}}}}}}}}else if(i=="EventSelection"){if(self.sameValue(e,v,r,t,i)){if(!jquery(u.children[0]).hasClass("h2subtitle")&&!jquery(u.children[c]).hasClass("gtotal")&&!jquery(u.children[c]).hasClass("subtotal")){if(self.checkConditions(n,p)){OAT.SetNodeBackgroundColor(u.children[c],self.selection.Color,jquery("#"+self.controlName+"_"+self.query));if(self.selection.SelectedNode.length<=s){self.selection.SelectedNode.push({value:e,dataField:l,type:r,rowData:[self.createDataRowFromItem(p,r)],clicked:false})}else{self.selection.SelectedNode[s].rowData.push(self.createDataRowFromItem(p,r))}if(self.selection.EntireLine){OAT.SelectAllRow(u,self.selection.Color,c);for(var j=o-1;j>0;j--){var E=jquery("#"+self.controlName+"_"+self.query+" tr")[j];for(var R=0;R<E.children.length;R++){var F=parseInt(jquery(E.children[R]).attr("rowspan"));if(j+F>o){OAT.SetNodeBackgroundColor(E.children[R],self.selection.Color)}}}var M=parseInt(jquery(u.children[c]).attr("rowspan"));if(M>=1){for(var j=o+1;j<o+M;j++){OAT.SelectAllRow(jquery("#"+self.controlName+"_"+self.query+" tr")[j],self.selection.Color)}var j=o+M;var E=jquery("#"+self.controlName+"_"+self.query+" tr")[j];if(E!=undefined&&jquery(E.children[0]).hasClass("h2subtitle")&&!jquery(E.children[0]).hasClass("grandtotaltitle")){selectedCellOffset=u.children[c].offsetLeft;rowOffset=E.children[0].offsetLeft;if(rowOffset==selectedCellOffset){OAT.SelectAllRow(E,self.selection.Color)}}}if(self.colConditions.length>0&&r=="MEASURE"){selectedCellOffset=u.children[c].offsetLeft;for(var T=1;T<jquery("#"+self.controlName+"_"+self.query+" tr").length;T++){if(T!=o){var x=false;var A=jquery("#"+self.controlName+"_"+self.query+" tr")[T];for(var E=0;E<A.children.length&&!x;E++){var C=A.children[E].offsetLeft+A.children[E].offsetWidth;if(C>selectedCellOffset){x=true;OAT.SetNodeBackgroundColor(A.children[E],self.selection.Color)}}}}}}}}}}}}}}};this.getRowInitialShift=function(e,r){var t=0;for(var i=r-1;i>=0;i--){var a=e[i];for(var s=0;s<a.children.length;s++){var n=parseInt(jquery(a.children[s]).attr("rowspan"));if(i+n>r){t=t+1}}}return t};this.getCellPositionSpanWithSpans=function(e,r,t){var i=e[r];var a=0;var s=t;var n=0;for(var f=0;f<i.children.length&&a<t;f++){var l=parseInt(jquery(i.children[f]).attr("colspan"));if(l>1){s<l?s=s-l:(s=s-l,n=n+1);a=a+l}else{a=a+1;n=n+1}}return n};this.RedrawSelectedNode=function(){if(self.selection.SelectedNode){for(var e=0;e<self.selection.SelectedNode.length;e++){var r;if(self.selection.SelectedNode[e].type=="DIMENSION"){for(var t=0;t<self.columns.length;t++){if(self.selection.SelectedNode[e].dataField==self.columns[t].getAttribute("dataField")){r=t}}}else{for(var t=0;t<measures.length;t++){if(self.selection.SelectedNode[e].dataField==measures[t].getAttribute("dataField")){r=t}}}if(self.selection.SelectedNode[e].rowData[0]=="GrandTotal"){self.SelectNodes(self.selection.SelectedNode[e].value,self.selection.SelectedNode[e].type,r,"GrandTotal",true)}else if(self.selection.SelectedNode[e].rowData[0].length>0&&self.selection.SelectedNode[e].rowData[0][0]=="PtrTotals"){self.SelectNodes(self.selection.SelectedNode[e].value,self.selection.SelectedNode[e].type,r,self.selection.SelectedNode[e].rowData[0],true)}else{for(var t=0;t<jquery("#"+self.controlName+"_"+self.query+" tr").length;t++){var i=jquery("#"+self.controlName+"_"+self.query+" tr")[t];for(var a=0;a<i.children.length;a++){var s=jquery(i.children[a]).data("itemValue");var n=jquery(i.children[a]).data("typeMorD");var f=jquery(i.children[a]).data("numberMorD");var l=jquery(i.children[a]).data("itemInfo");if(self.sameValue(self.selection.SelectedNode[e].value,s,self.selection.SelectedNode[e].type,r,l)&&r==f&&self.selection.SelectedNode[e].type==n){if(l.row!=undefined){var o=self.createDataRowFromItem(l,n);for(var u=0;u<self.selection.SelectedNode[e].rowData.length;u++){var c=true;for(var v=0;v<self.selection.SelectedNode[e].rowData[u].length;v++){if(self.selection.SelectedNode[e].rowData[u][v]!=undefined&&o[v]!=undefined&&!(self.filterIndexes.indexOf(v)>-1)&&!(self.colConditions.indexOf(v)>-1)){if(self.selection.SelectedNode[e].rowData[u][v]!="[all]"&&o[v]!="[all]"&&self.selection.SelectedNode[e].rowData[u][v].trim()!=o[v].trim()){c=false}}}if(c)self.SelectNodes(self.selection.SelectedNode[e].value,self.selection.SelectedNode[e].type,r,l,true,e)}}}}}}}}};this.sameValue=function(e,r,t,i,a){try{var s=false;if(r!=undefined){var n=t=="DIMENSION"?self.columns[i].getAttribute("dataType"):measures[i].getAttribute("dataType");if(n=="real"||n=="integer"){s=parseFloat(e)==parseFloat(r);if(!s&&t=="DIMENSION"&&a[0]!=undefined&&a[0]=="PtrTotals"&&e.trim()==r.trim())return true}else{s=e.trim()==r.trim()}}return s}catch(e){return false}};this.checkConditions=function(e,r){var t=true;for(var i=0;i<e.length;i++){if(!r.row||!r.row.headers)return false;for(var a=0;a<r.row.headers.length;a++){if(r.row.headers[a].dataField==e[i].DataField){var s;for(var n=0;n<self.columns.length;n++){if(r.row.headers[a].dataField==self.columns[n].getAttribute("dataField")){s=n}}if(!self.sameValue(e[i].Value,r.row.headers[a].value,"DIMENSION",s,r)){return false}}}for(var f=0;f<r.row.cells.length;f++){var s;var l;for(var n=0;n<measures.length;n++){if(r.row.cells[f].dataField==measures[n].getAttribute("dataField")){s=n;l=measures[n].getAttribute("name")}}if(l==e[i].Name){if(!self.sameValue(e[i].Value,r.row.cells[f].value,"MEASURE",s,r)){return false}}}}return t};this.selectValue=function(e){OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[];var r=-2;var t=-2;var i;var a;for(var s=0;s<e.length;s++){var n;var f;for(var l=0;l<measures.length;l++){if(e[s].Name==measures[l].getAttribute("name")){n="MEASURE";f=l}}for(var l=0;l<self.columns.length;l++){if(e[s].Name==self.columns[l].getAttribute("name")){n="DIMENSION";f=l}}if(self.rowConditions.indexOf(f)>=t){r=s;t=self.rowConditions.indexOf(f);i=n;a=f}}self.SelectNodes(e[r].Value,i,a,"EventSelection",false,0,e)};this.deselectValue=function(){OAT.ClearSelectedNodes(jquery("#"+self.controlName+"_"+self.query));self.selection.SelectedNode=[]};this.createDataRowFromItem=function(e,r){var t=e.row;self.pageData.rows.indexOf(t);var i=e.cell;var a=self.pageData.columnsHeaders[i];var s=[];for(var n=0;n<self.pageData.dataFields.length;n++){s[n]=undefined}if(t!=undefined&&t.headers!=undefined){for(var n=0;n<t.headers.length;n++){var f=self.pageData.dataFields.indexOf(t.headers[n].dataField);if(t.headers[n]!=undefined&&t.headers[n].value!=undefined){s[f]=t.headers[n].value}}}if(r!="DIMENSION"){if(a!=undefined){for(var n=0;n<a.subHeaders.length;n++){if(a.subHeaders[n]!=undefined){var f=self.pageData.dataFields.indexOf(a.subHeaders[n].dataField);if(a.subHeaders[n].value!=undefined){s[f]=a.subHeaders[n].value}}}}}for(var n=0;n<self.filterIndexes.length;n++){s[self.filterIndexes[n]]=self.filterDiv.selects[n].value}return s};this.ExpandCollapseHandle=function(e,r){var t=jquery(e).data("itemValue");jquery(e).data("typeMorD");var i=jquery(e).data("numberMorD");var a=jquery(e).data("itemInfo");var s='<DATA event="'+r+'"><ITEM ';s=s+'name="'+columns[i].getAttribute("name")+'" ';s=s+'displayName="'+columns[i].getAttribute("displayName")+'" ';s=s+">";s=s+self.cleanValueForNull(t);s=s+"</ITEM>";s=s+"<CONTEXT>";s=s+"<EXPANDEDVALUES>";var n=s;try{if(a!=""){var f=[];for(var l=0;l<this.GeneralDataRows.length;l++){if(f.indexOf(this.GeneralDataRows[l][i])==-1){f=f.concat(this.GeneralDataRows[l][i]);if(self.conditions[i].collapsedValues.indexOf(this.GeneralDataRows[l][i])===-1){s=s+"<VALUE>"+self.cleanValueForNull(this.GeneralDataRows[l][i])+"</VALUE>"}}}}}catch(e){s=n}s=s+"</EXPANDEDVALUES>";s=s+"</CONTEXT>";s=s+"</DATA>";return s};this.ExpandCollapseHandleWhenServerPagination=function(e,r){if(typeof self.QueryViewerCollection[IdForQueryViewerCollection].ItemExpand=="function"){var t=jquery(e).data("numberMorD");if(self.conditions[t].previousPage>=self.conditions[t].totalPages){var i=self.ExpandCollapseHandleWhenServerPaginationCreateXML(e,r);i=i.replace(/\&/g,"&amp;");self.fireOnItemExpandCollapseEvent(self.QueryViewerCollection[IdForQueryViewerCollection],i,r=="collapse");self.getDataForPivot(self.UcId,self.pageData.ServerPageNumber,self.rowsPerPage,true,"","","","",true)}else{self.lastColumnNumber=t;self.lastRequestAttributeValues="ExpandCollapse";self.lastRequestAttributeValuesElemValue=e;self.lastRequestAttributeValuesAction=r;self.requestAttributeValues(self.columns[t].getAttribute("dataField"),1,0,"")}}else{self.getDataForPivot(self.UcId,self.pageData.ServerPageNumber,self.rowsPerPage,true,"","","","",true)}};this.ExpandCollapseHandleWhenServerPaginationCreateXML=function(e,r){var t=jquery(e).data("itemValue");jquery(e).data("typeMorD");var i=jquery(e).data("numberMorD");jquery(e).data("itemInfo");actionName='event="ItemExpand"';if(r=="collapse"){actionName='event="ItemCollapse"'}var a="<DATA "+actionName+"><ITEM ";a=a+'name="'+columns[i].getAttribute("name")+'" ';a=a+'displayName="'+columns[i].getAttribute("displayName")+'" ';a=a+">";a=a+t;a=a+"</ITEM>";a=a+"<CONTEXT>";a=a+"<EXPANDEDVALUES>";for(var s=0;s<self.conditions[i].distinctValues.length;s++){if(self.conditions[i].collapsedValues.indexOf(self.conditions[i].distinctValues[s])==-1){a=a+"<VALUE>"+self.conditions[i].distinctValues[s]+"</VALUE>"}}a=a+"</EXPANDEDVALUES>";a=a+"</CONTEXT>";a=a+"</DATA>";return a};this.onFilteredChangedEventHandleWhenServerPagination=function(e){if(self.QueryViewerCollection[IdForQueryViewerCollection].FilterChanged){if(self.conditions[e].previousPage>=self.conditions[e].totalPages){self.onFilteredChangedEventHandleWhenServerPaginationCreateXML(e,self.conditions[e].distinctValues,self.conditions[e].blackList)}else{self.lastColumnNumber=e;self.lastRequestAttributeValues="FilteredChanged";self.requestAttributeValues(self.columns[e].getAttribute("dataField"),1,0,"")}}};this.fireOnFilterChangedEvent=function(e,r){setTimeout((function(){var t={QueryviewerId:e,FilterChangedData:r};var i=document.createEvent("Events");i.initEvent("PivotTableOnFilterChangedEvent",true,true);i.parameter=t;document.dispatchEvent(i)}),0)};this.onFilteredChangedEventHandleWhenServerPaginationCreateXML=function(e,r,t){var i='<DATA event="FilterChanged" name="'+self.columns[e].getAttribute("name")+'" displayName="'+self.columns[e].getAttribute("displayName")+'">';for(var a=0;a<r.length;a++){var s=r[a];var n=true;if(self.conditions[e].state=="all"){n=true}else if(self.conditions[e].state=="none"){n=false}else if(self.conditions[e].blackList.indexOf(s)!=-1){n=false}else if(r.indexOf(s)!=-1){n=true}else if(self.conditions[e].defaultAction=="Exclude"){n=false}if(n){i=i+"<VALUE>"+s+"</VALUE>"}}i=i+"</DATA>";if(self.QueryViewerCollection[IdForQueryViewerCollection].FilterChanged){i=i.replace(/\&/g,"&amp;");var f=new DOMParser;var l=f.parseFromString(i,"text/xml");var o=function(e,r){var t;var i;if(e.evaluate){t=e.evaluate(r,e,null,XPathResult.ANY_TYPE,null);i=t.iterateNext()}else{t=e.selectNodes(r);i=t.length>0?t[0]:null}return i};var u=o(l,"/DATA");var c={};c.Name=u.getAttribute("name");c.SelectedValues=[];var v=-1;for(var a=0;a<u.childNodes.length;a++){if(u.childNodes[a].nodeName=="VALUE"){v++;c.SelectedValues[v]=u.childNodes[a].firstChild.nodeValue}}self.fireOnFilterChangedEvent(IdForQueryViewerCollection,c)}};this.onDragundDropEventHandle=function(e,r,t){var i='<DATA event="DragAndDrop" name="'+this.columns[e].getAttribute("name")+'" displayName="'+this.columns[e].getAttribute("displayName")+'" axis="'+r+'"  position="'+(t+1)+'" />';i=i.replace(/\&/g,"&amp;");self.fireOnDragundDropEvent(this.QueryViewerCollection[IdForQueryViewerCollection],i)};this.fireOnDragundDropEvent=function(e,r){setTimeout((function(){var t={QueryViewer:e,Data:r,QueryviewerId:self.IdForQueryViewerCollection};var i=document.createEvent("Events");i.initEvent("PivotTableOnDragundDropEvent",true,true);i.parameter=t;document.dispatchEvent(i)}),0)};this.pivotStateChanged=function(){for(var e=0;e<self.pageData.AxisInfo.length;e++){if(self.pageData.AxisInfo[e].Axis.Type!=self.initState.AxisInfo[e].Axis.Type)return true}for(var r=0;r<self.pageData.DataInfo.length;r++){if(self.pageData.DataInfo[r].Axis.Type!=self.initState.DataInfo[r].Axis.Type)return true}if(self.initState.CollapseInfo.length!=self.pageData.CollapseInfo.length)return true;var t=JSON.stringify(self.initState.CollapseInfo);var i=JSON.stringify(self.pageData.CollapseInfo);if(t!=i)return true;return false};self.initWhenServerPagination()};try{OAT.Loader.featureLoaded("pivot")}catch(e){}function sortUnidimensionalArray(e,r,t){var i;var a=1;var s=function(e,r){if(e==r){return 0}return a*(parseInt(e)>parseInt(r)?1:-1)};var n=function(e,r){if(e==r){return 0}return a*(e>r?1:-1)};var f=true;for(var l=0;l<e.length;l++){if(f&&e[l]!=parseInt(e[l])){f=false}}if(f){i=s}else{i=n}e.sort(i);for(var o=0;o<t.columns[r].childNodes.length;o++){if(t.columns[r].childNodes[o]!=undefined&&t.columns[r].childNodes[o].localName!=undefined&&t.columns[r].childNodes[o].localName==="customOrder"){e=[];for(var u=0;u<t.columns[r].childNodes[o].childNodes.length;u++){if(t.columns[r].childNodes[o].childNodes[u].localName=="Value"){e.push(t.columns[r].childNodes[o].childNodes[u].textContent)}}}}return e}function fillGeneralDistinctValues(e,r,t){r.GeneralDistinctValues=[];for(var i=0;i<e;i++){var a=[];for(var s=0;s<t.length;s++){if(t[s][i]==undefined){if(a.indexOf(" ")==-1){a.push(" ")}}else{if(a.indexOf(t[s][i])==-1){a.push(t[s][i])}}}r.GeneralDistinctValues[i]=sortUnidimensionalArray(a,i,r)}}function fromUndefinedToBlanck(e){for(var r=0;r<e.length;r++){for(var t=0;t<e[r].length;t++){if(e[r][t]==undefined){e[r][t]=" "}}}}function getMeasureNumberByName(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("displayName")==e){return t}}return 0}function getMeasureNumberByDataField(e,r){for(var t=0;t<r.length;t++){if(r[t].getAttribute("dataField")==e){return t}}return 0}OAT.Statistics={list:[{longDesc:"Count",shortDesc:"COUNT",func:"count"},{longDesc:"Sum",shortDesc:"SUM",func:"sum"},{longDesc:"Product",shortDesc:"PRODUCT",func:"product"},{longDesc:"Arithmetic mean",shortDesc:"MEAN",func:"amean"},{longDesc:"Maximum",shortDesc:"MAX",func:"max"},{longDesc:"Minimum",shortDesc:"MIN",func:"min"},{longDesc:"Distinct values",shortDesc:"DISTINCT",func:"distinct"},{longDesc:"Variance",shortDesc:"VAR",func:"variance"},{longDesc:"Standard deviation",shortDesc:"STDDEV",func:"deviation"},{longDesc:"Median",shortDesc:"MEDIAN",func:"median"},{longDesc:"Mode",shortDesc:"MODE",func:"mode"}],count:function(e){return e.length},sum:function(e){if(e=="#FoE#")return"#NaV#";var r=e.length>0;for(var t=0,i=0;i<e.length;i++){if(e[i]!="#NuN#")r=false;if(!isNaN(e[i]))t+=e[i]}if(r)return"#NuN#";return t},product:function(e){for(var r=1,t=0;t<e.length;t++)r*=e[t];return r},amean:function(e){for(var r=0,t=0;t<e.length;t++)r+=e[t];return r=e.length?r/e.length:0},max:function(e){for(var r=Number.MIN_VALUE,t=0;t<e.length;t++)e[t]>r&&(r=e[t]);return r},min:function(e){for(var r=Number.MAX_VALUE,t=0;t<e.length;t++)e[t]<r&&(r=e[t]);return r},distinct:function(e){for(var r=0,t={},i=0;i<e.length;i++)t[e[i]]=1;for(p in t)r++;return r},deviation:function(e){e=OAT.Statistics.variance(e);return Math.sqrt(e)},variance:function(e){if(2>e.length)return 0;for(var r=0,t=OAT.Statistics.amean(e),i=0;i<e.length;i++)r+=(e[i]-t)*(e[i]-t);return r/(e.length-1)},median:function(e){return e.sort((function(e,r){return e-r}))[Math.floor(e.length/2)]},mode:function(e){for(var r={},t=0;t<e.length;t++){var i=e[t]+"";i in r?r[i]++:r[i]=1}var e=0,t="",a;for(a in r)i=r[a],i>e&&(e=i,t=a);return parseFloat(t)}};try{OAT.Loader.featureLoaded("statistics")}catch(e){}OAT.WinData={TYPE_TEMPLATE:-1,TYPE_AUTO:0,TYPE_MS:1,TYPE_MAC:2,TYPE_ROUND:3,TYPE_RECT:4,TYPE_ODS:5};OAT.Win=function(e){var r=this;this.options={title:"",x:0,y:0,visibleButtons:"cmMfr",enabledButtons:"cmMfr",innerWidth:0,innerHeight:0,outerWidth:350,outerHeight:!1,stackGroupBase:100,type:OAT.WinData.TYPE_AUTO,template:!1,className:!1};for(var t in e)this.options[t]=e[t];r.dom={buttons:{c:!1,m:!1,M:!1,f:!1,r:!1},container:!1,content:!1,title:!1,caption:!1,status:!1,resizeContainer:!1};r.moveTo=function(e,t){r.dom.container.style.left=e+"px";r.dom.container.style.top=t+"px"};r.innerResizeTo=function(){};r.outerResizeTo=function(){};r.show=function(){document.body.appendChild(r.dom.container);OAT.Dom.show(r.dom.container)};r.hide=function(){OAT.Dom.hide(r.dom.container)};r.close=r.hide();r.minimize=function(){};r.maximize=function(){};r.flip=function(){};r.accomodate=function(e){e=OAT.Dom.getWH(e);r.innerResizeTo(e[0],e[1])};r.options.type==OAT.WinData.TYPE_TEMPLATE&&OAT.WinTemplate(r);r.options.type==OAT.WinData.TYPE_MS&&OAT.WinMS(r);r.options.type==OAT.WinData.TYPE_MAC&&OAT.WinMAC(r);r.options.type==OAT.WinData.TYPE_RECT&&OAT.WinRECT(r,e.containerQuery);r.options.type==OAT.WinData.TYPE_ROUND&&OAT.WinROUND(r);r.options.type==OAT.WinData.TYPE_ODS&&OAT.WinODS(r);-1!=r.options.enabledButtons.indexOf("m")&&r.dom.buttons.m&&OAT.Dom.attach(r.dom.buttons.m,"click",r.minimize);-1!=r.options.enabledButtons.indexOf("M")&&r.dom.buttons.M&&OAT.Dom.attach(r.dom.buttons.M,"click",r.maximize);-1!=r.options.enabledButtons.indexOf("c")&&r.dom.buttons.c&&OAT.Dom.attach(r.dom.buttons.c,"click",r.hide);-1!=r.options.enabledButtons.indexOf("f")&&r.dom.buttons.f&&OAT.Dom.attach(r.dom.buttons.f,"click",r.flip);-1!=r.options.enabledButtons.indexOf("r")&&r.dom.buttons.r&&OAT.Resize.create(r.dom.buttons.r,r.dom.resizeContainer,OAT.Resize.TYPE_XY);r.dom.title&&OAT.Drag.create(r.dom.title,r.dom.container);r.moveTo(r.options.x,r.options.y);(r.options.outerWidth||r.options.outerHeight)&&r.outerResizeTo(r.options.outerWidth,r.options.outerHeight);(r.options.innerWidth||r.options.innerHeight)&&r.innerResizeTo(r.options.innerWidth,r.options.innerHeight);r.dom.caption&&OAT.addTextNode(r.dom.caption,r.options);r.options.stackGroupBase&&OAT.WinManager.addWindow(r.options.stackGroupBase,r.dom.container);r.hide()};OAT.WinTemplate=function(e){var r=e.options.template;if(r){for(var t="function"==typeof r?r():OAT.$(r).cloneNode(!0),i={oat_w_ctr:"container",oat_w_title_ctr:"title",oat_w_title_t_ctr:"caption",oat_w_content:"content",oat_w_max_b:["buttons","M"],oat_w_min_b:["buttons","m"],oat_w_close_b:["buttons","c"],oat_w_flip_b:["buttons","f"],oat_w_resize_handle:["buttons","r"]},a=[t],r=t.getElementsByTagName("*"),t=0;t<r.length;t++)a.push(r[t]);for(t=0;t<a.length;t++){var r=a[t],s;for(s in i)if(OAT.Dom.isClass(r,s)){var n=i[s];n instanceof Array?e.dom[n[0]][n[1]]=r:e.dom[n]=r}}e.moveTo=function(r,t){e.dom.container.style.left=r+"px";e.dom.container.style.top=t+"px"};e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"};e.innerResizeTo=function(r,t){e.dom.content.style.width=r?r+"px":"auto";e.dom.content.style.height=t?t+"px":"auto"}}else alert("OAT Window cannot be created, as a template is required but not specified!")};OAT.WinMS=function(e){OAT.Style.include("winms.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winms_container");e.dom.resizeContainer=e.dom.container;e.dom.content=OAT.Dom.create("div",{},"oat_winms_content");e.dom.title=OAT.Dom.create("div",{},"oat_winms_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winms_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winms_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winms_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("M")&&(e.dom.buttons.M=OAT.Dom.create("div",{},"oat_winms_max_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.M]));-1!=e.options.visibleButtons.indexOf("m")&&(e.dom.buttons.m=OAT.Dom.create("div",{},"oat_winms_min_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.m]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winms_resize_b"),OAT.Dom.append([e.dom.container,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinMAC=function(e){OAT.Style.include("winmac.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winmac_container");e.dom.resizeContainer=e.dom.container;e.dom.content=OAT.Dom.create("div",{},"oat_winmac_content");e.dom.title=OAT.Dom.create("div",{},"oat_winmac_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winmac_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winmac_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);e.dom.buttons.lc=OAT.Dom.create("div",{},"oat_winmac_leftCorner");OAT.Dom.append([e.dom.title,e.dom.buttons.lc]);e.dom.buttons.rc=OAT.Dom.create("div",{},"oat_winmac_rightCorner");OAT.Dom.append([e.dom.title,e.dom.buttons.rc]);-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winmac_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("M")&&(e.dom.buttons.M=OAT.Dom.create("div",{},"oat_winmac_max_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.M]));-1!=e.options.visibleButtons.indexOf("m")&&(e.dom.buttons.m=OAT.Dom.create("div",{},"oat_winmac_min_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.m]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winmac_resize_b"),OAT.Dom.append([e.dom.container,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t-8+"px":"auto"}};OAT.WinRECT=function(e,r){if(r!=undefined)e.dom.container=OAT.Dom.create("div",{position:"absolute"},r+" oat_winrect_container");else e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winrect_container");e.dom.resizeContainer=e.dom.container;if(OAT.isSD()){e.dom.content=OAT.Dom.create("div",{},"oat_winrect_content oat_winrect_content_small");e.dom.title=OAT.Dom.create("div",{},"oat_winrect_title oat_winrect_title_small")}else{e.dom.content=OAT.Dom.create("div",{},"oat_winrect_content");e.dom.title=OAT.Dom.create("div",{},"oat_winrect_title")}e.dom.caption=OAT.Dom.create("span",{},"oat_winrect_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winrect_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);if(OAT.isSD()){e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winrect_close_b oat_winrect_close_small")}else{e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winrect_close_b")}OAT.addImageNode(e.dom.buttons.c,"close","");OAT.Dom.append([e.dom.title,e.dom.buttons.c]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinROUND=function(e){OAT.Style.include("winround.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winround_container");e.dom.resizeContainer=e.dom.container;e.dom.table=OAT.Dom.create("table",{},"oat_winround_wrapper");e.dom.tr_t=OAT.Dom.create("tr",{});e.dom.td_lt=OAT.Dom.create("td",{},"oat_winround_lt");e.dom.td_t=OAT.Dom.create("td",{},"oat_winround_t");e.dom.td_rt=OAT.Dom.create("td",{},"oat_winround_rt");e.dom.tr_m=OAT.Dom.create("tr",{});e.dom.td_l=OAT.Dom.create("td",{},"oat_winround_l");e.dom.td_m=OAT.Dom.create("td",{},"oat_winround_m");e.dom.td_r=OAT.Dom.create("td",{},"oat_winround_r");e.dom.tr_b=OAT.Dom.create("tr",{});e.dom.td_lb=OAT.Dom.create("td",{},"oat_winround_lb");e.dom.td_b=OAT.Dom.create("td",{},"oat_winround_b");e.dom.td_rb=OAT.Dom.create("td",{},"oat_winround_rb");e.dom.content=OAT.Dom.create("div",{},"oat_winround_content");e.dom.title=OAT.Dom.create("div",{},"oat_winround_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winround_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winround_status");-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winround_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winround_resize_b"),OAT.Dom.append([e.dom.td_rb,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);OAT.Browser.isIE?(OAT.addTextNode(e.dom.container,'<table class="oat_winround_wrapper"><tr><td class="oat_winround_lt"></td><td class="oat_winround_t"></td><td class="oat_winround_rt"></td></tr><tr><td class="oat_winround_l"></td><td class="oat_winround_m"></td><td class="oat_winround_r"></td></tr><tr><td class="oat_winround_lb"></td><td class="oat_winround_b"></td><td class="oat_winround_rb"></td></tr></table>'),e.dom.container.childNodes[0].childNodes[0].childNodes[0].childNodes[1].appendChild(e.dom.title),e.dom.container.childNodes[0].childNodes[0].childNodes[1].childNodes[1].appendChild(e.dom.content),e.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[1].appendChild(e.dom.status),e.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[2].appendChild(e.dom.buttons.r)):(OAT.Dom.append([e.dom.tr_t,e.dom.td_lt,e.dom.td_t,e.dom.td_rt]),OAT.Dom.append([e.dom.tr_m,e.dom.td_l,e.dom.td_m,e.dom.td_r]),OAT.Dom.append([e.dom.tr_b,e.dom.td_lb,e.dom.td_b,e.dom.td_rb]),OAT.Dom.append([e.dom.table,e.dom.tr_t,e.dom.tr_m,e.dom.tr_b]),OAT.Dom.append([e.dom.td_t,e.dom.title]),OAT.Dom.append([e.dom.td_m,e.dom.content]),OAT.Dom.append([e.dom.td_b,e.dom.status]),OAT.Dom.append([e.dom.container,e.dom.table]));e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinODS=function(e){OAT.Style.include("winods.css");e.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winods_container");e.dom.resizeContainer=e.dom.container;e.dom.content=OAT.Dom.create("div",{},"oat_winods_content");e.dom.title=OAT.Dom.create("div",{},"oat_winods_title");e.dom.caption=OAT.Dom.create("span",{},"oat_winods_caption");e.dom.status=OAT.Dom.create("div",{},"oat_winods_status");OAT.Dom.append([e.dom.container,e.dom.title,e.dom.content,e.dom.status]);-1!=e.options.visibleButtons.indexOf("c")&&(e.dom.buttons.c=OAT.Dom.create("div",{},"oat_winods_close_b"),OAT.Dom.append([e.dom.title,e.dom.buttons.c]));-1!=e.options.visibleButtons.indexOf("r")&&(e.dom.buttons.r=OAT.Dom.create("div",{},"oat_winods_resize_b"),OAT.Dom.append([e.dom.container,e.dom.buttons.r]));OAT.Dom.append([e.dom.title,e.dom.caption]);e.outerResizeTo=function(r,t){e.dom.container.style.width=r?r+"px":"auto";e.dom.container.style.height=t?t+"px":"auto"}};OAT.WinManager={stackingGroups:{},addWindow:function(e,r){if(e in OAT.WinManager.stackingGroups)var t=OAT.WinManager.stackingGroups[e];else t=new OAT.Layers(e),OAT.WinManager.stackingGroups[e]=t;t.addLayer(r,"click")},removeWindow:function(){if(zI in OAT.WinManager.stackingGroups)var e=OAT.WinManager.stackingGroups[zI];else e=new OAT.Layers(zI),OAT.WinManager.stackingGroups[zI]=e;e.removeLayer(container)}};try{OAT.Loader.featureLoaded("win")}catch(e){}OAT.Resize={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,element:[],mouse_x:0,mouse_y:0,move:function(e){if(OAT.Resize.element.length){for(var r=e.clientX-OAT.Resize.mouse_x,t=e.clientY-OAT.Resize.mouse_y,i=1,a=0;a<OAT.Resize.element.length;a++){var s=OAT.Resize.element[a][0],s=OAT.Dom.getWH(s),n=OAT.Resize.element[a][2],f=r,l=t;switch(OAT.Resize.element[a][1]){case OAT.Resize.TYPE_X:l=0;break;case-OAT.Resize.TYPE_X:f=-r;l=0;break;case OAT.Resize.TYPE_Y:f=0;break;case-OAT.Resize.TYPE_Y:f=0;l=-t;break;case-OAT.Resize.TYPE_XY:f=-r,l=-t}n(s[0]+f,s[1]+l)&&(i=0)}if(i){for(a=0;a<OAT.Resize.element.length;a++)switch(s=OAT.Resize.element[a][0],OAT.Resize.element[a][1]){case OAT.Resize.TYPE_X:OAT.Dom.resizeBy(s,r,0);break;case-OAT.Resize.TYPE_X:OAT.Dom.resizeBy(s,-r,0);break;case OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(s,0,t);break;case-OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(s,0,-t);break;case OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(s,r,t);break;case-OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(s,-r,-t)}OAT.Resize.mouse_x=e.clientX;OAT.Resize.mouse_y=e.clientY}}},up:function(){for(var e=0;e<OAT.Resize.element.length;e++)OAT.Resize.element[e][3]();OAT.Resize.element=[]},create:function(e,r,t,i,a){var s=OAT.$(e),e=OAT.$(r),r=function(){return!1},n=function(){return!1};i&&(r=i);a&&(n=a);switch(t){case OAT.Resize.TYPE_XY:s.style.cursor="nw-resize";break;case OAT.Resize.TYPE_X:s.style.cursor="w-resize";break;case OAT.Resize.TYPE_Y:s.style.cursor="n-resize"}i=function(e){OAT.Resize.element=s._Resize_movers;OAT.Resize.mouse_x=e.clientX;OAT.Resize.mouse_y=e.clientY;e.cancelBubble=!0};s._Resize_movers||(OAT.Dom.attach(s,"mousedown",i),s._Resize_movers=[]);s._Resize_movers.push([e,t,r,n])},remove:function(e,r){var t=OAT.$(e);OAT.$(r);if(t._Resize_movers){for(var i=-1,a=0;a<t._Resize_movers.length;a++)t._Resize_movers[a][0]==r&&(i=a);-1!=i&&t._Resize_movers.splice(i,1)}},removeAll:function(e){e=OAT.$(e);e._Resize_movers&&(e._Resize_movers=[])},createDefault:function(e,r,t){if(OAT.Preferences.allowDefaultResize){var i=OAT.Dom.create("div",{position:"absolute",width:"10px",height:"10px",right:"0px",fontSize:"1px",bottom:"0px"});e.appendChild(i);OAT.Resize.create(i,e,OAT.Resize.TYPE_XY,r,t);OAT.Dom.hide(i);var a=function(){i._Resize_pending&&OAT.Dom.hide(i)};OAT.Dom.attach(e,"mouseover",(function(){OAT.Dom.show(i);i._Resize_pending=0}));OAT.Dom.attach(e,"mouseout",(function(){i._Resize_pending=1;setTimeout(a,2e3)}))}}};if(typeof document!="undefined"){OAT.Dom.attach(document,"mousemove",OAT.Resize.move);OAT.Dom.attach(document,"mouseup",OAT.Resize.up)}try{OAT.Loader.featureLoaded("resize")}catch(e){}OAT.XMLHTTP=function(){this.obj=this.iframe=!1;this.open=function(e,r,t){this.iframe?this.temp_src=r:this.obj.open(e,r,t)};this.send=function(e){this.iframe?this.ifr.src=this.temp_src:this.obj.send(e)};this.setResponse=function(e){this.iframe?OAT.Dom.attach(this.ifr,"load",e):this.obj.onreadystatechange=e};this.getResponseText=function(){};this.getResponseXML=function(){return this.iframe?(alert("IFRAME mode active -> XML data not supported"),""):this.obj.responseXML};this.getReadyState=function(){return this.iframe?4:this.obj.readyState};this.getStatus=function(){return this.iframe?200:this.obj.status};this.setRequestHeader=function(e,r){this.iframe||this.obj.setRequestHeader(e,r)};this.getAllResponseHeaders=function(){return!this.iframe?this.obj.getAllResponseHeaders():{}};this.isIframe=function(){return this.iframe};window.XMLHttpRequest?this.obj=new XMLHttpRequest:window.ActiveXObject&&(this.obj=new ActiveXObject("Microsoft.XMLHTTP"));this.obj||(this.iframe=!0,this.ifr=OAT.Dom.create("iframe"),this.ifr.style.display="none",this.ifr.src="javascript:;",document.body.appendChild(this.ifr))};OAT.XMLHTTP_supported=function(){return!(new OAT.XMLHTTP).isIframe()};try{OAT.Loader.featureLoaded("ajax")}catch(e){}OAT.AnchorData={active:!1,window:!1};OAT.Anchor={appendContent:function(e){if(e.content&&e.window){"function"==typeof e.content&&(e.content=e.content());var r=e.window;OAT.Dom.clear(r.dom.content);r.dom.content.appendChild(e.content);OAT.Anchor.fixSize(r)}},callForData:function(e,r){var t=e.window;e.stat=1;e.status&&OAT.addTextNode(t.dom.status,e.status);var i=e.datasource;if(i){i.connection=e.connection;var a=e.elm.innerHTML,s=function(){t.dom.caption.innerHTML=e.elm.innerHTML;if(e.title)t.dom.caption.innerHTML=e.title};i.bindRecord(s);i.bindEmpty(s)}switch(e.result_control){case"grid":s=new OAT.FormObject.grid(0,0,0,1);s.showAll=!0;e.content=s.elm;s.elm.style.position="relative";s.init();i.bindRecord(s.bindRecordCallback);i.bindPage(s.bindPageCallback);i.bindHeader(s.bindHeaderCallback);break;case"form":var n=!1;e.content=OAT.Dom.create("div");n=new OAT.Form(e.content,{onDone:function(){t.resizeTo(n.totalWidth+5,n.totalHeight+5);e.anchorTo(r[0],r[1])}});i.bindFile((function(e){e=OAT.Xml.createXmlDoc(e);n.createFromXML(e)}));break;case"timeline":s=new OAT.FormObject.timeline(0,20,0);e.content=s.elm;s.elm.style.position="relative";s.elm.style.width=e.width-5+"px";s.elm.style.height=e.height-65+"px";s.init();for(var f=0;f<s.datasources[0].fieldSets.length;f++)s.datasources[0].fieldSets[f].realIndexes=[f];i.bindPage(s.bindPageCallback)}OAT.Anchor.appendContent(e);if(i){i.options.query=i.options.query.replace(/\$link_name/g,a);e.connection.options.endpoint=e.href;e.connection.options.url=e.href;switch(i.type){case OAT.DataSourceData.TYPE_SPARQL:a=new OAT.SparqlQuery;a.fromString(i.options.query);a=a.variables.length?"format=xml":"format=rdf";i.options.query="query="+encodeURIComponent(i.options.query)+"&"+a;break;case OAT.DataSourceData.TYPE_GDATA:i.options.query=i.options.query?"q="+encodeURIComponent(i.options.query):""}i.advanceRecord(0)}},fixSize:function(e){setTimeout((function(){}),50)},assign:function(e,r){var t=OAT.$(e),i={href:!1,newHref:"javascript:void(0)",connection:!1,datasource:!1,content:!1,status:!1,title:!1,result_control:"grid",activation:"hover",width:340,height:!1,elm:t,window:!1,arrow:!1,type:OAT.WinData.TYPE_RECT,visibleButtons:"cr",enabledButtons:"cr",template:!1},a;for(a in r)i[a]=r[a];var s=new OAT.Win({outerWidth:i.width,outerHeight:i.height,title:"",type:i.type,status:i.status,visibleButtons:i.visibleButtons,enabledButtons:i.enabledButtons,template:i.template,containerQuery:i.containerQuery});OAT.Dom.attach(s.dom.container,"mouseover",(function(){var e=OAT.AnchorData.active;e&&"hover"==e.activation&&e.endClose()}));OAT.Dom.attach(s.dom.container,"mouseout",(function(){var e=OAT.AnchorData.active;e&&"hover"==e.activation&&e.startClose()}));a=OAT.Dom.create("div",{});i.window=s;s.close=function(){OAT.Dom.hide(s.dom.container)};s.onclose=s.close;s.close();i.stat=0;!i.href&&"href"in t&&(i.href=t.href);"a"==t.tagName.toString().toLowerCase()&&OAT.Dom.changeHref(t,i.newHref);i.displayRef=function(e){var r=i.window;r.hide();OAT.AnchorData.active=i;e=OAT.Dom.eventPos(e);OAT.AnchorData.window=r;i.stat?OAT.Anchor.appendContent(i):OAT.Anchor.callForData(i,e);i.activation=="focus"&&(e=OAT.Dom.position(t));i.anchorTo(e[0],e[1]);r.show();i.anchorTo(e[0],e[1])};i.displayRef2=function(e){var r=i.window;r.hide();OAT.AnchorData.active=i;OAT.AnchorData.window=r;i.stat?OAT.Anchor.appendContent(i):OAT.Anchor.callForData(i,e);i.activation=="focus"&&(e=OAT.Dom.position(t));i.anchorTo(e[0],e[1]);r.show();i.anchorTo(e[0],e[1])};i.anchorTo=function(e,r){var t=i.window,a=OAT.Dom.getFreeSpace(e,r),s=OAT.Dom.getWH(t.dom.container);if(a[1])var n=r-30-s[1];else{n=r+30}if(a[0]){a=e+20-s[0]}else{a=e-30}a<0&&(a=10);n<0&&(n=10);t.moveTo(a,n-20)};i.closeRef=function(){if(i.closeFlag){i.window.hide();OAT.AnchorData.active=false}};i.close=function(){i.window.hide()};i.startClose=function(){i.closeFlag=1;setTimeout(i.closeRef,1e3)};i.endClose=function(){i.closeFlag=0};switch(i.activation){case"hover":OAT.Dom.attach(t,"mouseover",i.displayRef);OAT.Dom.attach(t,"mouseout",i.startClose);break;case"click":OAT.Dom.attach(t,"click",i.displayRef);break;case"dblclick":OAT.Dom.attach(t,"dblclick",i.displayRef);break;case"focus":OAT.Dom.attach(t,"focus",i.displayRef),OAT.Dom.attach(t,"blur",i.close)}return i},close:function(e,r){e=OAT.$(e);"BODY"!=e.tagName&&(e.className.match(/^oat_win.+_container$/)?(OAT.Dom.hide(e),r&&this.close(e.parentNode)):this.close(e.parentNode))},openAnchor:function(){var r=this.window;r.hide();OAT.AnchorData.active=this;b=OAT.Dom.eventPos(b);OAT.AnchorData.window=r;a.stat?OAT.Anchor.appendContent(a):OAT.Anchor.callForData(a,b);a.activation=="focus"&&(b=OAT.Dom.position(e));a.anchorTo(b[0],b[1]);r.show();a.anchorTo(b[0],b[1])}};try{OAT.Loader.featureLoaded("anchor")}catch(e){}OAT.Animation=function(e,r){var t=this;this.elm=OAT.$(e);this.options={delay:50,startFunction:function(){},conditionFunction:function(){},stepFunction:function(){},stopFunction:function(){}};for(var i in r)t.options[i]=r[i];this.step=function(){setTimeout((function(){t.running&&(t.options.conditionFunction(t)?(t.running=0,t.options.stopFunction(t),OAT.MSG.send(t,OAT.MSG.ANIMATION_STOP,t)):(t.options.stepFunction(t),t.step(t)))}),t.options.delay)};this.start=function(){t.running=1;t.options.startFunction(t);t.step()};this.stop=function(){t.running=0}};OAT.AnimationSize=function(e,r){var t=this;this.options={width:-1,height:-1,delay:50,speed:1};for(var i in r)t.options[i]=r[i];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e.stepX=0;e.stepY=0;var r=OAT.Dom.getWH(e.elm);e.width=r[0];e.height=r[1];e.diffX=-1==t.options.width?0:t.options.width-r[0];e.diffY=-1==t.options.height?0:t.options.height-r[1];e.signX=0<=e.diffX?1:-1;e.signY=0<=e.diffY?1:-1;var r=e.diffX*e.diffX,i=e.diffY*e.diffY;e.stepX=e.signX*Math.sqrt(t.options.speed*t.options.speed*r/(r+i));e.stepY=e.signY*Math.sqrt(t.options.speed*t.options.speed*i/(r+i))},stopFunction:function(e){-1!=t.options.width&&(e.elm.style.width=t.options.width+"px");-1!=t.options.height&&(e.elm.style.height=t.options.height+"px")},conditionFunction:function(e){var r=0<e.signX?e.width>=t.options.width:e.width<=t.options.width,e=0<e.signY?e.height>=t.options.height:e.height<=t.options.height;-1==t.options.width&&(r=1);-1==t.options.height&&(e=1);return r&&e},stepFunction:function(e){e.width+=e.stepX;e.height+=e.stepY;var r=parseInt(e.width),i=parseInt(e.height);-1!=t.options.width&&(e.elm.style.width=(0<=r?r:0)+"px");-1!=t.options.height&&(e.elm.style.height=(0<=i?i:0)+"px")}});this.start=t.animation.start;this.stop=t.animation.stop};OAT.AnimationPosition=function(e,r){var t=this;this.options={left:-1,top:-1,delay:50,speed:1};for(var i in r)t.options[i]=r[i];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e.stepX=0;e.stepY=0;var r=OAT.Dom.getLT(e.elm);e.left=r[0];e.top=r[1];e.diffX=-1==t.options.left?0:t.options.left-r[0];e.diffY=-1==t.options.top?0:t.options.top-r[1];e.signX=0<=e.diffX?1:-1;e.signY=0<=e.diffY?1:-1;var r=e.diffX*e.diffX,i=e.diffY*e.diffY;e.stepX=e.signX*Math.sqrt(t.options.speed*t.options.speed*r/(r+i));e.stepY=e.signY*Math.sqrt(t.options.speed*t.options.speed*i/(r+i))},stopFunction:function(e){-1!=t.options.left&&(e.elm.style.left=t.options.left+"px");-1!=t.options.top&&(e.elm.style.top=t.options.top+"px")},conditionFunction:function(e){var r=0<e.signX?e.left>=t.options.left:e.left<=t.options.left,e=0<e.signY?e.top>=t.options.top:e.top<=t.options.top;-1==t.options.left&&(r=1);-1==t.options.top&&(e=1);return r&&e},stepFunction:function(e){e.left+=e.stepX;e.top+=e.stepY;var r=parseInt(e.left),i=parseInt(e.top);-1!=t.options.left&&(e.elm.style.left=r+"px");-1!=t.options.top&&(e.elm.style.top=i+"px")}});this.start=t.animation.start;this.stop=t.animation.stop};OAT.AnimationOpacity=function(e,r){var t=this;this.options={opacity:1,delay:50,speed:.1};for(var i in r)t.options[i]=r[i];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e.opacity=1;!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i)&&(e.opacity=parseFloat(OAT.Dom.style(e.elm,"opacity")));if(OAT.isIE()){var r=OAT.Dom.style(e.elm,"filter").match(/alpha\(opacity=([^\)]+)\)/);r&&(e.opacity=parseFloat(r[1])/100)}e.step_=1;e.diff=t.options.opacity-e.opacity;e.sign=0<=e.diff?1:-1;e.step_=e.sign*t.options.speed},stopFunction:function(e){OAT.Style.opacity(e.elm,t.options.opacity)},conditionFunction:function(e){return 0<e.sign?e.opacity+1e-4>=t.options.opacity:e.opacity-1e-4<=t.options.opacity},stepFunction:function(e){e.opacity+=e.step_;OAT.Style.opacity(e.elm,e.opacity)}});this.start=t.animation.start;this.stop=t.animation.stop};OAT.AnimationCSS=function(e,r){var t=this;this.options={delay:50,property:!1,start:0,step:1,stop:10};for(var i in r)t.options[i]=r[i];this.animation=new OAT.Animation(e,{delay:t.options.delay,startFunction:function(e){e[t.options.property]=t.options.start;e.elm.style[t.options.property]=t.options.start},stopFunction:function(e){e.elm.style[t.options.property]=t.options.stop},conditionFunction:function(e){return e[t.options.property]==t.options.stop},stepFunction:function(e){e[t.options.property]+=t.options.step;e.elm.style[t.options.property]=e[t.options.property]}});this.start=t.animation.start;this.stop=t.animation.stop};try{OAT.Loader.featureLoaded("animation")}catch(e){}OAT.getURL=function(){try{var e=location.href.substring(0,location.href.lastIndexOf("/"));var r=e;if(r.substr(0,7)=="http://")r=r.substr(7);var t="";var i=r.indexOf("/");if(i>-1){t=r.substr(i+1);r=r.substr(0,i)}var a=location.href.substring(e.length+1,location.href.length+1);var i=a.indexOf("?");if(i>-1){a=a.substring(0,i)}i=a.indexOf("#");if(i>-1){a=a.substring(0,i)}var s="";i=a.indexOf(".");if(i>-1){s=a.substring(i+1);a=a.substr(0,i)}var n=a;if(s!="")n+="."+s;if(n=="")a="index";args=location.search.substr(1).split("?");return t+a}catch(e){return""}};OAT.PartialSort=function(e,r,t,i,a,s){var n=[];for(var f=0;f<=t-r;f++){n[f]=e[r+f]}if(s[i]){n.sort(function(e){return function(r,t){return parseInt(r[e])===parseInt(t[e])?0:parseInt(r[e])<parseInt(t[e])?-1:1}}(i))}else{n.sort(function(e){return function(r,t){return r[e]===t[e]?0:r[e]<t[e]?-1:1}}(i))}if(i<a-1){var l=n[0][i];var o=0;for(var u=0;u<n.length;u++){if(l!=n[u][i]){l=n[u][i];n=OAT.PartialSort(n,o,u-1,i+1,a,s);o=u}else if(u==n.length-1){n=OAT.PartialSort(n,o,u,i+1,a,s)}}}for(var f=r;f<=t;f++){e[f]=n[f-r]}return e};var currPageNumber=[];OAT.partialTablePagination=function(e,r){var t={rowsPerPage:5,currPage:1,jstype:"pivot",optionsForRows:[5,10,25,50,100],ignoreRows:[],topNav:false,cantPages:10};r=jquery.extend(t,r);return e.each((function(){var e=jquery(this)[0];var i,a,s,n,f,l,o;i="#tablePagination_totalPages";a="#tablePagination_currPage";s="#"+r.controlName+"tablePagination_rowsPerPage";n="#tablePagination_firstPage";f="#tablePagination_prevPage";l="#tablePagination_nextPage";o="#tablePagination_lastPage";var u=t.topNav?"prev":"next";try{t.rowsPerPage=parseInt(t.rowsPerPage)}catch(e){t.rowsPerPage=10}var c=jquery.makeArray(jquery("tbody tr",e));jquery.grep(c,(function(e,r){return jquery.inArray(e,t.ignoreRows)==-1}),false);var v=d();currPageNumber[r.controlName]=t.currPage>v?1:t.currPage;if(jquery.inArray(t.rowsPerPage,t.optionsForRows)==-1)t.optionsForRows.push(t.rowsPerPage);function d(){return t.cantPages}function h(i,s){if(i<1||i>jquery("#"+r.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].innerHTML.replace("&nbsp;",""))return;currPageNumber[r.controlName]=i;jquery(e)[u]().find(a).val(currPageNumber[r.controlName]);currPageNumber[r.controlName]>1?jquery("#tablePagination_firstPage,#tablePagination_prevPage").removeClass("disabled_pivot_button"):jquery("#tablePagination_firstPage,#tablePagination_prevPage").addClass("disabled_pivot_button");currPageNumber[r.controlName]!=v?jquery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jquery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button");if(r.control&&r.jstype=="table"){var n=s?t.rowsPerPage:OAT_JS.grid.gridData[r.controlUcId].rowsPerPage;r.control.getDataForTable(r.controlUcId,i,n,s,"","","","","",true);setTimeout((function(){v=r.control.getActualCantPages(r.controlUcId);currPageNumber[r.controlName]!=v?jquery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jquery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button")}),500)}else if(r.control){var n=s?t.rowsPerPage:r.control.rowsPerPage;r.control.getDataForPivot(r.controlUcId,i,n,s,"","","","","",true)}}function p(){var i=t.optionsForRows;i.sort((function(e,r){return e-r}));var a=jquery(e)[u]().find(s)[0];a.length=0;for(var n=0;n<i.length;n++){if(i[n]==t.rowsPerPage){a.options[n]=new Option(i[n],i[n],true,true)}else{a.options[n]=new Option(i[n],i[n])}}if(v==1||v==0){jquery("#"+r.controlName+"_tablePagination_paginater").css("display","none")}else{jquery("#"+r.controlName+"_tablePagination_paginater").css("display","")}}function m(){var e=1;try{var t=100;if(OAT.isWebkit()&&!(jquery("#"+r.controlName).closest(".gxwebcomponent").length>0)){t=t*100}if(currPageNumber[r.controlName]>t*10){if(jquery("#"+r.controlName).closest(".gxwebcomponent").length>0){e=e+2}var i=currPageNumber[r.controlName]/t;while(i>10){i=i/10;e++}}}catch(e){}var a=currPageNumber[r.controlName]==1?" disabled_pivot_button":"";var s=currPageNumber[r.controlName]==v?" disabled_pivot_button":"";var n=navigator.userAgent.toLowerCase();n.indexOf("android")>-1;if(!OAT.isSD()){var f=[];f.push("<div id='"+r.controlName+"_tablePagination' class='pivot_pag_div'>");f.push("<span id='tablePagination_perPage'>");f.push("<select id='"+r.controlName+"tablePagination_rowsPerPage'></select>");f.push(" "+r.translations.GXPL_QViewerJSPerPage+" ");f.push("</span>");f.push("<span id='"+r.controlName+"_tablePagination_paginater'>");f.push("<div class='pagefirst "+a+"' id='tablePagination_firstPage' >");f.push('<i class="material-icons">first_page</i>');f.push("</div>");f.push("<div class='pageprev "+a+"' id='tablePagination_prevPage' >");f.push('<i class="material-icons">navigate_before</i>');f.push("</div>");f.push("<span style=''>&nbsp;"+r.translations.GXPL_QViewerJSPage+"&nbsp;</span>");f.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[r.controlName]+"' size='"+e+"'>");f.push("<span>&nbsp;"+r.translations.GXPL_QViewerJSOf+"</span><span id='tablePagination_totalPages'>&nbsp;"+v+"</span>");f.push("<div class='pagenext "+s+"' id='tablePagination_nextPage' >");f.push('<i class="material-icons">navigate_next</i>');f.push("</div>");f.push("<div class='pagelast "+s+"' id='tablePagination_lastPage'>");f.push('<i class="material-icons">last_page</i>');f.push("</div>");f.push("</span>");f.push("</div>");return f.join("").toString()}else{var f=[];f.push("<div id='"+r.controlName+"_tablePagination' class='pivot_pag_div pivot_pag_div_sd'>");f.push("<span id='tablePagination_perPage'>");f.push("<select id='"+r.controlName+"tablePagination_rowsPerPage'><option value='5'>5</option></select>");f.push(" "+r.translations.GXPL_QViewerJSPerPage+" ");f.push("</span>");f.push("<span id='"+r.controlName+"_tablePagination_paginater'>");f.push("<div class='pagefirst "+a+"' id='tablePagination_firstPage' >");f.push('<i class="material-icons">first_page</i>');f.push("</div>");f.push("<div class='pageprev "+a+"' id='tablePagination_prevPage' >");f.push('<i class="material-icons">navigate_before</i>');f.push("</div>");f.push("<span style=''>&nbsp;"+r.translations.GXPL_QViewerJSPage+"&nbsp;</span>");f.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[r.controlName]+"' size='"+e+"'>");f.push("<span>&nbsp;"+r.translations.GXPL_QViewerJSOf+"</span><span id='tablePagination_totalPages'>&nbsp;"+v+"</span>");f.push("<div class='pagenext "+s+"' id='tablePagination_nextPage' >");f.push('<i class="material-icons">navigate_next</i>');f.push("</div>");f.push("<div class='pagelast "+s+"' id='tablePagination_lastPage'>");f.push('<i class="material-icons">last_page</i>');f.push("</div>");f.push("</span>");f.push("</div>");return f.join("").toString()}}if(jquery(e)[u]().find(i).length==0){if(t.topNav){jquery(this).before(m())}else{jquery(this).after(m())}}else{jquery(e)[u]().find(a).val(currPageNumber[r.controlName])}p();jquery(e)[u]().find(n).bind("click",(function(e){h(1,false)}));jquery(e)[u]().find(f).bind("click",(function(e){h(currPageNumber[r.controlName]-1,false)}));jquery(e)[u]().find(l).bind("click",(function(e){h(parseInt(currPageNumber[r.controlName])+1,false)}));jquery(e)[u]().find(o).bind("click",(function(e){h(parseInt(jquery("#"+r.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].textContent.replace("&nbsp;","")),false)}));jquery(e)[u]().find(a).bind("change",(function(e){h(parseInt(this.value,10),false)}));jquery(e)[u]().find(s).bind("change",(function(e){t.rowsPerPage=parseInt(this.value,10);v=d();h(1,true)}))}))};exports.OAT=OAT}));const myPivotScss="#QUERYVIEWER1Container{width:100%;height:100%;overflow:auto}gx-query-viewer-pivot{display:contents}";const PIVOT_PAGE="QUERYVIEWER1_Queryviewer1_GeneralQuery1_pivot_page";const PIVOT_CONTENT="QUERYVIEWER1_Queryviewer1_GeneralQuery1_pivot_content";const Pivot=class{constructor(e){registerInstance(this,e);this.metadata='<?xml version = "1.0" encoding = "UTF-8"?>\n\r\n<OLAPCube Version="2" format="compact" decimalSeparator="." thousandsSeparator="," dateFormat="MDY" textForNullValues="" ShowDataLabelsIn="Columns">\n\t<OLAPDimension name="Element1" displayName="Datos Dsc" description="Datos Dsc" dataField="F1" visible="Yes" axis="Rows" canDragToPages="true" summarize="yes" align="left" picture="" dataType="character" format="">\n\t</OLAPDimension>\n\t<OLAPDimension name="Element2" displayName="Datos Codigo" description="Datos Codigo" dataField="F2" visible="Yes" axis="Rows" canDragToPages="true" summarize="yes" align="left" picture="" dataType="character" format="">\n\t</OLAPDimension>\n\t<OLAPMeasure name="Element3" displayName="Datos Valor" description="Datos Valor" dataField="F3" visible="Yes" aggregation="" align="right" picture="ZZZ9" targetValue="0" maximumValue="0" dataType="integer" format="">\n\t</OLAPMeasure>\n</OLAPCube>\n';this.data=undefined;this.qViewer=undefined;this.qv={collection:{QUERYVIEWER1_Queryviewer1:{AutoRefreshGroup:"",debugServices:false,ControlName:"Queryviewer1",Metadata:{Axes:[{RaiseItemClick:true},{RaiseItemClick:true}],Data:[{RaiseItemClick:true},{RaiseItemClick:true}]}}},fadeTimeouts:{}};this.QueryViewerTranslations={GXPL_QViewerSinceTheBeginningTrend:"Trend Since The Beginning",GXPL_QViewerLastDayTrend:"Trend Last Day",GXPL_QViewerLastHourTrend:"Trend Last hour",GXPL_QViewerJSAllOption:"Todos",GXPL_QViewerJSAscending:"Ascending",GXPL_QViewerJSDescending:"Descendiente",GXPL_QViewerJSSubtotals:"Subtotal",GXPL_QViewerJSRestoreDefaultView:"Restore",GXPL_QViewerJSPivotDimensionToColumn:"To COlumns",GXPL_QViewerJSPivotDimensionToRow:"To Dimensions",GXPL_QViewerJSMoveToFilterBar:"To Filters",GXPL_QViewerJSAll:"ALL",GXPL_QViewerJSNone:"NONE",GXPL_QViewerJSReverse:"Revert",GXPL_QViewerSearch:"Search",GXPL_QViewerInfoUser:"User Info",GXPL_QViewerJSDropFiltersHere:"Drop her filters",GXPL_QViewerPopupTitle:"Title p",GXPL_QViewerJSVisibleColumns:"Visible columns",GXPL_QViewerContextMenuExportXml:"Export to XML",GXPL_QViewerContextMenuExportHtml:"To Html",GXPL_QViewerContextMenuExportPdf:"To PDF",GXPL_QViewerContextMenuExportXls2003:"To xls",GXPL_QViewerContextMenuExportXlsx:"To Xlsx",GXPL_QViewerJSMeasures:"Measures",GXPL_QViewerJSValue:"Value",GXPL_QViewerJSTotal:"Grand Total",GXPL_QViewerJSTotalFor:"Total for",GXPL_QViewerJSPerPage:"Roes:",GXPL_QViewerJSPage:"Pags:",GXPL_QViewerJSOf:"of",GXPL_QViewerJSMoveColumnToLeft:"to left",GXPL_QViewerJSMoveColumnToRight:"to right"}}handleRequestPageDataForPivotTable(e){const r=`<?xml version = "1.0" encoding = "UTF-8"?>\n    <Recordset RecordCount="10" PageCount="1">\n      <Page PageNumber="1">\n        <Columns>\n          <Header DataField="F1">\n          </Header>\n        </Columns>\n        <Rows>\n          <Row>\n            <Header>\n              <F2>2023-02-12</F2>\n            </Header>\n            <Cells>\n              <Cell>120</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-05-15</F2>\n            </Header>\n            <Cells>\n              <Cell>100</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-05-16</F2>\n            </Header>\n            <Cells>\n              <Cell>200</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-05-17</F2>\n            </Header>\n            <Cells>\n              <Cell>150</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-05-18</F2>\n            </Header>\n            <Cells>\n              <Cell>250</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-05-19</F2>\n            </Header>\n            <Cells>\n              <Cell>120</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-05-20</F2>\n            </Header>\n            <Cells>\n              <Cell>400</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-06-20</F2>\n            </Header>\n            <Cells>\n              <Cell>80</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header>\n              <F2>2023-09-10</F2>\n            </Header>\n            <Cells>\n              <Cell>233</Cell>\n            </Cells>\n          </Row>\n          <Row>\n            <Header Subtotal="true">\n            </Header>\n            <Cells>\n              <Cell>1653</Cell>\n            </Cells>\n          </Row>\n        </Rows>\n      </Page>\n    </Recordset>`;e.parameter.callback(r)}componentDidLoad(){const e=`<?xml version = "1.0" encoding = "UTF-8"?>\n\n<OLAPCube Version="2" format="compact" decimalSeparator="." thousandsSeparator="," dateFormat="MDY" textForNullValues="" ShowDataLabelsIn="Columns">\n\t<OLAPDimension name="Element3" displayName="Fecha" description="Fecha" dataField="F2" visible="Yes" axis="Rows" canDragToPages="true" summarize="yes" align="left" picture="99/99/99" dataType="date" format="">\n\t</OLAPDimension>\n\t<OLAPMeasure name="Element1" displayName="Sum of Gasto" description="Sum of Gasto" dataField="F1" visible="Yes" aggregation="sum" align="right" picture="ZZZZZZZZ9.99" targetValue="0" maximumValue="0" dataType="real" format="">\n\t</OLAPMeasure>\n</OLAPCube>\n`;this.qViewer={xml:{metadata:e},pivotParams:{page:PIVOT_PAGE,content:PIVOT_CONTENT,container:this.queryViewerContainer,RealType:"PivotTable",ObjectName:"General.Query1",ControlName:"Queryviewer1",PageSize:20,metadata:e,UcId:"QUERYVIEWER1_Queryviewer1",AutoResize:false,DisableColumnSort:false,RememberLayout:true,ShowDataLabelsIn:"Columns",ServerPaging:true,ServerPagingPivot:true,ServerPagingCacheSize:0,UseRecordsetCache:true,AllowSelection:false,SelectLine:true,TotalForColumns:"Yes",TotalForRows:undefined,Title:""},oat_element:undefined};if(oat_pivotTable.OAT.Loader!=undefined){oat_pivotTable.renderJSPivot(this.qViewer.pivotParams,this.qv.collection,this.QueryViewerTranslations,this.qViewer)}else{oat_pivotTable.OAT.Loader.addListener((function(){oat_pivotTable.renderJSPivot(this.qViewer.pivotParams,this.pivotCollection.collection,this.QueryViewerTranslations,this.qViewer)}))}}render(){return h("div",{class:"gx_usercontrol qv-pivottable QueryViewer-pivottable",id:"QUERYVIEWER1Container",ref:e=>this.queryViewerContainer=e},h("div",{id:PIVOT_PAGE,class:"pivot_filter_div"}),h("div",{id:PIVOT_CONTENT,class:"conteiner_table_div"}))}};Pivot.style=myPivotScss;export{Pivot as my_pivot};